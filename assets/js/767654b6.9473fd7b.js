"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[30256],{91699:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>o,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"Xuanji/CTF/82","title":"2024 \u94c1\u4eba\u4e09\u9879 \u51b3\u8d5b Misc - BlindFlowanalyis","description":"\u6d41\u91cf\u5305\u521d\u6b65\u5206\u6790","source":"@site/docs/Xuanji/CTF/82.md","sourceDirName":"Xuanji/CTF","slug":"/Xuanji/CTF/82","permalink":"/Target-Machines-WriteUp/docs/Xuanji/CTF/82","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/CTF/82.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Xuanji_Sidebar","previous":{"title":"2024 \u94c1\u4eba\u4e09\u9879 \u51b3\u8d5b Misc - Zip_guessinteger","permalink":"/Target-Machines-WriteUp/docs/Xuanji/CTF/77"},"next":{"title":"2024 \u94c1\u4eba\u4e09\u9879 \u51b3\u8d5b Reverse - \u6587\u5b57\u8c1c\u9898","permalink":"/Target-Machines-WriteUp/docs/Xuanji/CTF/83"}}');var r=s(74848),a=s(28453);const t={},c="2024 \u94c1\u4eba\u4e09\u9879 \u51b3\u8d5b Misc - BlindFlowanalyis",l={},d=[{value:"\u6d41\u91cf\u5305\u521d\u6b65\u5206\u6790",id:"\u6d41\u91cf\u5305\u521d\u6b65\u5206\u6790",level:2},{value:"\u63d0\u53d6\u654f\u611f\u4fe1\u606f",id:"\u63d0\u53d6\u654f\u611f\u4fe1\u606f",level:2},{value:"\u89e3\u5bc6\u4fe1\u606f",id:"\u89e3\u5bc6\u4fe1\u606f",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"2024-\u94c1\u4eba\u4e09\u9879-\u51b3\u8d5b-misc---blindflowanalyis",children:"2024 \u94c1\u4eba\u4e09\u9879 \u51b3\u8d5b Misc - BlindFlowanalyis"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6d41\u91cf\u5305\u521d\u6b65\u5206\u6790",children:"\u6d41\u91cf\u5305\u521d\u6b65\u5206\u6790"}),"\n",(0,r.jsx)(n.p,{children:"\u603b\u5171\u7ed9\u4e86\u4e24\u4e2a\u6587\u4ef6"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"webflow1.pcap"}),"\n",(0,r.jsx)(n.li,{children:"webflow2.pcap"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5148\u5bf9 ",(0,r.jsx)(n.code,{children:"webflow1.pcap"})," \u8fdb\u884c\u5206\u6790"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(48817).A+"",width:"2560",height:"1540"})}),"\n",(0,r.jsx)(n.p,{children:"\u524d\u9762\u90e8\u5206\u90fd\u662f\u76ee\u5f55\u7206\u7834\u7684\u6d41\u91cf\uff0c\u5230\u4e86\u540e\u9762\u90e8\u5206"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(95136).A+"",width:"2560",height:"1540"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f88\u660e\u663e\u7684\u5c31\u662f sql \u6ce8\u5165\u7684\u8bed\u53e5\uff0c\u5c06 sql \u6ce8\u5165\u7684\u8bed\u53e5\u8fdb\u884c\u63d0\u53d6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"tshark -r webflow1.pcap -T fields -Y 'http.request.uri.path ==\"/cgi-bin/getauthor.py\"'-e http.request.uri | perl -MURI::Escape -lne'print uri_unescape($_);' > webflow1.pcap.sql\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\u7f16\u5199\u811a\u672c\u4ece\u5176\u4e2d\u7b5b\u9009\u51fa\u6765\u542b\u6709\u7684\u8868"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'with open("webflow1.pcap.sql", "r") as f:\n    data_sql = f.read().strip().split("\\n")\n\ndata_sql = [i.split(" ") for i in data_sql]\ndata_sql = [[j.lower() for j in i if j != ""] for i in data_sql]\n\nres = []\n\nfor i in data_sql:\n    if "from" in i:\n        index_FROM = i.index("from")\n        data_table = i[index_FROM + 1].split(")")[0]\n        if data_table in res:\n            continue\n        else:\n            res.append(data_table)\n\nprint(res)\n\nprint("\\n-".join(res))\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u5176\u4e2d\u5f97\u77e5\u5b58\u5728\u6709\u4e00\u4e0b\u8868"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"msysaccessobjects"}),"\n",(0,r.jsx)(n.li,{children:"sysibm.sysdummy1"}),"\n",(0,r.jsx)(n.li,{children:"rdb$database"}),"\n",(0,r.jsx)(n.li,{children:"information_schema.io_statistics"}),"\n",(0,r.jsx)(n.li,{children:"information_schema.system_users"}),"\n",(0,r.jsxs)(n.li,{children:["sysmaster",":sysdual"]}),"\n",(0,r.jsx)(n.li,{children:"versions"}),"\n",(0,r.jsx)(n.li,{children:"system.onerow"}),"\n",(0,r.jsx)(n.li,{children:"dual"}),"\n",(0,r.jsx)(n.li,{children:"sqlite_master"}),"\n",(0,r.jsx)(n.li,{children:"secret"}),"\n",(0,r.jsx)(n.li,{children:"flagdata"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u540c\u7406\uff0c\u5bf9 ",(0,r.jsx)(n.code,{children:"webflow2.pcap"})," \u8fdb\u884c\u540c\u6837\u7684\u64cd\u4f5c"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"flagdata"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u63d0\u53d6\u654f\u611f\u4fe1\u606f",children:"\u63d0\u53d6\u654f\u611f\u4fe1\u606f"}),"\n",(0,r.jsxs)(n.p,{children:["\u90a3\u4e48\u5c31\u5f88\u660e\u663e\u4e86\uff0c\u6709\u4e24\u4e2a\u8868 ",(0,r.jsx)(n.code,{children:"secret"})," \u548c ",(0,r.jsx)(n.code,{children:"flagdata"})," \u9700\u8981\u6ce8\u610f"]}),"\n",(0,r.jsx)(n.p,{children:"\u627e\u5230\u4e24\u4e2a\u8868\u7684\u6240\u6709\u76f8\u5173\u6d41\u91cf"}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"\u76f2\u6ce8\u7684\u76f8\u5173\u8bb0\u5f55\u592a\u591a\u4e86\uff0c\u6240\u4ee5\u505a\u4e86\u9690\u85cf"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",metastring:'title="webflow1.pcap"',children:"$ tshark -r webflow1.pcap -T fields -Y 'http.request.uri.path ==\"/cgi-bin/getauthor.py\"'-e http.request.uri | perl -MURI::Escape -lne'print uri_unescape($_);' | grep secret\n/cgi-bin/getauthor.py?name=Albert'union/**/select name,pub_key,private_key,contract,datetime,1,1,1,1 from secret where'1'='1\ntshark: The file \"webflow1.pcap\" appears to have been cut short in the middle of a packet.\n/cgi-bin/getauthor.py?name=Albert'union/**/select name,pub_key,private_key,contract,datetime,1,1,1,1 from secret where'1'='1\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",metastring:'title="webflow2.pcap"',children:"$ tshark -r webflow2.pcap -T fields -Y 'http.request.uri.path ==\"/cgi-bin/getauthor.py\"'-e http.request.uri | perl -MURI::Escape -lne'print uri_unescape($_);'| grep\"flagdata\"| grep -e\"union\"\n/cgi-bin/getauthor.py?name=Albert'union/**/select name,flagdata,note,datetime,1,1,1,1,1 from flagdata where'1'='1\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f88\u597d\uff0c\u662f\u76f4\u63a5\u8054\u5408\u67e5\u8be2\u800c\u4e0d\u662f\u76f2\u6ce8\uff0c\u90a3\u4e48\u53bb\u627e\u5230\u5bf9\u5e94\u6d41\u91cf\u63d0\u53d6\u8fd4\u56de\u5305"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:'(http.request.uri.path == "/cgi-bin/getauthor.py") && (http.request.uri.query.parameter contains "secret")\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(63516).A+"",width:"2560",height:"1540"})}),"\n",(0,r.jsx)(n.p,{children:"\u67e5\u770b\u8fd4\u56de\u5305"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(7926).A+"",width:"2560",height:"1540"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u5176\u4e2d\u5173\u6ce8\u5230 ",(0,r.jsx)(n.code,{children:"admin"})," \u8d26\u6237\u7684\u5bc6\u94a5"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"-----BEGIN PUBLIC KEY-----\nMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBtGmqBdtXPN9TcBo9UXwHbozxSjAgOk4sfOTYhbWgjcp8ia2BaIsHUfOB2SpevVejexwNxDFOo6v/mycoFOF8wqpiii8tGTVB+FBo39YKkBI4yI863VsB3NJV8gedFZAybEUkwkFhGN7mVs9XTaYYrHXNFWRIxjvnjQtpMnAvvQIDAQAB\n-----END PUBLIC KEY-----\n\n-----BEGIN ENCRYPTED PRIVATE KEY-----\nMTTC3TBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQIVLQmLXnlUYkCAggAMAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAEqBBBCQKgOObf2BrhJ9tHvAb4oBIICgP3WaNdtO3oTAX1GjdqBL0f6HvFZ9q25EIOAah78rfhKNrJQP0uHHUnbIDKUZTSMwNZ7kNQAAnJPdjwhZVNbymCjUrVvqs0VD8GWncUlIIxrAkpsgqioABSKLoy280ubg2s1IV/sqbuuvN4ldPvnAvyrLLnNLgGyU86v2Q1ArFWfG4kgeZSpW06W6TwgeIZbjRSnLKFXx1VEhpZSCOadg/HOh8BfLbFlZiWgDiuTdVSzGq34fLV8jKYfUjhEffh/tCNhjU5E8M6ItqgXZYyjbBO2ujewBzV1JiBE0QvcavwT8JvV2IDQXBtQmBJZXH4Vqoo2n5YmUgUFDxoZSdAqOfh5kcgO0OgORhOrX/qNisaDfBMwGx2csywJBuSujzZ3ckV3Gv2ysMzRPKfyZ/v10zElsrKZHci2wDMZ4XYqNyvPDafWaxkSNXP64eYRS8J6WVgWycaPq0LkoJnuxtmOnlYlZ8cmY2zOf4WfyG7X+NhK6CllS0or2Y7fuqo80dmGTrg7cuVA1GguRMA6qZAOlbqu8zT53vGUOIHDRQFb8DUU5H6t+I3e0+0Qj8ZwgTtUMCx2/WLc0YAq18Al9okrtsxuYIQ815SSxXKOXZsX93hACLEFFkKOW7vNdBMJdVJnbPoaMotkDYtH/d8TYPrrtyOhPRa/Xl8BzA9J40Z3PE+5XaQfTC4Wx9GMb3y/Dv1lVXrAd9XvCPD8jr6tu+aQWpMAq0uLpF0kgyS/5FDfIpiEHMMuRQ+FBKS58HWVkX1yKNmXkljJRpwe53AHLuDgt+0LNhry+5ck2GFH7bkxU13WmotrtUtnSdIX7FZrQzbJmbwHiyMi7oGdKT7vxkr3aFY=\n-----END ENCRYPTED PRIVATE KEY-----\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u540c\u6837\u7684\uff0c\u627e\u5230 ",(0,r.jsx)(n.code,{children:"flagdata"})," \u8868\u4e2d\uff0c\u7528\u6237 ",(0,r.jsx)(n.code,{children:"admin"})," \u7684\u6570\u636e"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"MDgnetOpihRoTmbreC2P7EQqkmeHloAWQ0SA2gKuHWPUP3u8u81ewsTnlyhvc7qL\nMMpVl36M9Z0Hu++yIKt2C/mimOFH04ixQAUo5y8h8vajw7vRLwfhpxC+pSjWvxjP\n2ieWVgdmXraijq92K6vdXod/SVaOyBT/1/asqhq1abQ=\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u89e3\u5bc6\u4fe1\u606f",children:"\u89e3\u5bc6\u4fe1\u606f"}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728 ",(0,r.jsx)(n.code,{children:"BEGIN ENCRYPTED PRIVATE KEY"})," \u5934\u90e8\u7684 ",(0,r.jsx)(n.code,{children:"MTTC"})," \u9700\u8981\u66f4\u6539\u4e3a ",(0,r.jsx)(n.code,{children:"MIIC"})," \u624d\u80fd\u6b63\u786e\u8bc6\u522b\uff0c\u56e0\u4e3a ",(0,r.jsx)(n.code,{children:"PKCS #8 format"})]})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4f7f\u7528 ",(0,r.jsx)(n.a,{href:"https://mp.weixin.qq.com/s/p484j38nCFGpuy6qkv-hdA",children:"\u7b2c\u4e00\u5c4a \u201c\u957f\u57ce\u676f\u201d \u4fe1\u606f\u5b89\u5168\u94c1\u4eba\u4e09\u9879\u8d5b\u7ebf\u4e0b\u51b3\u8d5b - WriteUp"})," \u4e2d\u63d0\u4f9b\u7684\u5bc6\u7801\u7206\u7834\u811a\u672c"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from Crypto.PublicKey import RSA\nfrom rich.progress import Progress\n\n# \u8bfb\u53d6\u52a0\u5bc6\u7684\u79c1\u94a5\u6587\u4ef6\nfile_in = open("private.pem", "rb")\nencrypted_key = file_in.read()\nfile_in.close()\n\n# \u5bc6\u7801\u7206\u7834\u51fd\u6570\ndef passphrase_cracker():\n    # \u8bfb\u53d6\u5bc6\u7801\u5b57\u5178\u6587\u4ef6\n    with open("/usr/share/wordlists/rockyou.txt", "r", encoding="latin-1") as file:\n        passwords = file.readlines()\n    print(1)\n    # \u5c1d\u8bd5\u6bcf\u4e2a\u5bc6\u7801\n    with Progress() as progress:\n        task = progress.add_task("Processing...", total=len(passwords))\n        for password in passwords:\n            passphrase = password.strip()\n            progress.update(task, advance=1)\n            try:\n                key = RSA.import_key(encrypted_key, passphrase=passphrase)\n                print(f"Passphrase cracked: {passphrase}")\n                print("n = %d" % key.n)\n                print("e = %d" % key.e)\n                print("d = %d" % key.d)\n                print("p = %d" % key.p)\n                print("q = %d" % key.q)\n                break  # \u5982\u679c\u627e\u5230\u6b63\u786e\u7684\u5bc6\u7801\uff0c\u505c\u6b62\u5faa\u73af\n            except ValueError:\n                continue\n\n\n# \u8c03\u7528\u5bc6\u7801\u7206\u7834\u51fd\u6570\npassphrase_cracker()\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4ee5\u53ca Hashcat \u5de5\u5177\uff0c\u914d\u5408 rockyou \u5b57\u5178\u8fdb\u884c\u7206\u7834\uff0c\u5747\u5931\u8d25\u4e86"}),"\n",(0,r.jsx)(n.p,{children:"\u8fd9\u91cc\u76f4\u63a5\u9644\u4e0a\u89e3\u5bc6\u540e\u7ed3\u679c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from Crypto.PublicKey import RSA\nimport libnum\nimport gmpy2\n\nn = 136024092362152689710172713899392826085562613819502637163574709012959800908069097569347489959246188000879909455954675900898187256462694001680199507890264369748020986792003039927832146357618380320485640247974651461597017754521523478582789651823653650205470697891883134131193787384293246455773119816555908050877\ne = 65537\nd = 96983349311172448114610684077344531859866705158061854017461211652174689366790434748659538326833645524163686606777761277160529104669611099325734812475218305914063705028257975357368955813173682894994622796568980398528404622799756620123598161913849740935593865664141149764560174893499019267153779766584891066853\np = 12048894621399454101058574170146672880023504304935502855438830209547540828334463319100866266089541071671086068945870668091434002554455832672446379382564831\nq = 11289342021513486663717934560260253958877903230700176094000844663541917077757746704211638621740652499799934180688739478331856827700031454191788549757111267\n\nc = "MDgnetOpihRoTmbreC2P7EQqkmeHloAWQ0SA2gKuHWPUP3u8u81ewsTnlyhvc7qLMMpVl36M9Z0Hu++yIKt2C/mimOFH04ixQAUo5y8h8vajw7vRLwfhpxC+pSjWvxjP2ieWVgdmXraijq92K6vdXod/SVaOyBT/1/asqhq1abQ="\n\nimport base64\n\nc = base64.b64decode(c.encode())\nc = libnum.s2n(c)\n\nphi = (p - 1) * (q - 1)\nd = gmpy2.invert(e, phi)\nm = pow(c, d, n)\nprint(libnum.n2s(int(m)))\n\n# flag{182w3t-he5dr4y8g-gy590-gggtd46nd-dgw3456utg676}\n'})})]})}function o(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},95136:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20241011-181150-2790750a3ca797b2e31a8195848a2279.png"},63516:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20241038-183856-0ecdd21505ba36065b0397b45a7ec6eb.png"},7926:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20241040-184009-b8f48340f98e5e419335322bcb888565.png"},48817:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20241052-175247-87d839c4968ee7a09e20c425cb43dbe6.png"},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var i=s(96540);const r={},a=i.createContext(r);function t(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);