"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4794],{41377:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>t});var o=s(59444),i=s(74848),r=s(28453);const a={slug:"Hackthebox Battleground Scripts",title:"Hackthebox Battleground \u5999\u5999\u547d\u4ee4",authors:"Randark",toc_max_heading_level:5,tags:["Incident-Response"]},l=void 0,c={authorsImageUrls:[void 0]},t=[{value:"Web \u8fdb\u7a0b\u9632\u8303",id:"web-\u8fdb\u7a0b\u9632\u8303",level:2},{value:"SSH \u5b89\u5168\u9632\u8303",id:"ssh-\u5b89\u5168\u9632\u8303",level:2}];function d(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"\u6de6\u4ed6"}),"\n",(0,i.jsx)(n.h2,{id:"web-\u8fdb\u7a0b\u9632\u8303",children:"Web \u8fdb\u7a0b\u9632\u8303"}),"\n",(0,i.jsx)(n.p,{children:"\u4ee5 Nginx \u4e3a\u4f8b\uff0c\u63d0\u53d6 Nginx \u7684\u4e3b\u8fdb\u7a0b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'root@jmt-projekt:~# ps auxe | grep nginx | pgrep -f "nginx: master process"\n3568483\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u67e5\u770b\u8fdb\u7a0b\u6811"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"root@jmt-projekt:~# pstree -p 3568483\nnginx(3568483)\u2500\u252c\u2500nginx(3568484)\n               \u2514\u2500nginx(3568485)\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u7b5b\u9009\u6240\u6709\u5b50\u8fdb\u7a0b\u7684 pid"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"root@jmt-projekt:~# pstree -p 3568483 | grep -o '([0-9]\\+)' | grep -o '[0-9]\\+'\n3568483\n3568484\n3568485\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u68c0\u67e5\u6240\u6709\u5b50\u8fdb\u7a0b\u7684 process name"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"root@jmt-projekt:~# pstree -p 3568483 | grep -o '([0-9]\\+)' | grep -o '[0-9]\\+' | xargs -I{} sh -c 'ps -o comm= -p {}'\nnginx\nnginx\nnginx\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u663e\u793a\u6240\u6709\u975e nginx \u7684 process \u7684 pid"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pstree -p 3568483 | grep -o '([0-9]\\+)' | grep -o '[0-9]\\+' | xargs -I{} sh -c 'ps -o comm= -p {} | grep -qv nginx && echo {}'\nNone\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u7136\u540e\u8c03\u7528 ",(0,i.jsx)(n.code,{children:"kill -9"})," \u5f3a\u5236\u7ec8\u6b62\u8fdb\u7a0b"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pstree -p 3568483 | grep -o '([0-9]\\+)' | grep -o '[0-9]\\+' | xargs -I{} sh -c 'ps -o comm= -p {} | grep -qv nginx && kill -9 {}'\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5b9e\u73b0\u4e3a\u4e00\u4e2a\u5b8c\u6574\u7684\u811a\u672c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\nLOG_FILE="/var/log/nginx_kill_suspicious.log"\n\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\nlog() {\n    local message="$1"\n    echo "$(date \'+%Y-%m-%d %H:%M:%S\') - $message" | tee -a "$LOG_FILE"\n}\n\n# \u4e3b\u5faa\u73af\nwhile true; do\n    # \u83b7\u53d6 nginx \u4e3b\u8fdb\u7a0b\u7684 PID\n    nginx_master_pid=$(ps auxe | grep nginx | pgrep -f "nginx: master process")\n\n    if [ -z "$nginx_master_pid" ]; then\n        log "\u672a\u627e\u5230 nginx \u4e3b\u8fdb\u7a0b\uff0c\u8df3\u8fc7\u672c\u6b21\u68c0\u6d4b\u3002"\n    else\n        log "\u68c0\u6d4b\u5230 nginx \u4e3b\u8fdb\u7a0b PID: $nginx_master_pid"\n\n        # \u83b7\u53d6 nginx \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\n        all_child_pids=$(pstree -p "$nginx_master_pid" | grep -o \'([0-9]\\+)\' | grep -o \'[0-9]\\+\')\n\n        if [ -z "$all_child_pids" ]; then\n            log "\u672a\u68c0\u6d4b\u5230\u5b50\u8fdb\u7a0b\u3002"\n        else\n            # \u5217\u51fa\u6240\u6709\u5b50\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\n            log "\u6240\u6709\u5b50\u8fdb\u7a0b\u4fe1\u606f\uff1a"\n            for pid in $all_child_pids; do\n                process_info=$(ps -o pid,comm,args= -p "$pid" --no-headers)\n                log "PID: $process_info"\n            done\n\n            # \u83b7\u53d6 nginx \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u975e nginx \u5b50\u8fdb\u7a0b\n            suspicious_pids=$(echo "$all_child_pids" | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv nginx && echo {}\')\n\n            if [ -z "$suspicious_pids" ]; then\n                log "\u672a\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b\u3002"\n            else\n                # \u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\u5e76\u8bb0\u5f55\u65e5\u5fd7\n                for pid in $suspicious_pids; do\n                    process_info=$(ps -o pid,comm,args= -p "$pid" --no-headers)\n                    log "\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b PID: $process_info\uff0c\u6b63\u5728\u6740\u6b7b..."\n                    kill -9 "$pid"\n                    if [ $? -eq 0 ]; then\n                        log "\u6210\u529f\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid"\n                    else\n                        log "\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid \u5931\u8d25\uff01"\n                    fi\n                done\n            fi\n        fi\n    fi\n\n    # \u7b49\u5f85 1 \u79d2\n    sleep 1\ndone\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u540c\u6837\u7684\uff0c\u53ef\u4ee5\u4e3a ",(0,i.jsx)(n.code,{children:"apache2"})," \u5b9e\u73b0\u76f8\u540c\u7684\u6548\u679c"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\nLOG_FILE="/var/log/apache2_kill_suspicious.log"\n\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\nlog() {\n    local message="$1"\n    echo "$(date \'+%Y-%m-%d %H:%M:%S\') - $message" | tee -a "$LOG_FILE"\n}\n\n# \u4e3b\u5faa\u73af\nwhile true; do\n    # \u83b7\u53d6 apache2 \u4e3b\u8fdb\u7a0b\u7684 PID\n    apache2_master_pid=$(ps auxe | grep apache2 | pgrep -f "apache2")\n\n    if [ -z "$apache2_master_pid" ]; then\n        log "\u672a\u627e\u5230 apache2 \u4e3b\u8fdb\u7a0b\uff0c\u8df3\u8fc7\u672c\u6b21\u68c0\u6d4b\u3002"\n    else\n        log "\u68c0\u6d4b\u5230 apache2 \u4e3b\u8fdb\u7a0b PID: $apache2_master_pid"\n\n        # \u83b7\u53d6 apache2 \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\n        all_child_pids=$(pstree -p "$apache2_master_pid" | grep -o \'([0-9]\\+)\' | grep -o \'[0-9]\\+\')\n\n        if [ -z "$all_child_pids" ]; then\n            log "\u672a\u68c0\u6d4b\u5230\u5b50\u8fdb\u7a0b\u3002"\n        else\n            # \u5217\u51fa\u6240\u6709\u5b50\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\n            log "\u6240\u6709\u5b50\u8fdb\u7a0b\u4fe1\u606f\uff1a"\n            for pid in $all_child_pids; do\n                process_info=$(ps -o pid,comm,args= -p "$pid" --no-headers)\n                log "PID: $process_info"\n            done\n\n            # \u83b7\u53d6 apache2 \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u975e apache2 \u5b50\u8fdb\u7a0b\n            suspicious_pids=$(echo "$all_child_pids" | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv apache2 && echo {}\')\n\n            if [ -z "$suspicious_pids" ]; then\n                log "\u672a\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b\u3002"\n            else\n                # \u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\u5e76\u8bb0\u5f55\u65e5\u5fd7\n                for pid in $suspicious_pids; do\n                    process_info=$(ps -o pid,comm,args= -p "$pid" --no-headers)\n                    log "\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b PID: $process_info\uff0c\u6b63\u5728\u6740\u6b7b..."\n                    kill -9 "$pid"\n                    if [ $? -eq 0 ]; then\n                        log "\u6210\u529f\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid"\n                    else\n                        log "\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid \u5931\u8d25\uff01"\n                    fi\n                done\n            fi\n        fi\n    fi\n\n    # \u7b49\u5f85 1 \u79d2\n    sleep 1\ndone\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u4e24\u4e2a\u811a\u672c\u5408\u5e76\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u811a\u672c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\nLOG_FILE="/var/log/web_kill_suspicious.log"\n\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\nlog() {\n    local message="$1"\n    echo "$(date \'+%Y-%m-%d %H:%M:%S\') - $message" | tee -a "$LOG_FILE"\n}\n\n# \u51fd\u6570\uff1a\u68c0\u6d4b\u5e76\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\ncheck_and_kill_suspicious() {\n    local service_name="$1"\n    local master_process_keyword="$2"\n\n    # \u83b7\u53d6\u4e3b\u8fdb\u7a0b\u7684 PID\n    local master_pid=$(pgrep -f "$master_process_keyword" | head -n 1)\n\n    if [ -z "$master_pid" ]; then\n        log "\u672a\u627e\u5230 $service_name \u4e3b\u8fdb\u7a0b\uff0c\u8df3\u8fc7\u672c\u6b21\u68c0\u6d4b\u3002"\n    else\n        log "\u68c0\u6d4b\u5230 $service_name \u4e3b\u8fdb\u7a0b PID: $master_pid"\n\n        # \u83b7\u53d6\u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\n        local all_child_pids=$(pstree -p "$master_pid" | grep -o \'([0-9]\\+)\' | grep -o \'[0-9]\\+\')\n\n        if [ -z "$all_child_pids" ]; then\n            log "\u672a\u68c0\u6d4b\u5230 $service_name \u5b50\u8fdb\u7a0b\u3002"\n        else\n            # \u5217\u51fa\u6240\u6709\u5b50\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\n            log "$service_name \u6240\u6709\u5b50\u8fdb\u7a0b\u4fe1\u606f\uff1a"\n            for pid in $all_child_pids; do\n                local process_info=$(ps -o pid,comm,args= -p "$pid" --no-headers)\n                log "PID: $process_info"\n            done\n\n            # \u83b7\u53d6\u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u975e\u670d\u52a1\u5b50\u8fdb\u7a0b\n            local suspicious_pids=$(echo "$all_child_pids" | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv \'"$service_name"\' && echo {}\')\n\n            if [ -z "$suspicious_pids" ]; then\n                log "\u672a\u68c0\u6d4b\u5230 $service_name \u53ef\u7591\u8fdb\u7a0b\u3002"\n            else\n                # \u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\u5e76\u8bb0\u5f55\u65e5\u5fd7\n                for pid in $suspicious_pids; do\n                    local process_info=$(ps -o pid,comm,args= -p "$pid" --no-headers)\n                    log "\u68c0\u6d4b\u5230 $service_name \u53ef\u7591\u8fdb\u7a0b PID: $process_info\uff0c\u6b63\u5728\u6740\u6b7b..."\n                    kill -9 "$pid"\n                    if [ $? -eq 0 ]; then\n                        log "\u6210\u529f\u6740\u6b7b $service_name \u53ef\u7591\u8fdb\u7a0b PID: $pid"\n                    else\n                        log "\u6740\u6b7b $service_name \u53ef\u7591\u8fdb\u7a0b PID: $pid \u5931\u8d25\uff01"\n                    fi\n                done\n            fi\n        fi\n    fi\n}\n\n# \u4e3b\u5faa\u73af\nwhile true; do\n    # \u68c0\u6d4b nginx\n    check_and_kill_suspicious "nginx" "nginx: master process"\n\n    # \u68c0\u6d4b apache2\n    check_and_kill_suspicious "apache2" "apache2"\n\n    # \u7b49\u5f85 1 \u79d2\n    sleep 1\ndone\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u76f4\u63a5\u6295\u9012\u547d\u4ee4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"echo H4sIAH4WAWgA/7VV32/bVBR+919xcJM60eZk6VszRbzwq1IRSDyhUUWufZNYdezMTn9AWylFgzQbtAVprTQyUDUGU7WQImAF0iZ/DL035qn/wq597cR2HNoX/GLr+txzvu873z135o3ssqpnlyWrwnEzQI6e48EROWxe9l7ZZ13cf8AtfvBu8Z2FxbcLfHZNMrOaUc6uo+XiiqppRWvVqqmyaqxaGbrOOxlw84I8Pr06f2L/coovHrOEHP2bSsMmB/TRDFnSoIosSyqjAp/I8e4ykisG8ImUItURCLeSH4vJqphUIPlePvl+PvmRkAYREt42HragjhCIEt3iI+S57RAC8qxB/niE/3pFnjZIp4f3u8PDb+zBd8MXjzi5guSVoqQrUSIRmBYy11QZFXWpGsDqUZCsOjKLNdOQKariCvp03TAVGjVHlXDCZsDeO8P7h5d/9ljZ4ZMH8OHCWzE5VKWQSNXKJqqBWKKc4nM7tCtIUkDUIZdmRdQS3APxs8AelcYt3YV6BeluBKtWBp60T0irj3dPIRHkBSN8V+df2We/2YMmab8kL4+ZgP80Pvc6pFkokpApPD2hwzZPuzZGxkBPU4e0GqTdwp0Dr03jao5YEu2UXFE1xclkOYJZddNxQS3CfguYkgYIqXt3xPmlT26lheCqtyh4GoZ1DJeZ1DKk5xQFRhRG6k0oyDTAu0e4+XeEN1XC7v407H15OTgmO93JyuFikd1sEz0A48LOUzJMoIRA1SFC8S4oRih0LLlvQFUvGa7gjnx0z23ZqFZvS2bZKjD5Xd1FUTdEx6DItNIxGSlyZohg2jBKxdDRuCn/7ZN/n35P2l/jh8eThgmc4NHR9l3jTZpom7dgw+ED4sLmNlgVEGUQGF+Hq0uT/vBNdH8NhHAbeAFmZ9kY29wOOivsrgieeHvdyGKBeRZyWazTmJKTk5COx9Ckju4JuiYCPdY2/491rp04QUre0AnWp4ONdJ7h9gsmQCaTCcvlP85lAOK8Byo2xO1k4k0Q0X24M7V5YdC7B/jhD6z0DXBPqxzb03Chm5cA/OOv9u/Pr8534ouV1Ill92hOifE+6cu9g+lZxf2T4V6XW6cnDEHdXEUju1Abul0EvazqG+7S1OsYeDeI995578L0zTW6aL2MUk2iqeauy+mF0az+l59n2Gnh/heQg+HP37pLlobocc9xDvnXRKof/S0JAAA= | base64 -d | gunzip > web-protect.sh ; chmod +x web-protect.sh\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ssh-\u5b89\u5168\u9632\u8303",children:"SSH \u5b89\u5168\u9632\u8303"}),"\n",(0,i.jsx)(n.p,{children:"\u9996\u5148\u5148\u9650\u5236\u53ea\u5141\u8bb8 root \u7528\u6237\u8fdb\u884c\u8bbf\u95ee"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo sed -i '/^AllowUsers/d' /etc/ssh/sshd_config\nsudo sed -i '/^PermitRootLogin/d' /etc/ssh/sshd_config\necho \"AllowUsers root\" | tee -a /etc/ssh/sshd_config > /dev/null\necho \"PermitRootLogin yes\" | tee -a /etc/ssh/sshd_config > /dev/null\nsystemctl restart sshd\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6574\u5408\u4e3a\u4e00\u4e2a\u811a\u672c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\nLOG_FILE="/var/log/ssh_security.log"\n\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\nlog() {\n    local message="$1"\n    echo "$(date \'+%Y-%m-%d %H:%M:%S\') - $message" | tee -a "$LOG_FILE"\n}\n\n# \u963b\u6b62\u975e root \u7528\u6237\u767b\u5f55\uff0c\u5e76\u5904\u7406 authorized_keys \u6587\u4ef6\nrestrict_ssh_to_root() {\n    log "\u6b63\u5728\u914d\u7f6e SSH \u53ea\u5141\u8bb8 root \u7528\u6237\u767b\u5f55..."\n    sed -i \'/^AllowUsers/d\' /etc/ssh/sshd_config\n    sed -i \'/^PermitRootLogin/d\' /etc/ssh/sshd_config\n    echo "AllowUsers root" | tee -a /etc/ssh/sshd_config > /dev/null\n    echo "PermitRootLogin yes" | tee -a /etc/ssh/sshd_config > /dev/null\n    systemctl restart sshd\n    log "SSH \u914d\u7f6e\u5df2\u66f4\u65b0\uff0c\u53ea\u5141\u8bb8 root \u7528\u6237\u767b\u5f55\u3002"\n\n    log "\u6b63\u5728\u5904\u7406 /home \u76ee\u5f55\u4e0b\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6..."\n    for user_home in /home/*; do\n        if [ -d "$user_home" ]; then\n            auth_keys_file="$user_home/.ssh/authorized_keys"\n            # \u786e\u4fdd .ssh \u76ee\u5f55\u5b58\u5728\n            mkdir -p "$user_home/.ssh"\n            # \u521b\u5efa\u6216\u66f4\u65b0 authorized_keys \u6587\u4ef6\n            touch "$auth_keys_file"\n            # \u4fee\u6539\u6587\u4ef6\u6240\u6709\u8005\u4e3a root:root\n            chown root:root "$auth_keys_file"\n            # \u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\u4e3a 600\n            chmod 600 "$auth_keys_file"\n            log "\u5df2\u5904\u7406 $auth_keys_file\uff1a\u6240\u6709\u8005\u8bbe\u7f6e\u4e3a root:root\uff0c\u6743\u9650\u8bbe\u7f6e\u4e3a 600\u3002"\n        fi\n    done\n    log "\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6\u5df2\u5904\u7406\u5b8c\u6210\u3002"\n}\n\n# \u5220\u9664\u6240\u6709 authorized_keys \u6587\u4ef6\uff0c\u5305\u62ec root \u7528\u6237\u7684\ndelete_authorized_keys() {\n    log "\u6b63\u5728\u5220\u9664\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6..."\n    # \u5220\u9664 /home \u76ee\u5f55\u4e0b\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6\uff0c\u5e76\u8bb0\u5f55\u65e5\u5fd7\n    find /home -name authorized_keys -delete -exec log "\u5df2\u5220\u9664\u6587\u4ef6: {}" \\;\n    # \u5220\u9664 root \u7528\u6237\u7684 authorized_keys \u6587\u4ef6\n    if [ -f "/root/.ssh/authorized_keys" ]; then\n        rm -f "/root/.ssh/authorized_keys"\n        log "\u5df2\u5220\u9664 /root/.ssh/authorized_keys \u6587\u4ef6\u3002"\n    else\n        log "/root/.ssh/authorized_keys \u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u8df3\u8fc7\u5220\u9664\u3002"\n    fi\n    log "\u6240\u6709 authorized_keys \u6587\u4ef6\u5df2\u5220\u9664\u3002"\n}\n\n# \u4e3b\u51fd\u6570\nmain() {\n    restrict_ssh_to_root\n\n    # \u6bcf\u79d2\u8fd0\u884c\u4e00\u6b21 delete_authorized_keys\n    while true; do\n        delete_authorized_keys\n        sleep 1\n    done\n}\n\n# \u6267\u884c\u4e3b\u51fd\u6570\nmain\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5feb\u901f\u6295\u9012"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"echo H4sIAD04AmgA/51W32/bVBR+919xcBtlAzneXnhoNSQegCEVgah4QPywPPsmsWb7TvbNShmTCrQ01TKtQlu3tiuiMLQJrdkEaM2WdfljiG+cp/4Luz9cx/bSdHClRJF9vu9859zv3JupN/QLjq9fMMO6okwBvf1H1LtNN1b73Sfx/qPoxbIy9/EHxvsfzr13TtUvm4Hu4poehnUjRFYjcMhihT1QOTRaPaC3Hh8+34rbj6ODW5JJYW9PnYYrCrDlYst0wUNhaNbQOXX6rCoeI6uOQZ0+ZZsEQfmt0udaydNKNpTOz5Q+minNl0+DBtMJTIXvgCAEmskgR9JU5SpXMLzTpXu/DXd+gQBjAoObD2hzf7DZZWoOn7eip0+ie8uD9Z/AbJA6DpxvkW1cRIshyHKVAIUkcCxi8PIINjhJRnsNVLr3e3T3wXDl+uCgDfPz5yG68We08n3c7ryasVKpyPJCZIPmQFn/+l3XxQufhSgIdbsMOiIW7yT/2IaF/apTKwA+QYHnkE8Z9RyusV2ahJJdHKUQijLdGgeEd0C30WXdb7huhqSQFhZR+F+JwsWQIM8iLvCumgEBHj3qJG+e7GO0/xfd/oduMOe0JrTz36UfmMsKO5Hsp17HHoLBdpvF9TvX6NoSvbuWgLeWj9nudH+qOIAG65ghWFi5gk5/cxZsLAL4cqrwBWg281waqsJXs0DqyE+D+OLJRBqj6rjc5Gm8XuFNK4iREo7WFAx22/3eDvDQpKBo7w6rNBfmXbSdALRLWTWCvcgWNbej7jPa3JAdPs74WRDBDavOiPN1FIn7vTa9+VTCZbvjpZV+55nYtxn+lQMwVy34o3cn0sftF8wZCf3Oj8PNdc799pkzBVYP2/zpCXzCMMxmiVsKsezASiuQeXN1MFdKBaN3LKNw4xF/1RE/beyjjEFfy4Spqqjdos11QSuOsqj563DzniQ5BsvnpbVCrz3MDcvWsmIjFxFkFFDjTrJslteelyNx/2/s5EGcuyJkD307IdR8k30X0ZqsCjT0DbJGWyoLEMwzcOWqCl/O5kXmezNpAuSIV0HVOWb8tL4y8oF3EiQNzWuG4yGJqNRjyA2lsVKWE7H9znV5brB2x/t/x71VmTXlTDybseoEh46gwpv9Tlfe9YpnOn7qq3HXpzyx2d+KRzcG93+Oe+vxbqvfWaIPd2G8S0X8Qp3NJZCggXJn8ASEuHJchC7B2dEsCrF07b7ImZX8EkllffD0CAAA | base64 -d | gunzip > ssh-protect.sh ; chmod +x ssh-protect.sh\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var o=s(96540);const i={},r=o.createContext(i);function a(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(r.Provider,{value:n},e.children)}},59444:e=>{e.exports=JSON.parse('{"permalink":"/Target-Machines-WriteUp/blog/Hackthebox Battleground Scripts","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2025-04-17-HBG-Scripts/index.md","source":"@site/blog/2025-04-17-HBG-Scripts/index.md","title":"Hackthebox Battleground \u5999\u5999\u547d\u4ee4","description":"\u6de6\u4ed6","date":"2025-04-17T00:00:00.000Z","tags":[{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":8.275,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"Hackthebox Battleground Scripts","title":"Hackthebox Battleground \u5999\u5999\u547d\u4ee4","authors":"Randark","toc_max_heading_level":5,"tags":["Incident-Response"]},"unlisted":false,"prevItem":{"title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-sc05"},"nextItem":{"title":"2025 \u957f\u57ce\u676f & \u56fd\u8d5b \u534a\u51b3\u8d5b ISW","permalink":"/Target-Machines-WriteUp/blog/2025CCB&CISCN-Semis-ISW"}}')}}]);