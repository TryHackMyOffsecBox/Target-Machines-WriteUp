"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[7475],{71242:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp04/index","title":"Logic App 04 - Tamper Trigger Parameter and Abuse Storage Queue","description":"Tamper Trigger Parameter and Abuse Storage Queue","source":"@site/docs/Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp04/index.md","sourceDirName":"Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp04","slug":"/Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp04/","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp04/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp04/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"Logic App 03 - Tamper Trigger Parameter and Abuse Storage Container","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp03/"},"next":{"title":"Logic App 05 - Tamper Trigger Parameter and Abuse Storage Table","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/RedLabs/LearningPaths/LOGIC APPS PWNER/LogicApp05/"}}');var i=r(74848),s=r(28453);const a={},o="Logic App 04 - Tamper Trigger Parameter and Abuse Storage Queue",c={},d=[];function p(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"logic-app-04---tamper-trigger-parameter-and-abuse-storage-queue",children:"Logic App 04 - Tamper Trigger Parameter and Abuse Storage Queue"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Tamper Trigger Parameter and Abuse Storage Queue"}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Scenario"})}),(0,i.jsx)(n.p,{children:"In certain scenarios, a logic app might trigger and reveal sensitive data. Leverage this information to obtain the flag."}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Overview"})}),(0,i.jsx)(n.p,{children:"What is SAS URL (Shared Access Signature URL)?"}),(0,i.jsx)(n.p,{children:"A SAS URL (Shared Access Signature URL) is a URL that contains a shared access signature token. It allows secure access to specific resources within an Azure Storage account for a limited period, without requiring the account key. SAS URLs provide us with a way to grant granular access permissions to clients or applications without exposing the storage account keys."}),(0,i.jsx)(n.p,{children:"What is IDOR?"}),(0,i.jsx)(n.p,{children:"IDOR, or Insecure Direct Object Reference, is a type of security vulnerability that occurs when an application provides direct access to objects based on user-supplied input. In simpler terms, it means that an attacker can manipulate input, such as URLs or form parameters, to gain unauthorized access to data."}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Hint"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Access resources without exposing keys."}),"\n"]}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Impact"})}),(0,i.jsx)(n.p,{children:'Logic app using request trigger with parameter here acted as an IDOR vulnerability. When triggered with the "admin" parameter the logic app revealed sensitive data.'}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Reference"})}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/logic-apps/logic-apps-overview",children:"Logic Apps Docs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/storage/queues/storage-queues-introduction",children:"Storage Queues Docs"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/connectors/azurequeues/",children:"Azure Queue Connector"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://azure.microsoft.com/en-in/products/storage/storage-explorer",children:"Azure Storage Explorer"})}),"\n"]})]}),"\n",(0,i.jsx)(n.p,{children:"\u9898\u76ee\u7ed9\u51fa\u4e86 TriggerURL \u548c QueueSASURL \u4e24\u4e2a\u4fe1\u606f"}),"\n",(0,i.jsx)(n.p,{children:"\u5982 03 \u7684\u60c5\u51b5\u4e00\u6837\uff0c\u5c1d\u8bd5\u4e0e TriggerURL \u8fdb\u884c\u4ea4\u4e92\u6ca1\u6709\u6570\u636e\u4f20\u56de\uff0c\u5c1d\u8bd5\u901a\u8fc7 SAS \u8fdb\u884c\u8fde\u63a5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",metastring:'title="TriggerURL"',children:"https://asmqiesp735.queue.core.windows.net/asvlzqgd735?sv=2019-07-07&sig=fG2EMYW0kM%2Bw9opDHbRmyKwGJe%2BIuy1ka8UD5wlgt7A%3D&se=2026-07-01T12%3A31%3A06Z&sp=r\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7 TriggerURL \u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u786e\u5b9a\u5176\u4e3a Queue \u7684 SAS URL"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:r(46669).A+"",width:"1971",height:"1332"})}),"\n",(0,i.jsx)(n.p,{children:"\u8fde\u63a5\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,i.jsxs)(n.admonition,{title:"Flags",type:"info",children:[(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:" In which storage account service did we find the flag value? (Container, Queue, Table or File) "}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"Queue\n"})})]}),(0,i.jsxs)(t,{children:[(0,i.jsx)("summary",{children:" What is the flag value we obtain ? "}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"aspcyesk735astalguy735\n"})})]})]})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}},46669:(e,n,r)=>{r.d(n,{A:()=>t});const t=r.p+"assets/images/image_20260142-214207-b32c2fc380a9a0d6e9f636655bf345cb.png"},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var t=r(96540);const i={},s=t.createContext(i);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);