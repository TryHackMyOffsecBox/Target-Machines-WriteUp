"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[2237],{52301:(s,r,e)=>{e.r(r),e.d(r,{assets:()=>t,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"Xuanji/Unit-1/24","title":"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94 - Linux\u65e5\u5fd7\u5206\u6790","description":"1","source":"@site/docs/Xuanji/Unit-1/24.md","sourceDirName":"Xuanji/Unit-1","slug":"/Xuanji/Unit-1/24","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-1/24","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/Unit-1/24.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Xuanji_Sidebar","previous":{"title":"\u54e5\u65af\u62c9 ekp \u7248\u672c\u6d41\u91cf\u5206\u6790","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Incident Response/96"},"next":{"title":"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94 - webshell \u67e5\u6740","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-1/25"}}');var o=e(74848),i=e(28453);const a={},l="\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94 - Linux\u65e5\u5fd7\u5206\u6790",t={},d=[{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2},{value:"5",id:"5",level:2}];function u(s){const r={admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...s.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"\u7b2c\u4e00\u7ae0-\u5e94\u6025\u54cd\u5e94---linux\u65e5\u5fd7\u5206\u6790",children:"\u7b2c\u4e00\u7ae0 \u5e94\u6025\u54cd\u5e94 - Linux\u65e5\u5fd7\u5206\u6790"})}),"\n",(0,o.jsx)(r.h2,{id:"1",children:"1"}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:'\u6709\u591a\u5c11IP\u5728\u7206\u7834\u4e3b\u673assh\u7684root\u5e10\u53f7\uff0c\u5982\u679c\u6709\u591a\u4e2a\u4f7f\u7528","\u5206\u5272'}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"(remote) root@ip-10-0-10-2:/root# cat /var/log/auth.log* | grep -a \"Failed password for root\" | awk '{print $11}' | sort -n | uniq | tr '\\n' ','\n192.168.200.2,192.168.200.31,192.168.200.32\n"})}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-plaintext",children:"flag{192.168.200.2,192.168.200.31,192.168.200.32}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"2",children:"2"}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:'ssh\u7206\u7834\u6210\u529f\u767b\u9646\u7684IP\u662f\u591a\u5c11\uff0c\u5982\u679c\u6709\u591a\u4e2a\u4f7f\u7528","\u5206\u5272'}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"(remote) root@ip-10-0-10-2:/root# cat /var/log/auth.log* | grep -a \"Accepted \" | awk '{print $11}' | sort -n | uniq -c\n      2 192.168.200.2\n      1 218.106.157.103\n"})}),"\n",(0,o.jsx)(r.p,{children:"\u6392\u9664\u6389\u81ea\u5df1\u7684IP\u5373\u53ef"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-plaintext",children:"flag{192.168.200.2}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"3",children:"3"}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:'\u7206\u7834\u7528\u6237\u540d\u5b57\u5178\u662f\u4ec0\u4e48\uff1f\u5982\u679c\u6709\u591a\u4e2a\u4f7f\u7528","\u5206\u5272'}),"\n"]}),"\n",(0,o.jsx)(r.p,{children:"\u7b5b\u9009\u767b\u9646\u5931\u8d25\u7684\u7528\u6237\u540d\u8bb0\u5f55"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:'(remote) root@ip-10-0-10-2:/root# cat /var/log/auth.log* | grep -a "Failed password"\nAug  1 07:40:50 linux-rz sshd[7461]: Failed password for invalid user test1 from 192.168.200.35 port 33874 ssh2\nAug  1 07:41:04 linux-rz sshd[7465]: Failed password for invalid user test2 from 192.168.200.35 port 51640 ssh2\nAug  1 07:41:13 linux-rz sshd[7468]: Failed password for invalid user test3 from 192.168.200.35 port 48168 ssh2\nAug  1 07:42:32 linux-rz sshd[7471]: Failed password for root from 192.168.200.32 port 51888 ssh2\nAug  1 07:46:41 linux-rz sshd[7475]: Failed password for invalid user user from 192.168.200.2 port 36149 ssh2\nAug  1 07:46:47 linux-rz sshd[7478]: Failed password for invalid user user from 192.168.200.2 port 44425 ssh2\nAug  1 07:46:50 linux-rz sshd[7480]: Failed password for invalid user user from 192.168.200.2 port 38791 ssh2\nAug  1 07:46:54 linux-rz sshd[7482]: Failed password for invalid user user from 192.168.200.2 port 37489 ssh2\nAug  1 07:46:56 linux-rz sshd[7484]: Failed password for invalid user user from 192.168.200.2 port 35575 ssh2\nAug  1 07:46:59 linux-rz sshd[7486]: Failed password for invalid user hello from 192.168.200.2 port 35833 ssh2\nAug  1 07:47:02 linux-rz sshd[7489]: Failed password for invalid user hello from 192.168.200.2 port 37653 ssh2\nAug  1 07:47:04 linux-rz sshd[7491]: Failed password for invalid user hello from 192.168.200.2 port 37917 ssh2\nAug  1 07:47:08 linux-rz sshd[7493]: Failed password for invalid user hello from 192.168.200.2 port 41957 ssh2\nAug  1 07:47:10 linux-rz sshd[7495]: Failed password for invalid user hello from 192.168.200.2 port 39685 ssh2\nAug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2\nAug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2\nAug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2\nAug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2\nAug  1 07:47:26 linux-rz sshd[7525]: Failed password for invalid user  from 192.168.200.2 port 37013 ssh2\nAug  1 07:47:30 linux-rz sshd[7528]: Failed password for invalid user  from 192.168.200.2 port 37545 ssh2\nAug  1 07:47:32 linux-rz sshd[7530]: Failed password for invalid user  from 192.168.200.2 port 39111 ssh2\nAug  1 07:47:35 linux-rz sshd[7532]: Failed password for invalid user  from 192.168.200.2 port 35173 ssh2\nAug  1 07:47:39 linux-rz sshd[7534]: Failed password for invalid user  from 192.168.200.2 port 45807 ssh2\nAug  1 07:52:59 linux-rz sshd[7606]: Failed password for root from 192.168.200.31 port 40364 ssh2\n'})}),"\n",(0,o.jsx)(r.p,{children:"\u5bf9\u7ed3\u679c\u8fdb\u884c\u6e05\u6d17"}),"\n",(0,o.jsxs)(r.admonition,{type:"note",children:[(0,o.jsx)(r.p,{children:"\u8fd9\u9898\u7684\u6e05\u6d17\u6709\u70b9\u95ee\u9898\uff0c\u987a\u5e8f\u4e0d\u662f\u5f88\u597d\u786e\u5b9a\uff0c\u8fd9\u91cc\u9644\u4e0a\u5b98\u65b9\u7684\u9898\u89e3"}),(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:'grep -a "Failed password"  /var/log/auth.log.2|perl -e \'while($_=<>){ /for(.*?) from/; print "$1\\n";}\'|uniq -c|sort -nr\n'})})]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"(remote) root@ip-10-0-10-2:/root# cat /var/log/auth.log* | grep -a \"Failed password\" | awk -F 'for ' '{print $2}' | awk -F ' from' '{print $1}' | sed 's/invalid user//g' | sed 's/^[ \\t]*//;s/[ \\t]*$//' | grep -v '^$' | uniq -c | sort -nr\n      5 user\n      5 root\n      5 hello\n      1 test3\n      1 test2\n      1 test1\n      1 root\n"})}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-plaintext",children:"flag{user,hello,root,test3,test2,test1}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"4",children:"4"}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:"\u767b\u9646\u6210\u529f\u7684IP\u5171\u7206\u7834\u4e86\u591a\u5c11\u6b21"}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"(remote) root@ip-10-0-10-2:/root# cat /var/log/auth.log* | grep -a \"Failed password for root\" | awk '{print $11}' | sort -n | uniq -c\n      4 192.168.200.2\n      1 192.168.200.31\n      1 192.168.200.32\n"})}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-plaintext",children:"flag{4}\n"})}),"\n",(0,o.jsx)(r.h2,{id:"5",children:"5"}),"\n",(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:"\u9ed1\u5ba2\u767b\u9646\u4e3b\u673a\u540e\u65b0\u5efa\u4e86\u4e00\u4e2a\u540e\u95e8\u7528\u6237\uff0c\u7528\u6237\u540d\u662f\u591a\u5c11"}),"\n"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:'(remote) root@ip-10-0-10-2:/root# cat /var/log/auth.log* | grep -a "useradd" | grep -a "linux-rz"\nAug  1 07:50:45 linux-rz useradd[7551]: new group: name=test2, GID=1000\nAug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh\n'})}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-plaintext",children:"flag{test2}\n"})})]})}function h(s={}){const{wrapper:r}={...(0,i.R)(),...s.components};return r?(0,o.jsx)(r,{...s,children:(0,o.jsx)(u,{...s})}):u(s)}},28453:(s,r,e)=>{e.d(r,{R:()=>a,x:()=>l});var n=e(96540);const o={},i=n.createContext(o);function a(s){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof s?s(r):{...r,...s}}),[r,s])}function l(s){let r;return r=s.disableParentContext?"function"==typeof s.components?s.components(o):s.components||o:a(s.components),n.createElement(i.Provider,{value:r},s.children)}}}]);