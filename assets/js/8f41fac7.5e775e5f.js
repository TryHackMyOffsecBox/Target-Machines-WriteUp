"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4437],{59714:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"HackMyVM/Challenges/Docker/072","title":"Docker - 072","description":"created by || rick","source":"@site/docs/HackMyVM/Challenges/Docker/072.md","sourceDirName":"HackMyVM/Challenges/Docker","slug":"/HackMyVM/Challenges/Docker/072","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Challenges/Docker/072","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Challenges/Docker/072.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"Docker - 059","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Challenges/Docker/059"},"next":{"title":"HMVLabs","permalink":"/Target-Machines-WriteUp/docs/category/HackMyVM-HMVLabs"}}');var a=r(74848),t=r(28453);const i={},c="Docker - 072",d={},o=[{value:"\u9898\u76ee\u4fe1\u606f",id:"\u9898\u76ee\u4fe1\u606f",level:2},{value:"\u89e3\u9898",id:"\u89e3\u9898",level:2}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"docker---072",children:"Docker - 072"})}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.p,{children:"created by || rick"}),(0,a.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2024-04-07"}),(0,a.jsx)(n.p,{children:"\ud83d\udc80 Solvers // 27"}),(0,a.jsx)(n.p,{children:"\ud83e\udde9 Type // docker"})]}),"\n",(0,a.jsx)(n.h2,{id:"\u9898\u76ee\u4fe1\u606f",children:"\u9898\u76ee\u4fe1\u606f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"Instructions in README.md inside the file.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u89e3\u9898",children:"\u89e3\u9898"}),"\n",(0,a.jsx)(n.p,{children:"\u9996\u5148\u90e8\u7f72\u73af\u5883"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"randark@developer:~$ unzip 072.zip\n......\nrandark@developer:~$ cd fr1end/\nrandark@developer:~/fr1end$ cd fr1end-main/\nrandark@developer:~/fr1end/fr1end-main$ docker build -t fr1end .\n[+] Building 32.9s (14/14) FINISHED                                                                                                                                                              docker:default\n => [internal] load build definition from Dockerfile                                                                                                                                                       0.0s\n => => transferring dockerfile: 413B                                                                                                                                                                       0.0s\n => [internal] load metadata for docker.io/library/node:18                                                                                                                                                 2.2s\n => [internal] load .dockerignore                                                                                                                                                                          0.0s\n => => transferring context: 2B                                                                                                                                                                            0.0s\n => CACHED [1/9] FROM docker.io/library/node:18@sha256:867be01f97d45cb7d89a8ef0b328d23e8207412ebec4564441ed8cabc8cc4ecd                                                                                    0.0s\n => [internal] load build context                                                                                                                                                                          1.7s\n => => transferring context: 3.48MB                                                                                                                                                                        1.7s\n => [2/9] RUN apt update && apt install -y supervisor && apt install -y nginx                                                                                                                             13.5s\n => [3/9] COPY . /app                                                                                                                                                                                      6.3s \n => [4/9] COPY ./lotr/build/ /var/www/html                                                                                                                                                                 0.1s \n => [5/9] RUN rm /etc/nginx/sites-available/default                                                                                                                                                        0.3s \n => [6/9] COPY /nginx/default /etc/nginx/sites-available/                                                                                                                                                  0.0s \n => [7/9] WORKDIR /app/server/                                                                                                                                                                             0.0s \n => [8/9] RUN npm i                                                                                                                                                                                        2.4s \n => [9/9] COPY config/supervisord.conf /etc/supervisord.conf                                                                                                                                               0.0s\n => exporting to image                                                                                                                                                                                     8.1s\n => => exporting layers                                                                                                                                                                                    8.1s\n => => writing image sha256:ca9175e115be6aaacbd4b2a05cfef2cb0203d6ce63bea33413ad1284768e4b2f                                                                                                               0.0s\n => => naming to docker.io/library/fr1end  \n\nrandark@developer:~/fr1end/fr1end-main$ docker run --name=fr1end -p1337:80 -p4000:4000 fr1end\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7136\u540e\u8bbf\u95ee\u73af\u5883 ",(0,a.jsx)(n.code,{children:"http://192.168.200.129:1337/"})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:r(37734).A+"",width:"2560",height:"1371"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7531\u4e8e\u5bb9\u5668 web \u670d\u52a1\u56fa\u5b9a\u8bbf\u95ee vhost \u4e3a ",(0,a.jsx)(n.code,{children:"localhost"})," \u7684\u539f\u56e0\uff0c\u4e0d\u7ee7\u7eed\u8fdb\u884c\u5206\u6790 (\u61d2)"]}),"\n",(0,a.jsx)(n.p,{children:"\u76f4\u63a5\u5206\u6790\u6e90\u7801"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:r(72736).A+"",width:"2560",height:"1540"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5206\u6790\u5176\u4e2d\u5b9a\u4e49\u7684\u8def\u7531\uff0c\u53ef\u4ee5\u53d1\u73b0 ",(0,a.jsx)(n.code,{children:"/validate"})," \u8def\u7531\u5b58\u5728\u6709\u95ee\u9898"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-javascript",children:"app.post('/validate', function (req, res) {\n    const token = req.body.accessToken;\n    if (!token) {\n        return res.status(403).send(\"A token is required for authentication\");\n    }\n    kid = parser.parseJwt(token)['kid']\n    username = parser.parseJwtname(token)['username']\n    try {\n        var key = fs.readFileSync(kid, 'utf8');\n        } catch(err) {\n            key = 'key not found'\n    }\n    try {\n        const decoded = jwt.verify(token,key);\n    } catch(e) {\n        return res.status(401).send({message:\"Invalid Token\",\"k\":key});\n    }\n    \n    res.set('Access-Control-Allow-Origin', '*');\n    res.json({\n        \"message\":username,\n        \"k\":key\n    });\n});\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5ba2\u6237\u7aef\u53ef\u4ee5\u7be1\u6539 ",(0,a.jsx)(n.code,{children:"kid"})," \u53d8\u91cf\u7684\u503c\uff0c\u8fdb\u800c\u901a\u8fc7\u62a5\u9519\u4fe1\u606f\u8bfb\u53d6\u5230\u6587\u4ef6\u5185\u5bb9"]}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u5229\u7528\uff0c\u5148\u6784\u9020 JWT"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:r(44726).A+"",width:"2560",height:"1371"})}),"\n",(0,a.jsx)(n.p,{children:"\u7136\u540e\u4f7f\u7528 json \u53d1\u5305\u5373\u53ef"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:r(13828).A+"",width:"2560",height:"1540"})}),"\n",(0,a.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-flag",children:"HMV{jWt_m4keS_th3_w0rLd_g0_r0und}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},72736:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image_20250500-110002-edc1ccccfb1363b7c010cc3830b419a6.png"},13828:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image_20250521-112140-336c2db7871c3dd5cf22c0cab36dd0fe.png"},44726:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image_20250522-112208-74afd334e8afe1611bf3e5042e8a961f.png"},37734:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image_20250556-105632-82e6ccff318dd3de599af32462186b44.png"},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>c});var s=r(96540);const a={},t=s.createContext(a);function i(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);