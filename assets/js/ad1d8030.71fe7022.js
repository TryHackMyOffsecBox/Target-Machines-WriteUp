"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[10],{61282:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"Xuanji/Unit-6/45","title":"\u7b2c\u516d\u7ae0 \u6d41\u91cf\u7279\u5f81\u5206\u6790 - waf \u4e0a\u7684\u622a\u83b7\u7684\u9ed1\u5ba2\u653b\u51fb\u6d41\u91cf","description":"\u521d\u6b65\u5206\u6790","source":"@site/docs/Xuanji/Unit-6/45.md","sourceDirName":"Xuanji/Unit-6","slug":"/Xuanji/Unit-6/45","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-6/45","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/Unit-6/45.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Xuanji_Sidebar","previous":{"title":"\u7b2c\u516d\u7ae0 \u6d41\u91cf\u7279\u5f81\u5206\u6790 - \u8682\u8681\u7231\u4e0a\u6811","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-6/44"},"next":{"title":"\u7b2c\u516d\u7ae0 \u6d41\u91cf\u7279\u5f81\u5206\u6790 - \u5e38\u89c1\u653b\u51fb\u4e8b\u4ef6 tomcat","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-6/50"}}');var a=i(74848),t=i(28453);const s={},l="\u7b2c\u516d\u7ae0 \u6d41\u91cf\u7279\u5f81\u5206\u6790 - waf \u4e0a\u7684\u622a\u83b7\u7684\u9ed1\u5ba2\u653b\u51fb\u6d41\u91cf",d={},c=[{value:"\u521d\u6b65\u5206\u6790",id:"\u521d\u6b65\u5206\u6790",level:2},{value:"url \u63d0\u53d6",id:"url-\u63d0\u53d6",level:3},{value:"\u63d0\u53d6\u5168\u90e8 HTTP \u534f\u8bae\u4e2d\u7684 ip \u5730\u5740",id:"\u63d0\u53d6\u5168\u90e8-http-\u534f\u8bae\u4e2d\u7684-ip-\u5730\u5740",level:3},{value:"192.168.94.233",id:"19216894233",level:3},{value:"192.168.94.59",id:"1921689459",level:3},{value:"ip \u6c47\u603b",id:"ip-\u6c47\u603b",level:3},{value:"\u63d0\u53d6\u6240\u6709\u6210\u529f\u8fc7\u767b\u5f55\u7684\u6d41\u91cf",id:"\u63d0\u53d6\u6240\u6709\u6210\u529f\u8fc7\u767b\u5f55\u7684\u6d41\u91cf",level:2},{value:"frame.number == 89",id:"framenumber--89",level:3},{value:"frame.number == 493",id:"framenumber--493",level:3},{value:"frame.number == 728915",id:"framenumber--728915",level:3},{value:"frame.number == 733519",id:"framenumber--733519",level:3},{value:"frame.number == 733530",id:"framenumber--733530",level:3},{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2}];function x(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"\u7b2c\u516d\u7ae0-\u6d41\u91cf\u7279\u5f81\u5206\u6790---waf-\u4e0a\u7684\u622a\u83b7\u7684\u9ed1\u5ba2\u653b\u51fb\u6d41\u91cf",children:"\u7b2c\u516d\u7ae0 \u6d41\u91cf\u7279\u5f81\u5206\u6790 - waf \u4e0a\u7684\u622a\u83b7\u7684\u9ed1\u5ba2\u653b\u51fb\u6d41\u91cf"})}),"\n",(0,a.jsx)(n.h2,{id:"\u521d\u6b65\u5206\u6790",children:"\u521d\u6b65\u5206\u6790"}),"\n",(0,a.jsx)(n.p,{children:"\u9996\u5148\uff0c\u5148\u52a0\u8f7d\u6d41\u91cf\u6587\u4ef6\u8fdb\u884c\u521d\u6b65\u5206\u6790"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:i(22823).A+"",width:"2052",height:"1252"})}),"\n",(0,a.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u51fa\uff0cHTTP \u534f\u8bae\u7684\u6d41\u91cf\u4e3a\u5927\u90e8\u5206\uff0c\u53ef\u4ee5\u6000\u7591\u5176\u4e2d\u5305\u542b\u6709\u9488\u5bf9 Web \u670d\u52a1\u7684\u653b\u51fb\u884c\u4e3a"}),"\n",(0,a.jsx)(n.h3,{id:"url-\u63d0\u53d6",children:"url \u63d0\u53d6"}),"\n",(0,a.jsx)(n.p,{children:"\u76f4\u63a5\u5bf9 HTTP \u7684 TCP \u6d41\u91cf\u8fdb\u884c\u7b80\u5355\u8ffd\u8e2a"}),"\n",(0,a.jsx)(n.h3,{id:"\u63d0\u53d6\u5168\u90e8-http-\u534f\u8bae\u4e2d\u7684-ip-\u5730\u5740",children:"\u63d0\u53d6\u5168\u90e8 HTTP \u534f\u8bae\u4e2d\u7684 ip \u5730\u5740"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:"title=\"tshark -r web.pcap -T fields -Y 'http' -e ip.src | sort | uniq -c | sort -nr\"",children:"  70586 192.168.94.59\n  67023 192.168.32.189\n    122 192.168.94.233\n"})}),"\n",(0,a.jsx)(n.h3,{id:"19216894233",children:"192.168.94.233"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:"title=\"tshark -r web.pcap -T fields -Y'http'-e ip.src -e ip.dst -e'http.request.uri'| sed'/^\\s*$/d'\"",children:"192.168.94.233 192.168.32.189 /admin/index.php\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /admin/login.php\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /admin/login.php?rec=login\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /admin/index.php\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /admin/manager.php?rec=manager_log\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /admin/system.php\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /admin/images/jquery.tab.js\n192.168.94.233 192.168.32.189 /admin/images/icon_yes.png\n192.168.32.189 192.168.94.233\n192.168.32.189 192.168.94.233\n192.168.94.233 192.168.32.189 /admin/nav.php\n......\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u53ef\u4ee5\u53d1\u73b0\uff0c\u524d\u9762\u5927\u90e8\u5206\u8bf7\u6c42\u90fd\u662f\u6b63\u5e38\u7684\u767b\u9646\u6d41\u91cf\uff0c\u53ef\u4ee5\u5224\u65ad ",(0,a.jsx)(n.code,{children:"192.168.94.233"})," \u8fd9\u4e2a ip \u662f\u6b63\u5e38\u8bbf\u95ee\u7684\u5730\u5740"]}),"\n",(0,a.jsx)(n.h3,{id:"1921689459",children:"192.168.94.59"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"192.168.94.59 192.168.32.189 /?page=1&s=%E4%BA%A7%E5%93%81%E6%90%9C%E7%B4%A2\n192.168.94.59 192.168.32.189 /192-backup.sql\n192.168.32.189 192.168.94.59\n192.168.94.59 192.168.32.189 /horde/util/barcode.php?type=../../../../../../../../../../../etc/passwd%00\n192.168.32.189 192.168.94.59\n192.168.32.189 192.168.94.59\n192.168.94.59 192.168.32.189 /ZkeGPa9RAL.jspa\n192.168.94.59 192.168.32.189 /product_category.php?id=3\n192.168.32.189 192.168.94.59\n192.168.94.59 192.168.32.189 /?page=0&s=%E4%BA%A7%E5%93%81%E6%90%9C%E7%B4%A2\n192.168.94.59 192.168.32.189 /backup192.sql\n192.168.32.189 192.168.94.59\n192.168.32.189 192.168.94.59\n192.168.94.59 192.168.32.189 /product_category.php?id=2\n192.168.94.59 192.168.32.189 /util/barcode.php?type=../../../../../../../../../../../etc/passwd%00\n192.168.32.189 192.168.94.59\n192.168.94.59 192.168.32.189 /ZkeGPa9RAL.stm\n192.168.94.59 192.168.32.189 /backup-192.sql\n192.168.32.189 192.168.94.59\n192.168.32.189 192.168.94.59\n192.168.94.59 192.168.32.189 /m/\n192.168.94.59 192.168.32.189 /?module=article&s=%e6%96%87%e7%ab%a0%e6%90%9c%e7%b4%a2\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u53ef\u4ee5\u5224\u65ad ",(0,a.jsx)(n.code,{children:"192.168.94.59"})," \u8fd9\u4e2a\u5730\u5740\u5b58\u5728\u6709\u626b\u63cf\u5668\u7684\u626b\u63cf\u884c\u4e3a"]}),"\n",(0,a.jsx)(n.h3,{id:"ip-\u6c47\u603b",children:"ip \u6c47\u603b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"192.168.32.189  web \u670d\u52a1\u5668\n192.168.94.59   \u653b\u51fb\u8005\n192.168.94.233  \u6b63\u5e38\u7528\u6237\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63d0\u53d6\u6240\u6709\u6210\u529f\u8fc7\u767b\u5f55\u7684\u6d41\u91cf",children:"\u63d0\u53d6\u6240\u6709\u6210\u529f\u8fc7\u767b\u5f55\u7684\u6d41\u91cf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"$ tshark -r web.pcap -T fields -Y 'http.response.code == 302' -Y 'http.location == \"http://192.168.32.189/admin/index.php\"' -e frame.number | sed '/^\\s*$/d'\n89\n493\n728915\n733519\n733530\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u57fa\u4e8e\u6bcf\u4e00\u4e2a\u6d41\u91cf\u5e27\u7684\u7f16\u53f7\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6bcf\u4e00\u4e2atcp\u4f1a\u8bdd\uff0c\u67e5\u770b\u5177\u4f53\u7684\u6d41\u91cf\u6570\u636e\uff08\u5df2\u8fdb\u884cURL Decode\uff09"}),"\n",(0,a.jsx)(n.h3,{id:"framenumber--89",children:"frame.number == 89"}),"\n",(0,a.jsx)(n.h3,{id:"framenumber--493",children:"frame.number == 493"}),"\n",(0,a.jsx)(n.h3,{id:"framenumber--728915",children:"frame.number == 728915"}),"\n",(0,a.jsx)(n.h3,{id:"framenumber--733519",children:"frame.number == 733519"}),"\n",(0,a.jsx)(n.h3,{id:"framenumber--733530",children:"frame.number == 733530"}),"\n",(0,a.jsx)(n.h2,{id:"1",children:"1"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\u9ed1\u5ba2\u6210\u529f\u767b\u5f55\u7cfb\u7edf\u7684\u5bc6\u7801 flag{xxxxxxxxxxxxxxx}"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"2",children:"2"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\u9ed1\u5ba2\u53d1\u73b0\u7684\u5173\u952e\u5b57\u7b26\u4e32 flag{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"3",children:"3"}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\u9ed1\u5ba2\u627e\u5230\u7684\u6570\u636e\u5e93\u5bc6\u7801 flag{xxxxxxxxxxxxxxxx}"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(x,{...e})}):x(e)}},22823:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/image_20240505-090502-dbf0c04264be0116f12c20a1440e8c18.png"},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>l});var r=i(96540);const a={},t=r.createContext(a);function s(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);