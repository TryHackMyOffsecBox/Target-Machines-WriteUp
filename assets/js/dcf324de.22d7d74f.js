"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[3385],{17054:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"HackTheBox/Battlegrounds/Cyber Mayhem/Amelia","title":"Amelia","description":"\u4fe1\u606f\u641c\u96c6","source":"@site/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Amelia.md","sourceDirName":"HackTheBox/Battlegrounds/Cyber Mayhem","slug":"/HackTheBox/Battlegrounds/Cyber Mayhem/Amelia","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Amelia","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Amelia.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Cyber Mayhem","permalink":"/Target-Machines-WriteUp/docs/category/HackTheBox-Battlegrounds-Cyber Mayhem"},"next":{"title":"Circus","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Circus"}}');var s=t(74848),a=t(28453);const i={},r="Amelia",c={},l=[{value:"\u4fe1\u606f\u641c\u96c6",id:"\u4fe1\u606f\u641c\u96c6",level:2},{value:"icescat config",id:"icescat-config",level:2},{value:"XSLTProcesso RCE",id:"xsltprocesso-rce",level:2}];function m(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"amelia",children:"Amelia"})}),"\n",(0,s.jsx)(n.h2,{id:"\u4fe1\u606f\u641c\u96c6",children:"\u4fe1\u606f\u641c\u96c6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'Nmap scan report for bogon (10.10.110.104)\nHost is up (0.21s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 ff:05:ac:91:6c:44:f2:f6:9e:03:f4:b8:60:5e:bc:04 (RSA)\n|   256 72:9f:1b:66:80:a1:11:e6:0b:9c:38:6c:f8:7f:99:24 (ECDSA)\n|_  256 93:30:e7:45:8b:97:9c:af:82:16:9d:06:7a:6a:14:84 (ED25519)\n139/tcp  open  netbios-ssn Samba smbd 4\n445/tcp  open  netbios-ssn Samba smbd 4\n1234/tcp open  hotline?\n| fingerprint-strings: \n|   FourOhFourRequest, GetRequest, HTTPOptions, Help, Kerberos, LPDString, RTSPRequest, SSLSessionReq, TerminalServerCookie: \n|     ERROR: unknown command, type "help" to get a list of commands.\n|   LDAPSearchReq, TLSSessionReq: \n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|   SIPOptions: \n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|     ERROR: unknown command, type "help" to get a list of commands.\n|_    ERROR: unknown command, type "help" to get a list of commands.\n8000/tcp open  http        Icecast streaming media server 2.4.4\n| http-methods: \n|_  Supported Methods: GET HEAD POST\n|_http-title: Icecast Streaming Media Server\n|_http-server-header: Icecast 2.4.4\n8080/tcp open  http        Apache Tomcat (language: en)\n|_http-title: Site doesn\'t have a title (application/json).\n'})}),"\n",(0,s.jsx)(n.h2,{id:"icescat-config",children:"icescat config"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'(remote) root@htb:/root# cat /proc/996/cmdline \n/home/soapuser/.opam/default/bin/liquidsoap/home/soapuser/liquidsoap-daemon/script/main-run.liq(remote) root@htb:/root# cat /home/soapuser/liquidsoap-daemon/script/main-run.liq\n#!/home/soapuser/.opam/default/bin/liquidsoap\n\nset("log.file",true)\nset("log.file.path","/var/log/liquidsoap/main-run.log")\nset("init.daemon",true)\nset("init.daemon.change_user",true)\nset("init.daemon.change_user.group","soapuser")\nset("init.daemon.change_user.user","soapuser")\nset("init.daemon.pidfile",true)\nset("init.daemon.pidfile.path","/home/soapuser/liquidsoap-daemon/pid/main-run.pid")\n%include "/home/soapuser/liquidsoap-daemon/script/main.liq"\n(remote) root@htb:/root# cat /home/soapuser/liquidsoap-daemon/script/main.liq\n#!/usr/bin/env liquidsoap\n\n########################\n# Custom beet protocol #\n########################\n# Play random song with optional query argument\nadd_protocol("beet", fun(~rlog,~maxtime,arg) ->\n  get_process_lines(\n    "/usr/bin/beet random -p #{arg}"\n  )\n)\n\n#################\n# Telnet server #\n#################\nset("server.telnet",true)\nset("server.telnet.bind_addr", "0.0.0.0")\n\n\n#########################\n# Interactive variables #\n#########################\n# Set "button" to false to run beet query (with optional argument "query")\nb = interactive.bool("button", true)\nq = interactive.string("query", "")\n\n\n###################\n# The two sources #\n###################\ns1 = playlist("~/music/playlist.m3u")\ns2 = mksafe(request.dynamic.list({ [request.create("beet:" ^ q())] }))\n\n# Switch between the tracks depending on the boolean\ns = switch(track_sensitive=false,[(b,s1), ({true},s2)])\n\n\n##################\n# Icecast output #\n##################\noutput.icecast(%vorbis,\n  host="localhost",\n  port=8000,\n  password="heiX.uy1",\n  mount="radio.ogg",\n  s\n);\n'})}),"\n",(0,s.jsx)(n.h2,{id:"xsltprocesso-rce",children:"XSLTProcesso RCE"}),"\n",(0,s.jsx)(n.p,{children:"\u6f0f\u6d1e\u6587\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(67297).A+"",width:"1564",height:"1138"})}),"\n",(0,s.jsx)(n.p,{children:"poc"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:t(70099).A+"",width:"2132",height:"754"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},67297:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/image_20250444-204427-2e799bd9d91e8cf99807e492d3e10a20.png"},70099:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/images/image_20250444-204443-0994e590bc80c0e9c4468069cdd3f015.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var o=t(96540);const s={},a=o.createContext(s);function i(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);