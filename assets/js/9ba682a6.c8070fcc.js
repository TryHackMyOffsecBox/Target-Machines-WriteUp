"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[6286],{7680:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var s=n(85893),a=n(11151);const i={},l="CrownJewel-1",r={id:"HackTheBox/Sherlocks/CrownJewel-1/index",title:"CrownJewel-1",description:"Forela's domain controller is under attack. The Domain Administrator account is believed to be compromised, and it is suspected that the threat actor dumped the NTDS.dit database on the DC. We just received an alert of vssadmin being used on the DC, since this is not part of the routine schedule we have good reason to believe that the attacker abused this LOLBIN utility to get the Domain environment's crown jewel. Perform some analysis on provided artifacts for a quick triage and if possible kick the attacker as early as possible.",source:"@site/docs/HackTheBox/Sherlocks/CrownJewel-1/index.md",sourceDirName:"HackTheBox/Sherlocks/CrownJewel-1",slug:"/HackTheBox/Sherlocks/CrownJewel-1/",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/CrownJewel-1/",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Sherlocks/CrownJewel-1/index.md",tags:[],version:"current",frontMatter:{},sidebar:"HackTheBox_Sidebar",previous:{title:"Constellation",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Constellation/"},next:{title:"Hyperfiletable",permalink:"/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Hyperfiletable/"}},o={},c=[{value:"\u9898\u76ee\u6570\u636e",id:"\u9898\u76ee\u6570\u636e",level:2},{value:"Task 1",id:"task-1",level:2},{value:"Task 2",id:"task-2",level:2},{value:"Task 3",id:"task-3",level:2},{value:"Task 4",id:"task-4",level:2},{value:"Task 5",id:"task-5",level:2},{value:"Task 6",id:"task-6",level:2},{value:"Task 7",id:"task-7",level:2},{value:"Task 8",id:"task-8",level:2},{value:"Task 9",id:"task-9",level:2},{value:"Task 10",id:"task-10",level:2},{value:"Task 11",id:"task-11",level:2},{value:"Task 12",id:"task-12",level:2},{value:"Task 13",id:"task-13",level:2},{value:"Task 14",id:"task-14",level:2},{value:"Task 15",id:"task-15",level:2}];function d(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"crownjewel-1",children:"CrownJewel-1"})}),"\n",(0,s.jsxs)(t.admonition,{title:"Sherlock Scenario",type:"info",children:[(0,s.jsx)(t.p,{children:"Forela's domain controller is under attack. The Domain Administrator account is believed to be compromised, and it is suspected that the threat actor dumped the NTDS.dit database on the DC. We just received an alert of vssadmin being used on the DC, since this is not part of the routine schedule we have good reason to believe that the attacker abused this LOLBIN utility to get the Domain environment's crown jewel. Perform some analysis on provided artifacts for a quick triage and if possible kick the attacker as early as possible."}),(0,s.jsx)(t.p,{children:"Forela \u7684\u57df\u63a7\u5236\u5668\u53d7\u5230\u653b\u51fb\u3002\u636e\u4fe1\uff0c\u8be5\u57df\u63a7\u5236\u5668\u7684\u57df\u7ba1\u7406\u5458\u8d26\u6237\u5df2\u88ab\u653b\u7834\uff0c\u5e76\u4e14\u6000\u7591\u5a01\u80c1\u8005\u5728\u8be5\u57df\u63a7\u5236\u5668\u4e0a\u8f6c\u50a8\u4e86 NTDS.dit \u6570\u636e\u5e93\u3002\u6211\u4eec\u521a\u521a\u6536\u5230\u5728 DC \u4e0a\u4f7f\u7528 vssadmin \u7684\u8b66\u62a5\uff0c\u7531\u4e8e\u8fd9\u4e0d\u5c5e\u4e8e\u4f8b\u884c\u8ba1\u5212\u7684\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u6709\u5145\u5206\u7406\u7531\u76f8\u4fe1\u653b\u51fb\u8005\u6ee5\u7528\u4e86\u6b64 LOLBIN \u5b9e\u7528\u7a0b\u5e8f\u6765\u83b7\u53d6\u57df\u73af\u5883\u7684\u7687\u51a0\u4e0a\u7684\u660e\u73e0\u3002\u5bf9\u6240\u63d0\u4f9b\u7684\u5de5\u4ef6\u8fdb\u884c\u4e00\u4e9b\u5206\u6790\uff0c\u4ee5\u4fbf\u5feb\u901f\u5206\u6d41\uff0c\u5e76\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u5c3d\u65e9\u6e05\u9664\u653b\u51fb\u8005\u3002"})]}),"\n",(0,s.jsx)(t.h2,{id:"\u9898\u76ee\u6570\u636e",children:"\u9898\u76ee\u6570\u636e"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:n(97145).Z+"",children:"CrownJewel1.zip"})}),"\n",(0,s.jsx)(t.h2,{id:"task-1",children:"Task 1"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"\u653b\u51fb\u8005\u53ef\u6ee5\u7528 vssadmin \u5b9e\u7528\u7a0b\u5e8f\u521b\u5efa\u5377\u5f71\u5feb\u7167\uff0c\u7136\u540e\u63d0\u53d6 NTDS.dit \u7b49\u654f\u611f\u6587\u4ef6\uff0c\u7ed5\u8fc7\u5b89\u5168\u673a\u5236\u3002\u786e\u5b9a\u5377\u5f71\u590d\u5236\u670d\u52a1\u8fdb\u5165\u8fd0\u884c\u72b6\u6001\u7684\u65f6\u95f4\u3002"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"TODO \u672a\u5b8c\u6210"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-2",children:"Task 2"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-3",children:"Task 3"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-4",children:"Task 4"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-5",children:"Task 5"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-6",children:"Task 6"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-7",children:"Task 7"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-8",children:"Task 8"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-9",children:"Task 9"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-10",children:"Task 10"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-11",children:"Task 11"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-12",children:"Task 12"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-13",children:"Task 13"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-14",children:"Task 14"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})}),"\n",(0,s.jsx)(t.h2,{id:"task-15",children:"Task 15"}),"\n",(0,s.jsx)(t.blockquote,{children:"\n"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-plaintext",metastring:'title="Answer"'})})]})}function h(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},97145:(e,t,n)=>{n.d(t,{Z:()=>s});const s=n.p+"assets/files/CrownJewel1-2f6ea12ed661063118ce83ab30f65e98.zip"},11151:(e,t,n)=>{n.d(t,{Z:()=>r,a:()=>l});var s=n(67294);const a={},i=s.createContext(a);function l(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);