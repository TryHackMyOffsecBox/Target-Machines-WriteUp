"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[48830],{73106:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>m,contentTitle:()=>c,default:()=>o,frontMatter:()=>i,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"Independent-Environment/Fengtaisec/51","title":"\u7834\u89e3\u52a0\u5bc6\u6570\u636e","description":"\u67d0\u5de5\u63a7\u5382\u5546\u81ea\u884c\u7814\u53d1\u4e86\u4e00\u5957\u52a0\u5bc6\u7cfb\u7edf\uff0c\u8fd9\u6837\u7684\u8bdd\u53ea\u8981\u4e0d\u662f\u7cfb\u7edf\u5185\u90e8\u4eba\u5458\uff0c\u5373\u4f7f\u6570\u636e\u88ab\u7a83\u542c\u6ca1\u5173\u7cfb\u4e86\u3002\u4f60\u622a\u83b7\u4e86\u4e00\u6bb5\u5bc6\u6587\uff1a109930883401687215730636522935643539707\uff0c\u8bf7\u8fdb\u884c\u89e3\u5bc6","source":"@site/docs/Independent-Environment/Fengtaisec/51.md","sourceDirName":"Independent-Environment/Fengtaisec","slug":"/Independent-Environment/Fengtaisec/51","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/51","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/Fengtaisec/51.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"\u5927\u5de5UDP\u534f\u8bae","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/5"},"next":{"title":"\u5de5\u63a7\u871c\u7f50\u65e5\u5fd7\u5206\u6790","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/Fengtaisec/6"}}');var t=s(74848),r=s(28453);const i={},c="\u7834\u89e3\u52a0\u5bc6\u6570\u636e",m={},l=[];function d(e){const n={admonition:"admonition",annotation:"annotation",code:"code",h1:"h1",header:"header",math:"math",mi:"mi",mo:"mo",mrow:"mrow",mspace:"mspace",msup:"msup",mtext:"mtext",p:"p",pre:"pre",semantics:"semantics",span:"span",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"\u7834\u89e3\u52a0\u5bc6\u6570\u636e",children:"\u7834\u89e3\u52a0\u5bc6\u6570\u636e"})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"\u67d0\u5de5\u63a7\u5382\u5546\u81ea\u884c\u7814\u53d1\u4e86\u4e00\u5957\u52a0\u5bc6\u7cfb\u7edf\uff0c\u8fd9\u6837\u7684\u8bdd\u53ea\u8981\u4e0d\u662f\u7cfb\u7edf\u5185\u90e8\u4eba\u5458\uff0c\u5373\u4f7f\u6570\u636e\u88ab\u7a83\u542c\u6ca1\u5173\u7cfb\u4e86\u3002\u4f60\u622a\u83b7\u4e86\u4e00\u6bb5\u5bc6\u6587\uff1a109930883401687215730636522935643539707\uff0c\u8bf7\u8fdb\u884c\u89e3\u5bc6"}),(0,t.jsxs)(n.p,{children:["flag \u5f62\u5f0f\u4e3a ",(0,t.jsx)(n.code,{children:"flag{}"})]})]}),"\n",(0,t.jsx)(n.p,{children:"ChatGPT \u76f4\u63a5\u79d2\u4e86"}),"\n",(0,t.jsx)(n.p,{children:"\u5148\u5206\u6790\u52a0\u5bc6\u811a\u672c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"m = \"unknown\"\ne = 2\nn = 0x6FBD096744B2B34B423D70C8FB19B541\n\nassert(int(m.encode('hex'), 16) < n)\nc = pow(int(m.encode('hex'), 16),e,n)\nprint c\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5178\u578b\u7684 RSA \u52a0\u5bc6\u95ee\u9898"}),"\n",(0,t.jsx)(n.span,{className:"katex-display",children:(0,t.jsxs)(n.span,{className:"katex",children:[(0,t.jsx)(n.span,{className:"katex-mathml",children:(0,t.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,t.jsxs)(n.semantics,{children:[(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{children:"c"}),(0,t.jsx)(n.mo,{children:"="}),(0,t.jsxs)(n.msup,{children:[(0,t.jsx)(n.mi,{children:"m"}),(0,t.jsx)(n.mi,{children:"e"})]}),(0,t.jsx)(n.mspace,{}),(0,t.jsx)(n.mspace,{width:"1em"}),(0,t.jsxs)(n.mrow,{children:[(0,t.jsx)(n.mi,{mathvariant:"normal",children:"m"}),(0,t.jsx)(n.mi,{mathvariant:"normal",children:"o"}),(0,t.jsx)(n.mi,{mathvariant:"normal",children:"d"})]}),(0,t.jsx)(n.mtext,{children:"\u2009"}),(0,t.jsx)(n.mtext,{children:"\u2009"}),(0,t.jsx)(n.mi,{children:"n"})]}),(0,t.jsx)(n.annotation,{encoding:"application/x-tex",children:"c = m^e \\mod n"})]})})}),(0,t.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(n.span,{className:"mord mathnormal",children:"c"}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(n.span,{className:"mrel",children:"="}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"0.7144em"}}),(0,t.jsxs)(n.span,{className:"mord",children:[(0,t.jsx)(n.span,{className:"mord mathnormal",children:"m"}),(0,t.jsx)(n.span,{className:"msupsub",children:(0,t.jsx)(n.span,{className:"vlist-t",children:(0,t.jsx)(n.span,{className:"vlist-r",children:(0,t.jsx)(n.span,{className:"vlist",style:{height:"0.7144em"},children:(0,t.jsxs)(n.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,t.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(n.span,{className:"mord mathnormal mtight",children:"e"})})]})})})})})]}),(0,t.jsx)(n.span,{className:"mspace allowbreak"}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"1em"}})]}),(0,t.jsxs)(n.span,{className:"base",children:[(0,t.jsx)(n.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(n.span,{className:"mord",children:(0,t.jsx)(n.span,{className:"mord",children:(0,t.jsx)(n.span,{className:"mord mathrm",children:"mod"})})}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(n.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(n.span,{className:"mord mathnormal",children:"n"})]})]})]})}),"\n",(0,t.jsx)(n.p,{children:"\u6c42\u89e3 m \u7684\u53ef\u80fd\u503c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from sympy import mod_inverse, isprime, sqrt_mod\n\n# Given values\nc = 109930883401687215730636522935643539707\nn = 0x6FBD096744B2B34B423D70C8FB19B541\ne = 2\n\n# Check if c has a modular square root under n\ntry:\n    # Compute the modular square root of c mod n\n    m_values = sqrt_mod(c, n, all_roots=True)\nexcept ValueError:\n    m_values = None\n\nm_values\n\n# [31698494966724069351424094257, 47966037907531568164415165899182644837, 100559804454305364139582472308130223836, 148525842330138437337273568855888774416]\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fd8\u539f\u51fa\u5b57\u7b26\u4e32"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Function to convert a number to a hex string and then decode it as text\ndef number_to_string(num):\n    try:\n        # Convert to hex, remove the '0x' prefix, and decode to ASCII\n        hex_str = hex(num)[2:]  # Remove '0x' prefix\n        if len(hex_str) % 2 != 0:  # Make sure it's even-length for decoding\n            hex_str = \"0\" + hex_str\n        return bytes.fromhex(hex_str).decode('utf-8', errors='ignore')  # Decode ignoring invalid characters\n    except Exception:\n        return None\n\n# Attempt to decode each candidate for m\ndecoded_strings = [number_to_string(m) for m in m_values]\ndecoded_strings\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-flag",children:"flag{flag_EnCryp1}\n"})})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var a=s(96540);const t={},r=a.createContext(t);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);