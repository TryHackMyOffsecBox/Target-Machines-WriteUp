<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析 | Target Machines WriteUp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析 | Target Machines WriteUp"><meta data-rh="true" name="description" content="2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析"><meta data-rh="true" property="og:description" content="2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-12-02T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://randark.site"><meta data-rh="true" property="article:tag" content="CTF,Incident-Response"><link data-rh="true" rel="icon" href="/Target-Machines-WriteUp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis","mainEntityOfPage":"https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis","url":"https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis","headline":"2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析","name":"2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析","description":"2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析","datePublished":"2024-12-02T00:00:00.000Z","author":{"@type":"Person","name":"陈橘mo","description":"Why So Serious?","url":"https://randark.site","image":"https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/Target-Machines-WriteUp/blog/rss.xml" title="Target Machines WriteUp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Target-Machines-WriteUp/blog/atom.xml" title="Target Machines WriteUp Atom Feed">



<link rel="preconnect" href="https://static.cloudflareinsights.com">
<script src="https://static.cloudflareinsights.com/beacon.min.js" defer="defer" data-cf-beacon="{&quot;token&quot;:&quot;419208379f5c472a9afad0d3dc0396f9&quot;}"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/Target-Machines-WriteUp/assets/css/styles.b5431df6.css">
<script src="/Target-Machines-WriteUp/assets/js/runtime~main.f1c58d5a.js" defer="defer"></script>
<script src="/Target-Machines-WriteUp/assets/js/main.30bfee9e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Target-Machines-WriteUp/"><div class="navbar__logo"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Target Machines WriteUp</b></a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/HackTheBox/">HackTheBox</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Yunjing/">春秋云境</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/HackMyVM/">HackMyVM</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Xuanji/">玄机</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Independent-Environment/">其他靶场</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/ToolsGuide/">Tools Guide</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Target-Machines-WriteUp/blog">Blog</a><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Target-Machines-WriteUp/blog/2025CCB&amp;CISCN-Semis-ISW">2025 长城杯 &amp; 国赛 半决赛 ISW</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Target-Machines-WriteUp/blog/2024CCB&amp;CISCN-WinFT">2024 长城杯 &amp; 国赛 初赛 威胁检测与网络流量分析 WinFT</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Target-Machines-WriteUp/blog/2024CCB&amp;CISCN-sc05">2024 长城杯 &amp; 国赛 初赛 威胁检测与网络流量分析 sc05</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/Target-Machines-WriteUp/blog/2024CCB&amp;CISCN-zeroshell">2024 长城杯 &amp; 国赛 初赛 威胁检测与网络流量分析 zeroshell</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/Target-Machines-WriteUp/blog/2024wdb-Semis IncidentResponse-threat analysis">2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析</a></li></ul></div></nav></aside><main class="col col--7"><article><header><h1 class="title_f1Hy">2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-12-02T00:00:00.000Z">2024年12月2日</time> · <!-- -->阅读需 19 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://randark.site" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://raw.githubusercontent.com/TryHackMyOffsecBox/Target-Machines-WriteUp/refs/heads/main/static/img/users/IMG_8925.PNG" alt="陈橘mo"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://randark.site" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">陈橘mo</span></a></div><small class="authorTitle_nd0D" title="Why So Serious?">Why So Serious?</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>2024 网鼎杯 半决赛 安全运营挑战赛 威胁分析</p>
<p>官方 writeup 未公布，无标准答案</p>
<p>按照题目描述进行检材分析</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="first-of-all---在此之前">First of all - 在此之前<a href="#first-of-all---在此之前" class="hash-link" aria-label="First of all - 在此之前的直接链接" title="First of all - 在此之前的直接链接">​</a></h2>
<p>对题目提供的附件进行分析，题目提供了以下附件</p>
<ul>
<li>dump.mem</li>
<li>disk.ad1</li>
<li>disk.ad1.txt</li>
</ul>
<p>其中，文件 <code>disk.ad1.txt</code> 的内容为</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Created By AccessData® FTK® Imager 4.7.1.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Case Information:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Acquired using: ADI4.7.1.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Case Number:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Evidence Number:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unique Description:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Examiner:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Notes:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Information for C:\Users\skills\Desktop\disk.ad1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Custom Content Sources]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> F:\:NONAME [NTFS]|[root]|Windows|*(Wildcard,Consider Case,Include Subdirectories)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> F:\:NONAME [NTFS]|[root]|ProgramData|*(Wildcard,Consider Case,Include Subdirectories)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> F:\:NONAME [NTFS]|[root]|Program Files (x86)|*(Wildcard,Consider Case,Include Subdirectories)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> F:\:NONAME [NTFS]|[root]|Program Files|*(Wildcard,Consider Case,Include Subdirectories)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> F:\:NONAME [NTFS]|[root]|Documents and Settings|*(Wildcard,Consider Case,Include Subdirectories)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> F:\:NONAME [NTFS]|[root]|PerfLogs|*(Wildcard,Consider Case,Include Subdirectories)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> F:\:NONAME [NTFS]|[root]|System Volume Information|*(Wildcard,Consider Case,Include Subdirectories)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Computed Hashes]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> MD5 checksum:    a576646c40769abb7dd36904417b6a4f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> SHA1 checksum:   9cee1fe36957674626661e1197b19b5f0b047026</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Image information:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Acquisition started:   Tue Nov  5 11:04:42 2024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Acquisition finished:  Tue Nov  5 11:49:00 2024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Segment list:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  C:\Users\skills\Desktop\disk.ad1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Image Verification Results:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Verification started:  Tue Nov  5 11:52:50 2024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Verification finished: Tue Nov  5 12:07:07 2024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> MD5 checksum:    a576646c40769abb7dd36904417b6a4f : verified</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> SHA1 checksum:   9cee1fe36957674626661e1197b19b5f0b047026 : verified</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由此可以得知，文件 <code>disk.ad1</code> 是由 <code>FTK Imager</code> 所制作的磁盘镜像，文件 <code>dump.mem</code> 是 目标计算机上捕获的内存镜像</p>
<p>对于 <code>disk.ad1</code> 文件，可以使用 <code>FTK Imager</code> 进行加载并挂载到虚拟盘符；而对于 <code>dump.mem</code> 文件，可以使用 <code>Volatility</code> 进行取证分析（需要内存镜像中系统版本对应的符号表）或者使用 <code>R-Studio</code> 对内存中的 <code>NTFS</code> 结构表进行读取分析，或者直接使用 <code>Strings</code> 进行暴力检索分析</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="威胁分析---01">威胁分析 - 01<a href="#威胁分析---01" class="hash-link" aria-label="威胁分析 - 01的直接链接" title="威胁分析 - 01的直接链接">​</a></h2>
<blockquote>
<p>在调查网络性能或安全问题时，了解特定应用程序在一段时间内的数据传输情况对于检测异常流量和潜在威胁至关重要。通过分析网络活动日志，我们可以确定是否存在数据泄露或异常通信。</p>
<p>请问，firefox 进程自有记录以来一共发送了多少字节的数据？（请将答案编辑并存入 <code>/opt/wxfx/answer/1.txt</code> 文件中，参考 <code>/opt/wxfx/example</code> 目录）</p>
</blockquote>
<p>基于题目描述，可以定位到 Windows 的服务报告使用数据库文件 <code>SRUDB.dat</code></p>
<p>参考资料 <a href="https://addshore.com/2023/10/see-all-windows-11-network-data-usage/" target="_blank" rel="noopener noreferrer">See all Windows 11 network data usage – addshore</a></p>
<p>在 <code>FTK Imager</code> 定位到 <code>SRUDB.dat</code> 文件的路径 <code>F:\Windows\System32\sru\SRUDB.dat</code></p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241205-120525-2085dd7efef559d4d4ba8e1b28fe2055.png" width="1902" height="1117" class="img_ev3q"></p>
<p>使用 <a href="https://www.nirsoft.net/utils/network_usage_view.html" target="_blank" rel="noopener noreferrer">NetworkUsageView - NirSoft</a> 进行查看</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241206-120620-109155fced8d4377f31e4b95793ac352.png" width="1902" height="1117" class="img_ev3q"></p>
<p>定位到 <code>firefox.exe</code> 进程的记录</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241207-120738-578da1bf991c6c149d5659cba94fb072.png" width="1902" height="1117" class="img_ev3q"></p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">3981907 + 384784 = 4366691</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>即可确定答案</p>
<div class="language-flag codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flag codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">4366691</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="威胁分析---02">威胁分析 - 02<a href="#威胁分析---02" class="hash-link" aria-label="威胁分析 - 02的直接链接" title="威胁分析 - 02的直接链接">​</a></h2>
<blockquote>
<p>识别安全防护软件的查杀记录，对于评估系统受感染的程度和了解攻击者所使用的工具至关重要。通过检查安全日志，可以获取被检测到的威胁信息。</p>
<p>请问，Windows Defender 检测到的第一个恶意软件的威胁 ID 是什么？（请将答案编辑并存入 <code>/opt/wxfx/answer/2.txt</code> 文件中，参考 <code>/opt/wxfx/example</code> 目录）</p>
</blockquote>
<p>在 <code>disk.ad1</code> 文件的磁盘数据中，定位到 <code>F:\Windows\System32\winevt\Logs\</code> 文件夹</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241220-232047-b6424ae86069dcd7c02f9ca37a98beed.png" width="1902" height="1117" class="img_ev3q"></p>
<p>将整个文件夹进行提取</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241221-232113-519b2f87bcff46d622a55fdec4e84ca5.png" width="1847" height="1259" class="img_ev3q"></p>
<p>根据 Windows Defender 的日志 ID 表 <a href="https://learn.microsoft.com/en-us/defender-endpoint/troubleshoot-microsoft-defender-antivirus" target="_blank" rel="noopener noreferrer">Microsoft Defender Antivirus event IDs and error codes - Microsoft Defender for Endpoint | Microsoft Learn</a> 可以知道，当 Windows Defender 检测到威胁时所记录的日志，其日志 ID 为 <code>1116</code></p>
<p>使用 <a href="https://www.nirsoft.net/utils/full_event_log_view.html" target="_blank" rel="noopener noreferrer">FullEventLogView - NirSoft</a> 进行分析</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241228-232844-a0af77010be709e8c3063ba6a5015299.png" width="1844" height="1247" class="img_ev3q"></p>
<p>或者直接定位到 Windows Defender 的操作日志文件 <code>Microsoft-Windows-Windows Defender%4Operational.evtx</code></p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241229-232905-3117be2cb7a942ec8211da94fe31c898.png" width="1964" height="1252" class="img_ev3q"></p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Windows Defender 已从隔离区删除一个项目。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 有关详细信息，请参阅以下内容:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://go.microsoft.com/fwlink/?linkid=37020&amp;name=Trojan:Win32/Meterpreter.O&amp;threatid=2147729928&amp;enterprise=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  名称: Trojan:Win32/Meterpreter.O</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ID: 2147729928</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  严重性: Severe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  类别: Trojan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  用户: DESKTOP-M3JIVN3\skills</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  安全智能版本: AV: 1.421.82.0, AS: 1.421.82.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  引擎版本: 1.1.24090.11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>即可确定答案</p>
<div class="language-flag codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flag codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2147729928</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="威胁分析---03">威胁分析 - 03<a href="#威胁分析---03" class="hash-link" aria-label="威胁分析 - 03的直接链接" title="威胁分析 - 03的直接链接">​</a></h2>
<blockquote>
<p>了解恶意软件的内部名称（如开发者给它的命名）有助于识别其家族、版本和特定功能，进而制定有效的防御策略。</p>
<p>请问，系统中正在运行的恶意软件的内部名称是什么？（请将答案编辑并存入 <code>/opt/wxfx/answer/3.txt</code> 文件中，参考 <code>/opt/wxfx/example</code> 目录）</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="思路一-基于常见关键词进行定位">思路一 基于常见关键词进行定位<a href="#思路一-基于常见关键词进行定位" class="hash-link" aria-label="思路一 基于常见关键词进行定位的直接链接" title="思路一 基于常见关键词进行定位的直接链接">​</a></h3>
<p>对内存镜像的 Strings 进行分析，经过常见恶意程序的关键词匹配，可以定位到内存中的以下部分</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241226-122607-ef1ee44e643f8da22a26e28c2f894426.png" width="1968" height="1327" class="img_ev3q"></p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;------------- [ Welcome to DarkSide] -------------&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> What happend?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ----------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Your computers and servers are encrypted, backups are deleted. We use strong encryption algorithms, so you cannot decrypt your data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> But you can restore everything by purchasing a special program from us - universal decryptor. This program will restore all your network.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Follow our instructions below and you will recover all your data.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> What guarantees?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ----------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> We value our reputation. If we do not do our work and liabilities, nobody will pay us. This is not in our interests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> All our decryption software is perfectly tested and will decrypt your data. We will also provide support in case of problems.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> We guarantee to decrypt one file for free. Go to the site and contact us.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> How to get access on website?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ----------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Using a TOR browser:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1) Download and install TOR browser from this site: https://torproject.org/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2) Open our website: http://darksidfqzcuhtk2.onion/GM0CG8TNZ83ZPUD15TL76BLDCG0ST24TR6NXG1J2AVXSKF8KS4KFIIN2ON5GRWD4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> When you open our website, put the following data in the input form:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Key:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> lsJTyyTnzJlGQ1I6sfwV6oVcXaRynwN6mWphA7BKXEDIHJcDlhNNHsrxlkpggRChK2nQ7wP0sknJvl37lbqElTopkUywK3QnfJFmqDBSCmFISeWSudjgwxB4kKSp7h4VySHeu4LmDiZXTAh1dbZHWxTtZ0bA6PhCoDrbGkctY4rucITW4IdYUZJC8d2B7SFnr5EA7EoRkajrZW54brM5Kgwqsz67qzH6Hk0Vr3EDcnGzNjGQBapJczIWkgPtMCJdTkeemQ34XH7wawXu3eOGV3uJlBZNoSuaxtDHMGApS8EWsUXhafMW8WxFLAPLCo6pdm7MLcLsVDp9iBXU1sLv2KkGyUJbO0KOmom9f1JREuidviHRfsndEgMFBAjyq5v4VEIraiioAbtWM7eecYaXPVt3rolsBi8mtjxLOpFj73NPPitoIDxBNfHGzXxvRTXi06Pjx9pRnAtjIqoq5wovnHa8uBel8nq8yDJTk7NWdGdsv3yVwV2TmBin7OvFqHN9lweFNJyuziKCVGEtSaglUNudMmpFnNObGlhfh58jQsrQiQZ2d3AOFsi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> !!! DANGER !!!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> DO NOT MODIFY or try to RECOVER any files yourself. We WILL NOT be able to RESTORE them.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> !!! DANGER !!!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>基于已知明文，可以定位到相关进程</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS D:\Downloads\attachment\attachment&gt; .\volatility_2.6_win64_standalone.exe -f .\dump.mem --profile=Win10x64_14393 yarascan -Y &quot;Your computers and servers are encrypted&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework 2.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rule: r1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Owner: Process SearchProtocol Pid 4036</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dcc5  59 6f 75 72 20 63 6f 6d 70 75 74 65 72 73 20 61   Your.computers.a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dcd5  6e 64 20 73 65 72 76 65 72 73 20 61 72 65 20 65   nd.servers.are.e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dce5  6e 63 72 79 70 74 65 64 2c 20 62 61 63 6b 75 70   ncrypted,.backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dcf5  73 20 61 72 65 20 64 65 6c 65 74 65 64 2e 20 57   s.are.deleted..W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd05  65 20 75 73 65 20 73 74 72 6f 6e 67 20 65 6e 63   e.use.strong.enc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd15  72 79 70 74 69 6f 6e 20 61 6c 67 6f 72 69 74 68   ryption.algorith</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd25  6d 73 2c 20 73 6f 20 79 6f 75 20 63 61 6e 6e 6f   ms,.so.you.canno</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd35  74 20 64 65 63 72 79 70 74 20 79 6f 75 72 20 64   t.decrypt.your.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd45  61 74 61 2e 20 0d 0a 20 42 75 74 20 79 6f 75 20   ata.....But.you.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd55  63 61 6e 20 72 65 73 74 6f 72 65 20 65 76 65 72   can.restore.ever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd65  79 74 68 69 6e 67 20 62 79 20 70 75 72 63 68 61   ything.by.purcha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd75  73 69 6e 67 20 61 20 73 70 65 63 69 61 6c 20 70   sing.a.special.p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd85  72 6f 67 72 61 6d 20 66 72 6f 6d 20 75 73 20 2d   rogram.from.us.-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dd95  20 75 6e 69 76 65 72 73 61 6c 20 64 65 63 72 79   .universal.decry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976dda5  70 74 6f 72 2e 20 54 68 69 73 20 70 72 6f 67 72   ptor..This.progr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079976ddb5  61 6d 20 77 69 6c 6c 20 72 65 73 74 6f 72 65 20   am.will.restore.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rule: r1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Owner: Process SearchProtocol Pid 4036</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977314d  59 6f 75 72 20 63 6f 6d 70 75 74 65 72 73 20 61   Your.computers.a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977315d  6e 64 20 73 65 72 76 65 72 73 20 61 72 65 20 65   nd.servers.are.e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977316d  6e 63 72 79 70 74 65 64 2c 20 62 61 63 6b 75 70   ncrypted,.backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977317d  73 20 61 72 65 20 64 65 6c 65 74 65 64 2e 20 57   s.are.deleted..W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977318d  65 20 75 73 65 20 73 74 72 6f 6e 67 20 65 6e 63   e.use.strong.enc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977319d  72 79 70 74 69 6f 6e 20 61 6c 67 6f 72 69 74 68   ryption.algorith</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x207997731ad  6d 73 2c 20 73 6f 20 79 6f 75 20 63 61 6e 6e 6f   ms,.so.you.canno</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x207997731bd  74 20 64 65 63 72 79 70 74 20 79 6f 75 72 20 64   t.decrypt.your.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x207997731cd  61 74 61 2e 20 0d 0a 20 42 75 74 20 79 6f 75 20   ata.....But.you.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x207997731dd  63 61 6e 20 72 65 73 74 6f 72 65 20 65 76 65 72   can.restore.ever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x207997731ed  79 74 68 69 6e 67 20 62 79 20 70 75 72 63 68 61   ything.by.purcha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x207997731fd  73 69 6e 67 20 61 20 73 70 65 63 69 61 6c 20 70   sing.a.special.p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977320d  72 6f 67 72 61 6d 20 66 72 6f 6d 20 75 73 20 2d   rogram.from.us.-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977321d  20 75 6e 69 76 65 72 73 61 6c 20 64 65 63 72 79   .universal.decry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977322d  70 74 6f 72 2e 20 54 68 69 73 20 70 72 6f 67 72   ptor..This.progr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2079977323d  61 6d 20 77 69 6c 6c 20 72 65 73 74 6f 72 65 20   am.will.restore.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rule: r1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Owner: Process svchost.exe Pid 5784</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a10d  59 6f 75 72 20 63 6f 6d 70 75 74 65 72 73 20 61   Your.computers.a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a11d  6e 64 20 73 65 72 76 65 72 73 20 61 72 65 20 65   nd.servers.are.e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a12d  6e 63 72 79 70 74 65 64 2c 20 62 61 63 6b 75 70   ncrypted,.backup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a13d  73 20 61 72 65 20 64 65 6c 65 74 65 64 2e 20 57   s.are.deleted..W</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a14d  65 20 75 73 65 20 73 74 72 6f 6e 67 20 65 6e 63   e.use.strong.enc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a15d  72 79 70 74 69 6f 6e 20 61 6c 67 6f 72 69 74 68   ryption.algorith</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a16d  6d 73 2c 20 73 6f 20 79 6f 75 20 63 61 6e 6e 6f   ms,.so.you.canno</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a17d  74 20 64 65 63 72 79 70 74 20 79 6f 75 72 20 64   t.decrypt.your.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a18d  61 74 61 2e 20 0d 0a 20 42 75 74 20 79 6f 75 20   ata.....But.you.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a19d  63 61 6e 20 72 65 73 74 6f 72 65 20 65 76 65 72   can.restore.ever</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a1ad  79 74 68 69 6e 67 20 62 79 20 70 75 72 63 68 61   ything.by.purcha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a1bd  73 69 6e 67 20 61 20 73 70 65 63 69 61 6c 20 70   sing.a.special.p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a1cd  72 6f 67 72 61 6d 20 66 72 6f 6d 20 75 73 20 2d   rogram.from.us.-</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a1dd  20 75 6e 69 76 65 72 73 61 6c 20 64 65 63 72 79   .universal.decry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a1ed  70 74 6f 72 2e 20 54 68 69 73 20 70 72 6f 67 72   ptor..This.progr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a1fd  61 6d 20 77 69 6c 6c 20 72 65 73 74 6f 72 65 20   am.will.restore.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>排除掉正常系统服务，即可确定到 <code>Process svchost.exe Pid 5784</code> 为恶意进程</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="思路二-对磁盘非常规文件进行排查">思路二 对磁盘非常规文件进行排查<a href="#思路二-对磁盘非常规文件进行排查" class="hash-link" aria-label="思路二 对磁盘非常规文件进行排查的直接链接" title="思路二 对磁盘非常规文件进行排查的直接链接">​</a></h3>
<p>使用 <code>R-Studio</code> 对内存中的 NTFS 结构数据库进行分析，找到 <code>F:\Users\skills\svchost.exe</code></p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241231-123152-70223958fb0b713bde30bf1fa94bbff7.png" width="1911" height="1386" class="img_ev3q"></p>
<p>常规情况下，文件 <code>svchost.exe</code> 不会存在于用户目录中，可以确定为可疑文件</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="思路三-使用-yara-进行匹配分析">思路三 使用 Yara 进行匹配分析<a href="#思路三-使用-yara-进行匹配分析" class="hash-link" aria-label="思路三 使用 Yara 进行匹配分析的直接链接" title="思路三 使用 Yara 进行匹配分析的直接链接">​</a></h3>
<p><a href="https://github.com/ufrisk/MemProcFS" target="_blank" rel="noopener noreferrer">MemProcFS</a> 自带了一份 Malware Yara 匹配规则表，可以直接使用</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241201-130121-da8a16b26cfc50a254008d8e76ed0b70.png" width="1059" height="408" class="img_ev3q"></p>
<p>Volatility 的话，可以使用 <a href="https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9" target="_blank" rel="noopener noreferrer">Simple python script for merging malware yara rules from https://github.com/Yara-Rules/rules</a> 将 Yara 官方规则库，以及一些增强型 Yara 规则库，进行合并之后进行加载，也可以定位到恶意进程</p>
<p>综上，都可以定位到恶意软件的信息，其文件路径为 <code>F:\Users\skills\svchost.exe</code> 进程信息为 <code>Process svchost.exe Pid 5784</code></p>
<p>将可执行文件进行提取</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS D:\Downloads\attachment\attachment&gt; .\volatility_2.6_win64_standalone.exe -f .\dump.mem --profile=Win10x64_14393 dumpfiles --regex &quot;skills\\svchost\.exe&quot; -D .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework 2.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ImageSectionObject 0xffff9a88056a9ef0   5784   \Device\HarddiskVolume3\Users\skills\svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataSectionObject 0xffff9a88056a9ef0   5784   \Device\HarddiskVolume3\Users\skills\svchost.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以得到文件 <code>file.5784.0xffff9a8805ed2010.dat</code></p>
<p>对 <code>file.5784.0xffff9a8805ed2010.dat</code> 查看其 PE 文件信息</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241235-143503-798c123684ee42e0e8220e3da3b7dde3.png" width="1898" height="1101" class="img_ev3q"></p>
<p>即可确定答案</p>
<div class="language-flag codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flag codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">calimalimodumator.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="威胁分析---04">威胁分析 - 04<a href="#威胁分析---04" class="hash-link" aria-label="威胁分析 - 04的直接链接" title="威胁分析 - 04的直接链接">​</a></h2>
<blockquote>
<p>逆向分析恶意软件时，确定其在进程内存中存储关键数据的位置，对于理解其工作机制和防范进一步的攻击非常重要。</p>
<p>请问，恶意软件在进程内存中存储密钥的内存地址是什么？（请将答案编辑并存入 <code>/opt/wxfx/answer/4.txt</code> 文件中，参考 <code>/opt/wxfx/example</code> 目录）</p>
</blockquote>
<p>在上文中，已经在内存中找到了恶意软件的勒索信息</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">When you open our website, put the following data in the input form:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Key:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lsJTyyTnzJlGQ1I6sfwV6oVcXaRynwN6mWphA7BKXEDIHJcDlhNNHsrxlkpggRChK2nQ7wP0sknJvl37lbqElTopkUywK3QnfJFmqDBSCmFISeWSudjgwxB4kKSp7h4VySHeu4LmDiZXTAh1dbZHWxTtZ0bA6PhCoDrbGkctY4rucITW4IdYUZJC8d2B7SFnr5EA7EoRkajrZW54brM5Kgwqsz67qzH6Hk0Vr3EDcnGzNjGQBapJczIWkgPtMCJdTkeemQ34XH7wawXu3eOGV3uJlBZNoSuaxtDHMGApS8EWsUXhafMW8WxFLAPLCo6pdm7MLcLsVDp9iBXU1sLv2KkGyUJbO0KOmom9f1JREuidviHRfsndEgMFBAjyq5v4VEIraiioAbtWM7eecYaXPVt3rolsBi8mtjxLOpFj73NPPitoIDxBNfHGzXxvRTXi06Pjx9pRnAtjIqoq5wovnHa8uBel8nq8yDJTk7NWdGdsv3yVwV2TmBin7OvFqHN9lweFNJyuziKCVGEtSaglUNudMmpFnNObGlhfh58jQsrQiQZ2d3AOFsi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <code>yarascan</code> 进行检索</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS D:\Downloads\attachment\attachment&gt; .\volatility_2.6_win64_standalone.exe -f .\dump.mem --profile=Win10x64_14393 yarascan -Y &quot;lsJTyyTnzJlGQ&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework 2.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">......</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Rule: r1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Owner: Process svchost.exe Pid 5784</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a585  6c 73 4a 54 79 79 54 6e 7a 4a 6c 47 51 31 49 36   lsJTyyTnzJlGQ1I6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a595  73 66 77 56 36 6f 56 63 58 61 52 79 6e 77 4e 36   sfwV6oVcXaRynwN6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a5a5  6d 57 70 68 41 37 42 4b 58 45 44 49 48 4a 63 44   mWphA7BKXEDIHJcD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a5b5  6c 68 4e 4e 48 73 72 78 6c 6b 70 67 67 52 43 68   lhNNHsrxlkpggRCh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a5c5  4b 32 6e 51 37 77 50 30 73 6b 6e 4a 76 6c 33 37   K2nQ7wP0sknJvl37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a5d5  6c 62 71 45 6c 54 6f 70 6b 55 79 77 4b 33 51 6e   lbqElTopkUywK3Qn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a5e5  66 4a 46 6d 71 44 42 53 43 6d 46 49 53 65 57 53   fJFmqDBSCmFISeWS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a5f5  75 64 6a 67 77 78 42 34 6b 4b 53 70 37 68 34 56   udjgwxB4kKSp7h4V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a605  79 53 48 65 75 34 4c 6d 44 69 5a 58 54 41 68 31   ySHeu4LmDiZXTAh1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a615  64 62 5a 48 57 78 54 74 5a 30 62 41 36 50 68 43   dbZHWxTtZ0bA6PhC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a625  6f 44 72 62 47 6b 63 74 59 34 72 75 63 49 54 57   oDrbGkctY4rucITW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a635  34 49 64 59 55 5a 4a 43 38 64 32 42 37 53 46 6e   4IdYUZJC8d2B7SFn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a645  72 35 45 41 37 45 6f 52 6b 61 6a 72 5a 57 35 34   r5EA7EoRkajrZW54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a655  62 72 4d 35 4b 67 77 71 73 7a 36 37 71 7a 48 36   brM5Kgwqsz67qzH6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a665  48 6b 30 56 72 33 45 44 63 6e 47 7a 4e 6a 47 51   Hk0Vr3EDcnGzNjGQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a675  42 61 70 4a 63 7a 49 57 6b 67 50 74 4d 43 4a 64   BapJczIWkgPtMCJd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>即可确定答案</p>
<div class="language-flag codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flag codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0x00d1a585</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="威胁分析---05">威胁分析 - 05<a href="#威胁分析---05" class="hash-link" aria-label="威胁分析 - 05的直接链接" title="威胁分析 - 05的直接链接">​</a></h2>
<blockquote>
<p>分析恶意软件的行为包括了解其在系统中启用了哪些权限，这有助于评估其潜在的危害和攻击范围。通过检查进程的权限列表，可以发现其可能执行的敏感操作。</p>
<p>请问，恶意软件在其进程中启用了多少个权限？（请将答案编辑并存入 <code>/opt/wxfx/answer/5.txt</code> 文件中，参考 <code>/opt/wxfx/example</code> 目录）</p>
</blockquote>
<p>已知恶意程序的进程信息为 <code>Process svchost.exe Pid 5784</code> 的情况下，查看进程权限信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS D:\Downloads\attachment\attachment&gt; .\volatility_2.6_win64_standalone.exe -f .\dump.mem --profile=Win10x64_14393 privs -p 5784</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework 2.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Pid      Process          Value  Privilege                            Attributes               Description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------- ---------------- ------ ------------------------------------ ------------------------ -----------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           2 SeCreateTokenPrivilege                                        Create a token object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           3 SeAssignPrimaryTokenPrivilege                                 Replace a process-level token</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           4 SeLockMemoryPrivilege                                         Lock pages in memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           5 SeIncreaseQuotaPrivilege             Present,Enabled          Increase quotas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           6 SeMachineAccountPrivilege                                     Add workstations to the domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           7 SeTcbPrivilege                                                Act as part of the operating system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           8 SeSecurityPrivilege                  Present,Enabled          Manage auditing and security log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe           9 SeTakeOwnershipPrivilege             Present,Enabled          Take ownership of files/objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          10 SeLoadDriverPrivilege                Present,Enabled          Load and unload device drivers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          11 SeSystemProfilePrivilege             Present,Enabled          Profile system performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          12 SeSystemtimePrivilege                Present,Enabled          Change the system time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          13 SeProfileSingleProcessPrivilege      Present,Enabled          Profile a single process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          14 SeIncreaseBasePriorityPrivilege      Present,Enabled          Increase scheduling priority</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          15 SeCreatePagefilePrivilege            Present,Enabled          Create a pagefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          16 SeCreatePermanentPrivilege                                    Create permanent shared objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          17 SeBackupPrivilege                    Present,Enabled          Backup files and directories</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          18 SeRestorePrivilege                   Present,Enabled          Restore files and directories</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          19 SeShutdownPrivilege                  Present,Enabled          Shut down the system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          20 SeDebugPrivilege                     Present,Enabled          Debug programs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          21 SeAuditPrivilege                                              Generate security audits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          22 SeSystemEnvironmentPrivilege         Present,Enabled          Edit firmware environment values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          23 SeChangeNotifyPrivilege              Present,Enabled,Default  Receive notifications of changes to files or directories</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          24 SeRemoteShutdownPrivilege            Present,Enabled          Force shutdown from a remote system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          25 SeUndockPrivilege                    Present,Enabled          Remove computer from docking station</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          26 SeSyncAgentPrivilege                                          Synch directory service data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          27 SeEnableDelegationPrivilege                                   Enable user accounts to be trusted for delegation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          28 SeManageVolumePrivilege              Present,Enabled          Manage the files on a volume</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          29 SeImpersonatePrivilege               Present,Enabled,Default  Impersonate a client after authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          30 SeCreateGlobalPrivilege              Present,Enabled,Default  Create global objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          31 SeTrustedCredManAccessPrivilege                               Access Credential Manager as a trusted caller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          32 SeRelabelPrivilege                                            Modify the mandatory integrity level of an object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          33 SeIncreaseWorkingSetPrivilege        Present,Enabled          Allocate more memory for user applications</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          34 SeTimeZonePrivilege                  Present,Enabled          Adjust the time zone of the computer&#x27;s internal clock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    5784 svchost.exe          35 SeCreateSymbolicLinkPrivilege        Present,Enabled          Required to create a symbolic link</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对 <code>Attributes</code> 为 <code>Enabled</code> 的权限进行筛选统计，即可确定答案</p>
<div class="language-flag codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flag codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">23</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="威胁分析---06">威胁分析 - 06<a href="#威胁分析---06" class="hash-link" aria-label="威胁分析 - 06的直接链接" title="威胁分析 - 06的直接链接">​</a></h2>
<blockquote>
<p>在分析勒索软件的行为时，确定其在内存中加载的位置对于深入理解其运行机制和发现潜在的漏洞非常重要。通过内存取证，可以找到打开勒索软件文件的设备的虚拟地址。</p>
<p>请问，打开勒索软件文件的设备的虚拟地址是什么（16 进制）？（请将答案编辑并存入 <code>/opt/wxfx/answer/6.txt</code> 文件中，参考 <code>/opt/wxfx/example</code> 目录）</p>
</blockquote>
<p>在上文中，已经确认了恶意程序的可执行文件在内存中的偏移地址 <code>0xffff9a88056a9ef0</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS D:\Downloads\attachment\attachment&gt; .\volatility_2.6_win64_standalone.exe -f .\dump.mem --profile=Win10x64_14393 dumpfiles --regex &quot;skills\\svchost\.exe&quot; -D .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework 2.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ImageSectionObject 0xffff9a88056a9ef0   5784   \Device\HarddiskVolume3\Users\skills\svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DataSectionObject 0xffff9a88056a9ef0   5784   \Device\HarddiskVolume3\Users\skills\svchost.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>进入 <code>volshell</code> 进行分析</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS D:\Downloads\attachment\attachment&gt; .\volatility_2.6_win64_standalone.exe -f .\dump.mem --profile=Win10x64_14393 volshell -p 5784</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Volatility Foundation Volatility Framework 2.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Current context: svchost.exe @ 0xffff9a8805cfb4c0, pid=5784, ppid=7136 DTB=0x30400000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to volshell! Current memory image is:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">file:///D:/Downloads/attachment/attachment/dump.mem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To get help, type &#x27;hh()&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; dt(&#x27;_FILE_OBJECT&#x27;,0xffff9a88056a9ef0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[_FILE_OBJECT _FILE_OBJECT] @ 0xFFFF9A88056A9EF0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x0   : Type                           5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x2   : Size                           216</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x8   : DeviceObject                   18446632507711949952</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10  : Vpb                            18446632507711953536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x18  : FsContext                      18446651757703889232</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x20  : FsContext2                     18446651757801468480</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x28  : SectionObjectPointer           18446632507741760728</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x30  : PrivateCacheMap                0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x38  : FinalStatus                    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x40  : RelatedFileObject              0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x48  : LockOperation                  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x49  : DeletePending                  0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x4a  : ReadAccess                     1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x4b  : WriteAccess                    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x4c  : DeleteAccess                   0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x4d  : SharedRead                     1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x4e  : SharedWrite                    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x4f  : SharedDelete                   1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x50  : Flags                          278594</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x58  : FileName                       \Users\skills\svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x68  : CurrentByteOffset              18446632507729944408</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x70  : Waiters                        0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x74  : Busy                           0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x78  : LastLock                       0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x80  : Lock                           18446632507729944432</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x98  : Event                          18446632507729944456</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xb0  : CompletionContext              0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xb8  : IrpListLock                    0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xc0  : IrpList                        18446632507729944496</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0xd0  : FileObjectExtension            0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;&gt;&gt; hex(18446632507711949952)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0xffff9a8804580c80L&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>即可确定答案</p>
<div class="language-flag codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-flag codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0xffff9a8804580c80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Target-Machines-WriteUp/blog/tags/ctf">CTF</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/Target-Machines-WriteUp/blog/tags/incident-response">Incident-Response</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/blog/2024-12-02-wdb-Semis-IncidentResponse-threat analysis/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/Target-Machines-WriteUp/blog/2024CCB&amp;CISCN-zeroshell"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">2024 长城杯 &amp; 国赛 初赛 威胁检测与网络流量分析 zeroshell</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Target-Machines-WriteUp/blog/2024qwbs8 Master of DFIR"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">2024 强网杯 Master of DFIR</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#first-of-all---在此之前" class="table-of-contents__link toc-highlight">First of all - 在此之前</a></li><li><a href="#威胁分析---01" class="table-of-contents__link toc-highlight">威胁分析 - 01</a></li><li><a href="#威胁分析---02" class="table-of-contents__link toc-highlight">威胁分析 - 02</a></li><li><a href="#威胁分析---03" class="table-of-contents__link toc-highlight">威胁分析 - 03</a><ul><li><a href="#思路一-基于常见关键词进行定位" class="table-of-contents__link toc-highlight">思路一 基于常见关键词进行定位</a></li><li><a href="#思路二-对磁盘非常规文件进行排查" class="table-of-contents__link toc-highlight">思路二 对磁盘非常规文件进行排查</a></li><li><a href="#思路三-使用-yara-进行匹配分析" class="table-of-contents__link toc-highlight">思路三 使用 Yara 进行匹配分析</a></li></ul></li><li><a href="#威胁分析---04" class="table-of-contents__link toc-highlight">威胁分析 - 04</a></li><li><a href="#威胁分析---05" class="table-of-contents__link toc-highlight">威胁分析 - 05</a></li><li><a href="#威胁分析---06" class="table-of-contents__link toc-highlight">威胁分析 - 06</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox 🇨🇳 Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>